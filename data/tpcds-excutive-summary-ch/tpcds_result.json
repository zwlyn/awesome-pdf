{
    "PowerTest": {
        "endTimeFormat": "2019-12-06 09:24:46", 
        "startTimeFormat": "2019-12-06 09:13:40", 
        "secondFormat": "00:11:05", 
        "sqls": [
            {
                "endTimeFormat": "2019-12-06 09:13:41", 
                "startTimeFormat": "2019-12-06 09:13:40", 
                "startTime": 1575594820.410957, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_1.sql", 
                "second": 0.6700868606567383, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 8\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 5\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 8\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 5\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                "id": 1, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/1.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query96.tpl\r", 
                "sid": 1, 
                "endTime": 1575594821.081044
            }, 
            {
                "endTimeFormat": "2019-12-06 09:13:42", 
                "startTimeFormat": "2019-12-06 09:13:41", 
                "startTime": 1575594821.081154, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_2.sql", 
                "second": 1.2532198429107666, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'M' and\r\n       cd_education_status = '4 yr Degree' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2001 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'M' and\r        cd_education_status = '4 yr Degree' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2001 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 2, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/2.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query7.tpl\r", 
                "sid": 2, 
                "endTime": 1575594822.334374
            }, 
            {
                "endTimeFormat": "2019-12-06 09:13:44", 
                "startTimeFormat": "2019-12-06 09:13:42", 
                "startTime": 1575594822.334471, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_3.sql", 
                "second": 2.1993439197540283, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Shoes'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Shoes'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Shoes') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2000\r\n   AND prev_yr.d_year=2000-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Shoes'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Shoes'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Shoes') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2000\r    AND prev_yr.d_year=2000-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                "id": 3, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/3.sql", 
                "secondFormat": "00:00:02", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query75.tpl\r", 
                "sid": 3, 
                "endTime": 1575594824.533815
            }, 
            {
                "endTimeFormat": "2019-12-06 09:13:45", 
                "startTimeFormat": "2019-12-06 09:13:44", 
                "startTime": 1575594824.533911, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_4.sql", 
                "second": 1.3231110572814941, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 36\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 36\r\n                                                    and ss_hdemo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 36\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 36\r\n                                                    and ss_hdemo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 36\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 36\r                                                     and ss_hdemo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 36\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 36\r                                                     and ss_hdemo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                "id": 4, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/4.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query44.tpl\r", 
                "sid": 4, 
                "endTime": 1575594825.857022
            }, 
            {
                "endTimeFormat": "2019-12-06 09:14:02", 
                "startTimeFormat": "2019-12-06 09:13:45", 
                "startTime": 1575594825.857114, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_5.sql", 
                "second": 16.740844011306763, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=1\r\n  and inv2.d_moy=1+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=1\r\n  and inv2.d_moy=1+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=1\r   and inv2.d_moy=1+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=1\r   and inv2.d_moy=1+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                "id": 5, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/5.sql", 
                "secondFormat": "00:00:16", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query39.tpl\r", 
                "sid": 5, 
                "endTime": 1575594842.597958
            }, 
            {
                "endTimeFormat": "2019-12-06 09:14:41", 
                "startTimeFormat": "2019-12-06 09:14:02", 
                "startTime": 1575594842.598045, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_6.sql", 
                "second": 38.572091817855835, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-04','yyyy-mm-dd') \r\n                  and to_date('2002-08-04','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-04','yyyy-mm-dd') \r\n                  and to_date('2002-08-04','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-04','yyyy-mm-dd') \r\n                  and to_date('2002-08-04','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2002-08-04','yyyy-mm-dd') \r                   and to_date('2002-08-04','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('2002-08-04','yyyy-mm-dd') \r                   and to_date('2002-08-04','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('2002-08-04','yyyy-mm-dd') \r                   and to_date('2002-08-04','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                "id": 6, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/6.sql", 
                "secondFormat": "00:00:38", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query80.tpl\r", 
                "sid": 6, 
                "endTime": 1575594881.170137
            }, 
            {
                "endTimeFormat": "2019-12-06 09:14:41", 
                "startTimeFormat": "2019-12-06 09:14:41", 
                "startTime": 1575594881.170215, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_7.sql", 
                "second": 0.02699899673461914, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 283\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('1999-02-22','yyyy-mm-dd') and \r\n        to_date('1999-02-22','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('1999-02-22','yyyy-mm-dd') and\r\n                             to_date('1999-02-22','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 283\r and i_item_sk = cs_item_sk \r and d_date between to_date('1999-02-22','yyyy-mm-dd') and \r         to_date('1999-02-22','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('1999-02-22','yyyy-mm-dd') and\r                              to_date('1999-02-22','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                "id": 7, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/7.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query32.tpl\r", 
                "sid": 7, 
                "endTime": 1575594881.197214
            }, 
            {
                "endTimeFormat": "2019-12-06 09:15:46", 
                "startTimeFormat": "2019-12-06 09:14:41", 
                "startTime": 1575594881.197297, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_8.sql", 
                "second": 65.54554200172424, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=8\r\n   and d_moy=11\r\n   and d_year=1999\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=8\r    and d_moy=11\r    and d_year=1999\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                "id": 8, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/8.sql", 
                "secondFormat": "00:01:05", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query19.tpl\r", 
                "sid": 8, 
                "endTime": 1575594946.742839
            }, 
            {
                "endTimeFormat": "2019-12-06 09:15:47", 
                "startTimeFormat": "2019-12-06 09:15:46", 
                "startTime": 1575594946.742943, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_9.sql", 
                "second": 0.44328904151916504, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,min(ss_net_profit) as store_sales_profit\r\n ,min(sr_net_loss) as store_returns_loss\r\n ,min(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 2002\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 2002\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 2002\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,min(ss_net_profit) as store_sales_profit\r  ,min(sr_net_loss) as store_returns_loss\r  ,min(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 2002\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 2002\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 2002\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                "id": 9, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/9.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query25.tpl\r", 
                "sid": 9, 
                "endTime": 1575594947.186232
            }, 
            {
                "endTimeFormat": "2019-12-06 09:15:53", 
                "startTimeFormat": "2019-12-06 09:15:47", 
                "startTime": 1575594947.186333, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_10.sql", 
                "second": 6.356101989746094, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_customer_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001\r\norder by \r\n  ss_customer_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_customer_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001\r order by \r   ss_customer_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                "id": 10, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/10.sql", 
                "secondFormat": "00:00:06", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query78.tpl\r", 
                "sid": 10, 
                "endTime": 1575594953.542435
            }, 
            {
                "endTimeFormat": "2019-12-06 09:15:57", 
                "startTimeFormat": "2019-12-06 09:15:53", 
                "startTime": 1575594953.542517, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_11.sql", 
                "second": 3.706779956817627, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1205 and 1205+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1205 and 1205+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                "id": 11, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/11.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query86.tpl\r", 
                "sid": 11, 
                "endTime": 1575594957.249297
            }, 
            {
                "endTimeFormat": "2019-12-06 09:15:57", 
                "startTimeFormat": "2019-12-06 09:15:57", 
                "startTime": 1575594957.249381, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_12.sql", 
                "second": 0.05309581756591797, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =1999\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'NC'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =1999\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'NC'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                "id": 12, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/12.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query1.tpl\r", 
                "sid": 12, 
                "endTime": 1575594957.302477
            }, 
            {
                "endTimeFormat": "2019-12-06 09:16:21", 
                "startTimeFormat": "2019-12-06 09:15:57", 
                "startTime": 1575594957.302577, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_13.sql", 
                "second": 24.223231077194214, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 2002 \r\nand     d_moy                   = 11\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like 'Unknown%'\r\nand     ca_gmt_offset           = -6\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 2002 \r and     d_moy                   = 11\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like 'Unknown%'\r and     ca_gmt_offset           = -6\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                "id": 13, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/13.sql", 
                "secondFormat": "00:00:24", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query91.tpl\r", 
                "sid": 13, 
                "endTime": 1575594981.525808
            }, 
            {
                "endTimeFormat": "2019-12-06 09:16:48", 
                "startTimeFormat": "2019-12-06 09:16:21", 
                "startTime": 1575594981.525895, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_14.sql", 
                "second": 27.15909481048584, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('2000-05-19' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('2000-05-19' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('2000-05-19' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('2000-05-19' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('2000-05-19' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('2000-05-19' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('2000-05-19' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('2000-05-19' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 14, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/14.sql", 
                "secondFormat": "00:00:27", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query21.tpl\r", 
                "sid": 14, 
                "endTime": 1575595008.68499
            }, 
            {
                "endTimeFormat": "2019-12-06 09:16:49", 
                "startTimeFormat": "2019-12-06 09:16:48", 
                "startTime": 1575595008.685101, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_15.sql", 
                "second": 0.9432878494262695, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 2000 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 2000 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                "id": 15, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/15.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query43.tpl\r", 
                "sid": 15, 
                "endTime": 1575595009.628389
            }, 
            {
                "endTimeFormat": "2019-12-06 09:16:50", 
                "startTimeFormat": "2019-12-06 09:16:49", 
                "startTime": 1575595009.628471, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_16.sql", 
                "second": 0.6439950466156006, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'F' and\r\n       cd_marital_status = 'U' and\r\n       cd_education_status = 'Advanced Degree' and\r\n       d_year = 1999 and\r\n       s_state in ('MN','MI', 'PA', 'MI', 'LA', 'MO')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'F' and\r        cd_marital_status = 'U' and\r        cd_education_status = 'Advanced Degree' and\r        d_year = 1999 and\r        s_state in ('MN','MI', 'PA', 'MI', 'LA', 'MO')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                "id": 16, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/16.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query27.tpl\r", 
                "sid": 16, 
                "endTime": 1575595010.272466
            }, 
            {
                "endTimeFormat": "2019-12-06 09:17:02", 
                "startTimeFormat": "2019-12-06 09:16:50", 
                "startTime": 1575595010.272564, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_17.sql", 
                "second": 12.212581157684326, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('1999-5-01','yyyy-mm-dd') and \r\n           to_date('1999-5-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'OK'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('1999-5-01','yyyy-mm-dd') and \r            to_date('1999-5-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'OK'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                "id": 17, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/17.sql", 
                "secondFormat": "00:00:12", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query94.tpl\r", 
                "sid": 17, 
                "endTime": 1575595022.485145
            }, 
            {
                "endTimeFormat": "2019-12-06 09:17:04", 
                "startTimeFormat": "2019-12-06 09:17:02", 
                "startTime": 1575595022.485235, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_18.sql", 
                "second": 1.8564989566802979, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2002\r\n group by ca_zip, ca_county\r\n order by ca_zip, ca_county\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2002\r  group by ca_zip, ca_county\r  order by ca_zip, ca_county\r   ) where rownum <= 100;\r \r ", 
                "id": 18, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/18.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query45.tpl\r", 
                "sid": 18, 
                "endTime": 1575595024.341734
            }, 
            {
                "endTimeFormat": "2019-12-06 09:17:04", 
                "startTimeFormat": "2019-12-06 09:17:04", 
                "startTime": 1575595024.341822, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_19.sql", 
                "second": 0.5010251998901367, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('2002-04-23','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('2002-04-23','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('2002-04-23','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('2002-04-23','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('2002-04-23','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('2002-04-23','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                "id": 19, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/19.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query58.tpl\r", 
                "sid": 19, 
                "endTime": 1575595024.842847
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:26", 
                "startTimeFormat": "2019-12-06 09:17:04", 
                "startTime": 1575595024.842948, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_20.sql", 
                "second": 81.85490012168884, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('chocolate','green','moccasin','chartreuse','forest','magenta') and\r\n         i_current_price between 18 and 18 + 10 and\r\n         i_current_price between 18 + 1 and 18 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2000 and\r\n     cs2.syear = 2000 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('chocolate','green','moccasin','chartreuse','forest','magenta') and\r          i_current_price between 18 and 18 + 10 and\r          i_current_price between 18 + 1 and 18 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2000 and\r      cs2.syear = 2000 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                "id": 20, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/20.sql", 
                "secondFormat": "00:01:21", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query64.tpl\r", 
                "sid": 20, 
                "endTime": 1575595106.697848
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:27", 
                "startTimeFormat": "2019-12-06 09:18:26", 
                "startTime": 1575595106.697951, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_21.sql", 
                "second": 0.6136448383331299, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 1998 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('PA','MN','NY','WA',\r\n                 'LA','GA','AL','GA')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 1998 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('PA','MN','NY','WA',\r                  'LA','GA','AL','GA')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                "id": 21, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/21.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query36.tpl\r", 
                "sid": 21, 
                "endTime": 1575595107.311596
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:30", 
                "startTimeFormat": "2019-12-06 09:18:27", 
                "startTime": 1575595107.311688, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_22.sql", 
                "second": 3.0210909843444824, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 5\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 5\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 5\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 5\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 5\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 5\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                "id": 22, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/22.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query33.tpl\r", 
                "sid": 22, 
                "endTime": 1575595110.332779
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:31", 
                "startTimeFormat": "2019-12-06 09:18:30", 
                "startTime": 1575595110.332859, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_23.sql", 
                "second": 1.0563669204711914, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 7 or\r\n         household_demographics.hd_vehicle_count= 4)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_city in ('Mount Pleasant','Riverview','Liberty','Antioch','Spring Valley') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 7 or\r          household_demographics.hd_vehicle_count= 4)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_city in ('Mount Pleasant','Riverview','Liberty','Antioch','Spring Valley') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                "id": 23, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/23.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query46.tpl\r", 
                "sid": 23, 
                "endTime": 1575595111.389226
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:35", 
                "startTimeFormat": "2019-12-06 09:18:31", 
                "startTime": 1575595111.389326, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_24.sql", 
                "second": 3.7317469120025635, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1208 and 1208 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1208 and 1208 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                "id": 24, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/24.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query62.tpl\r", 
                "sid": 24, 
                "endTime": 1575595115.121073
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:36", 
                "startTimeFormat": "2019-12-06 09:18:35", 
                "startTime": 1575595115.121153, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_25.sql", 
                "second": 1.2572379112243652, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2002-2-01','yyyy-mm-dd') and \r\n           (to_date('2002-2-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'IL'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Jefferson Davis Parish','Marshall County','Franklin Parish','Huron County',\r\n                  'Daviess County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2002-2-01','yyyy-mm-dd') and \r            (to_date('2002-2-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'IL'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Jefferson Davis Parish','Marshall County','Franklin Parish','Huron County',\r                   'Daviess County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                "id": 25, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/25.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query16.tpl\r", 
                "sid": 25, 
                "endTime": 1575595116.378391
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:38", 
                "startTimeFormat": "2019-12-06 09:18:36", 
                "startTime": 1575595116.378485, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_26.sql", 
                "second": 1.781831979751587, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Davis County','Henry County','McCurtain County','Scurry County','Howard County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 2 and 2+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2001 and\r\n                  d_moy between 2 and 2+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2001 and\r\n                  d_moy between 2 and 2+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Davis County','Henry County','McCurtain County','Scurry County','Howard County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 2 and 2+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2001 and\r                   d_moy between 2 and 2+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2001 and\r                   d_moy between 2 and 2+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                "id": 26, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/26.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query10.tpl\r", 
                "sid": 26, 
                "endTime": 1575595118.160317
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:38", 
                "startTimeFormat": "2019-12-06 09:18:38", 
                "startTime": 1575595118.160413, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_27.sql", 
                "second": 0.31943392753601074, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1197,1197+1,1197+2,1197+3,1197+4,1197+5,1197+6,1197+7,1197+8,1197+9,1197+10,1197+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1197,1197+1,1197+2,1197+3,1197+4,1197+5,1197+6,1197+7,1197+8,1197+9,1197+10,1197+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                "id": 27, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/27.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query63.tpl\r", 
                "sid": 27, 
                "endTime": 1575595118.479847
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:56", 
                "startTimeFormat": "2019-12-06 09:18:38", 
                "startTime": 1575595118.47993, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_28.sql", 
                "second": 17.65700101852417, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('IA','VA','AL') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 1999 and\r\n                d_moy between 3 and 3+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 1999 and\r\n                  d_moy between 3 and 3+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 1999 and\r\n                  d_moy between 3 and 3+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('IA','VA','AL') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 1999 and\r                 d_moy between 3 and 3+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 1999 and\r                   d_moy between 3 and 3+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 1999 and\r                   d_moy between 3 and 3+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                "id": 28, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/28.sql", 
                "secondFormat": "00:00:17", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query69.tpl\r", 
                "sid": 28, 
                "endTime": 1575595136.136931
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:56", 
                "startTimeFormat": "2019-12-06 09:18:56", 
                "startTime": 1575595136.137017, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_29.sql", 
                "second": 0.6749858856201172, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Music'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 10\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Music'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 10\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Music'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 10\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Music'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 10\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Music'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 10\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Music'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 10\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                "id": 29, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/29.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query60.tpl\r", 
                "sid": 29, 
                "endTime": 1575595136.812003
            }, 
            {
                "endTimeFormat": "2019-12-06 09:18:58", 
                "startTimeFormat": "2019-12-06 09:18:56", 
                "startTime": 1575595136.812097, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_30.sql", 
                "second": 1.9644889831542969, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1185 and 1185 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1185+ 12 and 1185 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1185 and 1185 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1185+ 12 and 1185 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                "id": 30, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/30.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query59.tpl\r", 
                "sid": 30, 
                "endTime": 1575595138.776586
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:06", 
                "startTimeFormat": "2019-12-06 09:18:58", 
                "startTime": 1575595138.776675, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_31.sql", 
                "second": 8.003973960876465, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 17 and 17 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1999-06-05' ,'yyyy-mm-dd') and to_date('1999-06-05' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (767,785,760,765)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 17 and 17 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1999-06-05' ,'yyyy-mm-dd') and to_date('1999-06-05' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (767,785,760,765)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 31, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/31.sql", 
                "secondFormat": "00:00:08", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query37.tpl\r", 
                "sid": 31, 
                "endTime": 1575595146.780649
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:07", 
                "startTimeFormat": "2019-12-06 09:19:06", 
                "startTime": 1575595146.780732, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_32.sql", 
                "second": 0.6594381332397461, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Women', 'Music', 'Sports')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2002-05-09' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2002-05-09' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Women', 'Music', 'Sports')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2002-05-09' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2002-05-09' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                "id": 32, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/32.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query98.tpl\r", 
                "sid": 32, 
                "endTime": 1575595147.44017
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:15", 
                "startTimeFormat": "2019-12-06 09:19:07", 
                "startTime": 1575595147.440277, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_33.sql", 
                "second": 8.336649894714355, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 1999\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'D'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '4 yr Degree'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'U'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Secondary' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'M'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Primary'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('TN', 'NJ', 'MO')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('FL', 'MT', 'IN')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('IL', 'TX', 'OR')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 1999\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'D'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '4 yr Degree'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'U'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Secondary' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'M'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Primary'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('TN', 'NJ', 'MO')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('FL', 'MT', 'IN')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('IL', 'TX', 'OR')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                "id": 33, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/33.sql", 
                "secondFormat": "00:00:08", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query85.tpl\r", 
                "sid": 33, 
                "endTime": 1575595155.776927
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:17", 
                "startTimeFormat": "2019-12-06 09:19:15", 
                "startTime": 1575595155.777, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_34.sql", 
                "second": 1.4498960971832275, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1199 and 1199 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1199 and 1199 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1199 and 1199 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1199 and 1199 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                "id": 34, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/34.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query70.tpl\r", 
                "sid": 34, 
                "endTime": 1575595157.226896
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:23", 
                "startTimeFormat": "2019-12-06 09:19:17", 
                "startTime": 1575595157.226979, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_35.sql", 
                "second": 6.344208002090454, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1208 and 1208+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1208 and 1208+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                "id": 35, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/35.sql", 
                "secondFormat": "00:00:06", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query67.tpl\r", 
                "sid": 35, 
                "endTime": 1575595163.571187
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:25", 
                "startTimeFormat": "2019-12-06 09:19:23", 
                "startTime": 1575595163.571275, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_36.sql", 
                "second": 2.2303049564361572, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 148 and 148+10 \r\n             or ss_coupon_amt between 8006 and 8006+1000\r\n             or ss_wholesale_cost between 47 and 47+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 44 and 44+10\r\n          or ss_coupon_amt between 15442 and 15442+1000\r\n          or ss_wholesale_cost between 39 and 39+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 140 and 140+10\r\n          or ss_coupon_amt between 754 and 754+1000\r\n          or ss_wholesale_cost between 16 and 16+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 138 and 138+10\r\n          or ss_coupon_amt between 13222 and 13222+1000\r\n          or ss_wholesale_cost between 5 and 5+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 115 and 115+10\r\n          or ss_coupon_amt between 5958 and 5958+1000\r\n          or ss_wholesale_cost between 21 and 21+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 132 and 132+10\r\n          or ss_coupon_amt between 15011 and 15011+1000\r\n          or ss_wholesale_cost between 44 and 44+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 148 and 148+10 \r              or ss_coupon_amt between 8006 and 8006+1000\r              or ss_wholesale_cost between 47 and 47+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 44 and 44+10\r           or ss_coupon_amt between 15442 and 15442+1000\r           or ss_wholesale_cost between 39 and 39+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 140 and 140+10\r           or ss_coupon_amt between 754 and 754+1000\r           or ss_wholesale_cost between 16 and 16+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 138 and 138+10\r           or ss_coupon_amt between 13222 and 13222+1000\r           or ss_wholesale_cost between 5 and 5+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 115 and 115+10\r           or ss_coupon_amt between 5958 and 5958+1000\r           or ss_wholesale_cost between 21 and 21+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 132 and 132+10\r           or ss_coupon_amt between 15011 and 15011+1000\r           or ss_wholesale_cost between 44 and 44+20)) B6\r  ) where rownum <= 100;\r \r ", 
                "id": 36, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/36.sql", 
                "secondFormat": "00:00:02", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query28.tpl\r", 
                "sid": 36, 
                "endTime": 1575595165.80158
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:26", 
                "startTimeFormat": "2019-12-06 09:19:25", 
                "startTime": 1575595165.801666, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_37.sql", 
                "second": 0.21056008338928223, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =1998\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MN'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =1998\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MN'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                "id": 37, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/37.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query81.tpl\r", 
                "sid": 37, 
                "endTime": 1575595166.012226
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:27", 
                "startTimeFormat": "2019-12-06 09:19:26", 
                "startTime": 1575595166.012325, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_38.sql", 
                "second": 1.6904120445251465, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1210 and 1210 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1210 and 1210 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1210 and 1210 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1210 and 1210 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                "id": 38, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/38.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query97.tpl\r", 
                "sid": 38, 
                "endTime": 1575595167.702737
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:55", 
                "startTimeFormat": "2019-12-06 09:19:27", 
                "startTime": 1575595167.702825, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_39.sql", 
                "second": 28.16245985031128, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'GERMA' || ',' || 'UPS' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2000\r\n \tand t_time between 7325 and 7325+28800 \r\n \tand sm_carrier in ('GERMA','UPS')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'GERMA' || ',' || 'UPS' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2000\r\n \tand t_time between 7325 AND 7325+28800 \r\n \tand sm_carrier in ('GERMA','UPS')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'GERMA' || ',' || 'UPS' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2000\r  \tand t_time between 7325 and 7325+28800 \r  \tand sm_carrier in ('GERMA','UPS')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'GERMA' || ',' || 'UPS' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2000\r  \tand t_time between 7325 AND 7325+28800 \r  \tand sm_carrier in ('GERMA','UPS')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                "id": 39, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/39.sql", 
                "secondFormat": "00:00:28", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query66.tpl\r", 
                "sid": 39, 
                "endTime": 1575595195.865285
            }, 
            {
                "endTimeFormat": "2019-12-06 09:19:59", 
                "startTimeFormat": "2019-12-06 09:19:55", 
                "startTime": 1575595195.865419, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_40.sql", 
                "second": 3.3992700576782227, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 8 and 8+1\r\n         and household_demographics.hd_dep_count = 4\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 16 and 16+1\r\n         and household_demographics.hd_dep_count = 4\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 8 and 8+1\r          and household_demographics.hd_dep_count = 4\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 16 and 16+1\r          and household_demographics.hd_dep_count = 4\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                "id": 40, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/40.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query90.tpl\r", 
                "sid": 40, 
                "endTime": 1575595199.264689
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:00", 
                "startTimeFormat": "2019-12-06 09:19:59", 
                "startTime": 1575595199.264771, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_41.sql", 
                "second": 0.8732531070709229, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '2002Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '2002Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                "id": 41, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/41.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query17.tpl\r", 
                "sid": 41, 
                "endTime": 1575595200.138024
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:02", 
                "startTimeFormat": "2019-12-06 09:20:00", 
                "startTime": 1575595200.138101, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_42.sql", 
                "second": 2.3327579498291016, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 2000 or\r\n         ( d_year = 2000-1 and d_moy =12) or\r\n         ( d_year = 2000+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.s_company_name\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2000 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 2000 or\r          ( d_year = 2000-1 and d_moy =12) or\r          ( d_year = 2000+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.s_company_name\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2000 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                "id": 42, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/42.sql", 
                "secondFormat": "00:00:02", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query47.tpl\r", 
                "sid": 42, 
                "endTime": 1575595202.470859
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:10", 
                "startTimeFormat": "2019-12-06 09:20:02", 
                "startTime": 1575595202.470947, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_43.sql", 
                "second": 7.536448955535889, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-2-01','yyyy-mm-dd') and \r\n            to_date('2002-2-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'VA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-2-01','yyyy-mm-dd') and \r             to_date('2002-2-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'VA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                "id": 43, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/43.sql", 
                "secondFormat": "00:00:07", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query95.tpl\r", 
                "sid": 43, 
                "endTime": 1575595210.007396
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:10", 
                "startTimeFormat": "2019-12-06 09:20:10", 
                "startTime": 1575595210.00747, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_44.sql", 
                "second": 0.022644996643066406, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 316\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2001-02-12','yyyy-mm-dd') and \r\n        to_date('2001-02-12','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2001-02-12','yyyy-mm-dd') and\r\n                             to_date('2001-02-12','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 316\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2001-02-12','yyyy-mm-dd') and \r         to_date('2001-02-12','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2001-02-12','yyyy-mm-dd') and\r                              to_date('2001-02-12','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                "id": 44, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/44.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query92.tpl\r", 
                "sid": 44, 
                "endTime": 1575595210.030115
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:10", 
                "startTimeFormat": "2019-12-06 09:20:10", 
                "startTime": 1575595210.030202, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_45.sql", 
                "second": 0.6400129795074463, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_net_profit) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 71\r\n   and dt.d_moy=12\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_net_profit) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 71\r    and dt.d_moy=12\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                "id": 45, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/45.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query3.tpl\r", 
                "sid": 45, 
                "endTime": 1575595210.670215
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:12", 
                "startTimeFormat": "2019-12-06 09:20:10", 
                "startTime": 1575595210.670287, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_46.sql", 
                "second": 2.2456421852111816, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1218 and 1218+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1218 and 1218+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1218 and 1218+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1218 and 1218+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                "id": 46, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/46.sql", 
                "secondFormat": "00:00:02", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query51.tpl\r", 
                "sid": 46, 
                "endTime": 1575595212.915929
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:13", 
                "startTimeFormat": "2019-12-06 09:20:12", 
                "startTime": 1575595212.916009, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_47.sql", 
                "second": 0.8745779991149902, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  sum(cd_dep_count) s1,\r\n  max(cd_dep_count) s2,\r\n  stddev_samp(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  sum(cd_dep_employed_count) s4,\r\n  max(cd_dep_employed_count) s5,\r\n  stddev_samp(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  sum(cd_dep_college_count) s7,\r\n  max(cd_dep_college_count) s8,\r\n  stddev_samp(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   sum(cd_dep_count) s1,\r   max(cd_dep_count) s2,\r   stddev_samp(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   sum(cd_dep_employed_count) s4,\r   max(cd_dep_employed_count) s5,\r   stddev_samp(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   sum(cd_dep_college_count) s7,\r   max(cd_dep_college_count) s8,\r   stddev_samp(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                "id": 47, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/47.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query35.tpl\r", 
                "sid": 47, 
                "endTime": 1575595213.790587
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:17", 
                "startTimeFormat": "2019-12-06 09:20:13", 
                "startTime": 1575595213.790694, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_48.sql", 
                "second": 3.2178258895874023, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                "id": 48, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/48.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query49.tpl\r", 
                "sid": 48, 
                "endTime": 1575595217.00852
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:19", 
                "startTimeFormat": "2019-12-06 09:20:17", 
                "startTime": 1575595217.008604, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_49.sql", 
                "second": 2.2433018684387207, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 42866742\r\n            then (select avg(ss_ext_sales_price) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 4447896\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 3814424\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 34147522\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 24280513\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 42866742\r             then (select avg(ss_ext_sales_price) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 4447896\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 3814424\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 34147522\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 24280513\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                "id": 49, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/49.sql", 
                "secondFormat": "00:00:02", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query9.tpl\r", 
                "sid": 49, 
                "endTime": 1575595219.251906
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:19", 
                "startTimeFormat": "2019-12-06 09:20:19", 
                "startTime": 1575595219.251997, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_50.sql", 
                "second": 0.7222731113433838, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 1998\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 1998\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 1998\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 1998\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 1998\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =1998\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by web_q1_q2_increase;\r\n\r\n", 
                "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 1998\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 1998\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 1998\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 1998\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 1998\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =1998\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by web_q1_q2_increase;\r \r ", 
                "id": 50, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/50.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query31.tpl\r", 
                "sid": 50, 
                "endTime": 1575595219.97427
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:23", 
                "startTimeFormat": "2019-12-06 09:20:19", 
                "startTime": 1575595219.974367, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_51.sql", 
                "second": 3.1084001064300537, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_email_address\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1999\r\n         and t_s_secyear.dyear = 1999+1\r\n         and t_w_firstyear.dyear = 1999\r\n         and t_w_secyear.dyear = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_email_address\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_email_address\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1999\r          and t_s_secyear.dyear = 1999+1\r          and t_w_firstyear.dyear = 1999\r          and t_w_secyear.dyear = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_email_address\r  ) where rownum <= 100;\r \r ", 
                "id": 51, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/51.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query11.tpl\r", 
                "sid": 51, 
                "endTime": 1575595223.082767
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:23", 
                "startTimeFormat": "2019-12-06 09:20:23", 
                "startTime": 1575595223.082858, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_52.sql", 
                "second": 0.30094480514526367, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 42') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 42') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                "id": 52, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/52.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query93.tpl\r", 
                "sid": 52, 
                "endTime": 1575595223.383803
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:27", 
                "startTimeFormat": "2019-12-06 09:20:23", 
                "startTime": 1575595223.383893, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_53.sql", 
                "second": 3.9949328899383545, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,avg(ss_quantity)        as store_sales_quantity\r\n    ,avg(sr_return_quantity) as store_returns_quantity\r\n    ,avg(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 1998\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 1998\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (1998,1998+1,1998+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,avg(ss_quantity)        as store_sales_quantity\r     ,avg(sr_return_quantity) as store_returns_quantity\r     ,avg(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 1998\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 1998\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (1998,1998+1,1998+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                "id": 53, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/53.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query29.tpl\r", 
                "sid": 53, 
                "endTime": 1575595227.378826
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:28", 
                "startTimeFormat": "2019-12-06 09:20:27", 
                "startTime": 1575595227.37892, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_54.sql", 
                "second": 1.3025989532470703, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1180 and 1180 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1180 and 1180 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1180 and 1180 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1180 and 1180 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1180 and 1180 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1180 and 1180 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                "id": 54, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/54.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query38.tpl\r", 
                "sid": 54, 
                "endTime": 1575595228.681519
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:57", 
                "startTimeFormat": "2019-12-06 09:20:28", 
                "startTime": 1575595228.681609, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_55.sql", 
                "second": 29.04028010368347, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1219 and 1219 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1219 and 1219 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                "id": 55, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/55.sql", 
                "secondFormat": "00:00:29", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query22.tpl\r", 
                "sid": 55, 
                "endTime": 1575595257.721889
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:59", 
                "startTimeFormat": "2019-12-06 09:20:57", 
                "startTime": 1575595257.721981, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_56.sql", 
                "second": 1.3973958492279053, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (2000) and\r\n        ((i_category in ('Home','Shoes','Men') and\r\n          i_class in ('lighting','kids','pants')\r\n         )\r\n      or (i_category in ('Music','Electronics','Women') and\r\n          i_class in ('pop','portable','dresses') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (2000) and\r         ((i_category in ('Home','Shoes','Men') and\r           i_class in ('lighting','kids','pants')\r          )\r       or (i_category in ('Music','Electronics','Women') and\r           i_class in ('pop','portable','dresses') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                "id": 56, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/56.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query89.tpl\r", 
                "sid": 56, 
                "endTime": 1575595259.119377
            }, 
            {
                "endTimeFormat": "2019-12-06 09:20:59", 
                "startTimeFormat": "2019-12-06 09:20:59", 
                "startTime": 1575595259.119461, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_57.sql", 
                "second": 0.30475783348083496, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 1 and d_year = 2001\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 1 and d_year = 2001\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                "id": 57, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/57.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query15.tpl\r", 
                "sid": 57, 
                "endTime": 1575595259.424219
            }, 
            {
                "endTimeFormat": "2019-12-06 09:21:32", 
                "startTimeFormat": "2019-12-06 09:20:59", 
                "startTime": 1575595259.424303, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_58.sql", 
                "second": 32.669081926345825, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 2001\r\n \t        and d_moy = 5 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 2001\r  \t        and d_moy = 5 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                "id": 58, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/58.sql", 
                "secondFormat": "00:00:32", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query6.tpl\r", 
                "sid": 58, 
                "endTime": 1575595292.093385
            }, 
            {
                "endTimeFormat": "2019-12-06 09:21:32", 
                "startTimeFormat": "2019-12-06 09:21:32", 
                "startTime": 1575595292.093518, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_59.sql", 
                "second": 0.5827200412750244, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=11\r\n    and dt.d_year=2001\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=11\r     and dt.d_year=2001\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                "id": 59, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/59.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query52.tpl\r", 
                "sid": 59, 
                "endTime": 1575595292.676238
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:10", 
                "startTimeFormat": "2019-12-06 09:21:32", 
                "startTime": 1575595292.676324, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_60.sql", 
                "second": 37.6258270740509, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 2001\r\nand d2.d_moy  = 8\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 2001\r and d2.d_moy  = 8\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                "id": 60, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/60.sql", 
                "secondFormat": "00:00:37", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query50.tpl\r", 
                "sid": 60, 
                "endTime": 1575595330.302151
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:10", 
                "startTimeFormat": "2019-12-06 09:22:10", 
                "startTime": 1575595330.302232, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_61.sql", 
                "second": 0.2901270389556885, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=12\r\n \tand dt.d_year=1999\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=12\r  \tand dt.d_year=1999\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                "id": 61, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/61.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query42.tpl\r", 
                "sid": 61, 
                "endTime": 1575595330.592359
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:10", 
                "startTimeFormat": "2019-12-06 09:22:10", 
                "startTime": 1575595330.59246, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_62.sql", 
                "second": 0.08103203773498535, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 994 and 994+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'sandy' or i_color = 'seashell') and \r\n        (i_units = 'Dram' or i_units = 'Bundle') and\r\n        (i_size = 'petite' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'puff' or i_color = 'honeydew') and\r\n        (i_units = 'N/A' or i_units = 'Ounce') and\r\n        (i_size = 'medium' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'grey' or i_color = 'cream') and\r\n        (i_units = 'Tsp' or i_units = 'Case') and\r\n        (i_size = 'economy' or i_size = 'extra large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'dark' or i_color = 'burlywood') and\r\n        (i_units = 'Dozen' or i_units = 'Ton') and\r\n        (i_size = 'petite' or i_size = 'large')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'linen' or i_color = 'mint') and \r\n        (i_units = 'Gross' or i_units = 'Bunch') and\r\n        (i_size = 'petite' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'pink' or i_color = 'royal') and\r\n        (i_units = 'Pound' or i_units = 'Lb') and\r\n        (i_size = 'medium' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'cornsilk' or i_color = 'metallic') and\r\n        (i_units = 'Gram' or i_units = 'Tbl') and\r\n        (i_size = 'economy' or i_size = 'extra large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'steel' or i_color = 'khaki') and\r\n        (i_units = 'Each' or i_units = 'Unknown') and\r\n        (i_size = 'petite' or i_size = 'large')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 994 and 994+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'sandy' or i_color = 'seashell') and \r         (i_units = 'Dram' or i_units = 'Bundle') and\r         (i_size = 'petite' or i_size = 'large')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'puff' or i_color = 'honeydew') and\r         (i_units = 'N/A' or i_units = 'Ounce') and\r         (i_size = 'medium' or i_size = 'small')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'grey' or i_color = 'cream') and\r         (i_units = 'Tsp' or i_units = 'Case') and\r         (i_size = 'economy' or i_size = 'extra large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'dark' or i_color = 'burlywood') and\r         (i_units = 'Dozen' or i_units = 'Ton') and\r         (i_size = 'petite' or i_size = 'large')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'linen' or i_color = 'mint') and \r         (i_units = 'Gross' or i_units = 'Bunch') and\r         (i_size = 'petite' or i_size = 'large')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'pink' or i_color = 'royal') and\r         (i_units = 'Pound' or i_units = 'Lb') and\r         (i_size = 'medium' or i_size = 'small')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'cornsilk' or i_color = 'metallic') and\r         (i_units = 'Gram' or i_units = 'Tbl') and\r         (i_size = 'economy' or i_size = 'extra large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'steel' or i_color = 'khaki') and\r         (i_units = 'Each' or i_units = 'Unknown') and\r         (i_size = 'petite' or i_size = 'large')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                "id": 62, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/62.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query41.tpl\r", 
                "sid": 62, 
                "endTime": 1575595330.673492
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:11", 
                "startTimeFormat": "2019-12-06 09:22:10", 
                "startTime": 1575595330.673582, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_63.sql", 
                "second": 1.083920955657959, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '62113','24658','51322','31477','20656','99781',\r\n                          '26272','70154','11167','13482','28931',\r\n                          '14718','71978','21051','39594','58604',\r\n                          '13152','49193','85608','13558','24427',\r\n                          '39485','51941','26668','21248','19525',\r\n                          '16182','98334','36898','82740','69858',\r\n                          '87190','48682','33823','37459','84876',\r\n                          '58233','38768','62694','28526','81214',\r\n                          '66179','12371','12534','89989','56280',\r\n                          '84245','62780','22236','44781','93371',\r\n                          '46565','19930','50002','41211','47819',\r\n                          '53712','39178','52267','33927','36796',\r\n                          '34458','36784','56892','66470','72049',\r\n                          '44248','27990','36708','18951','45382',\r\n                          '79557','75628','69800','95033','88176',\r\n                          '55373','34121','70334','24113','66139',\r\n                          '84112','37654','53381','28102','51535',\r\n                          '71536','65511','28379','53795','28952',\r\n                          '15477','18438','10265','94226','27105',\r\n                          '13924','66849','83255','23889','61493',\r\n                          '31048','44141','81920','11179','60623',\r\n                          '82304','93616','84635','60361','95326',\r\n                          '85402','68418','49371','43902','30590',\r\n                          '69966','79118','14672','56882','42110',\r\n                          '69710','47898','31808','87257','95415',\r\n                          '64646','76196','17581','39569','85802',\r\n                          '27372','45499','57365','96063','38001',\r\n                          '21608','78844','48389','12629','81502',\r\n                          '52036','55688','28533','48282','41198',\r\n                          '43651','18889','44703','24312','26390',\r\n                          '55113','49841','11720','19127','54541',\r\n                          '66638','71609','15670','59818','22655',\r\n                          '86614','88977','31269','23337','44224',\r\n                          '32149','74751','16185','36606','52890',\r\n                          '45430','83734','91313','15227','43819',\r\n                          '92734','46687','43095','22908','50015',\r\n                          '51855','41269','89329','21384','42592',\r\n                          '46690','53827','32188','26154','75550',\r\n                          '59590','35313','26715','36292','74010',\r\n                          '49738','19980','18244','43366','65747',\r\n                          '32589','55550','68320','19301','83453',\r\n                          '51811','95075','60996','63472','31118',\r\n                          '41649','87334','67444','84805','73111',\r\n                          '17893','82888','72084','50373','18850',\r\n                          '57222','20277','14295','57176','44131',\r\n                          '69573','54329','22145','50477','87134',\r\n                          '52058','53858','37108','45055','55526',\r\n                          '54042','35194','83425','44008','59549',\r\n                          '18984','11160','28508','79477','49343',\r\n                          '75571','67718','18833','53497','12119',\r\n                          '92793','13269','28823','69983','31105',\r\n                          '10033','38169','45070','67120','36857',\r\n                          '25386','13910','17294','57193','95745',\r\n                          '11178','88174','44442','22768','55417',\r\n                          '43547','26365','33266','91525','98063',\r\n                          '93717','56559','89243','72094','22501',\r\n                          '77475','54793','45925','27852','11995',\r\n                          '60363','80438','82676','16295','12718',\r\n                          '58479','93441','31036','52962','50791',\r\n                          '25507','56839','14633','42459','38505',\r\n                          '21784','42695','42112','75765','87416',\r\n                          '84376','46397','78131','87854','36431',\r\n                          '95229','53501','12717','63695','69802',\r\n                          '60104','16433','22323','97007','18440',\r\n                          '69770','67985','64604','87233','72311',\r\n                          '88003','13885','75624','95362','78339',\r\n                          '28477','57609','25601','28761','54158',\r\n                          '74637','78811','78108','52489','55462',\r\n                          '95197','32553','62980','77703','45075',\r\n                          '54303','27887','24159','20338','23928',\r\n                          '64676','20610','97545','59829','14626',\r\n                          '46730','34099','85427','56217','52147',\r\n                          '23114','76528','60597','34282','50746',\r\n                          '87212','71748','72139','19998','84521',\r\n                          '69789','89661','36794','14971','44351',\r\n                          '51081','81460','89059','21984','68257',\r\n                          '80192','41341','17461','35435','16642',\r\n                          '39117','11119','18191','68874','75848',\r\n                          '22752','34684','17093','20604','79103',\r\n                          '61363','15336','63072','41087')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 1 and d_year = 2002\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '62113','24658','51322','31477','20656','99781',\r                           '26272','70154','11167','13482','28931',\r                           '14718','71978','21051','39594','58604',\r                           '13152','49193','85608','13558','24427',\r                           '39485','51941','26668','21248','19525',\r                           '16182','98334','36898','82740','69858',\r                           '87190','48682','33823','37459','84876',\r                           '58233','38768','62694','28526','81214',\r                           '66179','12371','12534','89989','56280',\r                           '84245','62780','22236','44781','93371',\r                           '46565','19930','50002','41211','47819',\r                           '53712','39178','52267','33927','36796',\r                           '34458','36784','56892','66470','72049',\r                           '44248','27990','36708','18951','45382',\r                           '79557','75628','69800','95033','88176',\r                           '55373','34121','70334','24113','66139',\r                           '84112','37654','53381','28102','51535',\r                           '71536','65511','28379','53795','28952',\r                           '15477','18438','10265','94226','27105',\r                           '13924','66849','83255','23889','61493',\r                           '31048','44141','81920','11179','60623',\r                           '82304','93616','84635','60361','95326',\r                           '85402','68418','49371','43902','30590',\r                           '69966','79118','14672','56882','42110',\r                           '69710','47898','31808','87257','95415',\r                           '64646','76196','17581','39569','85802',\r                           '27372','45499','57365','96063','38001',\r                           '21608','78844','48389','12629','81502',\r                           '52036','55688','28533','48282','41198',\r                           '43651','18889','44703','24312','26390',\r                           '55113','49841','11720','19127','54541',\r                           '66638','71609','15670','59818','22655',\r                           '86614','88977','31269','23337','44224',\r                           '32149','74751','16185','36606','52890',\r                           '45430','83734','91313','15227','43819',\r                           '92734','46687','43095','22908','50015',\r                           '51855','41269','89329','21384','42592',\r                           '46690','53827','32188','26154','75550',\r                           '59590','35313','26715','36292','74010',\r                           '49738','19980','18244','43366','65747',\r                           '32589','55550','68320','19301','83453',\r                           '51811','95075','60996','63472','31118',\r                           '41649','87334','67444','84805','73111',\r                           '17893','82888','72084','50373','18850',\r                           '57222','20277','14295','57176','44131',\r                           '69573','54329','22145','50477','87134',\r                           '52058','53858','37108','45055','55526',\r                           '54042','35194','83425','44008','59549',\r                           '18984','11160','28508','79477','49343',\r                           '75571','67718','18833','53497','12119',\r                           '92793','13269','28823','69983','31105',\r                           '10033','38169','45070','67120','36857',\r                           '25386','13910','17294','57193','95745',\r                           '11178','88174','44442','22768','55417',\r                           '43547','26365','33266','91525','98063',\r                           '93717','56559','89243','72094','22501',\r                           '77475','54793','45925','27852','11995',\r                           '60363','80438','82676','16295','12718',\r                           '58479','93441','31036','52962','50791',\r                           '25507','56839','14633','42459','38505',\r                           '21784','42695','42112','75765','87416',\r                           '84376','46397','78131','87854','36431',\r                           '95229','53501','12717','63695','69802',\r                           '60104','16433','22323','97007','18440',\r                           '69770','67985','64604','87233','72311',\r                           '88003','13885','75624','95362','78339',\r                           '28477','57609','25601','28761','54158',\r                           '74637','78811','78108','52489','55462',\r                           '95197','32553','62980','77703','45075',\r                           '54303','27887','24159','20338','23928',\r                           '64676','20610','97545','59829','14626',\r                           '46730','34099','85427','56217','52147',\r                           '23114','76528','60597','34282','50746',\r                           '87212','71748','72139','19998','84521',\r                           '69789','89661','36794','14971','44351',\r                           '51081','81460','89059','21984','68257',\r                           '80192','41341','17461','35435','16642',\r                           '39117','11119','18191','68874','75848',\r                           '22752','34684','17093','20604','79103',\r                           '61363','15336','63072','41087')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 1 and d_year = 2002\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                "id": 63, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/63.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query8.tpl\r", 
                "sid": 63, 
                "endTime": 1575595331.757503
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:11", 
                "startTimeFormat": "2019-12-06 09:22:11", 
                "startTime": 1575595331.757609, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_64.sql", 
                "second": 0.2134392261505127, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Men', 'Jewelry', 'Music')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('2000-03-07' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('2000-03-07' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Men', 'Jewelry', 'Music')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('2000-03-07' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('2000-03-07' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                "id": 64, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/64.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query12.tpl\r", 
                "sid": 64, 
                "endTime": 1575595331.971048
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:12", 
                "startTimeFormat": "2019-12-06 09:22:11", 
                "startTime": 1575595331.971149, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_65.sql", 
                "second": 0.23676109313964844, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Sports', 'Electronics', 'Books')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('2000-05-08' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('2000-05-08' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Sports', 'Electronics', 'Books')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('2000-05-08' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('2000-05-08' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                "id": 65, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/65.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query20.tpl\r", 
                "sid": 65, 
                "endTime": 1575595332.20791
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:13", 
                "startTimeFormat": "2019-12-06 09:22:12", 
                "startTime": 1575595332.208003, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_66.sql", 
                "second": 0.9580068588256836, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                "id": 66, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/66.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query88.tpl\r", 
                "sid": 66, 
                "endTime": 1575595333.16601
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:13", 
                "startTimeFormat": "2019-12-06 09:22:13", 
                "startTime": 1575595333.166092, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_67.sql", 
                "second": 0.12526798248291016, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 41 and 41+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2000-06-15' ,'yyyy-mm-dd') and to_date('2000-06-15' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (731,336,588,976)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 41 and 41+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2000-06-15' ,'yyyy-mm-dd') and to_date('2000-06-15' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (731,336,588,976)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 67, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/67.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query82.tpl\r", 
                "sid": 67, 
                "endTime": 1575595333.29136
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:24", 
                "startTimeFormat": "2019-12-06 09:22:13", 
                "startTime": 1575595333.291464, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_68.sql", 
                "second": 10.740816831588745, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (2000,2000+1,2000+2,2000+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (2000,2000+1,2000+2,2000+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 2000 \r\n         and d_moy = 7 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 2000 \r\n         and d_moy = 7 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (2000,2000+1,2000+2,2000+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 2000 \r\n         and d_moy = 7 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 2000 \r\n         and d_moy = 7 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (2000,2000+1,2000+2,2000+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (2000,2000+1,2000+2,2000+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 2000 \r          and d_moy = 7 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 2000 \r          and d_moy = 7 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (2000,2000+1,2000+2,2000+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 2000 \r          and d_moy = 7 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 2000 \r          and d_moy = 7 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                "id": 68, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/68.sql", 
                "secondFormat": "00:00:10", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query23.tpl\r", 
                "sid": 68, 
                "endTime": 1575595344.032281
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:38", 
                "startTimeFormat": "2019-12-06 09:22:24", 
                "startTime": 1575595344.032384, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_69.sql", 
                "second": 14.085431098937988, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 20)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999\r\n                       and d_moy = 12\r\n                       and d_dom = 20)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 1999+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999 + 1\r                        and d_moy = 12\r                        and d_dom = 20)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999\r                        and d_moy = 12\r                        and d_dom = 20)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                "id": 69, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/69.sql", 
                "secondFormat": "00:00:14", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query14.tpl\r", 
                "sid": 69, 
                "endTime": 1575595358.117815
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:39", 
                "startTimeFormat": "2019-12-06 09:22:38", 
                "startTime": 1575595358.1179, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_70.sql", 
                "second": 1.4815070629119873, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 2001 or\r\n         ( d_year = 2001-1 and d_moy =12) or\r\n         ( d_year = 2001+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_brand\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2001 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 2001 or\r          ( d_year = 2001-1 and d_moy =12) or\r          ( d_year = 2001+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_brand\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2001 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                "id": 70, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/70.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query57.tpl\r", 
                "sid": 70, 
                "endTime": 1575595359.599407
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:40", 
                "startTimeFormat": "2019-12-06 09:22:39", 
                "startTime": 1575595359.599507, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_71.sql", 
                "second": 0.8575518131256104, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1192 and 1192+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                "id": 71, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/71.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query65.tpl\r", 
                "sid": 71, 
                "endTime": 1575595360.457059
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:41", 
                "startTimeFormat": "2019-12-06 09:22:40", 
                "startTime": 1575595360.457153, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_72.sql", 
                "second": 1.0810508728027344, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                "id": 72, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/72.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query71.tpl\r", 
                "sid": 72, 
                "endTime": 1575595361.538204
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:42", 
                "startTimeFormat": "2019-12-06 09:22:41", 
                "startTime": 1575595361.538303, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_73.sql", 
                "second": 0.9487600326538086, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = 'Unknown')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (2000,2000+1,2000+2)\r\n    and store.s_county in ('Levy County','Barrow County','Pennington County','Franklin Parish',\r\n                           'Kittitas County','Jefferson Davis Parish','Luce County','Marshall County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = 'Unknown')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (2000,2000+1,2000+2)\r     and store.s_county in ('Levy County','Barrow County','Pennington County','Franklin Parish',\r                            'Kittitas County','Jefferson Davis Parish','Luce County','Marshall County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                "id": 73, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/73.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query34.tpl\r", 
                "sid": 73, 
                "endTime": 1575595362.487063
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:43", 
                "startTimeFormat": "2019-12-06 09:22:42", 
                "startTime": 1575595362.48714, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_74.sql", 
                "second": 0.9184689521789551, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = 'Advanced Degree'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'M'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'W'\r\n   and \r\n   cd_education_status = 'College'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('IN', 'GA', 'MO')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('VA', 'WI', 'KY')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('AR', 'KS', 'TX')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = 'Advanced Degree'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'M'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'W'\r    and \r    cd_education_status = 'College'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('IN', 'GA', 'MO')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('VA', 'WI', 'KY')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('AR', 'KS', 'TX')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                "id": 74, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/74.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query48.tpl\r", 
                "sid": 74, 
                "endTime": 1575595363.405609
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:43", 
                "startTimeFormat": "2019-12-06 09:22:43", 
                "startTime": 1575595363.405682, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_75.sql", 
                "second": 0.019261837005615234, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2001\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'UT'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2001\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'UT'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                "id": 75, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/75.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query30.tpl\r", 
                "sid": 75, 
                "endTime": 1575595363.424944
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:44", 
                "startTimeFormat": "2019-12-06 09:22:43", 
                "startTime": 1575595363.425044, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_76.sql", 
                "second": 1.1913659572601318, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,max(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (1999,1999+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,max(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (1999,1999+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 1999\r\n         and t_s_secyear.year = 1999+1\r\n         and t_w_firstyear.year = 1999\r\n         and t_w_secyear.year = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 2,3,1\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,max(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (1999,1999+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,max(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (1999,1999+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 1999\r          and t_s_secyear.year = 1999+1\r          and t_w_firstyear.year = 1999\r          and t_w_secyear.year = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 2,3,1\r  ) where rownum <= 100;\r \r ", 
                "id": 76, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/76.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query74.tpl\r", 
                "sid": 76, 
                "endTime": 1575595364.61641
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:45", 
                "startTimeFormat": "2019-12-06 09:22:44", 
                "startTime": 1575595364.616489, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_77.sql", 
                "second": 1.1909940242767334, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1197 and 1197+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1197 and 1197+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1197 and 1197+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1197 and 1197+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1197 and 1197+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1197 and 1197+11)\r ) cool_cust\r ;\r \r ", 
                "id": 77, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/77.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query87.tpl\r", 
                "sid": 77, 
                "endTime": 1575595365.807483
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:46", 
                "startTimeFormat": "2019-12-06 09:22:45", 
                "startTime": 1575595365.807581, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_78.sql", 
                "second": 0.5931689739227295, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-25','yyyy-mm-dd') \r\n                  and to_date('1999-08-25','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-25','yyyy-mm-dd') \r\n                  and to_date('1999-08-25','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r\n                  and  to_date('1999-08-25','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r\n                  and  to_date('1999-08-25','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r\n                  and  to_date('1999-08-25','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r\n                  and  to_date('1999-08-25','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1999-08-25','yyyy-mm-dd') \r                   and to_date('1999-08-25','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('1999-08-25','yyyy-mm-dd') \r                   and to_date('1999-08-25','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r                   and  to_date('1999-08-25','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r                   and  to_date('1999-08-25','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r                   and  to_date('1999-08-25','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-25','yyyy-mm-dd') \r                   and  to_date('1999-08-25','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                "id": 78, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/78.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query77.tpl\r", 
                "sid": 78, 
                "endTime": 1575595366.40075
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:46", 
                "startTimeFormat": "2019-12-06 09:22:46", 
                "startTime": 1575595366.400805, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_79.sql", 
                "second": 0.08968806266784668, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Fairfield County','San Miguel County','Oglethorpe County','Huron County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Fairfield County','San Miguel County','Oglethorpe County','Huron County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                "id": 79, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/79.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query73.tpl\r", 
                "sid": 79, 
                "endTime": 1575595366.490493
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:47", 
                "startTimeFormat": "2019-12-06 09:22:46", 
                "startTime": 1575595366.490597, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_80.sql", 
                "second": 0.7810409069061279, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Harmony'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  23765\r\n   and ib_upper_bound   <=  23765 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Harmony'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  23765\r    and ib_upper_bound   <=  23765 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                "id": 80, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/80.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query84.tpl\r", 
                "sid": 80, 
                "endTime": 1575595367.271638
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:48", 
                "startTimeFormat": "2019-12-06 09:22:47", 
                "startTime": 1575595367.27172, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_81.sql", 
                "second": 0.7389950752258301, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Men'\r\n         and i_class = 'accessories'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 1\r\n         and d_year = 1999\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 1999 and d_moy = 1)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 1999 and d_moy = 1)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Men'\r          and i_class = 'accessories'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 1\r          and d_year = 1999\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 1999 and d_moy = 1)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 1999 and d_moy = 1)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                "id": 81, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/81.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query54.tpl\r", 
                "sid": 81, 
                "endTime": 1575595368.010715
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:48", 
                "startTimeFormat": "2019-12-06 09:22:48", 
                "startTime": 1575595368.010805, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_82.sql", 
                "second": 0.34351515769958496, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=49\r\n \tand d_moy=12\r\n \tand d_year=1998\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=49\r  \tand d_moy=12\r  \tand d_year=1998\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                "id": 82, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/82.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query55.tpl\r", 
                "sid": 82, 
                "endTime": 1575595368.35432
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:49", 
                "startTimeFormat": "2019-12-06 09:22:48", 
                "startTime": 1575595368.354418, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_83.sql", 
                "second": 0.8324408531188965, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('chiffon','beige','frosted'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('chiffon','beige','frosted'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('chiffon','beige','frosted'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('chiffon','beige','frosted'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('chiffon','beige','frosted'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('chiffon','beige','frosted'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 83, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/83.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query56.tpl\r", 
                "sid": 83, 
                "endTime": 1575595369.186859
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:50", 
                "startTimeFormat": "2019-12-06 09:22:49", 
                "startTime": 1575595369.186966, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_84.sql", 
                "second": 1.48244309425354, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 1999) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 1999+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 1999) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 1999+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                "id": 84, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/84.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query2.tpl\r", 
                "sid": 84, 
                "endTime": 1575595370.669409
            }, 
            {
                "endTimeFormat": "2019-12-06 09:22:51", 
                "startTimeFormat": "2019-12-06 09:22:50", 
                "startTime": 1575595370.669497, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_85.sql", 
                "second": 0.35748887062072754, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'D' and\r\n       cd_education_status = '4 yr Degree' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1999 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'D' and\r        cd_education_status = '4 yr Degree' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1999 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 85, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/85.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query26.tpl\r", 
                "sid": 85, 
                "endTime": 1575595371.026986
            }, 
            {
                "endTimeFormat": "2019-12-06 09:23:12", 
                "startTimeFormat": "2019-12-06 09:22:51", 
                "startTime": 1575595371.027095, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_86.sql", 
                "second": 21.413237810134888, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('1998-05-31','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('1998-05-31','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('1998-05-31','yyyy-mm-dd') - 30 )\r\n                and (to_date ('1998-05-31','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('1998-05-31','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('1998-05-31','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('1998-05-31','yyyy-mm-dd') - 30 )\r                 and (to_date ('1998-05-31','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                "id": 86, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/86.sql", 
                "secondFormat": "00:00:21", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query40.tpl\r", 
                "sid": 86, 
                "endTime": 1575595392.440333
            }, 
            {
                "endTimeFormat": "2019-12-06 09:23:48", 
                "startTimeFormat": "2019-12-06 09:23:12", 
                "startTime": 1575595392.440412, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_87.sql", 
                "second": 36.24232506752014, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '>10000'\r\n  and d1.d_year = 1998\r\n  and cd_marital_status = 'W'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '>10000'\r   and d1.d_year = 1998\r   and cd_marital_status = 'W'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                "id": 87, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/87.sql", 
                "secondFormat": "00:00:36", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query72.tpl\r", 
                "sid": 87, 
                "endTime": 1575595428.682737
            }, 
            {
                "endTimeFormat": "2019-12-06 09:23:49", 
                "startTimeFormat": "2019-12-06 09:23:48", 
                "startTime": 1575595428.682806, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_88.sql", 
                "second": 0.366441011428833, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1178,1178+1,1178+2,1178+3,1178+4,1178+5,1178+6,1178+7,1178+8,1178+9,1178+10,1178+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1178,1178+1,1178+2,1178+3,1178+4,1178+5,1178+6,1178+7,1178+8,1178+9,1178+10,1178+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                "id": 88, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/88.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query53.tpl\r", 
                "sid": 88, 
                "endTime": 1575595429.049247
            }, 
            {
                "endTimeFormat": "2019-12-06 09:23:50", 
                "startTimeFormat": "2019-12-06 09:23:49", 
                "startTime": 1575595429.049318, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_89.sql", 
                "second": 1.0911478996276855, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 2 or household_demographics.hd_vehicle_count > 0)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (1998,1998+1,1998+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 2 or household_demographics.hd_vehicle_count > 0)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (1998,1998+1,1998+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                "id": 89, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/89.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query79.tpl\r", 
                "sid": 89, 
                "endTime": 1575595430.140466
            }, 
            {
                "endTimeFormat": "2019-12-06 09:23:51", 
                "startTimeFormat": "2019-12-06 09:23:50", 
                "startTime": 1575595430.140568, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_90.sql", 
                "second": 1.830704927444458, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'M' and \r\n       cd1.cd_education_status = 'Primary' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (12,2,5,9,3,6) and\r\n       d_year = 1999 and\r\n       ca_state in ('IA','MI','AR'\r\n                   ,'TX','IL','OR','FL')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'M' and \r        cd1.cd_education_status = 'Primary' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (12,2,5,9,3,6) and\r        d_year = 1999 and\r        ca_state in ('IA','MI','AR'\r                    ,'TX','IL','OR','FL')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                "id": 90, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/90.sql", 
                "secondFormat": "00:00:01", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query18.tpl\r", 
                "sid": 90, 
                "endTime": 1575595431.971273
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:09", 
                "startTimeFormat": "2019-12-06 09:23:51", 
                "startTime": 1575595431.971358, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_91.sql", 
                "second": 17.784523963928223, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'M'\r\n  and cd_education_status = '4 yr Degree'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'D'\r\n  and cd_education_status = 'College'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = 'Secondary'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('IA', 'CA', 'FL')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('NM', 'MI', 'GA')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('KS', 'CO', 'WI')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'M'\r   and cd_education_status = '4 yr Degree'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'D'\r   and cd_education_status = 'College'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = 'Secondary'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('IA', 'CA', 'FL')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('NM', 'MI', 'GA')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('KS', 'CO', 'WI')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                "id": 91, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/91.sql", 
                "secondFormat": "00:00:17", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query13.tpl\r", 
                "sid": 91, 
                "endTime": 1575595449.755882
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:12", 
                "startTimeFormat": "2019-12-06 09:24:09", 
                "startTime": 1575595449.75599, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_92.sql", 
                "second": 2.312532901763916, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=6\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'tomato'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 6\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'lime'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=6\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'tomato'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 6\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'lime'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                "id": 92, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/92.sql", 
                "secondFormat": "00:00:02", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query24.tpl\r", 
                "sid": 92, 
                "endTime": 1575595452.068523
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:15", 
                "startTimeFormat": "2019-12-06 09:24:12", 
                "startTime": 1575595452.06861, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_93.sql", 
                "second": 3.581210136413574, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_email_address\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  2001\r\n   and t_s_secyear.dyear = 2001+1\r\n   and t_c_firstyear.dyear =  2001\r\n   and t_c_secyear.dyear =  2001+1\r\n   and t_w_firstyear.dyear = 2001\r\n   and t_w_secyear.dyear = 2001+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_email_address\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_email_address\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  2001\r    and t_s_secyear.dyear = 2001+1\r    and t_c_firstyear.dyear =  2001\r    and t_c_secyear.dyear =  2001+1\r    and t_w_firstyear.dyear = 2001\r    and t_w_secyear.dyear = 2001+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_email_address\r  ) where rownum <= 100;\r \r ", 
                "id": 93, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/93.sql", 
                "secondFormat": "00:00:03", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query4.tpl\r", 
                "sid": 93, 
                "endTime": 1575595455.64982
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:16", 
                "startTimeFormat": "2019-12-06 09:24:15", 
                "startTime": 1575595455.649912, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_94.sql", 
                "second": 0.516204833984375, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1194 and 1194 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1194 and 1194 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                "id": 94, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/94.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query99.tpl\r", 
                "sid": 94, 
                "endTime": 1575595456.166117
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:16", 
                "startTimeFormat": "2019-12-06 09:24:16", 
                "startTime": 1575595456.166199, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_95.sql", 
                "second": 0.09990596771240234, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 1 or\r\n             household_demographics.hd_vehicle_count= 2)\r\n        and date_dim.d_year in (2000,2000+1,2000+2)\r\n        and store.s_city in ('Liberty','Pleasant Hill')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 1 or\r              household_demographics.hd_vehicle_count= 2)\r         and date_dim.d_year in (2000,2000+1,2000+2)\r         and store.s_city in ('Liberty','Pleasant Hill')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                "id": 95, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/95.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query68.tpl\r", 
                "sid": 95, 
                "endTime": 1575595456.266105
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:16", 
                "startTimeFormat": "2019-12-06 09:24:16", 
                "startTime": 1575595456.266213, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_96.sql", 
                "second": 0.3092191219329834, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('1999-06-28','yyyy-mm-dd'),to_date('1999-09-24','yyyy-mm-dd'),to_date('1999-11-17','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('1999-06-28','yyyy-mm-dd'),to_date('1999-09-24','yyyy-mm-dd'),to_date('1999-11-17','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('1999-06-28','yyyy-mm-dd'),to_date('1999-09-24','yyyy-mm-dd'),to_date('1999-11-17','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('1999-06-28','yyyy-mm-dd'),to_date('1999-09-24','yyyy-mm-dd'),to_date('1999-11-17','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('1999-06-28','yyyy-mm-dd'),to_date('1999-09-24','yyyy-mm-dd'),to_date('1999-11-17','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('1999-06-28','yyyy-mm-dd'),to_date('1999-09-24','yyyy-mm-dd'),to_date('1999-11-17','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                "id": 96, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/96.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query83.tpl\r", 
                "sid": 96, 
                "endTime": 1575595456.575432
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:16", 
                "startTimeFormat": "2019-12-06 09:24:16", 
                "startTime": 1575595456.575531, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_97.sql", 
                "second": 0.15033292770385742, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Jewelry'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 1998\r\n   and   d_moy  = 12) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Jewelry'\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 1998\r\n   and   d_moy  = 12) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -7\r    and   i_category = 'Jewelry'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -7\r    and   d_year = 1998\r    and   d_moy  = 12) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -7\r    and   i_category = 'Jewelry'\r    and   s_gmt_offset = -7\r    and   d_year = 1998\r    and   d_moy  = 12) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                "id": 97, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/97.sql", 
                "secondFormat": "00:00:00", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query61.tpl\r", 
                "sid": 97, 
                "endTime": 1575595456.725864
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:40", 
                "startTimeFormat": "2019-12-06 09:24:16", 
                "startTime": 1575595456.725959, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_98.sql", 
                "second": 24.2465238571167, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-03','yyyy-mm-dd') \r\n                  and to_date('1999-08-03','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-03','yyyy-mm-dd') \r\n                  and to_date('1999-08-03','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-03','yyyy-mm-dd') \r\n                  and to_date('1999-08-03','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('1999-08-03','yyyy-mm-dd') \r                   and to_date('1999-08-03','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('1999-08-03','yyyy-mm-dd') \r                   and to_date('1999-08-03','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('1999-08-03','yyyy-mm-dd') \r                   and to_date('1999-08-03','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                "id": 98, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/98.sql", 
                "secondFormat": "00:00:24", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query5.tpl\r", 
                "sid": 98, 
                "endTime": 1575595480.972483
            }, 
            {
                "endTimeFormat": "2019-12-06 09:24:46", 
                "startTimeFormat": "2019-12-06 09:24:40", 
                "startTime": 1575595480.972569, 
                "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_99.sql", 
                "second": 5.117005109786987, 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_0.sql", 
                "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_customer_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_bill_addr_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_bill_addr_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_customer_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_bill_addr_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_bill_addr_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                "id": 99, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/99.sql", 
                "secondFormat": "00:00:05", 
                "filename": "query_0.sql", 
                "isSuccess": true, 
                "template": "query76.tpl\r", 
                "sid": 99, 
                "endTime": 1575595486.089574
            }
        ], 
        "second": 665.6792449951172, 
        "startTime": 1575594820.410609, 
        "endTime": 1575595486.089854
    }, 
    "ThroughputRun1": {
        "endTimeFormat": "2019-12-06 09:27:42", 
        "startTimeFormat": "2019-12-06 09:24:46", 
        "query_3.sql": {
            "endTimeFormat": "2019-12-06 09:27:38", 
            "startTimeFormat": "2019-12-06 09:24:46", 
            "secondFormat": "00:02:52", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:24:46", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.093434, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_298.sql", 
                    "second": 0.43955183029174805, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (2000) and\r\n        ((i_category in ('Music','Sports','Shoes') and\r\n          i_class in ('classical','hockey','womens')\r\n         )\r\n      or (i_category in ('Electronics','Home','Women') and\r\n          i_class in ('memory','rugs','dresses') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (2000) and\r         ((i_category in ('Music','Sports','Shoes') and\r           i_class in ('classical','hockey','womens')\r          )\r       or (i_category in ('Electronics','Home','Women') and\r           i_class in ('memory','rugs','dresses') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 298, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/298.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595486.532986
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:52", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.533067, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_299.sql", 
                    "second": 6.128895998001099, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r\n                  and to_date('2001-08-10','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-10','yyyy-mm-dd') \r\n                  and to_date('2001-08-10','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-10','yyyy-mm-dd') \r\n                  and to_date('2001-08-10','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r                   and to_date('2001-08-10','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('2001-08-10','yyyy-mm-dd') \r                   and to_date('2001-08-10','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('2001-08-10','yyyy-mm-dd') \r                   and to_date('2001-08-10','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 299, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/299.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595492.661963
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:52", 
                    "startTimeFormat": "2019-12-06 09:24:52", 
                    "startTime": 1575595492.662043, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_300.sql", 
                    "second": 0.2538018226623535, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=11\r\n    and dt.d_year=1998\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=11\r     and dt.d_year=1998\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 300, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/300.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595492.915845
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:52", 
                    "startTime": 1575595492.915945, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_301.sql", 
                    "second": 0.376708984375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1188 and 1188 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1188 and 1188 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 301, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/301.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595493.292654
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.292737, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_302.sql", 
                    "second": 0.32834506034851074, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 302, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/302.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595493.621082
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:54", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.621184, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_303.sql", 
                    "second": 0.5521268844604492, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'U' and\r\n       cd_education_status = 'College' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2000 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'U' and\r        cd_education_status = 'College' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2000 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 303, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/303.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595494.173311
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:55", 
                    "startTimeFormat": "2019-12-06 09:24:54", 
                    "startTime": 1575595494.173407, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_304.sql", 
                    "second": 1.3370130062103271, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2002\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=3\r\n  and inv2.d_moy=3+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2002\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=3\r\n  and inv2.d_moy=3+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2002\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=3\r   and inv2.d_moy=3+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2002\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=3\r   and inv2.d_moy=3+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 304, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/304.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595495.51042
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:09", 
                    "startTimeFormat": "2019-12-06 09:24:55", 
                    "startTime": 1575595495.510526, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_305.sql", 
                    "second": 13.57914400100708, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-06','yyyy-mm-dd') \r\n                  and to_date('2001-08-06','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-06','yyyy-mm-dd') \r\n                  and to_date('2001-08-06','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-06','yyyy-mm-dd') \r\n                  and to_date('2001-08-06','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-06','yyyy-mm-dd') \r                   and to_date('2001-08-06','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-06','yyyy-mm-dd') \r                   and to_date('2001-08-06','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-06','yyyy-mm-dd') \r                   and to_date('2001-08-06','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 305, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/305.sql", 
                    "secondFormat": "00:00:13", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595509.08967
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:09", 
                    "startTimeFormat": "2019-12-06 09:25:09", 
                    "startTime": 1575595509.089764, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_306.sql", 
                    "second": 0.30582380294799805, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1181,1181+1,1181+2,1181+3,1181+4,1181+5,1181+6,1181+7,1181+8,1181+9,1181+10,1181+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1181,1181+1,1181+2,1181+3,1181+4,1181+5,1181+6,1181+7,1181+8,1181+9,1181+10,1181+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 306, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/306.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595509.395588
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:13", 
                    "startTimeFormat": "2019-12-06 09:25:09", 
                    "startTime": 1575595509.395681, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_307.sql", 
                    "second": 4.381205081939697, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '501-1000'\r\n  and d1.d_year = 1998\r\n  and cd_marital_status = 'S'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '501-1000'\r   and d1.d_year = 1998\r   and cd_marital_status = 'S'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 307, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/307.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595513.776886
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:14", 
                    "startTimeFormat": "2019-12-06 09:25:13", 
                    "startTime": 1575595513.77699, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_308.sql", 
                    "second": 0.5979189872741699, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'M' and \r\n       cd1.cd_education_status = 'Advanced Degree' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (9,5,11,1,6,8) and\r\n       d_year = 1998 and\r\n       ca_state in ('IL','AR','NV'\r\n                   ,'FL','OH','MT','IN')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'M' and \r        cd1.cd_education_status = 'Advanced Degree' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (9,5,11,1,6,8) and\r        d_year = 1998 and\r        ca_state in ('IL','AR','NV'\r                    ,'FL','OH','MT','IN')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 308, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/308.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595514.374909
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:14", 
                    "startTimeFormat": "2019-12-06 09:25:14", 
                    "startTime": 1575595514.375014, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_309.sql", 
                    "second": 0.4873340129852295, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('spring','burlywood','tan'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 3\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('spring','burlywood','tan'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 3\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('spring','burlywood','tan'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 3\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('spring','burlywood','tan'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 3\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('spring','burlywood','tan'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 3\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('spring','burlywood','tan'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 3\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 309, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/309.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595514.862348
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:16", 
                    "startTimeFormat": "2019-12-06 09:25:14", 
                    "startTime": 1575595514.862445, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_310.sql", 
                    "second": 1.177271842956543, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = 'Secondary'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'W'\r\n  and cd_education_status = '4 yr Degree'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'M'\r\n  and cd_education_status = 'Primary'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('ME', 'NC', 'AZ')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('TX', 'GA', 'KY')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('PA', 'IN', 'MN')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = 'Secondary'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'W'\r   and cd_education_status = '4 yr Degree'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'M'\r   and cd_education_status = 'Primary'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('ME', 'NC', 'AZ')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('TX', 'GA', 'KY')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('PA', 'IN', 'MN')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 310, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/310.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595516.039717
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:16", 
                    "startTimeFormat": "2019-12-06 09:25:16", 
                    "startTime": 1575595516.039806, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_311.sql", 
                    "second": 0.6579971313476562, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('MI','GA','UT') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 3 and 3+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 3 and 3+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 3 and 3+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('MI','GA','UT') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 3 and 3+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 3 and 3+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 3 and 3+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 311, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/311.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595516.697803
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:24", 
                    "startTimeFormat": "2019-12-06 09:25:16", 
                    "startTime": 1575595516.697915, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_312.sql", 
                    "second": 7.9285149574279785, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (2000,2000+1,2000+2,2000+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (2000,2000+1,2000+2,2000+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 2000 \r\n         and d_moy = 4 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 2000 \r\n         and d_moy = 4 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (2000,2000+1,2000+2,2000+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 2000 \r\n         and d_moy = 4 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 2000 \r\n         and d_moy = 4 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (2000,2000+1,2000+2,2000+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (2000,2000+1,2000+2,2000+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 2000 \r          and d_moy = 4 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 2000 \r          and d_moy = 4 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (2000,2000+1,2000+2,2000+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 2000 \r          and d_moy = 4 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 2000 \r          and d_moy = 4 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 312, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/312.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595524.62643
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:25", 
                    "startTimeFormat": "2019-12-06 09:25:24", 
                    "startTime": 1575595524.626522, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_313.sql", 
                    "second": 0.37877798080444336, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=13\r\n   and d_moy=12\r\n   and d_year=1999\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=13\r    and d_moy=12\r    and d_year=1999\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 313, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/313.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595525.0053
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:26", 
                    "startTimeFormat": "2019-12-06 09:25:25", 
                    "startTime": 1575595525.005391, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_314.sql", 
                    "second": 1.2383310794830322, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (1998,1998+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (1998,1998+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 1998\r\n         and t_s_secyear.year = 1998+1\r\n         and t_w_firstyear.year = 1998\r\n         and t_w_secyear.year = 1998+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 2,1,3\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (1998,1998+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (1998,1998+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 1998\r          and t_s_secyear.year = 1998+1\r          and t_w_firstyear.year = 1998\r          and t_w_secyear.year = 1998+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 2,1,3\r  ) where rownum <= 100;\r \r ", 
                    "id": 314, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/314.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595526.243722
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:26", 
                    "startTimeFormat": "2019-12-06 09:25:26", 
                    "startTime": 1575595526.243843, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_315.sql", 
                    "second": 0.021744966506958008, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2001\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'NY'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2001\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'NY'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 315, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/315.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595526.265588
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:26", 
                    "startTimeFormat": "2019-12-06 09:25:26", 
                    "startTime": 1575595526.265684, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_316.sql", 
                    "second": 0.1450181007385254, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Waterloo'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  59450\r\n   and ib_upper_bound   <=  59450 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Waterloo'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  59450\r    and ib_upper_bound   <=  59450 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 316, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/316.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595526.410702
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:26", 
                    "startTimeFormat": "2019-12-06 09:25:26", 
                    "startTime": 1575595526.410804, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_317.sql", 
                    "second": 0.25492191314697266, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 20\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 6\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 20\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 6\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 317, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/317.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595526.665726
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:26", 
                    "startTime": 1575595526.665816, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_318.sql", 
                    "second": 14.346357822418213, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 2000 AND 2000 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 2000 AND 2000 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 2000 AND 2000 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 2000 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 1)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 2000\r\n                       and d_moy = 12\r\n                       and d_dom = 1)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 2000 AND 2000 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 2000 AND 2000 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 2000 AND 2000 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 2000+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 2000+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 2000+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 2000 AND 2000 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 2000 AND 2000 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 2000 AND 2000 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 2000 + 1\r                        and d_moy = 12\r                        and d_dom = 1)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 2000\r                        and d_moy = 12\r                        and d_dom = 1)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 318, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/318.sql", 
                    "secondFormat": "00:00:14", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595541.012174
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.012278, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_319.sql", 
                    "second": 0.6054549217224121, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Toole County','Greene County','Ward County','Montgomery County','Boulder County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_moy between 1 and 1+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2000 and\r\n                  d_moy between 1 and 1+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2000 and\r\n                  d_moy between 1 and 1+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Toole County','Greene County','Ward County','Montgomery County','Boulder County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_moy between 1 and 1+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2000 and\r                   d_moy between 1 and 1+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2000 and\r                   d_moy between 1 and 1+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 319, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/319.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595541.617733
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.617844, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_320.sql", 
                    "second": 0.2651479244232178, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1223 and 1223+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1223 and 1223+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 320, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/320.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595541.882992
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:42", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.883077, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_321.sql", 
                    "second": 0.4338691234588623, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2001-4-01','yyyy-mm-dd') and \r\n           to_date('2001-4-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'VA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2001-4-01','yyyy-mm-dd') and \r            to_date('2001-4-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'VA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 321, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/321.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595542.316946
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:42", 
                    "startTimeFormat": "2019-12-06 09:25:42", 
                    "startTime": 1575595542.317046, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_322.sql", 
                    "second": 0.130079984664917, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '87026','33178','48786','86867','36192','53947',\r\n                          '82344','43340','55462','35455','43955',\r\n                          '35632','13719','54190','96816','46842',\r\n                          '96287','34931','31542','80840','17362',\r\n                          '53557','87810','27524','37203','96232',\r\n                          '48839','86903','37558','33964','44449',\r\n                          '65367','77968','90025','74994','98058',\r\n                          '19021','14379','28812','17646','42476',\r\n                          '67983','60675','24763','17551','81392',\r\n                          '38081','78676','24361','99026','32649',\r\n                          '28087','73893','31970','17019','91458',\r\n                          '35354','94100','80770','50083','67373',\r\n                          '25524','35244','20546','33238','66251',\r\n                          '30115','75288','62484','52061','62468',\r\n                          '23018','86608','43939','19689','67375',\r\n                          '32569','44168','29041','27703','12216',\r\n                          '16668','50298','87220','89192','14603',\r\n                          '46218','28067','33942','99604','11379',\r\n                          '23387','69504','36505','32897','34894',\r\n                          '45129','11329','35073','37088','99767',\r\n                          '80011','94385','46670','31730','81168',\r\n                          '22709','72950','30642','67235','90741',\r\n                          '73958','31130','79940','13627','64524',\r\n                          '28936','54896','71342','99825','31595',\r\n                          '41454','60097','36771','71540','68867',\r\n                          '18521','38085','78679','38160','15989',\r\n                          '39023','62652','15530','73402','88379',\r\n                          '50684','60547','54477','53480','17402',\r\n                          '60973','68023','23435','47994','46724',\r\n                          '39302','36049','48837','59509','83528',\r\n                          '45725','33135','66214','65421','66615',\r\n                          '34051','47188','78788','47336','44129',\r\n                          '41579','22067','12114','49633','40224',\r\n                          '69487','41531','73601','14450','36240',\r\n                          '91928','70989','77189','25860','76598',\r\n                          '43847','56853','62472','55171','95258',\r\n                          '39122','91483','34127','43578','41105',\r\n                          '83548','56203','76860','72525','57123',\r\n                          '29653','40907','42008','84838','65458',\r\n                          '44839','96429','79446','82689','44036',\r\n                          '57823','61079','68034','15311','26662',\r\n                          '40325','26379','75092','65349','22502',\r\n                          '81712','18345','46264','86607','47752',\r\n                          '54400','99258','59493','75689','20100',\r\n                          '59183','92404','94440','35556','48760',\r\n                          '88402','64858','16048','16653','55003',\r\n                          '68627','95614','92426','16890','46510',\r\n                          '41698','26573','79847','57135','57809',\r\n                          '28352','15835','11092','37739','39653',\r\n                          '57982','77384','63852','18161','98450',\r\n                          '93351','36271','30204','56315','60178',\r\n                          '91692','47408','37289','74381','10026',\r\n                          '92761','39160','96493','59666','63275',\r\n                          '56669','39814','66880','90251','41749',\r\n                          '51761','72954','43219','34587','59766',\r\n                          '36780','38342','55767','10561','35652',\r\n                          '84695','62085','38362','68278','73498',\r\n                          '50268','21986','24718','92295','47727',\r\n                          '73212','53927','98402','51124','60832',\r\n                          '30480','65784','78580','82942','57130',\r\n                          '66211','64585','20420','81342','61230',\r\n                          '69989','93311','42860','64307','70115',\r\n                          '23078','28849','76470','78695','97799',\r\n                          '39641','69177','84156','86748','31238',\r\n                          '23930','92040','78055','75664','43216',\r\n                          '60121','28310','73182','77721','65854',\r\n                          '28047','46032','50319','52571','27580',\r\n                          '96141','54867','28442','91122','73446',\r\n                          '14811','20921','86900','46404','31220',\r\n                          '88034','71241','78384','66059','27297',\r\n                          '91098','20104','81214','96051','73623',\r\n                          '70929','86835','57165','22974','38697',\r\n                          '49882','52793','49655','91023','44285',\r\n                          '97092','38453','30136','15859','53194',\r\n                          '54044','62499','30233','84418','92092',\r\n                          '74474','61157','87632','94111','59777',\r\n                          '38649','28555','70888','53071','19447',\r\n                          '32180','36723','74269','56585','29247',\r\n                          '29363','23986','51562','79252','62140',\r\n                          '62628','36991','15638','96986')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 2 and d_year = 2001\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '87026','33178','48786','86867','36192','53947',\r                           '82344','43340','55462','35455','43955',\r                           '35632','13719','54190','96816','46842',\r                           '96287','34931','31542','80840','17362',\r                           '53557','87810','27524','37203','96232',\r                           '48839','86903','37558','33964','44449',\r                           '65367','77968','90025','74994','98058',\r                           '19021','14379','28812','17646','42476',\r                           '67983','60675','24763','17551','81392',\r                           '38081','78676','24361','99026','32649',\r                           '28087','73893','31970','17019','91458',\r                           '35354','94100','80770','50083','67373',\r                           '25524','35244','20546','33238','66251',\r                           '30115','75288','62484','52061','62468',\r                           '23018','86608','43939','19689','67375',\r                           '32569','44168','29041','27703','12216',\r                           '16668','50298','87220','89192','14603',\r                           '46218','28067','33942','99604','11379',\r                           '23387','69504','36505','32897','34894',\r                           '45129','11329','35073','37088','99767',\r                           '80011','94385','46670','31730','81168',\r                           '22709','72950','30642','67235','90741',\r                           '73958','31130','79940','13627','64524',\r                           '28936','54896','71342','99825','31595',\r                           '41454','60097','36771','71540','68867',\r                           '18521','38085','78679','38160','15989',\r                           '39023','62652','15530','73402','88379',\r                           '50684','60547','54477','53480','17402',\r                           '60973','68023','23435','47994','46724',\r                           '39302','36049','48837','59509','83528',\r                           '45725','33135','66214','65421','66615',\r                           '34051','47188','78788','47336','44129',\r                           '41579','22067','12114','49633','40224',\r                           '69487','41531','73601','14450','36240',\r                           '91928','70989','77189','25860','76598',\r                           '43847','56853','62472','55171','95258',\r                           '39122','91483','34127','43578','41105',\r                           '83548','56203','76860','72525','57123',\r                           '29653','40907','42008','84838','65458',\r                           '44839','96429','79446','82689','44036',\r                           '57823','61079','68034','15311','26662',\r                           '40325','26379','75092','65349','22502',\r                           '81712','18345','46264','86607','47752',\r                           '54400','99258','59493','75689','20100',\r                           '59183','92404','94440','35556','48760',\r                           '88402','64858','16048','16653','55003',\r                           '68627','95614','92426','16890','46510',\r                           '41698','26573','79847','57135','57809',\r                           '28352','15835','11092','37739','39653',\r                           '57982','77384','63852','18161','98450',\r                           '93351','36271','30204','56315','60178',\r                           '91692','47408','37289','74381','10026',\r                           '92761','39160','96493','59666','63275',\r                           '56669','39814','66880','90251','41749',\r                           '51761','72954','43219','34587','59766',\r                           '36780','38342','55767','10561','35652',\r                           '84695','62085','38362','68278','73498',\r                           '50268','21986','24718','92295','47727',\r                           '73212','53927','98402','51124','60832',\r                           '30480','65784','78580','82942','57130',\r                           '66211','64585','20420','81342','61230',\r                           '69989','93311','42860','64307','70115',\r                           '23078','28849','76470','78695','97799',\r                           '39641','69177','84156','86748','31238',\r                           '23930','92040','78055','75664','43216',\r                           '60121','28310','73182','77721','65854',\r                           '28047','46032','50319','52571','27580',\r                           '96141','54867','28442','91122','73446',\r                           '14811','20921','86900','46404','31220',\r                           '88034','71241','78384','66059','27297',\r                           '91098','20104','81214','96051','73623',\r                           '70929','86835','57165','22974','38697',\r                           '49882','52793','49655','91023','44285',\r                           '97092','38453','30136','15859','53194',\r                           '54044','62499','30233','84418','92092',\r                           '74474','61157','87632','94111','59777',\r                           '38649','28555','70888','53071','19447',\r                           '32180','36723','74269','56585','29247',\r                           '29363','23986','51562','79252','62140',\r                           '62628','36991','15638','96986')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 2 and d_year = 2001\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 322, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/322.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595542.447126
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:43", 
                    "startTimeFormat": "2019-12-06 09:25:42", 
                    "startTime": 1575595542.447227, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_323.sql", 
                    "second": 1.1602249145507812, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1187 and 1187+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1187 and 1187+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1187 and 1187+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1187 and 1187+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1187 and 1187+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1187 and 1187+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 323, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/323.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595543.607452
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:44", 
                    "startTimeFormat": "2019-12-06 09:25:43", 
                    "startTime": 1575595543.607536, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_324.sql", 
                    "second": 0.48441600799560547, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1998-02-17','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1998-02-17','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('1998-02-17','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1998-02-17','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1998-02-17','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('1998-02-17','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 324, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/324.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595544.091952
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:44", 
                    "startTimeFormat": "2019-12-06 09:25:44", 
                    "startTime": 1575595544.092056, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_325.sql", 
                    "second": 0.8465049266815186, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 2000 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('SC','GA','MI','TN',\r\n                 'SD','MI','SC','MO')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 2000 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('SC','GA','MI','TN',\r                  'SD','MI','SC','MO')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 325, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/325.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595544.938561
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:46", 
                    "startTimeFormat": "2019-12-06 09:25:44", 
                    "startTime": 1575595544.938642, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_326.sql", 
                    "second": 1.0929710865020752, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 37 and 37 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1998-02-10' ,'yyyy-mm-dd') and to_date('1998-02-10' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (861,729,668,929)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 37 and 37 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1998-02-10' ,'yyyy-mm-dd') and to_date('1998-02-10' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (861,729,668,929)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 326, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/326.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595546.031613
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:49", 
                    "startTimeFormat": "2019-12-06 09:25:46", 
                    "startTime": 1575595546.0317, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_327.sql", 
                    "second": 3.683561086654663, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_login\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  2001\r\n   and t_s_secyear.dyear = 2001+1\r\n   and t_c_firstyear.dyear =  2001\r\n   and t_c_secyear.dyear =  2001+1\r\n   and t_w_firstyear.dyear = 2001\r\n   and t_w_secyear.dyear = 2001+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_login\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_login\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  2001\r    and t_s_secyear.dyear = 2001+1\r    and t_c_firstyear.dyear =  2001\r    and t_c_secyear.dyear =  2001+1\r    and t_w_firstyear.dyear = 2001\r    and t_w_secyear.dyear = 2001+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_login\r  ) where rownum <= 100;\r \r ", 
                    "id": 327, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/327.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595549.715261
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:50", 
                    "startTimeFormat": "2019-12-06 09:25:49", 
                    "startTime": 1575595549.715344, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_328.sql", 
                    "second": 1.2542531490325928, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1207 and 1207 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1207 and 1207 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1207 and 1207 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1207 and 1207 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1207 and 1207 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1207 and 1207 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 328, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/328.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595550.969597
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:55", 
                    "startTimeFormat": "2019-12-06 09:25:50", 
                    "startTime": 1575595550.969687, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_329.sql", 
                    "second": 4.661700010299683, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'PRIVATECARRIER' || ',' || 'DHL' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 1998\r\n \tand t_time between 2488 and 2488+28800 \r\n \tand sm_carrier in ('PRIVATECARRIER','DHL')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'PRIVATECARRIER' || ',' || 'DHL' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 1998\r\n \tand t_time between 2488 AND 2488+28800 \r\n \tand sm_carrier in ('PRIVATECARRIER','DHL')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'PRIVATECARRIER' || ',' || 'DHL' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 1998\r  \tand t_time between 2488 and 2488+28800 \r  \tand sm_carrier in ('PRIVATECARRIER','DHL')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'PRIVATECARRIER' || ',' || 'DHL' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 1998\r  \tand t_time between 2488 AND 2488+28800 \r  \tand sm_carrier in ('PRIVATECARRIER','DHL')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 329, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/329.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595555.631387
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:59", 
                    "startTimeFormat": "2019-12-06 09:25:55", 
                    "startTime": 1575595555.63148, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_330.sql", 
                    "second": 3.932188034057617, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_sold_year, ss_item_sk, ss_customer_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000\r\norder by \r\n  ss_sold_year, ss_item_sk, ss_customer_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_sold_year, ss_item_sk, ss_customer_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000\r order by \r   ss_sold_year, ss_item_sk, ss_customer_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 330, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/330.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595559.563668
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:00", 
                    "startTimeFormat": "2019-12-06 09:25:59", 
                    "startTime": 1575595559.56375, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_331.sql", 
                    "second": 0.6164200305938721, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 1998 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 1998 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 331, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/331.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595560.18017
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:11", 
                    "startTimeFormat": "2019-12-06 09:26:00", 
                    "startTime": 1575595560.180273, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_332.sql", 
                    "second": 11.080906867980957, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1200 and 1200 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1200 and 1200 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 332, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/332.sql", 
                    "secondFormat": "00:00:11", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595571.26118
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:11", 
                    "startTimeFormat": "2019-12-06 09:26:11", 
                    "startTime": 1575595571.261287, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_333.sql", 
                    "second": 0.21094894409179688, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('2001-03-04' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('2001-03-04' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('2001-03-04' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('2001-03-04' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('2001-03-04' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('2001-03-04' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('2001-03-04' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('2001-03-04' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 333, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/333.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595571.472236
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:13", 
                    "startTimeFormat": "2019-12-06 09:26:11", 
                    "startTime": 1575595571.47233, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_334.sql", 
                    "second": 1.8906879425048828, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1185 and 1185 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1185 and 1185 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1185 and 1185 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1185 and 1185 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 334, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/334.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595573.363018
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:15", 
                    "startTimeFormat": "2019-12-06 09:26:13", 
                    "startTime": 1575595573.363114, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_335.sql", 
                    "second": 2.220047950744629, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 2000 or\r\n         ( d_year = 2000-1 and d_moy =12) or\r\n         ( d_year = 2000+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2000 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 2000 or\r          ( d_year = 2000-1 and d_moy =12) or\r          ( d_year = 2000+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2000 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 335, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/335.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595575.583162
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:16", 
                    "startTimeFormat": "2019-12-06 09:26:15", 
                    "startTime": 1575595575.583273, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_336.sql", 
                    "second": 0.45795106887817383, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,max(ss_quantity)        as store_sales_quantity\r\n    ,max(sr_return_quantity) as store_returns_quantity\r\n    ,max(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 1999\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 1999\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (1999,1999+1,1999+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,max(ss_quantity)        as store_sales_quantity\r     ,max(sr_return_quantity) as store_returns_quantity\r     ,max(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 1999\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 1999\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (1999,1999+1,1999+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 336, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/336.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595576.041224
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:16", 
                    "startTimeFormat": "2019-12-06 09:26:16", 
                    "startTime": 1575595576.041312, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_337.sql", 
                    "second": 0.30326199531555176, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_ext_sales_price) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 318\r\n   and dt.d_moy=12\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_ext_sales_price) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 318\r    and dt.d_moy=12\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 337, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/337.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595576.344574
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:16", 
                    "startTimeFormat": "2019-12-06 09:26:16", 
                    "startTime": 1575595576.344671, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_338.sql", 
                    "second": 0.5136868953704834, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_cdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_cdemo_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_ship_hdemo_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_bill_addr_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_cdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_cdemo_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_ship_hdemo_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_bill_addr_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 338, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/338.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595576.858358
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:17", 
                    "startTimeFormat": "2019-12-06 09:26:16", 
                    "startTime": 1575595576.858447, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_339.sql", 
                    "second": 1.0714268684387207, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 64 and 64+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1998-04-24' ,'yyyy-mm-dd') and to_date('1998-04-24' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (139,703,387,619)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 64 and 64+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1998-04-24' ,'yyyy-mm-dd') and to_date('1998-04-24' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (139,703,387,619)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 339, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/339.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595577.929874
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:18", 
                    "startTimeFormat": "2019-12-06 09:26:17", 
                    "startTime": 1575595577.929969, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_340.sql", 
                    "second": 0.1071779727935791, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 2 or\r\n         household_demographics.hd_vehicle_count= -1)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (1999,1999+1,1999+2) \r\n    and store.s_city in ('Oakdale','Oak Hill','Lakewood','Pleasant Grove','Riverside') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 2 or\r          household_demographics.hd_vehicle_count= -1)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (1999,1999+1,1999+2) \r     and store.s_city in ('Oakdale','Oak Hill','Lakewood','Pleasant Grove','Riverside') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 340, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/340.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595578.037147
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:18", 
                    "startTimeFormat": "2019-12-06 09:26:18", 
                    "startTime": 1575595578.037244, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_341.sql", 
                    "second": 0.08842897415161133, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 734 and 734+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'blue' or i_color = 'frosted') and \r\n        (i_units = 'Bundle' or i_units = 'Gross') and\r\n        (i_size = 'small' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'slate' or i_color = 'black') and\r\n        (i_units = 'Box' or i_units = 'Oz') and\r\n        (i_size = 'N/A' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'rose' or i_color = 'saddle') and\r\n        (i_units = 'Pound' or i_units = 'Tbl') and\r\n        (i_size = 'petite' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'green' or i_color = 'red') and\r\n        (i_units = 'Case' or i_units = 'N/A') and\r\n        (i_size = 'small' or i_size = 'economy')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'purple' or i_color = 'mint') and \r\n        (i_units = 'Carton' or i_units = 'Pallet') and\r\n        (i_size = 'small' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'lavender' or i_color = 'metallic') and\r\n        (i_units = 'Lb' or i_units = 'Ounce') and\r\n        (i_size = 'N/A' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'antique' or i_color = 'tan') and\r\n        (i_units = 'Unknown' or i_units = 'Dozen') and\r\n        (i_size = 'petite' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'wheat' or i_color = 'chocolate') and\r\n        (i_units = 'Cup' or i_units = 'Gram') and\r\n        (i_size = 'small' or i_size = 'economy')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 734 and 734+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'blue' or i_color = 'frosted') and \r         (i_units = 'Bundle' or i_units = 'Gross') and\r         (i_size = 'small' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'slate' or i_color = 'black') and\r         (i_units = 'Box' or i_units = 'Oz') and\r         (i_size = 'N/A' or i_size = 'large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'rose' or i_color = 'saddle') and\r         (i_units = 'Pound' or i_units = 'Tbl') and\r         (i_size = 'petite' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'green' or i_color = 'red') and\r         (i_units = 'Case' or i_units = 'N/A') and\r         (i_size = 'small' or i_size = 'economy')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'purple' or i_color = 'mint') and \r         (i_units = 'Carton' or i_units = 'Pallet') and\r         (i_size = 'small' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'lavender' or i_color = 'metallic') and\r         (i_units = 'Lb' or i_units = 'Ounce') and\r         (i_size = 'N/A' or i_size = 'large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'antique' or i_color = 'tan') and\r         (i_units = 'Unknown' or i_units = 'Dozen') and\r         (i_size = 'petite' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'wheat' or i_color = 'chocolate') and\r         (i_units = 'Cup' or i_units = 'Gram') and\r         (i_size = 'small' or i_size = 'economy')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 341, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/341.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595578.125673
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:19", 
                    "startTimeFormat": "2019-12-06 09:26:18", 
                    "startTime": 1575595578.125761, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_342.sql", 
                    "second": 1.860724925994873, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1199 and 1199 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1199+ 12 and 1199 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1199 and 1199 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1199+ 12 and 1199 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 342, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/342.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595579.986486
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:20", 
                    "startTimeFormat": "2019-12-06 09:26:19", 
                    "startTime": 1575595579.986584, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_343.sql", 
                    "second": 0.18428611755371094, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('1999-04-08','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('1999-04-08','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('1999-04-08','yyyy-mm-dd') - 30 )\r\n                and (to_date ('1999-04-08','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('1999-04-08','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('1999-04-08','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('1999-04-08','yyyy-mm-dd') - 30 )\r                 and (to_date ('1999-04-08','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 343, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/343.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595580.17087
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:20", 
                    "startTimeFormat": "2019-12-06 09:26:20", 
                    "startTime": 1575595580.170961, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_344.sql", 
                    "second": 0.24318814277648926, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=29\r\n \tand d_moy=12\r\n \tand d_year=2002\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=29\r  \tand d_moy=12\r  \tand d_year=2002\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 344, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/344.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595580.414149
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:21", 
                    "startTimeFormat": "2019-12-06 09:26:20", 
                    "startTime": 1575595580.414224, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_345.sql", 
                    "second": 0.6292011737823486, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2002-5-01','yyyy-mm-dd') and \r\n           (to_date('2002-5-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'KS'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Richland County','Luce County','Jefferson Davis Parish','Kittitas County',\r\n                  'Williamson County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2002-5-01','yyyy-mm-dd') and \r            (to_date('2002-5-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'KS'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Richland County','Luce County','Jefferson Davis Parish','Kittitas County',\r                   'Williamson County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 345, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/345.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595581.043425
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:21", 
                    "startTime": 1575595581.043523, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_346.sql", 
                    "second": 1.143824815750122, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'M' and\r\n       cd_marital_status = 'S' and\r\n       cd_education_status = 'Secondary' and\r\n       d_year = 2001 and\r\n       s_state in ('NY','TN', 'MI', 'WA', 'SC', 'GA')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'M' and\r        cd_marital_status = 'S' and\r        cd_education_status = 'Secondary' and\r        d_year = 2001 and\r        s_state in ('NY','TN', 'MI', 'WA', 'SC', 'GA')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 346, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/346.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595582.187348
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.187436, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_347.sql", 
                    "second": 0.6830799579620361, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Sports'\r\n         and i_class = 'athletic shoes'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 3\r\n         and d_year = 2000\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2000 and d_moy = 3)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2000 and d_moy = 3)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Sports'\r          and i_class = 'athletic shoes'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 3\r          and d_year = 2000\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2000 and d_moy = 3)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2000 and d_moy = 3)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 347, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/347.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595582.870516
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.870612, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_348.sql", 
                    "second": 0.15308499336242676, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 12 and 12+1\r\n         and household_demographics.hd_dep_count = 3\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 13 and 13+1\r\n         and household_demographics.hd_dep_count = 3\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 12 and 12+1\r          and household_demographics.hd_dep_count = 3\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 13 and 13+1\r          and household_demographics.hd_dep_count = 3\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 348, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/348.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595583.023697
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.023801, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_349.sql", 
                    "second": 0.021574974060058594, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 375\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('1998-01-10','yyyy-mm-dd') and \r\n        to_date('1998-01-10','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('1998-01-10','yyyy-mm-dd') and\r\n                             to_date('1998-01-10','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 375\r and i_item_sk = ws_item_sk \r and d_date between  to_date('1998-01-10','yyyy-mm-dd') and \r         to_date('1998-01-10','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('1998-01-10','yyyy-mm-dd') and\r                              to_date('1998-01-10','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 349, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/349.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595583.045376
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.045478, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_350.sql", 
                    "second": 0.6780579090118408, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 2001\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 2001\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 2001\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 2001\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 2001\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =2001\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by store_q2_q3_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 2001\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 2001\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 2001\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 2001\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 2001\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =2001\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by store_q2_q3_increase;\r \r ", 
                    "id": 350, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/350.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595583.723536
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.723635, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_351.sql", 
                    "second": 0.23989105224609375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=12\r\n \tand dt.d_year=2002\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=12\r  \tand dt.d_year=2002\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 351, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/351.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595583.963526
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.963625, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_352.sql", 
                    "second": 0.3726310729980469, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'W' and\r\n       cd_education_status = 'Unknown' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2001 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'W' and\r        cd_education_status = 'Unknown' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2001 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 352, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/352.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595584.336256
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.336336, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_353.sql", 
                    "second": 0.07325100898742676, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = 'Unknown')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Mobile County','Oglethorpe County','Levy County','Fairfield County',\r\n                           'Dauphin County','Franklin Parish','Mesa County','Richland County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = 'Unknown')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Mobile County','Oglethorpe County','Levy County','Fairfield County',\r                            'Dauphin County','Franklin Parish','Mesa County','Richland County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 353, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/353.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595584.409587
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.40969, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_354.sql", 
                    "second": 0.0990300178527832, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 9 or\r\n             household_demographics.hd_vehicle_count= 3)\r\n        and date_dim.d_year in (1999,1999+1,1999+2)\r\n        and store.s_city in ('Antioch','Franklin')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 9 or\r              household_demographics.hd_vehicle_count= 3)\r         and date_dim.d_year in (1999,1999+1,1999+2)\r         and store.s_city in ('Antioch','Franklin')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 354, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/354.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595584.50872
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:25", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.508811, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_355.sql", 
                    "second": 1.4696879386901855, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 355, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/355.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595585.978499
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:26", 
                    "startTimeFormat": "2019-12-06 09:26:25", 
                    "startTime": 1575595585.978599, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_356.sql", 
                    "second": 0.33920884132385254, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 351\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 351\r\n                                                    and ss_promo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 351\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 351\r\n                                                    and ss_promo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 351\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 351\r                                                     and ss_promo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 351\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 351\r                                                     and ss_promo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 356, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/356.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595586.317808
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:26", 
                    "startTimeFormat": "2019-12-06 09:26:26", 
                    "startTime": 1575595586.317918, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_357.sql", 
                    "second": 0.021838903427124023, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =1998\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'TN'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =1998\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'TN'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 357, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/357.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595586.339757
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:32", 
                    "startTimeFormat": "2019-12-06 09:26:26", 
                    "startTime": 1575595586.33987, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_358.sql", 
                    "second": 6.35093092918396, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1193 and 1193+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1193 and 1193+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 358, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/358.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595592.690801
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:33", 
                    "startTimeFormat": "2019-12-06 09:26:32", 
                    "startTime": 1575595592.690916, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_359.sql", 
                    "second": 0.45296788215637207, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1196 and 1196 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1196 and 1196 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 359, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/359.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595593.143884
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:26:33", 
                    "startTime": 1575595593.143961, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_360.sql", 
                    "second": 33.20937705039978, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 2001\r\n \t        and d_moy = 2 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 2001\r  \t        and d_moy = 2 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 360, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/360.sql", 
                    "secondFormat": "00:00:33", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595626.353338
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.353445, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_361.sql", 
                    "second": 0.22293496131896973, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('2002-02-11','yyyy-mm-dd'),to_date('2002-08-04','yyyy-mm-dd'),to_date('2002-11-18','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('2002-02-11','yyyy-mm-dd'),to_date('2002-08-04','yyyy-mm-dd'),to_date('2002-11-18','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('2002-02-11','yyyy-mm-dd'),to_date('2002-08-04','yyyy-mm-dd'),to_date('2002-11-18','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('2002-02-11','yyyy-mm-dd'),to_date('2002-08-04','yyyy-mm-dd'),to_date('2002-11-18','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('2002-02-11','yyyy-mm-dd'),to_date('2002-08-04','yyyy-mm-dd'),to_date('2002-11-18','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('2002-02-11','yyyy-mm-dd'),to_date('2002-08-04','yyyy-mm-dd'),to_date('2002-11-18','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 361, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/361.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595626.57638
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.576483, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_362.sql", 
                    "second": 0.01994490623474121, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_REVERSED_CHARGE) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =1998\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'FL'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_REVERSED_CHARGE) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =1998\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'FL'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 362, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/362.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595626.596428
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:07", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.596514, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_363.sql", 
                    "second": 0.5258419513702393, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Men'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Men'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Men'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Men'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Men'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Men'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 363, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/363.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595627.122356
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:07", 
                    "startTimeFormat": "2019-12-06 09:27:07", 
                    "startTime": 1575595627.12244, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_364.sql", 
                    "second": 0.4309518337249756, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 3\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 3\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 3\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 3\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 3\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 3\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 364, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/364.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595627.553392
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:08", 
                    "startTimeFormat": "2019-12-06 09:27:07", 
                    "startTime": 1575595627.553497, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_365.sql", 
                    "second": 1.3705499172210693, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_email_address\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 2000\r\n         and t_s_secyear.dyear = 2000+1\r\n         and t_w_firstyear.dyear = 2000\r\n         and t_w_secyear.dyear = 2000+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_email_address\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_email_address\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 2000\r          and t_s_secyear.dyear = 2000+1\r          and t_w_firstyear.dyear = 2000\r          and t_w_secyear.dyear = 2000+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_email_address\r  ) where rownum <= 100;\r \r ", 
                    "id": 365, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/365.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595628.924047
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:09", 
                    "startTimeFormat": "2019-12-06 09:27:08", 
                    "startTime": 1575595628.924137, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_366.sql", 
                    "second": 0.3138158321380615, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 121 and 121+10 \r\n             or ss_coupon_amt between 4980 and 4980+1000\r\n             or ss_wholesale_cost between 2 and 2+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 128 and 128+10\r\n          or ss_coupon_amt between 6661 and 6661+1000\r\n          or ss_wholesale_cost between 3 and 3+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 21 and 21+10\r\n          or ss_coupon_amt between 13339 and 13339+1000\r\n          or ss_wholesale_cost between 40 and 40+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 107 and 107+10\r\n          or ss_coupon_amt between 7515 and 7515+1000\r\n          or ss_wholesale_cost between 27 and 27+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 28 and 28+10\r\n          or ss_coupon_amt between 2587 and 2587+1000\r\n          or ss_wholesale_cost between 59 and 59+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 147 and 147+10\r\n          or ss_coupon_amt between 15260 and 15260+1000\r\n          or ss_wholesale_cost between 31 and 31+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 121 and 121+10 \r              or ss_coupon_amt between 4980 and 4980+1000\r              or ss_wholesale_cost between 2 and 2+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 128 and 128+10\r           or ss_coupon_amt between 6661 and 6661+1000\r           or ss_wholesale_cost between 3 and 3+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 21 and 21+10\r           or ss_coupon_amt between 13339 and 13339+1000\r           or ss_wholesale_cost between 40 and 40+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 107 and 107+10\r           or ss_coupon_amt between 7515 and 7515+1000\r           or ss_wholesale_cost between 27 and 27+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 28 and 28+10\r           or ss_coupon_amt between 2587 and 2587+1000\r           or ss_wholesale_cost between 59 and 59+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 147 and 147+10\r           or ss_coupon_amt between 15260 and 15260+1000\r           or ss_wholesale_cost between 31 and 31+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 366, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/366.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595629.237953
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:17", 
                    "startTimeFormat": "2019-12-06 09:27:09", 
                    "startTime": 1575595629.238044, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_367.sql", 
                    "second": 7.934169054031372, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-4-01','yyyy-mm-dd') and \r\n            to_date('2002-4-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'GA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-4-01','yyyy-mm-dd') and \r             to_date('2002-4-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'GA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 367, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/367.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595637.172213
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:17", 
                    "startTimeFormat": "2019-12-06 09:27:17", 
                    "startTime": 1575595637.172298, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_368.sql", 
                    "second": 0.15634894371032715, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Jewelry', 'Music', 'Shoes')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('2001-01-20' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('2001-01-20' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Jewelry', 'Music', 'Shoes')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('2001-01-20' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('2001-01-20' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 368, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/368.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595637.328647
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:19", 
                    "startTimeFormat": "2019-12-06 09:27:17", 
                    "startTime": 1575595637.328755, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_369.sql", 
                    "second": 2.2588510513305664, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('peach','honeydew','magenta','lawn','coral','blush') and\r\n         i_current_price between 51 and 51 + 10 and\r\n         i_current_price between 51 + 1 and 51 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2001 and\r\n     cs2.syear = 2001 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('peach','honeydew','magenta','lawn','coral','blush') and\r          i_current_price between 51 and 51 + 10 and\r          i_current_price between 51 + 1 and 51 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2001 and\r      cs2.syear = 2001 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 369, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/369.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595639.587606
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:19", 
                    "startTimeFormat": "2019-12-06 09:27:19", 
                    "startTime": 1575595639.587682, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_370.sql", 
                    "second": 0.22072196006774902, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 1998\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 1998\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 370, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/370.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595639.808404
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:20", 
                    "startTimeFormat": "2019-12-06 09:27:19", 
                    "startTime": 1575595639.808474, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_371.sql", 
                    "second": 0.30939197540283203, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,max(ss_net_profit) as store_sales_profit\r\n ,max(sr_net_loss) as store_returns_loss\r\n ,max(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 2000\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 2000\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 2000\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,max(ss_net_profit) as store_sales_profit\r  ,max(sr_net_loss) as store_returns_loss\r  ,max(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 2000\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 2000\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 2000\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 371, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/371.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595640.117866
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:20", 
                    "startTimeFormat": "2019-12-06 09:27:20", 
                    "startTime": 1575595640.117962, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_372.sql", 
                    "second": 0.6058080196380615, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 31') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 31') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 372, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/372.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595640.72377
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:22", 
                    "startTimeFormat": "2019-12-06 09:27:20", 
                    "startTime": 1575595640.72388, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_373.sql", 
                    "second": 2.1698780059814453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 32619037\r\n            then (select avg(ss_ext_list_price) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 40451236\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 4608511\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 25654942\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 46612380\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 32619037\r             then (select avg(ss_ext_list_price) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 40451236\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 4608511\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 25654942\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 46612380\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 373, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/373.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595642.893758
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:23", 
                    "startTimeFormat": "2019-12-06 09:27:22", 
                    "startTime": 1575595642.893847, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_374.sql", 
                    "second": 0.8652911186218262, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1216 and 1216+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1216 and 1216+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1216 and 1216+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1216 and 1216+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 374, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/374.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595643.759138
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:24", 
                    "startTimeFormat": "2019-12-06 09:27:23", 
                    "startTime": 1575595643.759225, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_375.sql", 
                    "second": 0.5665860176086426, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2002\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2002\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2002\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=11\r                    and d_year=2002\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=11\r                    and d_year=2002\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=11\r                    and d_year=2002\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 375, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/375.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595644.325811
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:25", 
                    "startTimeFormat": "2019-12-06 09:27:24", 
                    "startTime": 1575595644.325931, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_376.sql", 
                    "second": 1.1367638111114502, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_category, v1.i_brand\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_category, v1.i_brand\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 376, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/376.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595645.462695
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:25", 
                    "startTimeFormat": "2019-12-06 09:27:25", 
                    "startTime": 1575595645.462777, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_377.sql", 
                    "second": 0.022300004959106445, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 94\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('1999-03-01','yyyy-mm-dd') and \r\n        to_date('1999-03-01','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('1999-03-01','yyyy-mm-dd') and\r\n                             to_date('1999-03-01','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 94\r and i_item_sk = cs_item_sk \r and d_date between to_date('1999-03-01','yyyy-mm-dd') and \r         to_date('1999-03-01','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('1999-03-01','yyyy-mm-dd') and\r                              to_date('1999-03-01','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 377, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/377.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595645.485077
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:25", 
                    "startTimeFormat": "2019-12-06 09:27:25", 
                    "startTime": 1575595645.485181, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_378.sql", 
                    "second": 0.21032094955444336, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Jewelry'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 2002\r\n   and   d_moy  = 11) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Jewelry'\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 2002\r\n   and   d_moy  = 11) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -7\r    and   i_category = 'Jewelry'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -7\r    and   d_year = 2002\r    and   d_moy  = 11) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -7\r    and   i_category = 'Jewelry'\r    and   s_gmt_offset = -7\r    and   d_year = 2002\r    and   d_moy  = 11) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 378, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/378.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595645.695502
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:27", 
                    "startTimeFormat": "2019-12-06 09:27:25", 
                    "startTime": 1575595645.695598, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_379.sql", 
                    "second": 1.4018712043762207, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 1998\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'S'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '2 yr Degree'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'M'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '4 yr Degree' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'U'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'College'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('UT', 'TX', 'IL')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('WI', 'ND', 'GA')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('SC', 'FL', 'DE')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 1998\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'S'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '2 yr Degree'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'M'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '4 yr Degree' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'U'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'College'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('UT', 'TX', 'IL')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('WI', 'ND', 'GA')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('SC', 'FL', 'DE')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 379, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/379.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595647.097469
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:27", 
                    "startTimeFormat": "2019-12-06 09:27:27", 
                    "startTime": 1575595647.097574, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_380.sql", 
                    "second": 0.07122802734375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Walker County','Kittitas County','Barrow County','Maverick County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Walker County','Kittitas County','Barrow County','Maverick County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 380, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/380.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595647.168802
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:27", 
                    "startTimeFormat": "2019-12-06 09:27:27", 
                    "startTime": 1575595647.168904, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_381.sql", 
                    "second": 0.47820496559143066, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Jewelry', 'Men', 'Electronics')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2002-04-04' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2002-04-04' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Jewelry', 'Men', 'Electronics')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2002-04-04' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2002-04-04' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 381, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/381.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595647.647109
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:28", 
                    "startTimeFormat": "2019-12-06 09:27:27", 
                    "startTime": 1575595647.64719, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_382.sql", 
                    "second": 0.5888378620147705, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-10','yyyy-mm-dd') \r\n                  and to_date('2001-08-10','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-10','yyyy-mm-dd') \r\n                  and to_date('2001-08-10','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r\n                  and  to_date('2001-08-10','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r\n                  and  to_date('2001-08-10','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r\n                  and  to_date('2001-08-10','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r\n                  and  to_date('2001-08-10','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-10','yyyy-mm-dd') \r                   and to_date('2001-08-10','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('2001-08-10','yyyy-mm-dd') \r                   and to_date('2001-08-10','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r                   and  to_date('2001-08-10','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r                   and  to_date('2001-08-10','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r                   and  to_date('2001-08-10','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-10','yyyy-mm-dd') \r                   and  to_date('2001-08-10','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 382, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/382.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595648.236028
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:28", 
                    "startTimeFormat": "2019-12-06 09:27:28", 
                    "startTime": 1575595648.236125, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_383.sql", 
                    "second": 0.21271705627441406, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  ca_zip, ca_state, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2002\r\n group by ca_zip, ca_state\r\n order by ca_zip, ca_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_state, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2002\r  group by ca_zip, ca_state\r  order by ca_zip, ca_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 383, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/383.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595648.448842
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:28", 
                    "startTimeFormat": "2019-12-06 09:27:28", 
                    "startTime": 1575595648.44894, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_384.sql", 
                    "second": 0.1782519817352295, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Home', 'Jewelry', 'Electronics')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('2001-06-29' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('2001-06-29' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Home', 'Jewelry', 'Electronics')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('2001-06-29' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('2001-06-29' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 384, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/384.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595648.627192
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:29", 
                    "startTimeFormat": "2019-12-06 09:27:28", 
                    "startTime": 1575595648.627298, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_385.sql", 
                    "second": 0.3878788948059082, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 2001\r\nand d2.d_moy  = 9\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 2001\r and d2.d_moy  = 9\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 385, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/385.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595649.015177
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:30", 
                    "startTimeFormat": "2019-12-06 09:27:29", 
                    "startTime": 1575595649.015272, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_386.sql", 
                    "second": 1.084313154220581, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1196 and 1196 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1196 and 1196 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1196 and 1196 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1196 and 1196 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 386, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/386.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595650.099585
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:31", 
                    "startTimeFormat": "2019-12-06 09:27:30", 
                    "startTime": 1575595650.099669, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_387.sql", 
                    "second": 0.9373841285705566, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Electronics'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Electronics'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Electronics') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2000\r\n   AND prev_yr.d_year=2000-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Electronics'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Electronics'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Electronics') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2000\r    AND prev_yr.d_year=2000-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 387, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/387.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595651.037053
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:31", 
                    "startTimeFormat": "2019-12-06 09:27:31", 
                    "startTime": 1575595651.037155, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_388.sql", 
                    "second": 0.20591115951538086, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 1999 \r\nand     d_moy                   = 11\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like '1001-5000%'\r\nand     ca_gmt_offset           = -7\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 1999 \r and     d_moy                   = 11\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like '1001-5000%'\r and     ca_gmt_offset           = -7\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 388, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/388.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595651.243066
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:31", 
                    "startTimeFormat": "2019-12-06 09:27:31", 
                    "startTime": 1575595651.243167, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_389.sql", 
                    "second": 0.3437681198120117, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '2000Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '2000Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 389, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/389.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595651.586935
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:32", 
                    "startTimeFormat": "2019-12-06 09:27:31", 
                    "startTime": 1575595651.587026, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_390.sql", 
                    "second": 1.0959391593933105, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=10\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'chartreuse'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 10\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'chiffon'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=10\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'chartreuse'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 10\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'chiffon'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 390, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/390.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595652.682965
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:33", 
                    "startTimeFormat": "2019-12-06 09:27:32", 
                    "startTime": 1575595652.683048, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_391.sql", 
                    "second": 0.9550108909606934, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 1998\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = 'Unknown'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'W'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = 'Advanced Degree'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('LA', 'AR', 'MA')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('CA', 'ME', 'MT')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('ND', 'MN', 'OH')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 1998\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = 'Unknown'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'W'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = 'Advanced Degree'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('LA', 'AR', 'MA')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('CA', 'ME', 'MT')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('ND', 'MN', 'OH')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 391, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/391.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595653.638059
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:35", 
                    "startTimeFormat": "2019-12-06 09:27:33", 
                    "startTime": 1575595653.638171, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_392.sql", 
                    "second": 2.2358789443969727, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1218 and 1218+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1218 and 1218+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1218 and 1218+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1218 and 1218+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 392, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/392.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595655.87405
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:36", 
                    "startTimeFormat": "2019-12-06 09:27:35", 
                    "startTime": 1575595655.874136, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_393.sql", 
                    "second": 0.6447789669036865, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 2 or household_demographics.hd_vehicle_count > -1)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 2 or household_demographics.hd_vehicle_count > -1)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (1999,1999+1,1999+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 393, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/393.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595656.518915
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:37", 
                    "startTimeFormat": "2019-12-06 09:27:36", 
                    "startTime": 1575595656.519013, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_394.sql", 
                    "second": 0.7200431823730469, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  avg(cd_dep_count) s1,\r\n  min(cd_dep_count) s2,\r\n  min(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  avg(cd_dep_employed_count) s4,\r\n  min(cd_dep_employed_count) s5,\r\n  min(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  avg(cd_dep_college_count) s7,\r\n  min(cd_dep_college_count) s8,\r\n  min(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   avg(cd_dep_count) s1,\r   min(cd_dep_count) s2,\r   min(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   avg(cd_dep_employed_count) s4,\r   min(cd_dep_employed_count) s5,\r   min(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   avg(cd_dep_college_count) s7,\r   min(cd_dep_college_count) s8,\r   min(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 394, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/394.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595657.239056
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:37", 
                    "startTimeFormat": "2019-12-06 09:27:37", 
                    "startTime": 1575595657.239154, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_395.sql", 
                    "second": 0.5479018688201904, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 395, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/395.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595657.787056
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:38", 
                    "startTimeFormat": "2019-12-06 09:27:37", 
                    "startTime": 1575595657.787152, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_396.sql", 
                    "second": 0.3804600238800049, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_3.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 1999\r\n                         and d_moy = 12\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 1999\r\n                         and d_moy = 12\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 1999\r\n                         and d_moy = 12\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 1999\r                          and d_moy = 12\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 1999\r                          and d_moy = 12\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 1999\r                          and d_moy = 12\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 396, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/396.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_3.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595658.167612
                }
            ], 
            "second": 172.0742950439453, 
            "startTime": 1575595486.093399, 
            "endTime": 1575595658.167694
        }, 
        "secondFormat": "00:02:56", 
        "second": 176.28098392486572, 
        "query_4.sql": {
            "endTimeFormat": "2019-12-06 09:27:42", 
            "startTimeFormat": "2019-12-06 09:24:46", 
            "secondFormat": "00:02:56", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:24:47", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.094122, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_397.sql", 
                    "second": 1.1274299621582031, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 1)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (1998,1998+1,1998+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 1)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (1998,1998+1,1998+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 397, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/397.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595487.221552
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:51", 
                    "startTimeFormat": "2019-12-06 09:24:47", 
                    "startTime": 1575595487.221625, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_398.sql", 
                    "second": 4.619390964508057, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=4\r\n  and inv2.d_moy=4+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=4\r\n  and inv2.d_moy=4+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=4\r   and inv2.d_moy=4+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=4\r   and inv2.d_moy=4+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 398, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/398.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595491.841016
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:51", 
                    "startTimeFormat": "2019-12-06 09:24:51", 
                    "startTime": 1575595491.841082, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_399.sql", 
                    "second": 0.07001399993896484, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 56') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 56') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 399, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/399.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595491.911096
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:52", 
                    "startTimeFormat": "2019-12-06 09:24:51", 
                    "startTime": 1575595491.911195, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_400.sql", 
                    "second": 0.23237085342407227, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 862 and 862+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'dark' or i_color = 'salmon') and \r\n        (i_units = 'Pound' or i_units = 'Cup') and\r\n        (i_size = 'petite' or i_size = 'N/A')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'dim' or i_color = 'aquamarine') and\r\n        (i_units = 'Ounce' or i_units = 'Oz') and\r\n        (i_size = 'small' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'gainsboro' or i_color = 'blanched') and\r\n        (i_units = 'Unknown' or i_units = 'Carton') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'royal' or i_color = 'chartreuse') and\r\n        (i_units = 'Tbl' or i_units = 'Tsp') and\r\n        (i_size = 'petite' or i_size = 'N/A')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'thistle' or i_color = 'lemon') and \r\n        (i_units = 'Box' or i_units = 'N/A') and\r\n        (i_size = 'petite' or i_size = 'N/A')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'forest' or i_color = 'plum') and\r\n        (i_units = 'Dram' or i_units = 'Lb') and\r\n        (i_size = 'small' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'cornflower' or i_color = 'tomato') and\r\n        (i_units = 'Case' or i_units = 'Bundle') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'slate' or i_color = 'green') and\r\n        (i_units = 'Gram' or i_units = 'Gross') and\r\n        (i_size = 'petite' or i_size = 'N/A')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 862 and 862+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'dark' or i_color = 'salmon') and \r         (i_units = 'Pound' or i_units = 'Cup') and\r         (i_size = 'petite' or i_size = 'N/A')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'dim' or i_color = 'aquamarine') and\r         (i_units = 'Ounce' or i_units = 'Oz') and\r         (i_size = 'small' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'gainsboro' or i_color = 'blanched') and\r         (i_units = 'Unknown' or i_units = 'Carton') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'royal' or i_color = 'chartreuse') and\r         (i_units = 'Tbl' or i_units = 'Tsp') and\r         (i_size = 'petite' or i_size = 'N/A')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'thistle' or i_color = 'lemon') and \r         (i_units = 'Box' or i_units = 'N/A') and\r         (i_size = 'petite' or i_size = 'N/A')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'forest' or i_color = 'plum') and\r         (i_units = 'Dram' or i_units = 'Lb') and\r         (i_size = 'small' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'cornflower' or i_color = 'tomato') and\r         (i_units = 'Case' or i_units = 'Bundle') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'slate' or i_color = 'green') and\r         (i_units = 'Gram' or i_units = 'Gross') and\r         (i_size = 'petite' or i_size = 'N/A')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 400, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/400.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595492.143566
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:52", 
                    "startTimeFormat": "2019-12-06 09:24:52", 
                    "startTime": 1575595492.143649, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_401.sql", 
                    "second": 0.4960489273071289, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,stddev_samp(ss_quantity)        as store_sales_quantity\r\n    ,stddev_samp(sr_return_quantity) as store_returns_quantity\r\n    ,stddev_samp(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 2000\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 2000\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (2000,2000+1,2000+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,stddev_samp(ss_quantity)        as store_sales_quantity\r     ,stddev_samp(sr_return_quantity) as store_returns_quantity\r     ,stddev_samp(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 2000\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 2000\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (2000,2000+1,2000+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 401, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/401.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595492.639698
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:52", 
                    "startTimeFormat": "2019-12-06 09:24:52", 
                    "startTime": 1575595492.639791, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_402.sql", 
                    "second": 0.022572994232177734, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 134\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('2002-02-02','yyyy-mm-dd') and \r\n        to_date('2002-02-02','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('2002-02-02','yyyy-mm-dd') and\r\n                             to_date('2002-02-02','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 134\r and i_item_sk = cs_item_sk \r and d_date between to_date('2002-02-02','yyyy-mm-dd') and \r         to_date('2002-02-02','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('2002-02-02','yyyy-mm-dd') and\r                              to_date('2002-02-02','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 402, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/402.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595492.662364
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:52", 
                    "startTime": 1575595492.66245, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_403.sql", 
                    "second": 0.4504718780517578, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'BOXBUNDLES' || ',' || 'GERMA' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 17180 and 17180+28800 \r\n \tand sm_carrier in ('BOXBUNDLES','GERMA')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'BOXBUNDLES' || ',' || 'GERMA' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 17180 AND 17180+28800 \r\n \tand sm_carrier in ('BOXBUNDLES','GERMA')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'BOXBUNDLES' || ',' || 'GERMA' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_paid * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_paid * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_paid * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 17180 and 17180+28800 \r  \tand sm_carrier in ('BOXBUNDLES','GERMA')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'BOXBUNDLES' || ',' || 'GERMA' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 17180 AND 17180+28800 \r  \tand sm_carrier in ('BOXBUNDLES','GERMA')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 403, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/403.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595493.112922
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.113033, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_404.sql", 
                    "second": 0.22152996063232422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Union'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  41188\r\n   and ib_upper_bound   <=  41188 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Union'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  41188\r    and ib_upper_bound   <=  41188 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 404, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/404.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595493.334563
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.334635, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_405.sql", 
                    "second": 0.13042187690734863, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '26841','47872','19480','24143','41753','98522',\r\n                          '13451','39038','51837','70679','52549',\r\n                          '74980','13442','10159','11858','66313',\r\n                          '30641','54025','64981','43478','46993',\r\n                          '27484','27388','46795','70640','56043',\r\n                          '87411','32689','25701','44304','86461',\r\n                          '91080','33727','30141','41145','22925',\r\n                          '90178','49180','75390','78414','27176',\r\n                          '14047','62745','12848','38865','31743',\r\n                          '23785','92731','58431','66678','91706',\r\n                          '20893','51363','50301','66223','14501',\r\n                          '59676','33420','27582','10630','35801',\r\n                          '99619','75579','90351','52068','46229',\r\n                          '72504','85414','54204','45407','12276',\r\n                          '50423','67237','52320','32401','10326',\r\n                          '91433','10770','23227','71913','55861',\r\n                          '70810','74884','61506','62599','34777',\r\n                          '40422','41469','40535','40412','67600',\r\n                          '33175','35759','47183','89750','82872',\r\n                          '67240','16424','32871','11757','85828',\r\n                          '68624','88594','29193','94391','99651',\r\n                          '64925','48380','42574','75373','42526',\r\n                          '31727','64649','95687','51264','28579',\r\n                          '86789','71015','20303','63985','13005',\r\n                          '37985','99860','88523','87996','69145',\r\n                          '67498','77658','56162','71473','73455',\r\n                          '70045','46555','76806','39449','40479',\r\n                          '31088','32245','86744','88477','53842',\r\n                          '57992','55807','15271','19860','69079',\r\n                          '30213','88220','14426','16065','53147',\r\n                          '90436','85647','40275','78376','39763',\r\n                          '53489','56909','41934','24027','60469',\r\n                          '58186','13680','32041','93243','46002',\r\n                          '65894','85973','63910','70036','98415',\r\n                          '40497','33699','29365','47208','64648',\r\n                          '68928','80879','35721','34135','70929',\r\n                          '23818','55515','96119','16447','99753',\r\n                          '77108','18408','86007','40551','87457',\r\n                          '90287','49263','84542','53918','39271',\r\n                          '46403','87292','73068','36251','69392',\r\n                          '81092','44665','11978','79105','61817',\r\n                          '77956','35035','16196','12547','20324',\r\n                          '37753','27599','11324','80160','68529',\r\n                          '98055','21343','77764','83483','96111',\r\n                          '64568','74547','85425','41543','56237',\r\n                          '58190','18073','29489','11646','91293',\r\n                          '52258','37405','67260','61106','70392',\r\n                          '26366','50134','35730','63421','30631',\r\n                          '55974','34686','78223','69984','34106',\r\n                          '15362','16071','18342','98898','95146',\r\n                          '52480','69831','18251','92270','25161',\r\n                          '86904','55795','87567','91591','21028',\r\n                          '80048','45917','14824','36085','67535',\r\n                          '90772','52039','91524','40757','30996',\r\n                          '93978','86985','58711','83533','79702',\r\n                          '73093','42858','49416','95796','99730',\r\n                          '40528','82709','47615','91062','69233',\r\n                          '98644','57090','71254','88132','74729',\r\n                          '56592','10441','60868','64772','62896',\r\n                          '10614','63656','85271','33868','47127',\r\n                          '63103','55948','18950','16484','89232',\r\n                          '68447','99841','62605','42289','31718',\r\n                          '12799','22181','30304','93155','78354',\r\n                          '65974','79649','95909','34692','97021',\r\n                          '24994','30109','18125','28952','13280',\r\n                          '91116','53170','19869','51069','15466',\r\n                          '43582','57241','76999','84654','24230',\r\n                          '52804','75479','56136','74802','34566',\r\n                          '91362','67910','36537','72806','62234',\r\n                          '74701','16079','25667','41823','10298',\r\n                          '85626','18156','35100','44577','78988',\r\n                          '86293','99934','23372','62321','43218',\r\n                          '60801','84109','92266','89736','79798',\r\n                          '60975','52628','63467','56127','42395',\r\n                          '89820','19461','68972','12174','22287',\r\n                          '63017','71087','77342','26310','37718',\r\n                          '84430','69508','15153','38998','15487',\r\n                          '41957','32613','86972','68843','27643',\r\n                          '80595','88175','94285','85373','34924',\r\n                          '75273','62816','39174','56823')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 1 and d_year = 1998\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '26841','47872','19480','24143','41753','98522',\r                           '13451','39038','51837','70679','52549',\r                           '74980','13442','10159','11858','66313',\r                           '30641','54025','64981','43478','46993',\r                           '27484','27388','46795','70640','56043',\r                           '87411','32689','25701','44304','86461',\r                           '91080','33727','30141','41145','22925',\r                           '90178','49180','75390','78414','27176',\r                           '14047','62745','12848','38865','31743',\r                           '23785','92731','58431','66678','91706',\r                           '20893','51363','50301','66223','14501',\r                           '59676','33420','27582','10630','35801',\r                           '99619','75579','90351','52068','46229',\r                           '72504','85414','54204','45407','12276',\r                           '50423','67237','52320','32401','10326',\r                           '91433','10770','23227','71913','55861',\r                           '70810','74884','61506','62599','34777',\r                           '40422','41469','40535','40412','67600',\r                           '33175','35759','47183','89750','82872',\r                           '67240','16424','32871','11757','85828',\r                           '68624','88594','29193','94391','99651',\r                           '64925','48380','42574','75373','42526',\r                           '31727','64649','95687','51264','28579',\r                           '86789','71015','20303','63985','13005',\r                           '37985','99860','88523','87996','69145',\r                           '67498','77658','56162','71473','73455',\r                           '70045','46555','76806','39449','40479',\r                           '31088','32245','86744','88477','53842',\r                           '57992','55807','15271','19860','69079',\r                           '30213','88220','14426','16065','53147',\r                           '90436','85647','40275','78376','39763',\r                           '53489','56909','41934','24027','60469',\r                           '58186','13680','32041','93243','46002',\r                           '65894','85973','63910','70036','98415',\r                           '40497','33699','29365','47208','64648',\r                           '68928','80879','35721','34135','70929',\r                           '23818','55515','96119','16447','99753',\r                           '77108','18408','86007','40551','87457',\r                           '90287','49263','84542','53918','39271',\r                           '46403','87292','73068','36251','69392',\r                           '81092','44665','11978','79105','61817',\r                           '77956','35035','16196','12547','20324',\r                           '37753','27599','11324','80160','68529',\r                           '98055','21343','77764','83483','96111',\r                           '64568','74547','85425','41543','56237',\r                           '58190','18073','29489','11646','91293',\r                           '52258','37405','67260','61106','70392',\r                           '26366','50134','35730','63421','30631',\r                           '55974','34686','78223','69984','34106',\r                           '15362','16071','18342','98898','95146',\r                           '52480','69831','18251','92270','25161',\r                           '86904','55795','87567','91591','21028',\r                           '80048','45917','14824','36085','67535',\r                           '90772','52039','91524','40757','30996',\r                           '93978','86985','58711','83533','79702',\r                           '73093','42858','49416','95796','99730',\r                           '40528','82709','47615','91062','69233',\r                           '98644','57090','71254','88132','74729',\r                           '56592','10441','60868','64772','62896',\r                           '10614','63656','85271','33868','47127',\r                           '63103','55948','18950','16484','89232',\r                           '68447','99841','62605','42289','31718',\r                           '12799','22181','30304','93155','78354',\r                           '65974','79649','95909','34692','97021',\r                           '24994','30109','18125','28952','13280',\r                           '91116','53170','19869','51069','15466',\r                           '43582','57241','76999','84654','24230',\r                           '52804','75479','56136','74802','34566',\r                           '91362','67910','36537','72806','62234',\r                           '74701','16079','25667','41823','10298',\r                           '85626','18156','35100','44577','78988',\r                           '86293','99934','23372','62321','43218',\r                           '60801','84109','92266','89736','79798',\r                           '60975','52628','63467','56127','42395',\r                           '89820','19461','68972','12174','22287',\r                           '63017','71087','77342','26310','37718',\r                           '84430','69508','15153','38998','15487',\r                           '41957','32613','86972','68843','27643',\r                           '80595','88175','94285','85373','34924',\r                           '75273','62816','39174','56823')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 1 and d_year = 1998\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 405, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/405.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595493.465057
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:54", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.465157, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_406.sql", 
                    "second": 0.5823979377746582, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 406, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/406.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595494.047555
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:54", 
                    "startTimeFormat": "2019-12-06 09:24:54", 
                    "startTime": 1575595494.047636, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_407.sql", 
                    "second": 0.17117595672607422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2001\r\n group by ca_zip, ca_county\r\n order by ca_zip, ca_county\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2001\r  group by ca_zip, ca_county\r  order by ca_zip, ca_county\r   ) where rownum <= 100;\r \r ", 
                    "id": 407, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/407.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595494.218812
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:54", 
                    "startTimeFormat": "2019-12-06 09:24:54", 
                    "startTime": 1575595494.218912, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_408.sql", 
                    "second": 0.30941200256347656, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (2001) and\r\n        ((i_category in ('Men','Music','Home') and\r\n          i_class in ('accessories','country','flatware')\r\n         )\r\n      or (i_category in ('Books','Electronics','Sports') and\r\n          i_class in ('business','cameras','optics') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (2001) and\r         ((i_category in ('Men','Music','Home') and\r           i_class in ('accessories','country','flatware')\r          )\r       or (i_category in ('Books','Electronics','Sports') and\r           i_class in ('business','cameras','optics') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 408, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/408.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595494.528324
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:55", 
                    "startTimeFormat": "2019-12-06 09:24:54", 
                    "startTime": 1575595494.528417, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_409.sql", 
                    "second": 0.6223528385162354, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 1999 \r\nand     d_moy                   = 12\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like '1001-5000%'\r\nand     ca_gmt_offset           = -7\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 1999 \r and     d_moy                   = 12\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like '1001-5000%'\r and     ca_gmt_offset           = -7\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 409, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/409.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595495.15077
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:08", 
                    "startTimeFormat": "2019-12-06 09:24:55", 
                    "startTime": 1575595495.150872, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_410.sql", 
                    "second": 12.925364017486572, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 7)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999\r\n                       and d_moy = 12\r\n                       and d_dom = 7)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 1999+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999 + 1\r                        and d_moy = 12\r                        and d_dom = 7)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999\r                        and d_moy = 12\r                        and d_dom = 7)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 410, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/410.sql", 
                    "secondFormat": "00:00:12", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595508.076236
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:08", 
                    "startTimeFormat": "2019-12-06 09:25:08", 
                    "startTime": 1575595508.076321, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_411.sql", 
                    "second": 0.7873940467834473, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 4 or\r\n         household_demographics.hd_vehicle_count= 1)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_city in ('Mount Vernon','Midway','Riverside','Union','Highland Park') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 4 or\r          household_demographics.hd_vehicle_count= 1)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_city in ('Mount Vernon','Midway','Riverside','Union','Highland Park') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 411, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/411.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595508.863715
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:09", 
                    "startTimeFormat": "2019-12-06 09:25:08", 
                    "startTime": 1575595508.8638, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_412.sql", 
                    "second": 0.4478340148925781, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('2001-01-16','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('2001-01-16','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('2001-01-16','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('2001-01-16','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('2001-01-16','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('2001-01-16','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 412, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/412.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595509.311634
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:10", 
                    "startTimeFormat": "2019-12-06 09:25:09", 
                    "startTime": 1575595509.311736, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_413.sql", 
                    "second": 1.1006088256835938, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2002\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = '4 yr Degree'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'U'\r\n   and \r\n   cd_education_status = 'Secondary'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('TX', 'SD', 'FL')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('NY', 'MO', 'KS')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('OK', 'WA', 'IL')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2002\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = '4 yr Degree'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'U'\r    and \r    cd_education_status = 'Secondary'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('TX', 'SD', 'FL')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('NY', 'MO', 'KS')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('OK', 'WA', 'IL')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 413, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/413.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595510.412345
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:12", 
                    "startTimeFormat": "2019-12-06 09:25:10", 
                    "startTime": 1575595510.41244, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_414.sql", 
                    "second": 1.7722208499908447, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1200 and 1200 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1200+ 12 and 1200 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1200 and 1200 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1200+ 12 and 1200 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 414, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/414.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595512.184661
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:13", 
                    "startTimeFormat": "2019-12-06 09:25:12", 
                    "startTime": 1575595512.184737, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_415.sql", 
                    "second": 1.3814780712127686, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2001) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2001+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2001) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2001+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 415, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/415.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595513.566215
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:13", 
                    "startTimeFormat": "2019-12-06 09:25:13", 
                    "startTime": 1575595513.566302, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_416.sql", 
                    "second": 0.21695399284362793, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('2002-07-13','yyyy-mm-dd'),to_date('2002-10-10','yyyy-mm-dd'),to_date('2002-11-19','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('2002-07-13','yyyy-mm-dd'),to_date('2002-10-10','yyyy-mm-dd'),to_date('2002-11-19','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('2002-07-13','yyyy-mm-dd'),to_date('2002-10-10','yyyy-mm-dd'),to_date('2002-11-19','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('2002-07-13','yyyy-mm-dd'),to_date('2002-10-10','yyyy-mm-dd'),to_date('2002-11-19','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('2002-07-13','yyyy-mm-dd'),to_date('2002-10-10','yyyy-mm-dd'),to_date('2002-11-19','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('2002-07-13','yyyy-mm-dd'),to_date('2002-10-10','yyyy-mm-dd'),to_date('2002-11-19','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 416, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/416.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595513.783256
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:13", 
                    "startTimeFormat": "2019-12-06 09:25:13", 
                    "startTime": 1575595513.783417, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_417.sql", 
                    "second": 0.19775009155273438, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('2000-06-29' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('2000-06-29' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('2000-06-29' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('2000-06-29' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('2000-06-29' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('2000-06-29' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('2000-06-29' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('2000-06-29' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 417, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/417.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595513.981167
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:17", 
                    "startTimeFormat": "2019-12-06 09:25:13", 
                    "startTime": 1575595513.981262, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_418.sql", 
                    "second": 3.396059036254883, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_sold_year, ss_item_sk, ss_customer_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001\r\norder by \r\n  ss_sold_year, ss_item_sk, ss_customer_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_sold_year, ss_item_sk, ss_customer_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001\r order by \r   ss_sold_year, ss_item_sk, ss_customer_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 418, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/418.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595517.377321
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:17", 
                    "startTimeFormat": "2019-12-06 09:25:17", 
                    "startTime": 1575595517.377401, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_419.sql", 
                    "second": 0.2002718448638916, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('1998-06-14','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('1998-06-14','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('1998-06-14','yyyy-mm-dd') - 30 )\r\n                and (to_date ('1998-06-14','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('1998-06-14','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('1998-06-14','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('1998-06-14','yyyy-mm-dd') - 30 )\r                 and (to_date ('1998-06-14','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 419, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/419.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595517.577673
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:18", 
                    "startTimeFormat": "2019-12-06 09:25:17", 
                    "startTime": 1575595517.577775, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_420.sql", 
                    "second": 0.481579065322876, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1213 and 1213 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1213 and 1213 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 420, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/420.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595518.059354
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:18", 
                    "startTimeFormat": "2019-12-06 09:25:18", 
                    "startTime": 1575595518.059447, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_421.sql", 
                    "second": 0.3308570384979248, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=2\r\n   and d_moy=12\r\n   and d_year=2000\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=2\r    and d_moy=12\r    and d_year=2000\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 421, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/421.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595518.390304
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:20", 
                    "startTimeFormat": "2019-12-06 09:25:18", 
                    "startTime": 1575595518.390398, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_422.sql", 
                    "second": 2.2941598892211914, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '>10000'\r\n  and d1.d_year = 1998\r\n  and cd_marital_status = 'M'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '>10000'\r   and d1.d_year = 1998\r   and cd_marital_status = 'M'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 422, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/422.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595520.684558
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:53", 
                    "startTimeFormat": "2019-12-06 09:25:20", 
                    "startTime": 1575595520.684636, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_423.sql", 
                    "second": 33.22317290306091, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 1998\r\n \t        and d_moy = 4 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 1998\r  \t        and d_moy = 4 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 423, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/423.sql", 
                    "secondFormat": "00:00:33", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595553.907809
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:54", 
                    "startTimeFormat": "2019-12-06 09:25:53", 
                    "startTime": 1575595553.90791, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_424.sql", 
                    "second": 0.3384969234466553, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 21 and 21+10 \r\n             or ss_coupon_amt between 14961 and 14961+1000\r\n             or ss_wholesale_cost between 67 and 67+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 83 and 83+10\r\n          or ss_coupon_amt between 16110 and 16110+1000\r\n          or ss_wholesale_cost between 11 and 11+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 7 and 7+10\r\n          or ss_coupon_amt between 16324 and 16324+1000\r\n          or ss_wholesale_cost between 79 and 79+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 95 and 95+10\r\n          or ss_coupon_amt between 5470 and 5470+1000\r\n          or ss_wholesale_cost between 51 and 51+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 143 and 143+10\r\n          or ss_coupon_amt between 6521 and 6521+1000\r\n          or ss_wholesale_cost between 36 and 36+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 140 and 140+10\r\n          or ss_coupon_amt between 504 and 504+1000\r\n          or ss_wholesale_cost between 39 and 39+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 21 and 21+10 \r              or ss_coupon_amt between 14961 and 14961+1000\r              or ss_wholesale_cost between 67 and 67+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 83 and 83+10\r           or ss_coupon_amt between 16110 and 16110+1000\r           or ss_wholesale_cost between 11 and 11+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 7 and 7+10\r           or ss_coupon_amt between 16324 and 16324+1000\r           or ss_wholesale_cost between 79 and 79+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 95 and 95+10\r           or ss_coupon_amt between 5470 and 5470+1000\r           or ss_wholesale_cost between 51 and 51+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 143 and 143+10\r           or ss_coupon_amt between 6521 and 6521+1000\r           or ss_wholesale_cost between 36 and 36+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 140 and 140+10\r           or ss_coupon_amt between 504 and 504+1000\r           or ss_wholesale_cost between 39 and 39+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 424, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/424.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595554.246407
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:54", 
                    "startTimeFormat": "2019-12-06 09:25:54", 
                    "startTime": 1575595554.246515, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_425.sql", 
                    "second": 0.030930042266845703, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =2000\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MI'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =2000\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MI'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 425, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/425.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595554.277445
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:54", 
                    "startTimeFormat": "2019-12-06 09:25:54", 
                    "startTime": 1575595554.277523, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_426.sql", 
                    "second": 0.20522499084472656, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 491\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 491\r\n                                                    and ss_promo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 491\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 491\r\n                                                    and ss_promo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 491\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 491\r                                                     and ss_promo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 491\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 491\r                                                     and ss_promo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 426, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/426.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595554.482748
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:56", 
                    "startTimeFormat": "2019-12-06 09:25:54", 
                    "startTime": 1575595554.482855, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_427.sql", 
                    "second": 1.7476320266723633, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1222 and 1222 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1222 and 1222 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1222 and 1222 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1222 and 1222 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 427, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/427.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595556.230487
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:56", 
                    "startTimeFormat": "2019-12-06 09:25:56", 
                    "startTime": 1575595556.230584, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_428.sql", 
                    "second": 0.7020490169525146, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 428, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/428.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595556.932633
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:57", 
                    "startTimeFormat": "2019-12-06 09:25:56", 
                    "startTime": 1575595556.932736, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_429.sql", 
                    "second": 0.5841341018676758, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-11','yyyy-mm-dd') \r\n                  and to_date('2001-08-11','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-11','yyyy-mm-dd') \r\n                  and to_date('2001-08-11','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r\n                  and  to_date('2001-08-11','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r\n                  and  to_date('2001-08-11','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r\n                  and  to_date('2001-08-11','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r\n                  and  to_date('2001-08-11','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-11','yyyy-mm-dd') \r                   and to_date('2001-08-11','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('2001-08-11','yyyy-mm-dd') \r                   and to_date('2001-08-11','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r                   and  to_date('2001-08-11','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r                   and  to_date('2001-08-11','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r                   and  to_date('2001-08-11','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-11','yyyy-mm-dd') \r                   and  to_date('2001-08-11','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 429, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/429.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595557.51687
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:05", 
                    "startTimeFormat": "2019-12-06 09:25:57", 
                    "startTime": 1575595557.51695, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_430.sql", 
                    "second": 7.9083850383758545, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2001-3-01','yyyy-mm-dd') and \r\n            to_date('2001-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'MO'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2001-3-01','yyyy-mm-dd') and \r             to_date('2001-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'MO'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 430, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/430.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595565.425335
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:05", 
                    "startTimeFormat": "2019-12-06 09:26:05", 
                    "startTime": 1575595565.425426, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_431.sql", 
                    "second": 0.5060238838195801, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 1\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 1\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 1\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 1\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 1\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 1\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 431, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/431.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595565.93145
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:06", 
                    "startTimeFormat": "2019-12-06 09:26:05", 
                    "startTime": 1575595565.931541, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_432.sql", 
                    "second": 0.8852651119232178, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 1999 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('WA','AL','SC','TN',\r\n                 'MO','WA','MI','MN')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 1999 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('WA','AL','SC','TN',\r                  'MO','WA','MI','MN')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 432, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/432.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595566.816806
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:06", 
                    "startTimeFormat": "2019-12-06 09:26:06", 
                    "startTime": 1575595566.816893, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_433.sql", 
                    "second": 0.09258079528808594, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -6\r\n   and   i_category = 'Jewelry'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -6\r\n   and   d_year = 2000\r\n   and   d_moy  = 11) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -6\r\n   and   i_category = 'Jewelry'\r\n   and   s_gmt_offset = -6\r\n   and   d_year = 2000\r\n   and   d_moy  = 11) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -6\r    and   i_category = 'Jewelry'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -6\r    and   d_year = 2000\r    and   d_moy  = 11) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -6\r    and   i_category = 'Jewelry'\r    and   s_gmt_offset = -6\r    and   d_year = 2000\r    and   d_moy  = 11) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 433, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/433.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595566.909474
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:07", 
                    "startTimeFormat": "2019-12-06 09:26:06", 
                    "startTime": 1575595566.909571, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_434.sql", 
                    "second": 0.759113073348999, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  stddev_samp(cd_dep_count) s1,\r\n  avg(cd_dep_count) s2,\r\n  min(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  stddev_samp(cd_dep_employed_count) s4,\r\n  avg(cd_dep_employed_count) s5,\r\n  min(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  stddev_samp(cd_dep_college_count) s7,\r\n  avg(cd_dep_college_count) s8,\r\n  min(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   stddev_samp(cd_dep_count) s1,\r   avg(cd_dep_count) s2,\r   min(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   stddev_samp(cd_dep_employed_count) s4,\r   avg(cd_dep_employed_count) s5,\r   min(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   stddev_samp(cd_dep_college_count) s7,\r   avg(cd_dep_college_count) s8,\r   min(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 434, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/434.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595567.668684
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:08", 
                    "startTimeFormat": "2019-12-06 09:26:07", 
                    "startTime": 1575595567.668763, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_435.sql", 
                    "second": 0.4928121566772461, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Shoes'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Shoes'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Shoes'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Shoes'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Shoes'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Shoes'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 435, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/435.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595568.161575
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:09", 
                    "startTimeFormat": "2019-12-06 09:26:08", 
                    "startTime": 1575595568.161674, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_436.sql", 
                    "second": 0.9819309711456299, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Music'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Music'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Music') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=1999\r\n   AND prev_yr.d_year=1999-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Music'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Music'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Music') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=1999\r    AND prev_yr.d_year=1999-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 436, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/436.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595569.143605
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:10", 
                    "startTimeFormat": "2019-12-06 09:26:09", 
                    "startTime": 1575595569.143691, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_437.sql", 
                    "second": 1.1434719562530518, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,max(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (2001,2001+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,max(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (2001,2001+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 2001\r\n         and t_s_secyear.year = 2001+1\r\n         and t_w_firstyear.year = 2001\r\n         and t_w_secyear.year = 2001+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 1,3,2\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,max(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (2001,2001+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,max(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (2001,2001+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 2001\r          and t_s_secyear.year = 2001+1\r          and t_w_firstyear.year = 2001\r          and t_w_secyear.year = 2001+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 1,3,2\r  ) where rownum <= 100;\r \r ", 
                    "id": 437, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/437.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595570.287163
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:10", 
                    "startTimeFormat": "2019-12-06 09:26:10", 
                    "startTime": 1575595570.287248, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_438.sql", 
                    "second": 0.236983060836792, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=56\r\n \tand d_moy=11\r\n \tand d_year=2002\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=56\r  \tand d_moy=11\r  \tand d_year=2002\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 438, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/438.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595570.524231
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:13", 
                    "startTimeFormat": "2019-12-06 09:26:10", 
                    "startTime": 1575595570.524329, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_439.sql", 
                    "second": 2.6313371658325195, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1190 and 1190+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1190 and 1190+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1190 and 1190+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1190 and 1190+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 439, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/439.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595573.155666
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:13", 
                    "startTimeFormat": "2019-12-06 09:26:13", 
                    "startTime": 1575595573.155757, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_440.sql", 
                    "second": 0.3662290573120117, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '2001Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '2001Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 440, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/440.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595573.521986
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:13", 
                    "startTimeFormat": "2019-12-06 09:26:13", 
                    "startTime": 1575595573.522088, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_441.sql", 
                    "second": 0.25320887565612793, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=12\r\n    and dt.d_year=1998\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=12\r     and dt.d_year=1998\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 441, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/441.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595573.775297
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:13", 
                    "startTimeFormat": "2019-12-06 09:26:13", 
                    "startTime": 1575595573.775387, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_442.sql", 
                    "second": 0.1665818691253662, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 10 and 10+1\r\n         and household_demographics.hd_dep_count = 3\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 17 and 17+1\r\n         and household_demographics.hd_dep_count = 3\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 10 and 10+1\r          and household_demographics.hd_dep_count = 3\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 17 and 17+1\r          and household_demographics.hd_dep_count = 3\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 442, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/442.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595573.941969
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:13", 
                    "startTime": 1575595573.942054, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_443.sql", 
                    "second": 10.271118879318237, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1187 and 1187 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1187 and 1187 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 443, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/443.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595584.213173
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.213261, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_444.sql", 
                    "second": 0.09725522994995117, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'M' and\r\n       cd_marital_status = 'W' and\r\n       cd_education_status = '2 yr Degree' and\r\n       d_year = 1998 and\r\n       s_state in ('FL','MI', 'IN', 'LA', 'MN', 'SC')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'M' and\r        cd_marital_status = 'W' and\r        cd_education_status = '2 yr Degree' and\r        d_year = 1998 and\r        s_state in ('FL','MI', 'IN', 'LA', 'MN', 'SC')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 444, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/444.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595584.310516
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.3106, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_445.sql", 
                    "second": 0.3163020610809326, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1183,1183+1,1183+2,1183+3,1183+4,1183+5,1183+6,1183+7,1183+8,1183+9,1183+10,1183+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1183,1183+1,1183+2,1183+3,1183+4,1183+5,1183+6,1183+7,1183+8,1183+9,1183+10,1183+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 445, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/445.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595584.626902
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:25", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.626992, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_446.sql", 
                    "second": 1.1469390392303467, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1209 and 1209 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1209 and 1209 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1209 and 1209 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1209 and 1209 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1209 and 1209 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1209 and 1209 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 446, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/446.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595585.773931
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:27", 
                    "startTimeFormat": "2019-12-06 09:26:25", 
                    "startTime": 1575595585.774027, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_447.sql", 
                    "second": 1.270448923110962, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'F' and \r\n       cd1.cd_education_status = '2 yr Degree' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (7,2,3,9,1,8) and\r\n       d_year = 2000 and\r\n       ca_state in ('WA','MO','AL'\r\n                   ,'CA','KY','OH','ND')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'F' and \r        cd1.cd_education_status = '2 yr Degree' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (7,2,3,9,1,8) and\r        d_year = 2000 and\r        ca_state in ('WA','MO','AL'\r                    ,'CA','KY','OH','ND')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 447, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/447.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595587.044476
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:40", 
                    "startTimeFormat": "2019-12-06 09:26:27", 
                    "startTime": 1575595587.044566, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_448.sql", 
                    "second": 13.149433135986328, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_ext_sales_price) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=8\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'green'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_ext_sales_price) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 8\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'navy'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_ext_sales_price) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=8\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'green'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_ext_sales_price) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 8\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'navy'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 448, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/448.sql", 
                    "secondFormat": "00:00:13", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595600.193999
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:40", 
                    "startTimeFormat": "2019-12-06 09:26:40", 
                    "startTime": 1575595600.194098, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_449.sql", 
                    "second": 0.0616910457611084, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 40 and 40 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2002-01-27' ,'yyyy-mm-dd') and to_date('2002-01-27' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (979,672,679,730)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 40 and 40 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2002-01-27' ,'yyyy-mm-dd') and to_date('2002-01-27' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (979,672,679,730)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 449, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/449.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595600.255789
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:42", 
                    "startTimeFormat": "2019-12-06 09:26:40", 
                    "startTime": 1575595600.255895, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_450.sql", 
                    "second": 2.129603147506714, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.i_category\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.i_category\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 450, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/450.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595602.385498
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:42", 
                    "startTimeFormat": "2019-12-06 09:26:42", 
                    "startTime": 1575595602.385591, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_451.sql", 
                    "second": 0.4200899600982666, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Crawford County','Stark County','Bradford County','Anchorage Borough','Casey County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_moy between 4 and 4+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2000 and\r\n                  d_moy between 4 and 4+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2000 and\r\n                  d_moy between 4 and 4+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Crawford County','Stark County','Bradford County','Anchorage Borough','Casey County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_moy between 4 and 4+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2000 and\r                   d_moy between 4 and 4+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2000 and\r                   d_moy between 4 and 4+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 451, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/451.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595602.805681
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:43", 
                    "startTimeFormat": "2019-12-06 09:26:42", 
                    "startTime": 1575595602.805781, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_452.sql", 
                    "second": 1.1190450191497803, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1176 and 1176 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1176 and 1176 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1176 and 1176 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1176 and 1176 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 452, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/452.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595603.924826
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:54", 
                    "startTimeFormat": "2019-12-06 09:26:43", 
                    "startTime": 1575595603.924925, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_453.sql", 
                    "second": 10.64518690109253, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1998,1998+1,1998+2,1998+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1998,1998+1,1998+2,1998+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 5 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 5 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1998,1998 + 1,1998 + 2,1998 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1998,1998+1,1998+2,1998+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1998 \r\n         and d_moy = 5 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 5 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1998,1998+1,1998+2,1998+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1998,1998+1,1998+2,1998+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 5 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 5 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1998,1998 + 1,1998 + 2,1998 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1998,1998+1,1998+2,1998+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1998 \r          and d_moy = 5 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 5 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 453, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/453.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595614.570112
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:55", 
                    "startTimeFormat": "2019-12-06 09:26:54", 
                    "startTime": 1575595614.570199, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_454.sql", 
                    "second": 0.5968930721282959, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'M' and\r\n       cd_education_status = 'Primary' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2000 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'M' and\r        cd_education_status = 'Primary' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2000 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 454, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/454.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595615.167092
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:55", 
                    "startTimeFormat": "2019-12-06 09:26:55", 
                    "startTime": 1575595615.167193, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_455.sql", 
                    "second": 0.021818161010742188, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 937\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('1998-02-04','yyyy-mm-dd') and \r\n        to_date('1998-02-04','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('1998-02-04','yyyy-mm-dd') and\r\n                             to_date('1998-02-04','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 937\r and i_item_sk = ws_item_sk \r and d_date between  to_date('1998-02-04','yyyy-mm-dd') and \r         to_date('1998-02-04','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('1998-02-04','yyyy-mm-dd') and\r                              to_date('1998-02-04','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 455, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/455.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595615.189011
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:55", 
                    "startTimeFormat": "2019-12-06 09:26:55", 
                    "startTime": 1575595615.189115, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_456.sql", 
                    "second": 0.6235780715942383, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Sports'\r\n         and i_class = 'golf'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 1\r\n         and d_year = 2001\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2001 and d_moy = 1)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2001 and d_moy = 1)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Sports'\r          and i_class = 'golf'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 1\r          and d_year = 2001\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2001 and d_moy = 1)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2001 and d_moy = 1)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 456, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/456.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595615.812693
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:55", 
                    "startTimeFormat": "2019-12-06 09:26:55", 
                    "startTime": 1575595615.812784, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_457.sql", 
                    "second": 0.06851601600646973, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 18 and 18+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2002-04-24' ,'yyyy-mm-dd') and to_date('2002-04-24' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (413,652,545,590)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 18 and 18+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2002-04-24' ,'yyyy-mm-dd') and to_date('2002-04-24' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (413,652,545,590)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 457, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/457.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595615.8813
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:56", 
                    "startTimeFormat": "2019-12-06 09:26:55", 
                    "startTime": 1575595615.881394, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_458.sql", 
                    "second": 0.521604061126709, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_store_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_store_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_web_site_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_web_site_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_ship_hdemo_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_store_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_store_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_web_site_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_web_site_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_ship_hdemo_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 458, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/458.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595616.402998
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:26:56", 
                    "startTime": 1575595616.40309, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_459.sql", 
                    "second": 9.699476957321167, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-21','yyyy-mm-dd') \r\n                  and to_date('1998-08-21','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-21','yyyy-mm-dd') \r\n                  and to_date('1998-08-21','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-21','yyyy-mm-dd') \r\n                  and to_date('1998-08-21','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-21','yyyy-mm-dd') \r                   and to_date('1998-08-21','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-21','yyyy-mm-dd') \r                   and to_date('1998-08-21','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-21','yyyy-mm-dd') \r                   and to_date('1998-08-21','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 459, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/459.sql", 
                    "secondFormat": "00:00:09", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595626.102567
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.102652, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_460.sql", 
                    "second": 0.4469490051269531, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('thistle','dim','papaya'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('thistle','dim','papaya'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('thistle','dim','papaya'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('thistle','dim','papaya'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('thistle','dim','papaya'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('thistle','dim','papaya'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 460, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/460.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595626.549601
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.549675, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_461.sql", 
                    "second": 0.27346110343933105, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 8\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 4\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 8\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 4\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 461, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/461.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595626.823136
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:07", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.823237, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_462.sql", 
                    "second": 0.3970820903778076, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 2000\r\nand d2.d_moy  = 9\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 2000\r and d2.d_moy  = 9\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 462, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/462.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595627.220319
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:07", 
                    "startTimeFormat": "2019-12-06 09:27:07", 
                    "startTime": 1575595627.220402, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_463.sql", 
                    "second": 0.4625680446624756, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'U'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Advanced Degree'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'S'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Primary' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'D'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '4 yr Degree'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('NY', 'KY', 'GA')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('VA', 'TN', 'CO')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('TX', 'WV', 'FL')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 2000\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'U'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Advanced Degree'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'S'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Primary' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'D'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '4 yr Degree'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('NY', 'KY', 'GA')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('VA', 'TN', 'CO')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('TX', 'WV', 'FL')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 463, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/463.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595627.68297
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:08", 
                    "startTimeFormat": "2019-12-06 09:27:07", 
                    "startTime": 1575595627.683069, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_464.sql", 
                    "second": 0.38835597038269043, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1181 and 1181+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1181 and 1181+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 464, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/464.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595628.071425
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:08", 
                    "startTimeFormat": "2019-12-06 09:27:08", 
                    "startTime": 1575595628.071518, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_465.sql", 
                    "second": 0.33854198455810547, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('VA','IL','NE') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2003 and\r\n                d_moy between 4 and 4+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2003 and\r\n                  d_moy between 4 and 4+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2003 and\r\n                  d_moy between 4 and 4+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('VA','IL','NE') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2003 and\r                 d_moy between 4 and 4+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2003 and\r                   d_moy between 4 and 4+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2003 and\r                   d_moy between 4 and 4+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 465, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/465.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595628.41006
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:08", 
                    "startTimeFormat": "2019-12-06 09:27:08", 
                    "startTime": 1575595628.410153, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_466.sql", 
                    "second": 0.11152815818786621, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 3 or\r\n             household_demographics.hd_vehicle_count= 4)\r\n        and date_dim.d_year in (1999,1999+1,1999+2)\r\n        and store.s_city in ('Greenville','Liberty')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 3 or\r              household_demographics.hd_vehicle_count= 4)\r         and date_dim.d_year in (1999,1999+1,1999+2)\r         and store.s_city in ('Greenville','Liberty')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 466, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/466.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595628.521681
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:08", 
                    "startTimeFormat": "2019-12-06 09:27:08", 
                    "startTime": 1575595628.52176, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_467.sql", 
                    "second": 0.021930932998657227, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_REVERSED_CHARGE) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =1998\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'MN'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_REVERSED_CHARGE) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =1998\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'MN'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 467, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/467.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595628.543691
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:08", 
                    "startTimeFormat": "2019-12-06 09:27:08", 
                    "startTime": 1575595628.543794, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_468.sql", 
                    "second": 0.1426069736480713, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Home', 'Music', 'Women')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('2000-04-02' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('2000-04-02' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Home', 'Music', 'Women')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('2000-04-02' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('2000-04-02' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 468, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/468.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595628.686401
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:09", 
                    "startTimeFormat": "2019-12-06 09:27:08", 
                    "startTime": 1575595628.686486, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_469.sql", 
                    "second": 0.5936529636383057, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 2001 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 2001 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 469, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/469.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595629.280139
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:09", 
                    "startTimeFormat": "2019-12-06 09:27:09", 
                    "startTime": 1575595629.280213, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_470.sql", 
                    "second": 0.08453083038330078, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2001-3-01','yyyy-mm-dd') and \r\n           (to_date('2001-3-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'MO'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Bronx County','Ziebach County','Fairfield County','Mobile County',\r\n                  'Pennington County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2001-3-01','yyyy-mm-dd') and \r            (to_date('2001-3-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'MO'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Bronx County','Ziebach County','Fairfield County','Mobile County',\r                   'Pennington County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 470, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/470.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595629.364744
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:12", 
                    "startTimeFormat": "2019-12-06 09:27:09", 
                    "startTime": 1575595629.364842, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_471.sql", 
                    "second": 2.7481980323791504, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_birth_country\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  1999\r\n   and t_s_secyear.dyear = 1999+1\r\n   and t_c_firstyear.dyear =  1999\r\n   and t_c_secyear.dyear =  1999+1\r\n   and t_w_firstyear.dyear = 1999\r\n   and t_w_secyear.dyear = 1999+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_birth_country\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_birth_country\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  1999\r    and t_s_secyear.dyear = 1999+1\r    and t_c_firstyear.dyear =  1999\r    and t_c_secyear.dyear =  1999+1\r    and t_w_firstyear.dyear = 1999\r    and t_w_secyear.dyear = 1999+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_birth_country\r  ) where rownum <= 100;\r \r ", 
                    "id": 471, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/471.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595632.11304
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:12", 
                    "startTimeFormat": "2019-12-06 09:27:12", 
                    "startTime": 1575595632.113136, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_472.sql", 
                    "second": 0.3256349563598633, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,sum(ss_net_profit) as store_sales_profit\r\n ,sum(sr_net_loss) as store_returns_loss\r\n ,sum(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 1999\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 1999\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 1999\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,sum(ss_net_profit) as store_sales_profit\r  ,sum(sr_net_loss) as store_returns_loss\r  ,sum(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 1999\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 1999\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 1999\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 472, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/472.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595632.438771
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:12", 
                    "startTimeFormat": "2019-12-06 09:27:12", 
                    "startTime": 1575595632.438868, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_473.sql", 
                    "second": 0.16332507133483887, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Music', 'Men', 'Jewelry')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('1999-01-28' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('1999-01-28' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Music', 'Men', 'Jewelry')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('1999-01-28' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('1999-01-28' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 473, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/473.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595632.602193
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:13", 
                    "startTimeFormat": "2019-12-06 09:27:12", 
                    "startTime": 1575595632.602297, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_474.sql", 
                    "second": 0.8931009769439697, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1210 and 1210+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1210 and 1210+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1210 and 1210+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1210 and 1210+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 474, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/474.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595633.495398
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:13", 
                    "startTimeFormat": "2019-12-06 09:27:13", 
                    "startTime": 1575595633.495497, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_475.sql", 
                    "second": 0.24315309524536133, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2002\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2002\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 475, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/475.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595633.73865
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:13", 
                    "startTime": 1575595633.73875, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_476.sql", 
                    "second": 0.3918459415435791, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Music', 'Children', 'Books')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('1999-05-17' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('1999-05-17' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Music', 'Children', 'Books')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('1999-05-17' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('1999-05-17' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 476, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/476.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595634.130596
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:14", 
                    "startTime": 1575595634.130703, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_477.sql", 
                    "second": 0.28462696075439453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=12\r\n \tand dt.d_year=2002\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=12\r  \tand dt.d_year=2002\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 477, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/477.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595634.41533
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:14", 
                    "startTime": 1575595634.415401, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_478.sql", 
                    "second": 0.31702399253845215, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'U' and\r\n       cd_education_status = 'Secondary' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1998 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'U' and\r        cd_education_status = 'Secondary' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1998 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 478, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/478.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595634.732425
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:14", 
                    "startTime": 1575595634.732521, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_479.sql", 
                    "second": 0.06529498100280762, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '501-1000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (2000,2000+1,2000+2)\r\n    and store.s_county in ('Levy County','Daviess County','Ziebach County','Marshall County',\r\n                           'Mesa County','Huron County','Wadena County','Gage County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '501-1000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (2000,2000+1,2000+2)\r     and store.s_county in ('Levy County','Daviess County','Ziebach County','Marshall County',\r                            'Mesa County','Huron County','Wadena County','Gage County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 479, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/479.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595634.797816
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:16", 
                    "startTimeFormat": "2019-12-06 09:27:14", 
                    "startTime": 1575595634.797909, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_480.sql", 
                    "second": 1.4065029621124268, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-29','yyyy-mm-dd') \r\n                  and to_date('1999-08-29','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-29','yyyy-mm-dd') \r\n                  and to_date('1999-08-29','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-29','yyyy-mm-dd') \r\n                  and to_date('1999-08-29','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('1999-08-29','yyyy-mm-dd') \r                   and to_date('1999-08-29','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('1999-08-29','yyyy-mm-dd') \r                   and to_date('1999-08-29','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('1999-08-29','yyyy-mm-dd') \r                   and to_date('1999-08-29','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 480, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/480.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595636.204412
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:17", 
                    "startTimeFormat": "2019-12-06 09:27:16", 
                    "startTime": 1575595636.204514, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_481.sql", 
                    "second": 1.2585148811340332, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1190 and 1190+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1190 and 1190+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1190 and 1190+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1190 and 1190+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1190 and 1190+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1190 and 1190+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 481, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/481.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595637.463029
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:17", 
                    "startTimeFormat": "2019-12-06 09:27:17", 
                    "startTime": 1575595637.463128, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_482.sql", 
                    "second": 0.2442610263824463, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_ext_sales_price) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 376\r\n   and dt.d_moy=11\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_ext_sales_price) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 376\r    and dt.d_moy=11\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 482, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/482.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595637.707389
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:27", 
                    "startTimeFormat": "2019-12-06 09:27:17", 
                    "startTime": 1575595637.707489, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_483.sql", 
                    "second": 10.278750896453857, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('tan','blue','lime','thistle','brown','aquamarine') and\r\n         i_current_price between 31 and 31 + 10 and\r\n         i_current_price between 31 + 1 and 31 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2001 and\r\n     cs2.syear = 2001 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('tan','blue','lime','thistle','brown','aquamarine') and\r          i_current_price between 31 and 31 + 10 and\r          i_current_price between 31 + 1 and 31 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2001 and\r      cs2.syear = 2001 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 483, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/483.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595647.98624
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:28", 
                    "startTimeFormat": "2019-12-06 09:27:27", 
                    "startTime": 1575595647.98633, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_484.sql", 
                    "second": 0.671807050704956, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 2001\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 2001\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 2001\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 2001\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 2001\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =2001\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by web_q2_q3_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 2001\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 2001\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 2001\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 2001\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 2001\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =2001\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by web_q2_q3_increase;\r \r ", 
                    "id": 484, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/484.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595648.658137
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:29", 
                    "startTimeFormat": "2019-12-06 09:27:28", 
                    "startTime": 1575595648.658216, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_485.sql", 
                    "second": 1.0908360481262207, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 2001 or\r\n         ( d_year = 2001-1 and d_moy =12) or\r\n         ( d_year = 2001+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_category\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2001 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 2001 or\r          ( d_year = 2001-1 and d_moy =12) or\r          ( d_year = 2001+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_category\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2001 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 485, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/485.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595649.749052
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:29", 
                    "startTimeFormat": "2019-12-06 09:27:29", 
                    "startTime": 1575595649.749136, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_486.sql", 
                    "second": 0.021949052810668945, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2000\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MN'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2000\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MN'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 486, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/486.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595649.771085
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:30", 
                    "startTimeFormat": "2019-12-06 09:27:29", 
                    "startTime": 1575595649.771171, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_487.sql", 
                    "second": 1.1703109741210938, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'D'\r\n  and cd_education_status = 'Unknown'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'M'\r\n  and cd_education_status = 'Primary'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = '4 yr Degree'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('KS', 'CA', 'FL')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('IN', 'TX', 'NE')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('AZ', 'IA', 'ND')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'D'\r   and cd_education_status = 'Unknown'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'M'\r   and cd_education_status = 'Primary'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = '4 yr Degree'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('KS', 'CA', 'FL')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('IN', 'TX', 'NE')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('AZ', 'IA', 'ND')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 487, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/487.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595650.941482
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:31", 
                    "startTimeFormat": "2019-12-06 09:27:30", 
                    "startTime": 1575595650.941575, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_488.sql", 
                    "second": 0.3570539951324463, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2001-3-01','yyyy-mm-dd') and \r\n           to_date('2001-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'KY'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2001-3-01','yyyy-mm-dd') and \r            to_date('2001-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'KY'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 488, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/488.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595651.298629
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:31", 
                    "startTimeFormat": "2019-12-06 09:27:31", 
                    "startTime": 1575595651.298735, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_489.sql", 
                    "second": 0.26364803314208984, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1177 and 1177 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1177 and 1177 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 489, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/489.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595651.562383
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:31", 
                    "startTimeFormat": "2019-12-06 09:27:31", 
                    "startTime": 1575595651.562483, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_490.sql", 
                    "second": 0.3979299068450928, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 490, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/490.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595651.960413
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:33", 
                    "startTimeFormat": "2019-12-06 09:27:31", 
                    "startTime": 1575595651.960498, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_491.sql", 
                    "second": 1.3508679866790771, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_login\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1999\r\n         and t_s_secyear.dyear = 1999+1\r\n         and t_w_firstyear.dyear = 1999\r\n         and t_w_secyear.dyear = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_login\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_login\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1999\r          and t_s_secyear.dyear = 1999+1\r          and t_w_firstyear.dyear = 1999\r          and t_w_secyear.dyear = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_login\r  ) where rownum <= 100;\r \r ", 
                    "id": 491, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/491.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595653.311366
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:33", 
                    "startTimeFormat": "2019-12-06 09:27:33", 
                    "startTime": 1575595653.31147, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_492.sql", 
                    "second": 0.06470990180969238, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '501-1000' or\r\n         household_demographics.hd_buy_potential = '5001-10000')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Mobile County','Gogebic County','Levy County','San Miguel County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '501-1000' or\r          household_demographics.hd_buy_potential = '5001-10000')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Mobile County','Gogebic County','Levy County','San Miguel County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 492, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/492.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595653.37618
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:39", 
                    "startTimeFormat": "2019-12-06 09:27:33", 
                    "startTime": 1575595653.376268, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_493.sql", 
                    "second": 6.57839298248291, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1222 and 1222+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1222 and 1222+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 493, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/493.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595659.954661
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:40", 
                    "startTimeFormat": "2019-12-06 09:27:39", 
                    "startTime": 1575595659.954824, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_494.sql", 
                    "second": 0.28928494453430176, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1211,1211+1,1211+2,1211+3,1211+4,1211+5,1211+6,1211+7,1211+8,1211+9,1211+10,1211+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1211,1211+1,1211+2,1211+3,1211+4,1211+5,1211+6,1211+7,1211+8,1211+9,1211+10,1211+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 494, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/494.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595660.244109
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:42", 
                    "startTimeFormat": "2019-12-06 09:27:40", 
                    "startTime": 1575595660.244217, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_495.sql", 
                    "second": 2.125246047973633, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_4.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 4830899\r\n            then (select avg(ss_ext_list_price) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 33226231\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 30516070\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 10219508\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 24274657\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 4830899\r             then (select avg(ss_ext_list_price) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 33226231\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 30516070\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 10219508\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 24274657\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 495, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/495.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_4.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595662.369463
                }
            ], 
            "second": 176.275475025177, 
            "startTime": 1575595486.094078, 
            "endTime": 1575595662.369553
        }, 
        "startTime": 1575595486.089904, 
        "query_1.sql": {
            "endTimeFormat": "2019-12-06 09:27:14", 
            "startTimeFormat": "2019-12-06 09:24:46", 
            "secondFormat": "00:02:28", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:24:46", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.09117, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_100.sql", 
                    "second": 0.32741403579711914, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('1999-07-08','yyyy-mm-dd'),to_date('1999-08-04','yyyy-mm-dd'),to_date('1999-11-11','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('1999-07-08','yyyy-mm-dd'),to_date('1999-08-04','yyyy-mm-dd'),to_date('1999-11-11','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('1999-07-08','yyyy-mm-dd'),to_date('1999-08-04','yyyy-mm-dd'),to_date('1999-11-11','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('1999-07-08','yyyy-mm-dd'),to_date('1999-08-04','yyyy-mm-dd'),to_date('1999-11-11','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('1999-07-08','yyyy-mm-dd'),to_date('1999-08-04','yyyy-mm-dd'),to_date('1999-11-11','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('1999-07-08','yyyy-mm-dd'),to_date('1999-08-04','yyyy-mm-dd'),to_date('1999-11-11','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 100, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/100.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595486.418584
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:46", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.418687, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_101.sql", 
                    "second": 0.028923988342285156, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 494\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('2001-03-27','yyyy-mm-dd') and \r\n        to_date('2001-03-27','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('2001-03-27','yyyy-mm-dd') and\r\n                             to_date('2001-03-27','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 494\r and i_item_sk = cs_item_sk \r and d_date between to_date('2001-03-27','yyyy-mm-dd') and \r         to_date('2001-03-27','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('2001-03-27','yyyy-mm-dd') and\r                              to_date('2001-03-27','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 101, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/101.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595486.447611
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:46", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.447702, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_102.sql", 
                    "second": 0.04254007339477539, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2001\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MS'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2001\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MS'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 102, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/102.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595486.490242
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:46", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.490342, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_103.sql", 
                    "second": 0.13148021697998047, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 773\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2002-01-27','yyyy-mm-dd') and \r\n        to_date('2002-01-27','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2002-01-27','yyyy-mm-dd') and\r\n                             to_date('2002-01-27','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 773\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2002-01-27','yyyy-mm-dd') and \r         to_date('2002-01-27','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2002-01-27','yyyy-mm-dd') and\r                              to_date('2002-01-27','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 103, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/103.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595486.621822
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:47", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.621912, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_104.sql", 
                    "second": 0.9274299144744873, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'MSC' || ',' || 'FEDEX' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 1998\r\n \tand t_time between 3649 and 3649+28800 \r\n \tand sm_carrier in ('MSC','FEDEX')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'MSC' || ',' || 'FEDEX' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 1998\r\n \tand t_time between 3649 AND 3649+28800 \r\n \tand sm_carrier in ('MSC','FEDEX')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'MSC' || ',' || 'FEDEX' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 1998\r  \tand t_time between 3649 and 3649+28800 \r  \tand sm_carrier in ('MSC','FEDEX')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'MSC' || ',' || 'FEDEX' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 1998\r  \tand t_time between 3649 AND 3649+28800 \r  \tand sm_carrier in ('MSC','FEDEX')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 104, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/104.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595487.549342
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:47", 
                    "startTimeFormat": "2019-12-06 09:24:47", 
                    "startTime": 1575595487.54944, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_105.sql", 
                    "second": 0.15784597396850586, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Oak Grove'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  49457\r\n   and ib_upper_bound   <=  49457 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Oak Grove'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  49457\r    and ib_upper_bound   <=  49457 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 105, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/105.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595487.707286
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:48", 
                    "startTimeFormat": "2019-12-06 09:24:47", 
                    "startTime": 1575595487.707376, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_106.sql", 
                    "second": 0.37794995307922363, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Music', 'Men', 'Books')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2000-03-01' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2000-03-01' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Music', 'Men', 'Books')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2000-03-01' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2000-03-01' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 106, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/106.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595488.085326
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:48", 
                    "startTimeFormat": "2019-12-06 09:24:48", 
                    "startTime": 1575595488.085411, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_107.sql", 
                    "second": 0.5003490447998047, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1999-03-15','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1999-03-15','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('1999-03-15','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1999-03-15','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1999-03-15','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('1999-03-15','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 107, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/107.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595488.58576
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:48", 
                    "startTimeFormat": "2019-12-06 09:24:48", 
                    "startTime": 1575595488.585865, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_108.sql", 
                    "second": 0.11392498016357422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2002-2-01','yyyy-mm-dd') and \r\n           (to_date('2002-2-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'SD'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Fairfield County','Pennington County','Levy County','Franklin Parish',\r\n                  'Ziebach County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2002-2-01','yyyy-mm-dd') and \r            (to_date('2002-2-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'SD'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Fairfield County','Pennington County','Levy County','Franklin Parish',\r                   'Ziebach County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 108, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/108.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595488.69979
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:49", 
                    "startTimeFormat": "2019-12-06 09:24:48", 
                    "startTime": 1575595488.699896, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_109.sql", 
                    "second": 0.5198009014129639, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-24','yyyy-mm-dd') \r\n                  and to_date('1998-08-24','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-24','yyyy-mm-dd') \r\n                  and to_date('1998-08-24','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r\n                  and  to_date('1998-08-24','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r\n                  and  to_date('1998-08-24','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r\n                  and  to_date('1998-08-24','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r\n                  and  to_date('1998-08-24','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-24','yyyy-mm-dd') \r                   and to_date('1998-08-24','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('1998-08-24','yyyy-mm-dd') \r                   and to_date('1998-08-24','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r                   and  to_date('1998-08-24','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r                   and  to_date('1998-08-24','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r                   and  to_date('1998-08-24','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1998-08-24','yyyy-mm-dd') \r                   and  to_date('1998-08-24','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 109, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/109.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595489.219697
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:49", 
                    "startTime": 1575595489.219795, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_110.sql", 
                    "second": 3.871891975402832, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('1999-03-06','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('1999-03-06','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('1999-03-06','yyyy-mm-dd') - 30 )\r\n                and (to_date ('1999-03-06','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('1999-03-06','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('1999-03-06','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('1999-03-06','yyyy-mm-dd') - 30 )\r                 and (to_date ('1999-03-06','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 110, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/110.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595493.091687
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.09178, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_111.sql", 
                    "second": 0.2802720069885254, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 15\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 9\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 15\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 9\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 111, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/111.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595493.372052
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:54", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.372137, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_112.sql", 
                    "second": 1.2035470008850098, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'D'\r\n  and cd_education_status = '4 yr Degree'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'S'\r\n  and cd_education_status = 'Advanced Degree'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'W'\r\n  and cd_education_status = '2 yr Degree'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('NC', 'GA', 'TX')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('OH', 'WI', 'MS')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('MO', 'FL', 'CA')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'D'\r   and cd_education_status = '4 yr Degree'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'S'\r   and cd_education_status = 'Advanced Degree'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'W'\r   and cd_education_status = '2 yr Degree'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('NC', 'GA', 'TX')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('OH', 'WI', 'MS')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('MO', 'FL', 'CA')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 112, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/112.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595494.575684
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:55", 
                    "startTimeFormat": "2019-12-06 09:24:54", 
                    "startTime": 1575595494.575793, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_113.sql", 
                    "second": 0.9735610485076904, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 2000 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('TN','MN','TN','GA',\r\n                 'OH','AL','OH','GA')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 2000 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('TN','MN','TN','GA',\r                  'OH','AL','OH','GA')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 113, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/113.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595495.549354
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:03", 
                    "startTimeFormat": "2019-12-06 09:24:55", 
                    "startTime": 1575595495.549436, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_114.sql", 
                    "second": 7.795476913452148, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-5-01','yyyy-mm-dd') and \r\n            to_date('2002-5-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'VT'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-5-01','yyyy-mm-dd') and \r             to_date('2002-5-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'VT'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 114, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/114.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595503.344913
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:03", 
                    "startTimeFormat": "2019-12-06 09:25:03", 
                    "startTime": 1575595503.345003, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_115.sql", 
                    "second": 0.3254890441894531, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1185,1185+1,1185+2,1185+3,1185+4,1185+5,1185+6,1185+7,1185+8,1185+9,1185+10,1185+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1185,1185+1,1185+2,1185+3,1185+4,1185+5,1185+6,1185+7,1185+8,1185+9,1185+10,1185+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 115, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/115.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595503.670492
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:04", 
                    "startTimeFormat": "2019-12-06 09:25:03", 
                    "startTime": 1575595503.670587, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_116.sql", 
                    "second": 0.47658681869506836, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1180 and 1180 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1180 and 1180 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 116, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/116.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595504.147174
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:04", 
                    "startTimeFormat": "2019-12-06 09:25:04", 
                    "startTime": 1575595504.147263, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_117.sql", 
                    "second": 0.295443058013916, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_ext_sales_price) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 110\r\n   and dt.d_moy=12\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_ext_sales_price) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 110\r    and dt.d_moy=12\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 117, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/117.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595504.442706
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:37", 
                    "startTimeFormat": "2019-12-06 09:25:04", 
                    "startTime": 1575595504.442798, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_118.sql", 
                    "second": 33.1609160900116, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 2000\r\n \t        and d_moy = 6 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 2000\r  \t        and d_moy = 6 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 118, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/118.sql", 
                    "secondFormat": "00:00:33", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595537.603714
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:37", 
                    "startTimeFormat": "2019-12-06 09:25:37", 
                    "startTime": 1575595537.60384, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_119.sql", 
                    "second": 0.14983296394348145, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Home', 'Music', 'Books')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('2002-01-13' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('2002-01-13' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Home', 'Music', 'Books')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('2002-01-13' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('2002-01-13' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 119, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/119.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595537.753673
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:38", 
                    "startTimeFormat": "2019-12-06 09:25:37", 
                    "startTime": 1575595537.753768, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_120.sql", 
                    "second": 0.3311440944671631, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 127 and 127+10 \r\n             or ss_coupon_amt between 9955 and 9955+1000\r\n             or ss_wholesale_cost between 70 and 70+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 17 and 17+10\r\n          or ss_coupon_amt between 3363 and 3363+1000\r\n          or ss_wholesale_cost between 56 and 56+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 111 and 111+10\r\n          or ss_coupon_amt between 4760 and 4760+1000\r\n          or ss_wholesale_cost between 40 and 40+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 115 and 115+10\r\n          or ss_coupon_amt between 10811 and 10811+1000\r\n          or ss_wholesale_cost between 66 and 66+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 109 and 109+10\r\n          or ss_coupon_amt between 9374 and 9374+1000\r\n          or ss_wholesale_cost between 46 and 46+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 174 and 174+10\r\n          or ss_coupon_amt between 13377 and 13377+1000\r\n          or ss_wholesale_cost between 77 and 77+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 127 and 127+10 \r              or ss_coupon_amt between 9955 and 9955+1000\r              or ss_wholesale_cost between 70 and 70+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 17 and 17+10\r           or ss_coupon_amt between 3363 and 3363+1000\r           or ss_wholesale_cost between 56 and 56+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 111 and 111+10\r           or ss_coupon_amt between 4760 and 4760+1000\r           or ss_wholesale_cost between 40 and 40+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 115 and 115+10\r           or ss_coupon_amt between 10811 and 10811+1000\r           or ss_wholesale_cost between 66 and 66+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 109 and 109+10\r           or ss_coupon_amt between 9374 and 9374+1000\r           or ss_wholesale_cost between 46 and 46+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 174 and 174+10\r           or ss_coupon_amt between 13377 and 13377+1000\r           or ss_wholesale_cost between 77 and 77+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 120, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/120.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595538.084912
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:38", 
                    "startTimeFormat": "2019-12-06 09:25:38", 
                    "startTime": 1575595538.084992, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_121.sql", 
                    "second": 0.8560090065002441, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 1999\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'D'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Secondary'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'W'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'College' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'U'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Advanced Degree'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('OH', 'IN', 'AR')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('FL', 'LA', 'GA')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('AL', 'NC', 'WI')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 1999\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'D'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Secondary'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'W'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'College' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'U'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Advanced Degree'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('OH', 'IN', 'AR')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('FL', 'LA', 'GA')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('AL', 'NC', 'WI')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 121, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/121.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595538.941001
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:38", 
                    "startTime": 1575595538.941091, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_122.sql", 
                    "second": 2.821938991546631, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1216 and 1216+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1216 and 1216+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1216 and 1216+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1216 and 1216+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 122, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/122.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595541.76303
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.763128, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_123.sql", 
                    "second": 0.08061885833740234, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 850 and 850+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'cornflower' or i_color = 'moccasin') and \r\n        (i_units = 'Gram' or i_units = 'Tsp') and\r\n        (i_size = 'petite' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'antique' or i_color = 'burnished') and\r\n        (i_units = 'Cup' or i_units = 'Oz') and\r\n        (i_size = 'medium' or i_size = 'N/A')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'lemon' or i_color = 'navajo') and\r\n        (i_units = 'Bunch' or i_units = 'Tbl') and\r\n        (i_size = 'extra large' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'papaya' or i_color = 'cornsilk') and\r\n        (i_units = 'Pound' or i_units = 'Case') and\r\n        (i_size = 'petite' or i_size = 'economy')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'rosy' or i_color = 'pink') and \r\n        (i_units = 'Box' or i_units = 'Pallet') and\r\n        (i_size = 'petite' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'orange' or i_color = 'thistle') and\r\n        (i_units = 'N/A' or i_units = 'Carton') and\r\n        (i_size = 'medium' or i_size = 'N/A')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'plum' or i_color = 'chiffon') and\r\n        (i_units = 'Dozen' or i_units = 'Dram') and\r\n        (i_size = 'extra large' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'royal' or i_color = 'lime') and\r\n        (i_units = 'Ounce' or i_units = 'Bundle') and\r\n        (i_size = 'petite' or i_size = 'economy')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 850 and 850+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'cornflower' or i_color = 'moccasin') and \r         (i_units = 'Gram' or i_units = 'Tsp') and\r         (i_size = 'petite' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'antique' or i_color = 'burnished') and\r         (i_units = 'Cup' or i_units = 'Oz') and\r         (i_size = 'medium' or i_size = 'N/A')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'lemon' or i_color = 'navajo') and\r         (i_units = 'Bunch' or i_units = 'Tbl') and\r         (i_size = 'extra large' or i_size = 'small')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'papaya' or i_color = 'cornsilk') and\r         (i_units = 'Pound' or i_units = 'Case') and\r         (i_size = 'petite' or i_size = 'economy')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'rosy' or i_color = 'pink') and \r         (i_units = 'Box' or i_units = 'Pallet') and\r         (i_size = 'petite' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'orange' or i_color = 'thistle') and\r         (i_units = 'N/A' or i_units = 'Carton') and\r         (i_size = 'medium' or i_size = 'N/A')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'plum' or i_color = 'chiffon') and\r         (i_units = 'Dozen' or i_units = 'Dram') and\r         (i_size = 'extra large' or i_size = 'small')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'royal' or i_color = 'lime') and\r         (i_units = 'Ounce' or i_units = 'Bundle') and\r         (i_size = 'petite' or i_size = 'economy')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 123, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/123.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595541.843747
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:42", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.84384, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_124.sql", 
                    "second": 0.8151721954345703, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'F' and\r\n       cd_marital_status = 'W' and\r\n       cd_education_status = 'College' and\r\n       d_year = 1999 and\r\n       s_state in ('FL','TN', 'MI', 'MN', 'AL', 'MN')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'F' and\r        cd_marital_status = 'W' and\r        cd_education_status = 'College' and\r        d_year = 1999 and\r        s_state in ('FL','TN', 'MI', 'MN', 'AL', 'MN')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 124, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/124.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595542.659012
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:45", 
                    "startTimeFormat": "2019-12-06 09:25:42", 
                    "startTime": 1575595542.659113, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_125.sql", 
                    "second": 3.036112070083618, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_item_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r\norder by \r\n  ss_item_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_item_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r order by \r   ss_item_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 125, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/125.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595545.695225
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:45", 
                    "startTimeFormat": "2019-12-06 09:25:45", 
                    "startTime": 1575595545.695323, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_126.sql", 
                    "second": 0.18761205673217773, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '28406','48693','57430','31269','36567','95547',\r\n                          '74460','45197','54281','55598','36678',\r\n                          '88809','11738','51645','32366','33764',\r\n                          '97629','21640','73195','95780','66388',\r\n                          '46873','75697','14162','75938','98170',\r\n                          '48691','69492','78766','81946','38145',\r\n                          '52537','74150','17636','84180','12898',\r\n                          '82329','32857','20435','21831','69077',\r\n                          '98249','74703','85721','34372','39529',\r\n                          '44890','69925','95913','89556','32442',\r\n                          '27830','15866','67562','36373','92517',\r\n                          '17555','72238','93746','49803','46016',\r\n                          '55016','71472','93920','65233','36230',\r\n                          '34382','51898','24574','88072','11086',\r\n                          '76310','38321','74692','16321','56193',\r\n                          '98514','23850','28482','59450','59718',\r\n                          '62115','26952','56083','91204','65611',\r\n                          '64805','26263','47667','22158','80149',\r\n                          '92726','64139','23001','42011','54254',\r\n                          '47751','64231','31762','36941','68019',\r\n                          '36450','20323','67779','70880','27006',\r\n                          '53820','32722','88367','26128','61887',\r\n                          '51826','34730','84332','39167','15427',\r\n                          '34507','34179','64697','49819','29175',\r\n                          '60711','53752','32150','12403','28533',\r\n                          '79260','86465','60569','82726','62422',\r\n                          '32010','11327','67878','80988','54016',\r\n                          '66666','34242','57522','21551','75377',\r\n                          '76789','53821','31761','83335','19379',\r\n                          '85089','15326','73049','17618','33519',\r\n                          '97346','82143','75875','25505','16766',\r\n                          '88874','19898','11194','96205','14169',\r\n                          '46402','52034','92873','58823','66322',\r\n                          '90830','18857','45415','55920','38302',\r\n                          '41325','93665','81149','26597','43349',\r\n                          '60329','49835','52671','41354','69257',\r\n                          '33454','85135','31441','90963','65298',\r\n                          '45176','33635','94267','82188','48947',\r\n                          '64446','81212','71313','87487','64622',\r\n                          '16979','32648','58959','75906','66969',\r\n                          '29100','52137','73794','71053','33972',\r\n                          '23496','62465','91162','84394','46124',\r\n                          '47699','78843','91281','89783','65057',\r\n                          '54937','99223','66093','80996','34014',\r\n                          '68874','22243','92220','14543','14525',\r\n                          '37057','26955','81151','51814','63155',\r\n                          '14405','99166','29189','98336','76501',\r\n                          '97270','16700','25584','52226','53181',\r\n                          '60795','74140','99148','98807','85935',\r\n                          '45677','84302','44155','86275','65988',\r\n                          '21998','91151','54131','37672','44089',\r\n                          '64353','71890','19680','37103','78092',\r\n                          '15711','26596','26178','85022','65492',\r\n                          '96078','74974','30490','24203','39359',\r\n                          '56959','16645','96963','36593','17835',\r\n                          '38802','38422','44994','79405','88112',\r\n                          '90423','28052','65780','22784','18925',\r\n                          '33765','85805','36122','67530','76863',\r\n                          '25103','98475','11807','50192','98375',\r\n                          '39864','43624','37823','74263','12339',\r\n                          '12318','10735','53265','20841','30769',\r\n                          '69849','25719','93429','45935','49186',\r\n                          '34928','95365','71227','60836','85772',\r\n                          '56303','50775','57424','63951','84046',\r\n                          '35610','15904','38031','74280','13476',\r\n                          '68797','92354','23031','34446','50046',\r\n                          '59402','10961','59885','96867','74995',\r\n                          '35373','61558','45141','81237','55998',\r\n                          '56639','51117','67483','66069','31041',\r\n                          '72980','26639','71942','65211','55787',\r\n                          '22839','69589','75823','92072','37040',\r\n                          '95475','95808','83921','65933','17930',\r\n                          '82591','55049','85544','14094','55511',\r\n                          '79741','40592','36022','36205','51359',\r\n                          '77796','69678','61725','87832','25680',\r\n                          '22761','33792','79165','55804','79371',\r\n                          '36728','35018','14473','35195','56416',\r\n                          '24039','41291','37842','58054','75413',\r\n                          '71300','22560','97376','56118','34210',\r\n                          '25571','97053','47181','62926')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 1 and d_year = 1998\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '28406','48693','57430','31269','36567','95547',\r                           '74460','45197','54281','55598','36678',\r                           '88809','11738','51645','32366','33764',\r                           '97629','21640','73195','95780','66388',\r                           '46873','75697','14162','75938','98170',\r                           '48691','69492','78766','81946','38145',\r                           '52537','74150','17636','84180','12898',\r                           '82329','32857','20435','21831','69077',\r                           '98249','74703','85721','34372','39529',\r                           '44890','69925','95913','89556','32442',\r                           '27830','15866','67562','36373','92517',\r                           '17555','72238','93746','49803','46016',\r                           '55016','71472','93920','65233','36230',\r                           '34382','51898','24574','88072','11086',\r                           '76310','38321','74692','16321','56193',\r                           '98514','23850','28482','59450','59718',\r                           '62115','26952','56083','91204','65611',\r                           '64805','26263','47667','22158','80149',\r                           '92726','64139','23001','42011','54254',\r                           '47751','64231','31762','36941','68019',\r                           '36450','20323','67779','70880','27006',\r                           '53820','32722','88367','26128','61887',\r                           '51826','34730','84332','39167','15427',\r                           '34507','34179','64697','49819','29175',\r                           '60711','53752','32150','12403','28533',\r                           '79260','86465','60569','82726','62422',\r                           '32010','11327','67878','80988','54016',\r                           '66666','34242','57522','21551','75377',\r                           '76789','53821','31761','83335','19379',\r                           '85089','15326','73049','17618','33519',\r                           '97346','82143','75875','25505','16766',\r                           '88874','19898','11194','96205','14169',\r                           '46402','52034','92873','58823','66322',\r                           '90830','18857','45415','55920','38302',\r                           '41325','93665','81149','26597','43349',\r                           '60329','49835','52671','41354','69257',\r                           '33454','85135','31441','90963','65298',\r                           '45176','33635','94267','82188','48947',\r                           '64446','81212','71313','87487','64622',\r                           '16979','32648','58959','75906','66969',\r                           '29100','52137','73794','71053','33972',\r                           '23496','62465','91162','84394','46124',\r                           '47699','78843','91281','89783','65057',\r                           '54937','99223','66093','80996','34014',\r                           '68874','22243','92220','14543','14525',\r                           '37057','26955','81151','51814','63155',\r                           '14405','99166','29189','98336','76501',\r                           '97270','16700','25584','52226','53181',\r                           '60795','74140','99148','98807','85935',\r                           '45677','84302','44155','86275','65988',\r                           '21998','91151','54131','37672','44089',\r                           '64353','71890','19680','37103','78092',\r                           '15711','26596','26178','85022','65492',\r                           '96078','74974','30490','24203','39359',\r                           '56959','16645','96963','36593','17835',\r                           '38802','38422','44994','79405','88112',\r                           '90423','28052','65780','22784','18925',\r                           '33765','85805','36122','67530','76863',\r                           '25103','98475','11807','50192','98375',\r                           '39864','43624','37823','74263','12339',\r                           '12318','10735','53265','20841','30769',\r                           '69849','25719','93429','45935','49186',\r                           '34928','95365','71227','60836','85772',\r                           '56303','50775','57424','63951','84046',\r                           '35610','15904','38031','74280','13476',\r                           '68797','92354','23031','34446','50046',\r                           '59402','10961','59885','96867','74995',\r                           '35373','61558','45141','81237','55998',\r                           '56639','51117','67483','66069','31041',\r                           '72980','26639','71942','65211','55787',\r                           '22839','69589','75823','92072','37040',\r                           '95475','95808','83921','65933','17930',\r                           '82591','55049','85544','14094','55511',\r                           '79741','40592','36022','36205','51359',\r                           '77796','69678','61725','87832','25680',\r                           '22761','33792','79165','55804','79371',\r                           '36728','35018','14473','35195','56416',\r                           '24039','41291','37842','58054','75413',\r                           '71300','22560','97376','56118','34210',\r                           '25571','97053','47181','62926')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 1 and d_year = 1998\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 126, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/126.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595545.882935
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:00", 
                    "startTimeFormat": "2019-12-06 09:25:45", 
                    "startTime": 1575595545.883025, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_127.sql", 
                    "second": 14.328590154647827, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1998 AND 1998 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1998 AND 1998 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1998 AND 1998 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 1998+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 1998+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 1998+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1998 AND 1998 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1998 AND 1998 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1998 AND 1998 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1998 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 19)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1998\r\n                       and d_moy = 12\r\n                       and d_dom = 19)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1998 AND 1998 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1998 AND 1998 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1998 AND 1998 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 1998+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 1998+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 1998+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1998 AND 1998 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1998 AND 1998 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1998 AND 1998 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1998 + 1\r                        and d_moy = 12\r                        and d_dom = 19)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1998\r                        and d_moy = 12\r                        and d_dom = 19)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 127, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/127.sql", 
                    "secondFormat": "00:00:14", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595560.211615
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:01", 
                    "startTimeFormat": "2019-12-06 09:26:00", 
                    "startTime": 1575595560.211708, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_128.sql", 
                    "second": 1.697335958480835, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 2002\r\nand d2.d_moy  = 10\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 2002\r and d2.d_moy  = 10\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 128, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/128.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595561.909044
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:02", 
                    "startTimeFormat": "2019-12-06 09:26:01", 
                    "startTime": 1575595561.909142, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_129.sql", 
                    "second": 0.2689850330352783, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=11\r\n    and dt.d_year=2001\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=11\r     and dt.d_year=2001\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 129, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/129.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595562.178127
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:02", 
                    "startTimeFormat": "2019-12-06 09:26:02", 
                    "startTime": 1575595562.178226, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_130.sql", 
                    "second": 0.032002925872802734, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =1999\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MT'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =1999\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MT'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 130, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/130.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595562.210229
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:04", 
                    "startTimeFormat": "2019-12-06 09:26:02", 
                    "startTime": 1575595562.210322, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_131.sql", 
                    "second": 2.52189302444458, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('2000-08-21','yyyy-mm-dd') \r\n                  and to_date('2000-08-21','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2000-08-21','yyyy-mm-dd') \r\n                  and to_date('2000-08-21','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2000-08-21','yyyy-mm-dd') \r\n                  and to_date('2000-08-21','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('2000-08-21','yyyy-mm-dd') \r                   and to_date('2000-08-21','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('2000-08-21','yyyy-mm-dd') \r                   and to_date('2000-08-21','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('2000-08-21','yyyy-mm-dd') \r                   and to_date('2000-08-21','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 131, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/131.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595564.732215
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:05", 
                    "startTimeFormat": "2019-12-06 09:26:04", 
                    "startTime": 1575595564.732319, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_132.sql", 
                    "second": 0.4073808193206787, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'M' and\r\n       cd_education_status = '4 yr Degree' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1998 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'M' and\r        cd_education_status = '4 yr Degree' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1998 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 132, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/132.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595565.1397
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:06", 
                    "startTimeFormat": "2019-12-06 09:26:05", 
                    "startTime": 1575595565.139795, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_133.sql", 
                    "second": 1.0564239025115967, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.cc_name\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.cc_name\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 133, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/133.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595566.196219
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:06", 
                    "startTimeFormat": "2019-12-06 09:26:06", 
                    "startTime": 1575595566.196308, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_134.sql", 
                    "second": 0.5367112159729004, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 54 and 54+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2001-07-14' ,'yyyy-mm-dd') and to_date('2001-07-14' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (802,211,125,972)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 54 and 54+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2001-07-14' ,'yyyy-mm-dd') and to_date('2001-07-14' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (802,211,125,972)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 134, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/134.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595566.733019
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:07", 
                    "startTimeFormat": "2019-12-06 09:26:06", 
                    "startTime": 1575595566.733115, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_135.sql", 
                    "second": 0.5701560974121094, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('ND','VA','TX') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 1 and 1+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 1 and 1+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 1 and 1+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('ND','VA','TX') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 1 and 1+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 1 and 1+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 1 and 1+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 135, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/135.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595567.303271
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:08", 
                    "startTimeFormat": "2019-12-06 09:26:07", 
                    "startTime": 1575595567.303371, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_136.sql", 
                    "second": 0.8642470836639404, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Men'\r\n         and i_class = 'accessories'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 1\r\n         and d_year = 2000\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2000 and d_moy = 1)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2000 and d_moy = 1)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Men'\r          and i_class = 'accessories'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 1\r          and d_year = 2000\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2000 and d_moy = 1)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2000 and d_moy = 1)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 136, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/136.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595568.167618
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:08", 
                    "startTimeFormat": "2019-12-06 09:26:08", 
                    "startTime": 1575595568.167766, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_137.sql", 
                    "second": 0.125701904296875, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -6\r\n   and   i_category = 'Jewelry'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -6\r\n   and   d_year = 2001\r\n   and   d_moy  = 12) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -6\r\n   and   i_category = 'Jewelry'\r\n   and   s_gmt_offset = -6\r\n   and   d_year = 2001\r\n   and   d_moy  = 12) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -6\r    and   i_category = 'Jewelry'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -6\r    and   d_year = 2001\r    and   d_moy  = 12) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -6\r    and   i_category = 'Jewelry'\r    and   s_gmt_offset = -6\r    and   d_year = 2001\r    and   d_moy  = 12) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 137, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/137.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595568.293468
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:08", 
                    "startTimeFormat": "2019-12-06 09:26:08", 
                    "startTime": 1575595568.293569, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_138.sql", 
                    "second": 0.5923149585723877, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 138, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/138.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595568.885884
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:09", 
                    "startTimeFormat": "2019-12-06 09:26:08", 
                    "startTime": 1575595568.88598, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_139.sql", 
                    "second": 0.6831681728363037, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'F' and \r\n       cd1.cd_education_status = 'Advanced Degree' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (2,4,1,12,7,10) and\r\n       d_year = 1998 and\r\n       ca_state in ('NE','WV','MS'\r\n                   ,'CA','VT','KY','KS')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'F' and \r        cd1.cd_education_status = 'Advanced Degree' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (2,4,1,12,7,10) and\r        d_year = 1998 and\r        ca_state in ('NE','WV','MS'\r                    ,'CA','VT','KY','KS')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 139, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/139.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595569.569148
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:09", 
                    "startTimeFormat": "2019-12-06 09:26:09", 
                    "startTime": 1575595569.569221, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_140.sql", 
                    "second": 0.3293190002441406, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-2-01','yyyy-mm-dd') and \r\n           to_date('2002-2-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'IA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-2-01','yyyy-mm-dd') and \r            to_date('2002-2-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'IA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 140, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/140.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595569.89854
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:10", 
                    "startTimeFormat": "2019-12-06 09:26:09", 
                    "startTime": 1575595569.898632, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_141.sql", 
                    "second": 0.7343909740447998, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  avg(cd_dep_count) s1,\r\n  stddev_samp(cd_dep_count) s2,\r\n  sum(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  avg(cd_dep_employed_count) s4,\r\n  stddev_samp(cd_dep_employed_count) s5,\r\n  sum(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  avg(cd_dep_college_count) s7,\r\n  stddev_samp(cd_dep_college_count) s8,\r\n  sum(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2002 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   avg(cd_dep_count) s1,\r   stddev_samp(cd_dep_count) s2,\r   sum(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   avg(cd_dep_employed_count) s4,\r   stddev_samp(cd_dep_employed_count) s5,\r   sum(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   avg(cd_dep_college_count) s7,\r   stddev_samp(cd_dep_college_count) s8,\r   sum(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2002 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 141, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/141.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595570.633023
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:11", 
                    "startTimeFormat": "2019-12-06 09:26:10", 
                    "startTime": 1575595570.633112, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_142.sql", 
                    "second": 0.5705029964447021, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 9 or\r\n             household_demographics.hd_vehicle_count= -1)\r\n        and date_dim.d_year in (2000,2000+1,2000+2)\r\n        and store.s_city in ('Glenwood','Midway')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 9 or\r              household_demographics.hd_vehicle_count= -1)\r         and date_dim.d_year in (2000,2000+1,2000+2)\r         and store.s_city in ('Glenwood','Midway')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 142, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/142.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595571.203615
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:11", 
                    "startTimeFormat": "2019-12-06 09:26:11", 
                    "startTime": 1575595571.203705, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_143.sql", 
                    "second": 0.4463999271392822, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_profit) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=5\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'mint'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_profit) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 5\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'goldenrod'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_profit) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=5\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'mint'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_profit) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 5\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'goldenrod'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 143, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/143.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595571.650105
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:12", 
                    "startTimeFormat": "2019-12-06 09:26:11", 
                    "startTime": 1575595571.650225, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_144.sql", 
                    "second": 0.9207451343536377, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Jewelry'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Jewelry'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Jewelry') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2002\r\n   AND prev_yr.d_year=2002-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Jewelry'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Jewelry'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Jewelry') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2002\r    AND prev_yr.d_year=2002-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 144, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/144.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595572.57097
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:14", 
                    "startTimeFormat": "2019-12-06 09:26:12", 
                    "startTime": 1575595572.571063, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_145.sql", 
                    "second": 1.5466070175170898, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_birth_country\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1998\r\n         and t_s_secyear.dyear = 1998+1\r\n         and t_w_firstyear.dyear = 1998\r\n         and t_w_secyear.dyear = 1998+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_birth_country\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_birth_country\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1998\r          and t_s_secyear.dyear = 1998+1\r          and t_w_firstyear.dyear = 1998\r          and t_w_secyear.dyear = 1998+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_birth_country\r  ) where rownum <= 100;\r \r ", 
                    "id": 145, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/145.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595574.11767
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:20", 
                    "startTimeFormat": "2019-12-06 09:26:14", 
                    "startTime": 1575595574.11777, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_146.sql", 
                    "second": 6.8387229442596436, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1180 and 1180+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1180 and 1180+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 146, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/146.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595580.956493
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:20", 
                    "startTime": 1575595580.956705, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_147.sql", 
                    "second": 3.033198833465576, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 11540986\r\n            then (select avg(ss_ext_sales_price) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 31933720\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 47248317\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 28004841\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 1891434\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 11540986\r             then (select avg(ss_ext_sales_price) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 31933720\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 47248317\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 28004841\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 1891434\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 147, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/147.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595583.989904
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.989987, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_148.sql", 
                    "second": 0.3560750484466553, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,avg(ss_net_profit) as store_sales_profit\r\n ,avg(sr_net_loss) as store_returns_loss\r\n ,avg(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 1998\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 1998\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 1998\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,avg(ss_net_profit) as store_sales_profit\r  ,avg(sr_net_loss) as store_returns_loss\r  ,avg(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 1998\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 1998\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 1998\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 148, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/148.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595584.346062
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.346162, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_149.sql", 
                    "second": 0.09228992462158203, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 40 and 40 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1998-05-07' ,'yyyy-mm-dd') and to_date('1998-05-07' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (919,964,805,875)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 40 and 40 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1998-05-07' ,'yyyy-mm-dd') and to_date('1998-05-07' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (919,964,805,875)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 149, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/149.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595584.438452
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:24", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.438531, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_150.sql", 
                    "second": 0.45757102966308594, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1198 and 1198+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1198 and 1198+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 150, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/150.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595584.896102
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:27", 
                    "startTimeFormat": "2019-12-06 09:26:24", 
                    "startTime": 1575595584.896193, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_151.sql", 
                    "second": 2.542581081390381, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_birth_country\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  2001\r\n   and t_s_secyear.dyear = 2001+1\r\n   and t_c_firstyear.dyear =  2001\r\n   and t_c_secyear.dyear =  2001+1\r\n   and t_w_firstyear.dyear = 2001\r\n   and t_w_secyear.dyear = 2001+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_birth_country\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_birth_country\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  2001\r    and t_s_secyear.dyear = 2001+1\r    and t_c_firstyear.dyear =  2001\r    and t_c_secyear.dyear =  2001+1\r    and t_w_firstyear.dyear = 2001\r    and t_w_secyear.dyear = 2001+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_birth_country\r  ) where rownum <= 100;\r \r ", 
                    "id": 151, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/151.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595587.438774
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:27", 
                    "startTimeFormat": "2019-12-06 09:26:27", 
                    "startTime": 1575595587.43887, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_152.sql", 
                    "second": 0.4756929874420166, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 10\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 10\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 10\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 10\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 10\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 10\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 152, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/152.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595587.914563
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:29", 
                    "startTimeFormat": "2019-12-06 09:26:27", 
                    "startTime": 1575595587.914653, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_153.sql", 
                    "second": 1.6548960208892822, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1218 and 1218 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1218 and 1218 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1218 and 1218 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1218 and 1218 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 153, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/153.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595589.569549
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:29", 
                    "startTimeFormat": "2019-12-06 09:26:29", 
                    "startTime": 1575595589.569655, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_154.sql", 
                    "second": 0.42302703857421875, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 4\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 4\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 4\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 4\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 4\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 4\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 154, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/154.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595589.992682
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:30", 
                    "startTimeFormat": "2019-12-06 09:26:29", 
                    "startTime": 1575595589.99278, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_155.sql", 
                    "second": 0.45653200149536133, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count > 3)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count > 3)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (1999,1999+1,1999+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 155, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/155.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595590.449312
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:30", 
                    "startTimeFormat": "2019-12-06 09:26:30", 
                    "startTime": 1575595590.449399, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_156.sql", 
                    "second": 0.21412110328674316, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -6 and\r\n       d_year = 2000 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -6 and\r        d_year = 2000 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 156, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/156.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595590.66352
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:31", 
                    "startTimeFormat": "2019-12-06 09:26:30", 
                    "startTime": 1575595590.663599, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_157.sql", 
                    "second": 1.2615320682525635, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-27','yyyy-mm-dd') \r\n                  and to_date('2001-08-27','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-27','yyyy-mm-dd') \r\n                  and to_date('2001-08-27','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-27','yyyy-mm-dd') \r\n                  and to_date('2001-08-27','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-27','yyyy-mm-dd') \r                   and to_date('2001-08-27','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-27','yyyy-mm-dd') \r                   and to_date('2001-08-27','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-27','yyyy-mm-dd') \r                   and to_date('2001-08-27','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 157, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/157.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595591.925131
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:31", 
                    "startTimeFormat": "2019-12-06 09:26:31", 
                    "startTime": 1575595591.92522, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_158.sql", 
                    "second": 0.07098603248596191, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 67') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 67') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 158, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/158.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595591.996206
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:32", 
                    "startTimeFormat": "2019-12-06 09:26:31", 
                    "startTime": 1575595591.9963, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_159.sql", 
                    "second": 0.5417630672454834, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 2002\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 2002\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 2002\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 2002\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 2002\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =2002\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by web_q1_q2_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 2002\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 2002\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 2002\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 2002\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 2002\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =2002\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by web_q1_q2_increase;\r \r ", 
                    "id": 159, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/159.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595592.538063
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:34", 
                    "startTimeFormat": "2019-12-06 09:26:32", 
                    "startTime": 1575595592.538151, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_160.sql", 
                    "second": 1.795487880706787, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 2001 or\r\n         ( d_year = 2001-1 and d_moy =12) or\r\n         ( d_year = 2001+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.s_company_name\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2001 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 2001 or\r          ( d_year = 2001-1 and d_moy =12) or\r          ( d_year = 2001+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.s_company_name\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2001 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 160, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/160.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595594.333639
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:34", 
                    "startTimeFormat": "2019-12-06 09:26:34", 
                    "startTime": 1575595594.333739, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_161.sql", 
                    "second": 0.26526594161987305, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '2002Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '2002Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 161, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/161.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595594.599005
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:34", 
                    "startTimeFormat": "2019-12-06 09:26:34", 
                    "startTime": 1575595594.59911, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_162.sql", 
                    "second": 0.3580331802368164, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=9\r\n   and d_moy=12\r\n   and d_year=2001\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=9\r    and d_moy=12\r    and d_year=2001\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 162, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/162.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595594.957143
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:34", 
                    "startTimeFormat": "2019-12-06 09:26:34", 
                    "startTime": 1575595594.957225, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_163.sql", 
                    "second": 0.02177596092224121, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_RETURN_TAX) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =2002\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'LA'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_RETURN_TAX) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =2002\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'LA'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 163, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/163.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595594.979001
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:37", 
                    "startTimeFormat": "2019-12-06 09:26:34", 
                    "startTime": 1575595594.979096, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_164.sql", 
                    "second": 2.9789199829101562, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('antique','powder','floral','lemon','medium','smoke') and\r\n         i_current_price between 59 and 59 + 10 and\r\n         i_current_price between 59 + 1 and 59 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2001 and\r\n     cs2.syear = 2001 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('antique','powder','floral','lemon','medium','smoke') and\r          i_current_price between 59 and 59 + 10 and\r          i_current_price between 59 + 1 and 59 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2001 and\r      cs2.syear = 2001 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 164, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/164.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595597.958016
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:38", 
                    "startTimeFormat": "2019-12-06 09:26:37", 
                    "startTime": 1575595597.958122, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_165.sql", 
                    "second": 0.572455883026123, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1224,1224+1,1224+2,1224+3,1224+4,1224+5,1224+6,1224+7,1224+8,1224+9,1224+10,1224+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1224,1224+1,1224+2,1224+3,1224+4,1224+5,1224+6,1224+7,1224+8,1224+9,1224+10,1224+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 165, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/165.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595598.530578
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:38", 
                    "startTimeFormat": "2019-12-06 09:26:38", 
                    "startTime": 1575595598.530668, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_166.sql", 
                    "second": 0.25554895401000977, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=28\r\n \tand d_moy=11\r\n \tand d_year=2000\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=28\r  \tand d_moy=11\r  \tand d_year=2000\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 166, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/166.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595598.786217
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:38", 
                    "startTimeFormat": "2019-12-06 09:26:38", 
                    "startTime": 1575595598.786313, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_167.sql", 
                    "second": 0.12223386764526367, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 4 or\r\n         household_demographics.hd_vehicle_count= -1)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (1999,1999+1,1999+2) \r\n    and store.s_city in ('New Hope','Oak Hill','Providence','Pleasant Valley','Woodlawn') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 4 or\r          household_demographics.hd_vehicle_count= -1)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (1999,1999+1,1999+2) \r     and store.s_city in ('New Hope','Oak Hill','Providence','Pleasant Valley','Woodlawn') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 167, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/167.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595598.908547
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:39", 
                    "startTimeFormat": "2019-12-06 09:26:38", 
                    "startTime": 1575595598.908646, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_168.sql", 
                    "second": 0.2516319751739502, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('2002-06-07' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('2002-06-07' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('2002-06-07' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('2002-06-07' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('2002-06-07' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('2002-06-07' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('2002-06-07' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('2002-06-07' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 168, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/168.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595599.160278
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:39", 
                    "startTimeFormat": "2019-12-06 09:26:39", 
                    "startTime": 1575595599.160358, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_169.sql", 
                    "second": 0.4265010356903076, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 1 and d_year = 2002\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 1 and d_year = 2002\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 169, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/169.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595599.586859
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:39", 
                    "startTimeFormat": "2019-12-06 09:26:39", 
                    "startTime": 1575595599.586958, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_170.sql", 
                    "second": 0.20358514785766602, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Sports', 'Jewelry', 'Men')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('1999-03-27' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('1999-03-27' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Sports', 'Jewelry', 'Men')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('1999-03-27' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('1999-03-27' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 170, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/170.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595599.790543
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:40", 
                    "startTimeFormat": "2019-12-06 09:26:39", 
                    "startTime": 1575595599.79064, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_171.sql", 
                    "second": 0.8380777835845947, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1177 and 1177+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 171, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/171.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595600.628718
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:41", 
                    "startTimeFormat": "2019-12-06 09:26:40", 
                    "startTime": 1575595600.628795, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_172.sql", 
                    "second": 1.1444330215454102, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1219 and 1219 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1219 and 1219 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1219 and 1219 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1219 and 1219 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 172, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/172.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595601.773228
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:42", 
                    "startTimeFormat": "2019-12-06 09:26:41", 
                    "startTime": 1575595601.773315, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_173.sql", 
                    "second": 0.380856990814209, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 12\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 12\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 12\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 12\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 12\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 12\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 173, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/173.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595602.154172
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:44", 
                    "startTimeFormat": "2019-12-06 09:26:42", 
                    "startTime": 1575595602.154265, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_174.sql", 
                    "second": 1.8473501205444336, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1197 and 1197 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1197+ 12 and 1197 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1197 and 1197 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1197+ 12 and 1197 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 174, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/174.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595604.001615
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:46", 
                    "startTimeFormat": "2019-12-06 09:26:44", 
                    "startTime": 1575595604.001717, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_175.sql", 
                    "second": 2.1716020107269287, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2002\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'U'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = '2 yr Degree'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = 'College'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('MN', 'SD', 'GA')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('ME', 'VA', 'AR')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('OH', 'KY', 'OK')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2002\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'U'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = '2 yr Degree'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = 'College'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('MN', 'SD', 'GA')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('ME', 'VA', 'AR')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('OH', 'KY', 'OK')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 175, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/175.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595606.173319
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:49", 
                    "startTimeFormat": "2019-12-06 09:26:46", 
                    "startTime": 1575595606.173412, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_176.sql", 
                    "second": 2.8928840160369873, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '>10000'\r\n  and d1.d_year = 2000\r\n  and cd_marital_status = 'M'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '>10000'\r   and d1.d_year = 2000\r   and cd_marital_status = 'M'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 176, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/176.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595609.066296
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:50", 
                    "startTimeFormat": "2019-12-06 09:26:49", 
                    "startTime": 1575595609.066385, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_177.sql", 
                    "second": 1.0160419940948486, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1218 and 1218+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1218 and 1218+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1218 and 1218+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1218 and 1218+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1218 and 1218+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1218 and 1218+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 177, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/177.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595610.082427
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:50", 
                    "startTimeFormat": "2019-12-06 09:26:50", 
                    "startTime": 1575595610.082514, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_178.sql", 
                    "second": 0.07657003402709961, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = 'Unknown')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (2000,2000+1,2000+2)\r\n    and store.s_county in ('Walker County','Fairfield County','Huron County','Maverick County',\r\n                           'Ziebach County','Pennington County','Richland County','San Miguel County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = 'Unknown')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (2000,2000+1,2000+2)\r     and store.s_county in ('Walker County','Fairfield County','Huron County','Maverick County',\r                            'Ziebach County','Pennington County','Richland County','San Miguel County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 178, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/178.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595610.159084
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:51", 
                    "startTimeFormat": "2019-12-06 09:26:50", 
                    "startTime": 1575595610.159176, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_179.sql", 
                    "second": 1.4274067878723145, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 179, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/179.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595611.586583
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:52", 
                    "startTimeFormat": "2019-12-06 09:26:51", 
                    "startTime": 1575595611.586676, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_180.sql", 
                    "second": 1.0338311195373535, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1200 and 1200 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1200 and 1200 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1200 and 1200 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1200 and 1200 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1200 and 1200 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1200 and 1200 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 180, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/180.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595612.620507
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:56", 
                    "startTimeFormat": "2019-12-06 09:26:52", 
                    "startTime": 1575595612.620603, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_181.sql", 
                    "second": 4.08945894241333, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1202 and 1202 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1202 and 1202 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 181, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/181.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595616.710062
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:57", 
                    "startTimeFormat": "2019-12-06 09:26:56", 
                    "startTime": 1575595616.710159, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_182.sql", 
                    "second": 0.3712019920349121, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (2001) and\r\n        ((i_category in ('Books','Men','Women') and\r\n          i_class in ('business','sports-apparel','maternity')\r\n         )\r\n      or (i_category in ('Children','Home','Music') and\r\n          i_class in ('toddlers','paint','pop') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (2001) and\r         ((i_category in ('Books','Men','Women') and\r           i_class in ('business','sports-apparel','maternity')\r          )\r       or (i_category in ('Children','Home','Music') and\r           i_class in ('toddlers','paint','pop') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 182, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/182.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595617.081361
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:57", 
                    "startTimeFormat": "2019-12-06 09:26:57", 
                    "startTime": 1575595617.081459, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_183.sql", 
                    "second": 0.5709030628204346, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'W' and\r\n       cd_education_status = 'College' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2000 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'W' and\r        cd_education_status = 'College' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2000 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 183, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/183.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595617.652362
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:58", 
                    "startTimeFormat": "2019-12-06 09:26:57", 
                    "startTime": 1575595617.65246, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_184.sql", 
                    "second": 0.4397709369659424, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Todd County','Pulaski County','Fairbanks North Star Borough','Morgan County','Perry County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 1999 and\r\n                d_moy between 2 and 2+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 1999 and\r\n                  d_moy between 2 and 2+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 1999 and\r\n                  d_moy between 2 and 2+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Todd County','Pulaski County','Fairbanks North Star Borough','Morgan County','Perry County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 1999 and\r                 d_moy between 2 and 2+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 1999 and\r                   d_moy between 2 and 2+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 1999 and\r                   d_moy between 2 and 2+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 184, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/184.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595618.092231
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:58", 
                    "startTimeFormat": "2019-12-06 09:26:58", 
                    "startTime": 1575595618.092316, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_185.sql", 
                    "second": 0.165999174118042, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 12 and 12+1\r\n         and household_demographics.hd_dep_count = 4\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 14 and 14+1\r\n         and household_demographics.hd_dep_count = 4\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 12 and 12+1\r          and household_demographics.hd_dep_count = 4\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 14 and 14+1\r          and household_demographics.hd_dep_count = 4\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 185, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/185.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595618.258315
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:58", 
                    "startTimeFormat": "2019-12-06 09:26:58", 
                    "startTime": 1575595618.258402, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_186.sql", 
                    "second": 0.5619947910308838, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 186, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/186.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595618.820397
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:59", 
                    "startTimeFormat": "2019-12-06 09:26:58", 
                    "startTime": 1575595618.820493, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_187.sql", 
                    "second": 0.42789411544799805, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,avg(ss_quantity)        as store_sales_quantity\r\n    ,avg(sr_return_quantity) as store_returns_quantity\r\n    ,avg(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 2000\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 2000\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (2000,2000+1,2000+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,avg(ss_quantity)        as store_sales_quantity\r     ,avg(sr_return_quantity) as store_returns_quantity\r     ,avg(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 2000\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 2000\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (2000,2000+1,2000+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 187, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/187.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595619.248387
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:59", 
                    "startTimeFormat": "2019-12-06 09:26:59", 
                    "startTime": 1575595619.248475, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_188.sql", 
                    "second": 0.06950497627258301, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Fairfield County','Bronx County','Pennington County','San Miguel County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Fairfield County','Bronx County','Pennington County','San Miguel County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 188, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/188.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595619.31798
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:59", 
                    "startTimeFormat": "2019-12-06 09:26:59", 
                    "startTime": 1575595619.318075, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_189.sql", 
                    "second": 0.25186705589294434, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  ca_zip, ca_state, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2000\r\n group by ca_zip, ca_state\r\n order by ca_zip, ca_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_state, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2000\r  group by ca_zip, ca_state\r  order by ca_zip, ca_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 189, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/189.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595619.569942
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:59", 
                    "startTimeFormat": "2019-12-06 09:26:59", 
                    "startTime": 1575595619.570029, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_190.sql", 
                    "second": 0.19576597213745117, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 1999 \r\nand     d_moy                   = 12\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like 'Unknown%'\r\nand     ca_gmt_offset           = -6\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 1999 \r and     d_moy                   = 12\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like 'Unknown%'\r and     ca_gmt_offset           = -6\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 190, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/190.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595619.765795
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:59", 
                    "startTimeFormat": "2019-12-06 09:26:59", 
                    "startTime": 1575595619.765907, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_191.sql", 
                    "second": 0.2308800220489502, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1176 and 1176 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1176 and 1176 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 191, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/191.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595619.996787
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:00", 
                    "startTimeFormat": "2019-12-06 09:26:59", 
                    "startTime": 1575595619.996895, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_192.sql", 
                    "second": 0.2078089714050293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 450\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 450\r\n                                                    and ss_promo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 450\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 450\r\n                                                    and ss_promo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 450\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 450\r                                                     and ss_promo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 450\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 450\r                                                     and ss_promo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 192, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/192.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595620.204704
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:00", 
                    "startTimeFormat": "2019-12-06 09:27:00", 
                    "startTime": 1575595620.204796, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_193.sql", 
                    "second": 0.5006439685821533, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_promo_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_ship_addr_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_bill_addr_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_promo_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_ship_addr_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_bill_addr_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 193, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/193.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595620.70544
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:10", 
                    "startTimeFormat": "2019-12-06 09:27:00", 
                    "startTime": 1575595620.705527, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_194.sql", 
                    "second": 10.121703863143921, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1999,1999+1,1999+2,1999+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 3 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 3 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1999 \r\n         and d_moy = 3 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 3 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1999,1999+1,1999+2,1999+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 3 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 3 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1999 \r          and d_moy = 3 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 3 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 194, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/194.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595630.827231
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:11", 
                    "startTimeFormat": "2019-12-06 09:27:10", 
                    "startTime": 1575595630.827321, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_195.sql", 
                    "second": 0.5533559322357178, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('gainsboro','papaya','light'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 4\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('gainsboro','papaya','light'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 4\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('gainsboro','papaya','light'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 4\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('gainsboro','papaya','light'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 4\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('gainsboro','papaya','light'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 4\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('gainsboro','papaya','light'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 4\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 195, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/195.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595631.380677
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:11", 
                    "startTimeFormat": "2019-12-06 09:27:11", 
                    "startTime": 1575595631.380774, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_196.sql", 
                    "second": 0.24060702323913574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=11\r\n \tand dt.d_year=2001\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=11\r  \tand dt.d_year=2001\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 196, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/196.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595631.621381
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:13", 
                    "startTimeFormat": "2019-12-06 09:27:11", 
                    "startTime": 1575595631.621487, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_197.sql", 
                    "second": 1.4864201545715332, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2002\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=2\r\n  and inv2.d_moy=2+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2002\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=2\r\n  and inv2.d_moy=2+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2002\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=2\r   and inv2.d_moy=2+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2002\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=2\r   and inv2.d_moy=2+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 197, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/197.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595633.107907
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:13", 
                    "startTime": 1575595633.107994, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_198.sql", 
                    "second": 1.2483088970184326, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_1.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (2001,2001+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (2001,2001+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 2001\r\n         and t_s_secyear.year = 2001+1\r\n         and t_w_firstyear.year = 2001\r\n         and t_w_secyear.year = 2001+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 3,2,1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (2001,2001+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (2001,2001+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 2001\r          and t_s_secyear.year = 2001+1\r          and t_w_firstyear.year = 2001\r          and t_w_secyear.year = 2001+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 3,2,1\r  ) where rownum <= 100;\r \r ", 
                    "id": 198, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/198.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_1.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595634.356303
                }
            ], 
            "second": 148.26531100273132, 
            "startTime": 1575595486.091097, 
            "endTime": 1575595634.356408
        }, 
        "endTime": 1575595662.370888, 
        "query_2.sql": {
            "endTimeFormat": "2019-12-06 09:27:19", 
            "startTimeFormat": "2019-12-06 09:24:46", 
            "secondFormat": "00:02:33", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:24:47", 
                    "startTimeFormat": "2019-12-06 09:24:46", 
                    "startTime": 1575595486.091521, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_199.sql", 
                    "second": 1.1296429634094238, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('almond','peru','rose'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 6\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('almond','peru','rose'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 6\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('almond','peru','rose'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 6\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('almond','peru','rose'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 6\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('almond','peru','rose'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 6\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('almond','peru','rose'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 6\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 199, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/199.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595487.221164
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:47", 
                    "startTimeFormat": "2019-12-06 09:24:47", 
                    "startTime": 1575595487.221269, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_200.sql", 
                    "second": 0.43678712844848633, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Shoes', 'Books', 'Home')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2000-05-16' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2000-05-16' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Shoes', 'Books', 'Home')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2000-05-16' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2000-05-16' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 200, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/200.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595487.658056
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:49", 
                    "startTimeFormat": "2019-12-06 09:24:47", 
                    "startTime": 1575595487.658143, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_201.sql", 
                    "second": 1.8127038478851318, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1211 and 1211 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1211+ 12 and 1211 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1211 and 1211 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1211+ 12 and 1211 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 201, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/201.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595489.470847
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:49", 
                    "startTimeFormat": "2019-12-06 09:24:49", 
                    "startTime": 1575595489.470955, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_202.sql", 
                    "second": 0.3384079933166504, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid_inc_tax) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=5\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'firebrick'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid_inc_tax) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 5\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'tan'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid_inc_tax) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=5\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'firebrick'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid_inc_tax) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 5\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'tan'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 202, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/202.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595489.809363
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:50", 
                    "startTimeFormat": "2019-12-06 09:24:49", 
                    "startTime": 1575595489.809444, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_203.sql", 
                    "second": 0.5820789337158203, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 203, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/203.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595490.391523
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:51", 
                    "startTimeFormat": "2019-12-06 09:24:50", 
                    "startTime": 1575595490.391618, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_204.sql", 
                    "second": 1.3856770992279053, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 1998) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 1998+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 1998) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 1998+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 204, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/204.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595491.777295
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:24:53", 
                    "startTimeFormat": "2019-12-06 09:24:51", 
                    "startTime": 1575595491.777394, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_205.sql", 
                    "second": 1.366412878036499, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('2002-08-29','yyyy-mm-dd') \r\n                  and to_date('2002-08-29','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-29','yyyy-mm-dd') \r\n                  and to_date('2002-08-29','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-29','yyyy-mm-dd') \r\n                  and to_date('2002-08-29','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('2002-08-29','yyyy-mm-dd') \r                   and to_date('2002-08-29','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('2002-08-29','yyyy-mm-dd') \r                   and to_date('2002-08-29','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('2002-08-29','yyyy-mm-dd') \r                   and to_date('2002-08-29','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 205, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/205.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595493.143807
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:25", 
                    "startTimeFormat": "2019-12-06 09:24:53", 
                    "startTime": 1575595493.143894, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_206.sql", 
                    "second": 32.68526005744934, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 1999\r\n \t        and d_moy = 3 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 1999\r  \t        and d_moy = 3 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 206, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/206.sql", 
                    "secondFormat": "00:00:32", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595525.829154
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:25", 
                    "startTimeFormat": "2019-12-06 09:25:25", 
                    "startTime": 1575595525.829244, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_207.sql", 
                    "second": 0.08475017547607422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'F' and\r\n       cd_marital_status = 'S' and\r\n       cd_education_status = 'Advanced Degree' and\r\n       d_year = 2001 and\r\n       s_state in ('GA','LA', 'AL', 'SC', 'WA', 'MI')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'F' and\r        cd_marital_status = 'S' and\r        cd_education_status = 'Advanced Degree' and\r        d_year = 2001 and\r        s_state in ('GA','LA', 'AL', 'SC', 'WA', 'MI')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 207, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/207.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595525.913994
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:27", 
                    "startTimeFormat": "2019-12-06 09:25:25", 
                    "startTime": 1575595525.914061, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_208.sql", 
                    "second": 1.1543898582458496, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1197 and 1197+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1197 and 1197+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1197 and 1197+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1197 and 1197+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1197 and 1197+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1197 and 1197+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 208, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/208.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595527.068451
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:27", 
                    "startTimeFormat": "2019-12-06 09:25:27", 
                    "startTime": 1575595527.068534, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_209.sql", 
                    "second": 0.1378481388092041, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 7 and 7+1\r\n         and household_demographics.hd_dep_count = 1\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 13 and 13+1\r\n         and household_demographics.hd_dep_count = 1\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 7 and 7+1\r          and household_demographics.hd_dep_count = 1\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 13 and 13+1\r          and household_demographics.hd_dep_count = 1\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 209, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/209.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595527.206382
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:27", 
                    "startTimeFormat": "2019-12-06 09:25:27", 
                    "startTime": 1575595527.206475, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_210.sql", 
                    "second": 0.17753291130065918, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('1998-05-05','yyyy-mm-dd'),to_date('1998-09-09','yyyy-mm-dd'),to_date('1998-11-03','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('1998-05-05','yyyy-mm-dd'),to_date('1998-09-09','yyyy-mm-dd'),to_date('1998-11-03','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('1998-05-05','yyyy-mm-dd'),to_date('1998-09-09','yyyy-mm-dd'),to_date('1998-11-03','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('1998-05-05','yyyy-mm-dd'),to_date('1998-09-09','yyyy-mm-dd'),to_date('1998-11-03','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('1998-05-05','yyyy-mm-dd'),to_date('1998-09-09','yyyy-mm-dd'),to_date('1998-11-03','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('1998-05-05','yyyy-mm-dd'),to_date('1998-09-09','yyyy-mm-dd'),to_date('1998-11-03','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 210, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/210.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595527.384008
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:27", 
                    "startTimeFormat": "2019-12-06 09:25:27", 
                    "startTime": 1575595527.384106, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_211.sql", 
                    "second": 0.5185110569000244, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 2000 \r\nand     d_moy                   = 11\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like 'Unknown%'\r\nand     ca_gmt_offset           = -6\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 2000 \r and     d_moy                   = 11\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like 'Unknown%'\r and     ca_gmt_offset           = -6\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 211, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/211.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595527.902617
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:28", 
                    "startTimeFormat": "2019-12-06 09:25:27", 
                    "startTime": 1575595527.902699, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_212.sql", 
                    "second": 0.28697896003723145, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 119 and 119+10 \r\n             or ss_coupon_amt between 3029 and 3029+1000\r\n             or ss_wholesale_cost between 55 and 55+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 177 and 177+10\r\n          or ss_coupon_amt between 15716 and 15716+1000\r\n          or ss_wholesale_cost between 72 and 72+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 5 and 5+10\r\n          or ss_coupon_amt between 614 and 614+1000\r\n          or ss_wholesale_cost between 62 and 62+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 27 and 27+10\r\n          or ss_coupon_amt between 16343 and 16343+1000\r\n          or ss_wholesale_cost between 30 and 30+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 59 and 59+10\r\n          or ss_coupon_amt between 12251 and 12251+1000\r\n          or ss_wholesale_cost between 34 and 34+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 52 and 52+10\r\n          or ss_coupon_amt between 17057 and 17057+1000\r\n          or ss_wholesale_cost between 52 and 52+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 119 and 119+10 \r              or ss_coupon_amt between 3029 and 3029+1000\r              or ss_wholesale_cost between 55 and 55+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 177 and 177+10\r           or ss_coupon_amt between 15716 and 15716+1000\r           or ss_wholesale_cost between 72 and 72+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 5 and 5+10\r           or ss_coupon_amt between 614 and 614+1000\r           or ss_wholesale_cost between 62 and 62+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 27 and 27+10\r           or ss_coupon_amt between 16343 and 16343+1000\r           or ss_wholesale_cost between 30 and 30+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 59 and 59+10\r           or ss_coupon_amt between 12251 and 12251+1000\r           or ss_wholesale_cost between 34 and 34+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 52 and 52+10\r           or ss_coupon_amt between 17057 and 17057+1000\r           or ss_wholesale_cost between 52 and 52+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 212, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/212.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595528.189678
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:28", 
                    "startTimeFormat": "2019-12-06 09:25:28", 
                    "startTime": 1575595528.189781, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_213.sql", 
                    "second": 0.07162904739379883, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 4 or\r\n             household_demographics.hd_vehicle_count= 1)\r\n        and date_dim.d_year in (1999,1999+1,1999+2)\r\n        and store.s_city in ('Stringtown','Oak Hill')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 4 or\r              household_demographics.hd_vehicle_count= 1)\r         and date_dim.d_year in (1999,1999+1,1999+2)\r         and store.s_city in ('Stringtown','Oak Hill')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 213, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/213.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595528.26141
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:28", 
                    "startTimeFormat": "2019-12-06 09:25:28", 
                    "startTime": 1575595528.2615, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_214.sql", 
                    "second": 0.19219517707824707, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '63704','93010','55357','20470','97423','44859',\r\n                          '38964','85882','48027','47304','16757',\r\n                          '69523','96440','40175','44447','95259',\r\n                          '88957','36568','40635','37236','66987',\r\n                          '45994','97050','86162','84620','21575',\r\n                          '17609','99283','15959','35184','55373',\r\n                          '93167','22684','13765','65879','53308',\r\n                          '45297','33979','69602','76483','25187',\r\n                          '54945','81016','15293','25120','67784',\r\n                          '97223','31089','85307','64889','78662',\r\n                          '44529','67736','16215','87389','62210',\r\n                          '62114','78810','41558','54271','92600',\r\n                          '90711','72204','37246','85645','74357',\r\n                          '26376','99795','54591','68039','14231',\r\n                          '38325','44451','38779','79789','41514',\r\n                          '45906','51728','29643','13370','64734',\r\n                          '31838','35763','99961','86289','85650',\r\n                          '33572','51219','80658','21244','98614',\r\n                          '83806','28326','90471','61882','11836',\r\n                          '27009','42710','61144','82518','30391',\r\n                          '14516','28671','56429','26255','85082',\r\n                          '55320','50762','84817','82065','69520',\r\n                          '58445','21899','59634','17792','36164',\r\n                          '91121','92210','72127','87487','74626',\r\n                          '78038','24691','41858','73648','58339',\r\n                          '80929','33868','78631','58972','77987',\r\n                          '84455','73609','15929','93121','29015',\r\n                          '37321','25204','15625','61976','16503',\r\n                          '34726','63277','83477','72531','76032',\r\n                          '78223','39448','68328','11858','35201',\r\n                          '71766','12526','64128','33844','80689',\r\n                          '26852','75065','76556','64774','26555',\r\n                          '26121','22784','59349','35291','44630',\r\n                          '61247','14564','35863','57582','53147',\r\n                          '66685','27335','25042','54678','28528',\r\n                          '33253','23642','27923','44174','62402',\r\n                          '42134','37451','22964','64687','97261',\r\n                          '65975','67312','48437','97684','39183',\r\n                          '57134','57160','64300','45351','94426',\r\n                          '82551','19922','47726','42493','64366',\r\n                          '81981','27747','98416','85775','81419',\r\n                          '23761','95480','80938','28044','74281',\r\n                          '56895','71557','92548','57776','97971',\r\n                          '38035','59979','93882','16475','76134',\r\n                          '64798','20982','32097','97760','82469',\r\n                          '81602','59751','72078','26393','87008',\r\n                          '15238','58243','72473','25456','33557',\r\n                          '78961','46350','70722','82901','48132',\r\n                          '98802','16488','87697','63642','27426',\r\n                          '97699','59430','40903','16302','45758',\r\n                          '14942','78759','16145','60904','39924',\r\n                          '12749','47956','26418','62274','40460',\r\n                          '39845','40284','69471','47014','18892',\r\n                          '59144','88082','72494','51353','79575',\r\n                          '96787','23407','16991','85853','21805',\r\n                          '27280','91864','32300','31868','48151',\r\n                          '40250','25450','96506','29546','53634',\r\n                          '21183','64570','56976','46286','41562',\r\n                          '58121','14076','24112','78031','64669',\r\n                          '56554','63933','92918','66509','80644',\r\n                          '33410','32656','34222','15771','50247',\r\n                          '91111','71434','81863','42917','21787',\r\n                          '99187','49803','28823','18783','85220',\r\n                          '38688','90512','32767','90445','56105',\r\n                          '32424','61461','31708','21726','86033',\r\n                          '28577','51876','43191','12919','44137',\r\n                          '28436','13260','75926','69446','67007',\r\n                          '91196','55407','88129','23263','83300',\r\n                          '12960','30902','77302','94711','73999',\r\n                          '43839','62087','28592','27103','28538',\r\n                          '87891','15567','25458','39644','37056',\r\n                          '84542','48149','19768','55038','51597',\r\n                          '94671','18948','55619','37657','44089',\r\n                          '27609','55375','83955','66694','68493',\r\n                          '28623','59419','83280','55761','57129',\r\n                          '76406','92942','61581','44320','66244',\r\n                          '13174','53976','11309','81092','26823',\r\n                          '63423','55631','19955','95922','86513',\r\n                          '86731','27340','75846','76430','95419',\r\n                          '83293','55391','80881','53888')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 2 and d_year = 1999\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '63704','93010','55357','20470','97423','44859',\r                           '38964','85882','48027','47304','16757',\r                           '69523','96440','40175','44447','95259',\r                           '88957','36568','40635','37236','66987',\r                           '45994','97050','86162','84620','21575',\r                           '17609','99283','15959','35184','55373',\r                           '93167','22684','13765','65879','53308',\r                           '45297','33979','69602','76483','25187',\r                           '54945','81016','15293','25120','67784',\r                           '97223','31089','85307','64889','78662',\r                           '44529','67736','16215','87389','62210',\r                           '62114','78810','41558','54271','92600',\r                           '90711','72204','37246','85645','74357',\r                           '26376','99795','54591','68039','14231',\r                           '38325','44451','38779','79789','41514',\r                           '45906','51728','29643','13370','64734',\r                           '31838','35763','99961','86289','85650',\r                           '33572','51219','80658','21244','98614',\r                           '83806','28326','90471','61882','11836',\r                           '27009','42710','61144','82518','30391',\r                           '14516','28671','56429','26255','85082',\r                           '55320','50762','84817','82065','69520',\r                           '58445','21899','59634','17792','36164',\r                           '91121','92210','72127','87487','74626',\r                           '78038','24691','41858','73648','58339',\r                           '80929','33868','78631','58972','77987',\r                           '84455','73609','15929','93121','29015',\r                           '37321','25204','15625','61976','16503',\r                           '34726','63277','83477','72531','76032',\r                           '78223','39448','68328','11858','35201',\r                           '71766','12526','64128','33844','80689',\r                           '26852','75065','76556','64774','26555',\r                           '26121','22784','59349','35291','44630',\r                           '61247','14564','35863','57582','53147',\r                           '66685','27335','25042','54678','28528',\r                           '33253','23642','27923','44174','62402',\r                           '42134','37451','22964','64687','97261',\r                           '65975','67312','48437','97684','39183',\r                           '57134','57160','64300','45351','94426',\r                           '82551','19922','47726','42493','64366',\r                           '81981','27747','98416','85775','81419',\r                           '23761','95480','80938','28044','74281',\r                           '56895','71557','92548','57776','97971',\r                           '38035','59979','93882','16475','76134',\r                           '64798','20982','32097','97760','82469',\r                           '81602','59751','72078','26393','87008',\r                           '15238','58243','72473','25456','33557',\r                           '78961','46350','70722','82901','48132',\r                           '98802','16488','87697','63642','27426',\r                           '97699','59430','40903','16302','45758',\r                           '14942','78759','16145','60904','39924',\r                           '12749','47956','26418','62274','40460',\r                           '39845','40284','69471','47014','18892',\r                           '59144','88082','72494','51353','79575',\r                           '96787','23407','16991','85853','21805',\r                           '27280','91864','32300','31868','48151',\r                           '40250','25450','96506','29546','53634',\r                           '21183','64570','56976','46286','41562',\r                           '58121','14076','24112','78031','64669',\r                           '56554','63933','92918','66509','80644',\r                           '33410','32656','34222','15771','50247',\r                           '91111','71434','81863','42917','21787',\r                           '99187','49803','28823','18783','85220',\r                           '38688','90512','32767','90445','56105',\r                           '32424','61461','31708','21726','86033',\r                           '28577','51876','43191','12919','44137',\r                           '28436','13260','75926','69446','67007',\r                           '91196','55407','88129','23263','83300',\r                           '12960','30902','77302','94711','73999',\r                           '43839','62087','28592','27103','28538',\r                           '87891','15567','25458','39644','37056',\r                           '84542','48149','19768','55038','51597',\r                           '94671','18948','55619','37657','44089',\r                           '27609','55375','83955','66694','68493',\r                           '28623','59419','83280','55761','57129',\r                           '76406','92942','61581','44320','66244',\r                           '13174','53976','11309','81092','26823',\r                           '63423','55631','19955','95922','86513',\r                           '86731','27340','75846','76430','95419',\r                           '83293','55391','80881','53888')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 2 and d_year = 1999\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 214, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/214.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595528.453695
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:29", 
                    "startTimeFormat": "2019-12-06 09:25:28", 
                    "startTime": 1575595528.453791, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_215.sql", 
                    "second": 0.5710980892181396, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_cdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_cdemo_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_web_page_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_web_page_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_bill_addr_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_cdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_cdemo_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_web_page_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_web_page_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_bill_addr_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 215, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/215.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595529.024889
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:32", 
                    "startTimeFormat": "2019-12-06 09:25:29", 
                    "startTime": 1575595529.024981, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_216.sql", 
                    "second": 3.4599080085754395, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Music'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Music'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Music') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2000\r\n   AND prev_yr.d_year=2000-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Music'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Music'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Music') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2000\r    AND prev_yr.d_year=2000-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 216, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/216.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595532.484889
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:35", 
                    "startTimeFormat": "2019-12-06 09:25:32", 
                    "startTime": 1575595532.484977, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_217.sql", 
                    "second": 3.1708240509033203, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-09','yyyy-mm-dd') \r\n                  and to_date('2002-08-09','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-09','yyyy-mm-dd') \r\n                  and to_date('2002-08-09','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-09','yyyy-mm-dd') \r\n                  and to_date('2002-08-09','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2002-08-09','yyyy-mm-dd') \r                   and to_date('2002-08-09','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('2002-08-09','yyyy-mm-dd') \r                   and to_date('2002-08-09','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('2002-08-09','yyyy-mm-dd') \r                   and to_date('2002-08-09','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 217, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/217.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595535.655801
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:35", 
                    "startTimeFormat": "2019-12-06 09:25:35", 
                    "startTime": 1575595535.655893, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_218.sql", 
                    "second": 0.023837804794311523, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_RETURN_AMT) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =2001\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'TX'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_RETURN_AMT) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =2001\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'TX'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 218, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/218.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595535.679731
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:36", 
                    "startTimeFormat": "2019-12-06 09:25:35", 
                    "startTime": 1575595535.67983, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_219.sql", 
                    "second": 0.5469579696655273, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('TX','AL','KS') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2002 and\r\n                d_moy between 4 and 4+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_moy between 4 and 4+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_moy between 4 and 4+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('TX','AL','KS') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2002 and\r                 d_moy between 4 and 4+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_moy between 4 and 4+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_moy between 4 and 4+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 219, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/219.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595536.226788
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:36", 
                    "startTimeFormat": "2019-12-06 09:25:36", 
                    "startTime": 1575595536.226879, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_220.sql", 
                    "second": 0.3892641067504883, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'M' and\r\n       cd_education_status = 'Secondary' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2002 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'M' and\r        cd_education_status = 'Secondary' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2002 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 220, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/220.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595536.616143
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:38", 
                    "startTimeFormat": "2019-12-06 09:25:36", 
                    "startTime": 1575595536.616257, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_221.sql", 
                    "second": 1.6168811321258545, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_login\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1999\r\n         and t_s_secyear.dyear = 1999+1\r\n         and t_w_firstyear.dyear = 1999\r\n         and t_w_secyear.dyear = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_login\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_login\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1999\r          and t_s_secyear.dyear = 1999+1\r          and t_w_firstyear.dyear = 1999\r          and t_w_secyear.dyear = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_login\r  ) where rownum <= 100;\r \r ", 
                    "id": 221, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/221.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595538.233138
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:38", 
                    "startTimeFormat": "2019-12-06 09:25:38", 
                    "startTime": 1575595538.233236, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_222.sql", 
                    "second": 0.3131718635559082, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '1998Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '1998Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 222, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/222.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595538.546408
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:38", 
                    "startTimeFormat": "2019-12-06 09:25:38", 
                    "startTime": 1575595538.546497, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_223.sql", 
                    "second": 0.2847139835357666, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 223, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/223.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595538.831211
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:39", 
                    "startTimeFormat": "2019-12-06 09:25:38", 
                    "startTime": 1575595538.831314, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_224.sql", 
                    "second": 0.7152009010314941, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-02','yyyy-mm-dd') \r\n                  and to_date('1999-08-02','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-02','yyyy-mm-dd') \r\n                  and to_date('1999-08-02','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r\n                  and  to_date('1999-08-02','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r\n                  and  to_date('1999-08-02','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r\n                  and  to_date('1999-08-02','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r\n                  and  to_date('1999-08-02','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1999-08-02','yyyy-mm-dd') \r                   and to_date('1999-08-02','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('1999-08-02','yyyy-mm-dd') \r                   and to_date('1999-08-02','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r                   and  to_date('1999-08-02','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r                   and  to_date('1999-08-02','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r                   and  to_date('1999-08-02','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-02','yyyy-mm-dd') \r                   and  to_date('1999-08-02','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 224, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/224.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595539.546515
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:39", 
                    "startTimeFormat": "2019-12-06 09:25:39", 
                    "startTime": 1575595539.546607, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_225.sql", 
                    "second": 0.35587286949157715, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=25\r\n   and d_moy=11\r\n   and d_year=1999\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=25\r    and d_moy=11\r    and d_year=1999\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 225, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/225.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595539.90248
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:40", 
                    "startTimeFormat": "2019-12-06 09:25:39", 
                    "startTime": 1575595539.902579, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_226.sql", 
                    "second": 0.20282483100891113, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('2001-04-06' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('2001-04-06' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('2001-04-06' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('2001-04-06' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('2001-04-06' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('2001-04-06' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('2001-04-06' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('2001-04-06' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 226, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/226.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595540.105404
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:40", 
                    "startTimeFormat": "2019-12-06 09:25:40", 
                    "startTime": 1575595540.105496, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_227.sql", 
                    "second": 0.5734560489654541, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 1998\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 1998\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 1998\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 1998\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 1998\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =1998\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by store_q1_q2_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 1998\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 1998\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 1998\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 1998\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 1998\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =1998\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by store_q1_q2_increase;\r \r ", 
                    "id": 227, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/227.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595540.678952
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:40", 
                    "startTime": 1575595540.67903, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_228.sql", 
                    "second": 0.4549260139465332, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'unauthoized purchase') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'unauthoized purchase') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 228, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/228.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595541.133956
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:41", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.134043, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_229.sql", 
                    "second": 0.719228982925415, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Electronics'\r\n         and i_class = 'audio'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 2\r\n         and d_year = 2001\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2001 and d_moy = 2)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2001 and d_moy = 2)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Electronics'\r          and i_class = 'audio'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 2\r          and d_year = 2001\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2001 and d_moy = 2)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2001 and d_moy = 2)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 229, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/229.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595541.853272
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:45", 
                    "startTimeFormat": "2019-12-06 09:25:41", 
                    "startTime": 1575595541.853356, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_230.sql", 
                    "second": 3.6634891033172607, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=2\r\n  and inv2.d_moy=2+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=2\r\n  and inv2.d_moy=2+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=2\r   and inv2.d_moy=2+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=2\r   and inv2.d_moy=2+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 230, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/230.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595545.516845
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:46", 
                    "startTimeFormat": "2019-12-06 09:25:45", 
                    "startTime": 1575595545.516946, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_231.sql", 
                    "second": 0.5023419857025146, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Macon County','Atkinson County','Chesterfield County','Cass County','Grant Parish') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 1 and 1+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2001 and\r\n                  d_moy between 1 and 1+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2001 and\r\n                  d_moy between 1 and 1+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Macon County','Atkinson County','Chesterfield County','Cass County','Grant Parish') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 1 and 1+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2001 and\r                   d_moy between 1 and 1+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2001 and\r                   d_moy between 1 and 1+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 231, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/231.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595546.019288
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:46", 
                    "startTimeFormat": "2019-12-06 09:25:46", 
                    "startTime": 1575595546.019379, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_232.sql", 
                    "second": 0.24973320960998535, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2002\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2002\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 232, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/232.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595546.269112
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:25:46", 
                    "startTimeFormat": "2019-12-06 09:25:46", 
                    "startTime": 1575595546.269211, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_233.sql", 
                    "second": 0.31877994537353516, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=53\r\n \tand d_moy=11\r\n \tand d_year=1998\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=53\r  \tand d_moy=11\r  \tand d_year=1998\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 233, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/233.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595546.587991
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:01", 
                    "startTimeFormat": "2019-12-06 09:25:46", 
                    "startTime": 1575595546.588075, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_234.sql", 
                    "second": 14.71697998046875, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 2000 AND 2000 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 2000 AND 2000 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 2000 AND 2000 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 2000 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 24)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 2000\r\n                       and d_moy = 12\r\n                       and d_dom = 24)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 2000 AND 2000 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 2000 AND 2000 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 2000 AND 2000 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 2000+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 2000+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 2000+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 2000 AND 2000 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 2000 AND 2000 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 2000 AND 2000 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 2000 + 1\r                        and d_moy = 12\r                        and d_dom = 24)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 2000\r                        and d_moy = 12\r                        and d_dom = 24)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 234, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/234.sql", 
                    "secondFormat": "00:00:14", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595561.305055
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:02", 
                    "startTimeFormat": "2019-12-06 09:26:01", 
                    "startTime": 1575595561.30514, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_235.sql", 
                    "second": 1.1295499801635742, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1214 and 1214 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1214 and 1214 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1214 and 1214 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1214 and 1214 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1214 and 1214 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1214 and 1214 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 235, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/235.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595562.43469
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:02", 
                    "startTimeFormat": "2019-12-06 09:26:02", 
                    "startTime": 1575595562.434799, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_236.sql", 
                    "second": 0.24931812286376953, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=11\r\n \tand dt.d_year=2000\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=11\r  \tand dt.d_year=2000\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 236, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/236.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595562.684117
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:02", 
                    "startTimeFormat": "2019-12-06 09:26:02", 
                    "startTime": 1575595562.684207, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_237.sql", 
                    "second": 0.30636000633239746, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1181,1181+1,1181+2,1181+3,1181+4,1181+5,1181+6,1181+7,1181+8,1181+9,1181+10,1181+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1181,1181+1,1181+2,1181+3,1181+4,1181+5,1181+6,1181+7,1181+8,1181+9,1181+10,1181+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 237, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/237.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595562.990567
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:03", 
                    "startTimeFormat": "2019-12-06 09:26:02", 
                    "startTime": 1575595562.990669, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_238.sql", 
                    "second": 0.17967796325683594, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  ca_zip, ca_state, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 1998\r\n group by ca_zip, ca_state\r\n order by ca_zip, ca_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_state, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 1998\r  group by ca_zip, ca_state\r  order by ca_zip, ca_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 238, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/238.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595563.170347
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:03", 
                    "startTimeFormat": "2019-12-06 09:26:03", 
                    "startTime": 1575595563.170443, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_239.sql", 
                    "second": 0.46100401878356934, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1217 and 1217 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1217 and 1217 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 239, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/239.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595563.631447
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:10", 
                    "startTimeFormat": "2019-12-06 09:26:03", 
                    "startTime": 1575595563.631536, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_240.sql", 
                    "second": 7.049696922302246, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1217 and 1217+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1217 and 1217+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 240, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/240.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595570.681233
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:20", 
                    "startTimeFormat": "2019-12-06 09:26:10", 
                    "startTime": 1575595570.681328, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_241.sql", 
                    "second": 9.846855878829956, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1999,1999+1,1999+2,1999+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 1 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 1 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1999 \r\n         and d_moy = 1 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 1 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1999,1999+1,1999+2,1999+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 1 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 1 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1999 \r          and d_moy = 1 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 1 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 241, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/241.sql", 
                    "secondFormat": "00:00:09", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595580.528184
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:20", 
                    "startTimeFormat": "2019-12-06 09:26:20", 
                    "startTime": 1575595580.528291, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_242.sql", 
                    "second": 0.4015660285949707, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1185 and 1185 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1185 and 1185 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 242, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/242.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595580.929857
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:20", 
                    "startTimeFormat": "2019-12-06 09:26:20", 
                    "startTime": 1575595580.929955, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_243.sql", 
                    "second": 0.02158498764038086, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2002\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'IL'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2002\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'IL'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 243, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/243.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595580.95154
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:21", 
                    "startTimeFormat": "2019-12-06 09:26:20", 
                    "startTime": 1575595580.951629, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_244.sql", 
                    "second": 0.6644279956817627, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1179 and 1179+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1179 and 1179+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 244, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/244.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595581.616057
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:21", 
                    "startTimeFormat": "2019-12-06 09:26:21", 
                    "startTime": 1575595581.61616, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_245.sql", 
                    "second": 0.13563299179077148, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 41 and 41+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1999-06-21' ,'yyyy-mm-dd') and to_date('1999-06-21' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (103,767,448,533)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 41 and 41+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1999-06-21' ,'yyyy-mm-dd') and to_date('1999-06-21' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (103,767,448,533)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 245, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/245.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595581.751793
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:21", 
                    "startTime": 1575595581.7519, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_246.sql", 
                    "second": 0.3513829708099365, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,min(ss_net_profit) as store_sales_profit\r\n ,min(sr_net_loss) as store_returns_loss\r\n ,min(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 1999\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 1999\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 1999\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,min(ss_net_profit) as store_sales_profit\r  ,min(sr_net_loss) as store_returns_loss\r  ,min(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 1999\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 1999\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 1999\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 246, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/246.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595582.103283
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.103378, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_247.sql", 
                    "second": 0.16714692115783691, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('1999-5-01','yyyy-mm-dd') and \r\n           (to_date('1999-5-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'ND'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Ziebach County','Pennington County','Fairfield County','Barrow County',\r\n                  'Mobile County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('1999-5-01','yyyy-mm-dd') and \r            (to_date('1999-5-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'ND'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Ziebach County','Pennington County','Fairfield County','Barrow County',\r                   'Mobile County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 247, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/247.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595582.270525
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.270628, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_248.sql", 
                    "second": 0.01974201202392578, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =2001\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MA'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =2001\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MA'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 248, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/248.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595582.29037
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.290453, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_249.sql", 
                    "second": 0.16322708129882812, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('2002-05-25','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('2002-05-25','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('2002-05-25','yyyy-mm-dd') - 30 )\r\n                and (to_date ('2002-05-25','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('2002-05-25','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('2002-05-25','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('2002-05-25','yyyy-mm-dd') - 30 )\r                 and (to_date ('2002-05-25','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 249, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/249.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595582.45368
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:22", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.453758, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_250.sql", 
                    "second": 0.24127602577209473, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 24\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 24\r\n                                                    and ss_cdemo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 24\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 24\r\n                                                    and ss_cdemo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 24\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 24\r                                                     and ss_cdemo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 24\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 24\r                                                     and ss_cdemo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 250, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/250.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595582.695034
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:22", 
                    "startTime": 1575595582.695129, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_251.sql", 
                    "second": 0.3984050750732422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 1998\r\nand d2.d_moy  = 10\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 1998\r and d2.d_moy  = 10\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 251, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/251.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595583.093534
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:23", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.093635, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_252.sql", 
                    "second": 0.1348268985748291, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Electronics'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 2001\r\n   and   d_moy  = 12) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Electronics'\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 2001\r\n   and   d_moy  = 12) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -7\r    and   i_category = 'Electronics'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -7\r    and   d_year = 2001\r    and   d_moy  = 12) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -7\r    and   i_category = 'Electronics'\r    and   s_gmt_offset = -7\r    and   d_year = 2001\r    and   d_moy  = 12) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 252, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/252.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595583.228462
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:28", 
                    "startTimeFormat": "2019-12-06 09:26:23", 
                    "startTime": 1575595583.228559, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_253.sql", 
                    "second": 5.745461940765381, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'U'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'College'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'S'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '4 yr Degree' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'M'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Unknown'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('AZ', 'ND', 'OH')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('NE', 'MT', 'CA')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('WV', 'SD', 'MI')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 2000\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'U'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'College'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'S'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '4 yr Degree' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'M'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Unknown'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('AZ', 'ND', 'OH')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('NE', 'MT', 'CA')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('WV', 'SD', 'MI')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 253, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/253.sql", 
                    "secondFormat": "00:00:05", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595588.974021
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:29", 
                    "startTimeFormat": "2019-12-06 09:26:28", 
                    "startTime": 1575595588.974108, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_254.sql", 
                    "second": 0.0906829833984375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '>10000' or\r\n         household_demographics.hd_buy_potential = '5001-10000')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Kittitas County','Pennington County','Gage County','Luce County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '>10000' or\r          household_demographics.hd_buy_potential = '5001-10000')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Kittitas County','Pennington County','Gage County','Luce County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 254, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/254.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595589.064791
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:36", 
                    "startTimeFormat": "2019-12-06 09:26:29", 
                    "startTime": 1575595589.064887, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_255.sql", 
                    "second": 7.8494439125061035, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2001-5-01','yyyy-mm-dd') and \r\n            to_date('2001-5-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'OH'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2001-5-01','yyyy-mm-dd') and \r             to_date('2001-5-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'OH'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 255, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/255.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595596.914331
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:37", 
                    "startTimeFormat": "2019-12-06 09:26:36", 
                    "startTime": 1575595596.914434, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_256.sql", 
                    "second": 0.1613750457763672, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Summit'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  36675\r\n   and ib_upper_bound   <=  36675 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Summit'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  36675\r    and ib_upper_bound   <=  36675 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 256, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/256.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595597.075809
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:39", 
                    "startTimeFormat": "2019-12-06 09:26:37", 
                    "startTime": 1575595597.075916, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_257.sql", 
                    "second": 2.6162028312683105, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_login\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  1998\r\n   and t_s_secyear.dyear = 1998+1\r\n   and t_c_firstyear.dyear =  1998\r\n   and t_c_secyear.dyear =  1998+1\r\n   and t_w_firstyear.dyear = 1998\r\n   and t_w_secyear.dyear = 1998+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_login\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_login\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  1998\r    and t_s_secyear.dyear = 1998+1\r    and t_c_firstyear.dyear =  1998\r    and t_c_secyear.dyear =  1998+1\r    and t_w_firstyear.dyear = 1998\r    and t_w_secyear.dyear = 1998+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_login\r  ) where rownum <= 100;\r \r ", 
                    "id": 257, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/257.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595599.692119
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:39", 
                    "startTimeFormat": "2019-12-06 09:26:39", 
                    "startTime": 1575595599.692226, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_258.sql", 
                    "second": 0.10577797889709473, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 57 and 57 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2000-01-14' ,'yyyy-mm-dd') and to_date('2000-01-14' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (724,697,871,853)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 57 and 57 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2000-01-14' ,'yyyy-mm-dd') and to_date('2000-01-14' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (724,697,871,853)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 258, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/258.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595599.798004
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:40", 
                    "startTimeFormat": "2019-12-06 09:26:39", 
                    "startTime": 1575595599.798115, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_259.sql", 
                    "second": 0.7110140323638916, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  sum(cd_dep_count) s1,\r\n  avg(cd_dep_count) s2,\r\n  max(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  sum(cd_dep_employed_count) s4,\r\n  avg(cd_dep_employed_count) s5,\r\n  max(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  sum(cd_dep_college_count) s7,\r\n  avg(cd_dep_college_count) s8,\r\n  max(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   sum(cd_dep_count) s1,\r   avg(cd_dep_count) s2,\r   max(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   sum(cd_dep_employed_count) s4,\r   avg(cd_dep_employed_count) s5,\r   max(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   sum(cd_dep_college_count) s7,\r   avg(cd_dep_college_count) s8,\r   max(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 259, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/259.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595600.509129
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:40", 
                    "startTimeFormat": "2019-12-06 09:26:40", 
                    "startTime": 1575595600.509227, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_260.sql", 
                    "second": 0.3964390754699707, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2000-4-01','yyyy-mm-dd') and \r\n           to_date('2000-4-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'WA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2000-4-01','yyyy-mm-dd') and \r            to_date('2000-4-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'WA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 260, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/260.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595600.905666
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:41", 
                    "startTimeFormat": "2019-12-06 09:26:40", 
                    "startTime": 1575595600.905753, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_261.sql", 
                    "second": 0.47257399559020996, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1999-05-19','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1999-05-19','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('1999-05-19','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1999-05-19','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1999-05-19','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('1999-05-19','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 261, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/261.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595601.378327
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:41", 
                    "startTimeFormat": "2019-12-06 09:26:41", 
                    "startTime": 1575595601.37841, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_262.sql", 
                    "second": 0.25116491317749023, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 20\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 1\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 20\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 1\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 262, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/262.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595601.629575
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:41", 
                    "startTimeFormat": "2019-12-06 09:26:41", 
                    "startTime": 1575595601.629655, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_263.sql", 
                    "second": 0.23847103118896484, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Electronics', 'Music', 'Books')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('1998-01-02' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('1998-01-02' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Electronics', 'Music', 'Books')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('1998-01-02' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('1998-01-02' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 263, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/263.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595601.868126
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:42", 
                    "startTimeFormat": "2019-12-06 09:26:41", 
                    "startTime": 1575595601.868224, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_264.sql", 
                    "second": 0.4230949878692627, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,stddev_samp(ss_quantity)        as store_sales_quantity\r\n    ,stddev_samp(sr_return_quantity) as store_returns_quantity\r\n    ,stddev_samp(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 1999\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 1999\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (1999,1999+1,1999+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,stddev_samp(ss_quantity)        as store_sales_quantity\r     ,stddev_samp(sr_return_quantity) as store_returns_quantity\r     ,stddev_samp(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 1999\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 1999\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (1999,1999+1,1999+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 264, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/264.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595602.291319
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:48", 
                    "startTimeFormat": "2019-12-06 09:26:42", 
                    "startTime": 1575595602.291391, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_265.sql", 
                    "second": 6.496875047683716, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1178 and 1178 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1178 and 1178 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 265, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/265.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595608.788266
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:51", 
                    "startTimeFormat": "2019-12-06 09:26:48", 
                    "startTime": 1575595608.788354, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_266.sql", 
                    "second": 2.4364020824432373, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1187 and 1187+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1187 and 1187+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1187 and 1187+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1187 and 1187+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 266, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/266.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595611.224756
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:51", 
                    "startTimeFormat": "2019-12-06 09:26:51", 
                    "startTime": 1575595611.224859, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_267.sql", 
                    "second": 0.17580795288085938, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 2002 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('AL','NM','FL','LA',\r\n                 'LA','IN','LA','FL')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 2002 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('AL','NM','FL','LA',\r                  'LA','IN','LA','FL')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 267, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/267.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595611.400667
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:52", 
                    "startTimeFormat": "2019-12-06 09:26:51", 
                    "startTime": 1575595611.400756, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_268.sql", 
                    "second": 0.6407811641693115, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 2001 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 2001 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 268, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/268.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595612.041537
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:54", 
                    "startTimeFormat": "2019-12-06 09:26:52", 
                    "startTime": 1575595612.04162, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_269.sql", 
                    "second": 2.497483968734741, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('maroon','tomato','frosted','dark','beige','steel') and\r\n         i_current_price between 61 and 61 + 10 and\r\n         i_current_price between 61 + 1 and 61 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2001 and\r\n     cs2.syear = 2001 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('maroon','tomato','frosted','dark','beige','steel') and\r          i_current_price between 61 and 61 + 10 and\r          i_current_price between 61 + 1 and 61 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2001 and\r      cs2.syear = 2001 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 269, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/269.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595614.539104
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:54", 
                    "startTimeFormat": "2019-12-06 09:26:54", 
                    "startTime": 1575595614.539182, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_270.sql", 
                    "second": 0.16690397262573242, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Sports', 'Books', 'Home')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('2002-05-07' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('2002-05-07' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Sports', 'Books', 'Home')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('2002-05-07' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('2002-05-07' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 270, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/270.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595614.706086
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:55", 
                    "startTimeFormat": "2019-12-06 09:26:54", 
                    "startTime": 1575595614.706188, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_271.sql", 
                    "second": 0.9888401031494141, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 2000 or\r\n         ( d_year = 2000-1 and d_moy =12) or\r\n         ( d_year = 2000+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_category, v1.i_brand, v1.cc_name\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2000 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 2000 or\r          ( d_year = 2000-1 and d_moy =12) or\r          ( d_year = 2000+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_category, v1.i_brand, v1.cc_name\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2000 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 271, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/271.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595615.695028
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:58", 
                    "startTimeFormat": "2019-12-06 09:26:55", 
                    "startTime": 1575595615.695126, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_272.sql", 
                    "second": 2.587754964828491, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 26359783\r\n            then (select avg(ss_ext_sales_price) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 29121500\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 37830688\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 47331715\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 42181974\r\n            then (select avg(ss_ext_sales_price)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_paid)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 26359783\r             then (select avg(ss_ext_sales_price) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 29121500\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 37830688\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 47331715\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 42181974\r             then (select avg(ss_ext_sales_price)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_paid)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 272, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/272.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595618.282881
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:58", 
                    "startTimeFormat": "2019-12-06 09:26:58", 
                    "startTime": 1575595618.28299, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_273.sql", 
                    "second": 0.2762329578399658, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=12\r\n    and dt.d_year=2001\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=12\r     and dt.d_year=2001\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 273, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/273.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595618.559223
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:58", 
                    "startTimeFormat": "2019-12-06 09:26:58", 
                    "startTime": 1575595618.559321, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_274.sql", 
                    "second": 0.4087531566619873, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 11\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 11\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 11\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 11\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 11\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 11\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 274, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/274.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595618.968074
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:26:59", 
                    "startTimeFormat": "2019-12-06 09:26:58", 
                    "startTime": 1575595618.96815, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_275.sql", 
                    "second": 0.5390281677246094, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 275, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/275.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595619.507178
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:01", 
                    "startTimeFormat": "2019-12-06 09:26:59", 
                    "startTime": 1575595619.507269, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_276.sql", 
                    "second": 2.272428035736084, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '1001-5000'\r\n  and d1.d_year = 2000\r\n  and cd_marital_status = 'D'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '1001-5000'\r   and d1.d_year = 2000\r   and cd_marital_status = 'D'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 276, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/276.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595621.779697
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:02", 
                    "startTimeFormat": "2019-12-06 09:27:01", 
                    "startTime": 1575595621.779787, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_277.sql", 
                    "second": 1.174466848373413, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1179 and 1179 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1179 and 1179 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1179 and 1179 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1179 and 1179 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 277, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/277.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595622.954254
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:03", 
                    "startTimeFormat": "2019-12-06 09:27:02", 
                    "startTime": 1575595622.954333, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_278.sql", 
                    "second": 0.5365228652954102, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'S' and\r\n       cd_education_status = '4 yr Degree' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1999 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'S' and\r        cd_education_status = '4 yr Degree' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1999 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 278, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/278.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595623.490856
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:05", 
                    "startTimeFormat": "2019-12-06 09:27:03", 
                    "startTime": 1575595623.490942, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_279.sql", 
                    "second": 1.7806029319763184, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1222 and 1222 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1222 and 1222 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1222 and 1222 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1222 and 1222 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 279, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/279.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595625.271545
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:05", 
                    "startTimeFormat": "2019-12-06 09:27:05", 
                    "startTime": 1575595625.271632, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_280.sql", 
                    "second": 0.43831515312194824, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Home'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 5\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Home'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 5\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Home'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 5\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Home'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 5\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Home'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 5\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Home'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 5\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 280, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/280.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595625.709947
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:27:05", 
                    "startTime": 1575595625.710044, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_281.sql", 
                    "second": 0.5379681587219238, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 1 or household_demographics.hd_vehicle_count > 1)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 1 or household_demographics.hd_vehicle_count > 1)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (1999,1999+1,1999+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 281, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/281.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595626.248012
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:06", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.248121, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_282.sql", 
                    "second": 0.022752046585083008, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 468\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('2001-01-27','yyyy-mm-dd') and \r\n        to_date('2001-01-27','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('2001-01-27','yyyy-mm-dd') and\r\n                             to_date('2001-01-27','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 468\r and i_item_sk = cs_item_sk \r and d_date between to_date('2001-01-27','yyyy-mm-dd') and \r         to_date('2001-01-27','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('2001-01-27','yyyy-mm-dd') and\r                              to_date('2001-01-27','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 282, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/282.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595626.270873
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:09", 
                    "startTimeFormat": "2019-12-06 09:27:06", 
                    "startTime": 1575595626.270963, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_283.sql", 
                    "second": 3.3080430030822754, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_sold_year,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000\r\norder by \r\n  ss_sold_year,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_sold_year,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000\r order by \r   ss_sold_year,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 283, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/283.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595629.579006
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:10", 
                    "startTimeFormat": "2019-12-06 09:27:09", 
                    "startTime": 1575595629.579113, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_284.sql", 
                    "second": 0.6365199089050293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'F' and \r\n       cd1.cd_education_status = 'College' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (4,10,12,5,2,6) and\r\n       d_year = 1998 and\r\n       ca_state in ('MO','IL','GA'\r\n                   ,'MI','MN','AL','IA')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'F' and \r        cd1.cd_education_status = 'College' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (4,10,12,5,2,6) and\r        d_year = 1998 and\r        ca_state in ('MO','IL','GA'\r                    ,'MI','MN','AL','IA')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 284, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/284.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595630.215633
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:11", 
                    "startTimeFormat": "2019-12-06 09:27:10", 
                    "startTime": 1575595630.215737, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_285.sql", 
                    "second": 1.4323928356170654, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 285, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/285.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595631.64813
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:12", 
                    "startTimeFormat": "2019-12-06 09:27:11", 
                    "startTime": 1575595631.648216, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_286.sql", 
                    "second": 0.5527958869934082, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Jewelry'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 8\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Jewelry'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 8\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Jewelry'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 8\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Jewelry'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 8\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Jewelry'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 8\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Jewelry'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 8\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 286, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/286.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595632.201012
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:12", 
                    "startTimeFormat": "2019-12-06 09:27:12", 
                    "startTime": 1575595632.201097, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_287.sql", 
                    "second": 0.3693990707397461, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '501-1000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (2000,2000+1,2000+2)\r\n    and store.s_county in ('Raleigh County','Gage County','Franklin Parish','Luce County',\r\n                           'San Miguel County','Williamson County','Mobile County','Walker County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '501-1000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (2000,2000+1,2000+2)\r     and store.s_county in ('Raleigh County','Gage County','Franklin Parish','Luce County',\r                            'San Miguel County','Williamson County','Mobile County','Walker County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 287, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/287.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595632.570496
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:12", 
                    "startTimeFormat": "2019-12-06 09:27:12", 
                    "startTime": 1575595632.570602, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_288.sql", 
                    "second": 0.20702099800109863, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_sales_price) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 655\r\n   and dt.d_moy=11\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_sales_price) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 655\r    and dt.d_moy=11\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 288, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/288.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595632.777623
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:13", 
                    "startTimeFormat": "2019-12-06 09:27:12", 
                    "startTime": 1575595632.777711, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_289.sql", 
                    "second": 1.1132721900939941, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'D'\r\n  and cd_education_status = 'Advanced Degree'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'W'\r\n  and cd_education_status = '2 yr Degree'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = '4 yr Degree'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('LA', 'VA', 'TN')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('WI', 'IN', 'KS')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('AL', 'OH', 'NC')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'D'\r   and cd_education_status = 'Advanced Degree'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'W'\r   and cd_education_status = '2 yr Degree'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = '4 yr Degree'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('LA', 'VA', 'TN')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('WI', 'IN', 'KS')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('AL', 'OH', 'NC')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 289, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/289.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595633.890983
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:13", 
                    "startTime": 1575595633.891085, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_290.sql", 
                    "second": 0.13359618186950684, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 697 and 697+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'drab' or i_color = 'dim') and \r\n        (i_units = 'Oz' or i_units = 'Pallet') and\r\n        (i_size = 'economy' or i_size = 'extra large')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'puff' or i_color = 'deep') and\r\n        (i_units = 'Gram' or i_units = 'Dram') and\r\n        (i_size = 'small' or i_size = 'N/A')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'salmon' or i_color = 'mint') and\r\n        (i_units = 'Dozen' or i_units = 'N/A') and\r\n        (i_size = 'petite' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'steel' or i_color = 'slate') and\r\n        (i_units = 'Cup' or i_units = 'Ton') and\r\n        (i_size = 'economy' or i_size = 'extra large')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'pink' or i_color = 'metallic') and \r\n        (i_units = 'Gross' or i_units = 'Pound') and\r\n        (i_size = 'economy' or i_size = 'extra large')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'navajo' or i_color = 'thistle') and\r\n        (i_units = 'Carton' or i_units = 'Each') and\r\n        (i_size = 'small' or i_size = 'N/A')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'tan' or i_color = 'firebrick') and\r\n        (i_units = 'Tbl' or i_units = 'Case') and\r\n        (i_size = 'petite' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'purple' or i_color = 'magenta') and\r\n        (i_units = 'Unknown' or i_units = 'Ounce') and\r\n        (i_size = 'economy' or i_size = 'extra large')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 697 and 697+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'drab' or i_color = 'dim') and \r         (i_units = 'Oz' or i_units = 'Pallet') and\r         (i_size = 'economy' or i_size = 'extra large')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'puff' or i_color = 'deep') and\r         (i_units = 'Gram' or i_units = 'Dram') and\r         (i_size = 'small' or i_size = 'N/A')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'salmon' or i_color = 'mint') and\r         (i_units = 'Dozen' or i_units = 'N/A') and\r         (i_size = 'petite' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'steel' or i_color = 'slate') and\r         (i_units = 'Cup' or i_units = 'Ton') and\r         (i_size = 'economy' or i_size = 'extra large')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'pink' or i_color = 'metallic') and \r         (i_units = 'Gross' or i_units = 'Pound') and\r         (i_size = 'economy' or i_size = 'extra large')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'navajo' or i_color = 'thistle') and\r         (i_units = 'Carton' or i_units = 'Each') and\r         (i_size = 'small' or i_size = 'N/A')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'tan' or i_color = 'firebrick') and\r         (i_units = 'Tbl' or i_units = 'Case') and\r         (i_size = 'petite' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'purple' or i_color = 'magenta') and\r         (i_units = 'Unknown' or i_units = 'Ounce') and\r         (i_size = 'economy' or i_size = 'extra large')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 290, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/290.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595634.024681
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:14", 
                    "startTimeFormat": "2019-12-06 09:27:14", 
                    "startTime": 1575595634.024783, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_291.sql", 
                    "second": 0.021622180938720703, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 320\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2002-03-26','yyyy-mm-dd') and \r\n        to_date('2002-03-26','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2002-03-26','yyyy-mm-dd') and\r\n                             to_date('2002-03-26','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 320\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2002-03-26','yyyy-mm-dd') and \r         to_date('2002-03-26','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2002-03-26','yyyy-mm-dd') and\r                              to_date('2002-03-26','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 291, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/291.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595634.046405
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:15", 
                    "startTimeFormat": "2019-12-06 09:27:14", 
                    "startTime": 1575595634.046488, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_292.sql", 
                    "second": 1.1430518627166748, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,avg(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (1999,1999+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,avg(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (1999,1999+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 1999\r\n         and t_s_secyear.year = 1999+1\r\n         and t_w_firstyear.year = 1999\r\n         and t_w_secyear.year = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 1,2,3\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,avg(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (1999,1999+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,avg(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (1999,1999+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 1999\r          and t_s_secyear.year = 1999+1\r          and t_w_firstyear.year = 1999\r          and t_w_secyear.year = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 1,2,3\r  ) where rownum <= 100;\r \r ", 
                    "id": 292, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/292.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595635.18954
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:15", 
                    "startTimeFormat": "2019-12-06 09:27:15", 
                    "startTime": 1575595635.18963, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_293.sql", 
                    "second": 0.07594490051269531, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 0 or\r\n         household_demographics.hd_vehicle_count= 3)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (1998,1998+1,1998+2) \r\n    and store.s_city in ('Walnut Grove','Franklin','Mount Vernon','Concord','Mount Olive') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 0 or\r          household_demographics.hd_vehicle_count= 3)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (1998,1998+1,1998+2) \r     and store.s_city in ('Walnut Grove','Franklin','Mount Vernon','Concord','Mount Olive') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 293, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/293.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595635.265575
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:15", 
                    "startTimeFormat": "2019-12-06 09:27:15", 
                    "startTime": 1575595635.265663, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_294.sql", 
                    "second": 0.3698761463165283, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (1999) and\r\n        ((i_category in ('Home','Electronics','Men') and\r\n          i_class in ('flatware','audio','shirts')\r\n         )\r\n      or (i_category in ('Women','Sports','Shoes') and\r\n          i_class in ('fragrances','optics','athletic') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (1999) and\r         ((i_category in ('Home','Electronics','Men') and\r           i_class in ('flatware','audio','shirts')\r          )\r       or (i_category in ('Women','Sports','Shoes') and\r           i_class in ('fragrances','optics','athletic') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 294, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/294.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595635.635539
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:17", 
                    "startTimeFormat": "2019-12-06 09:27:15", 
                    "startTime": 1575595635.635625, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_295.sql", 
                    "second": 2.216618061065674, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.i_category\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.i_category\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 295, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/295.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595637.852243
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:18", 
                    "startTimeFormat": "2019-12-06 09:27:17", 
                    "startTime": 1575595637.85235, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_296.sql", 
                    "second": 0.6384539604187012, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'BARIAN' || ',' || 'GERMA' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2002\r\n \tand t_time between 23581 and 23581+28800 \r\n \tand sm_carrier in ('BARIAN','GERMA')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'BARIAN' || ',' || 'GERMA' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2002\r\n \tand t_time between 23581 AND 23581+28800 \r\n \tand sm_carrier in ('BARIAN','GERMA')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'BARIAN' || ',' || 'GERMA' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2002\r  \tand t_time between 23581 and 23581+28800 \r  \tand sm_carrier in ('BARIAN','GERMA')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'BARIAN' || ',' || 'GERMA' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2002\r  \tand t_time between 23581 AND 23581+28800 \r  \tand sm_carrier in ('BARIAN','GERMA')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 296, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/296.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595638.490804
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:27:19", 
                    "startTimeFormat": "2019-12-06 09:27:18", 
                    "startTime": 1575595638.490901, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_297.sql", 
                    "second": 1.1768670082092285, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_2.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2002\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = '2 yr Degree'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'M'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'W'\r\n   and \r\n   cd_education_status = 'College'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('NJ', 'NY', 'AK')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('WY', 'ID', 'SC')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('GA', 'PA', 'OH')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2002\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = '2 yr Degree'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'M'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'W'\r    and \r    cd_education_status = 'College'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('NJ', 'NY', 'AK')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('WY', 'ID', 'SC')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('GA', 'PA', 'OH')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 297, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/297.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_2.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595639.667768
                }
            ], 
            "second": 153.57641792297363, 
            "startTime": 1575595486.091458, 
            "endTime": 1575595639.667876
        }
    }, 
    "ThroughputRun2": {
        "endTimeFormat": "2019-12-06 09:32:21", 
        "startTimeFormat": "2019-12-06 09:29:44", 
        "endTime": 1575595941.512911, 
        "query_8.sql": {
            "endTimeFormat": "2019-12-06 09:32:08", 
            "startTimeFormat": "2019-12-06 09:29:44", 
            "secondFormat": "00:02:24", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:44", 
                    "startTime": 1575595784.040382, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_793.sql", 
                    "second": 1.5368621349334717, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 2000 or\r\n         ( d_year = 2000-1 and d_moy =12) or\r\n         ( d_year = 2000+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_brand\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2000 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 2000 or\r          ( d_year = 2000-1 and d_moy =12) or\r          ( d_year = 2000+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_brand\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2000 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 793, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/793.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595785.577244
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:46", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.577327, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_794.sql", 
                    "second": 0.462954044342041, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,max(ss_quantity)        as store_sales_quantity\r\n    ,max(sr_return_quantity) as store_returns_quantity\r\n    ,max(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 2000\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 2000\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (2000,2000+1,2000+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,max(ss_quantity)        as store_sales_quantity\r     ,max(sr_return_quantity) as store_returns_quantity\r     ,max(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 2000\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 2000\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (2000,2000+1,2000+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 794, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/794.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595786.040281
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:46", 
                    "startTime": 1575595786.040379, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_795.sql", 
                    "second": 2.196665048599243, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=6\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'lace'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 6\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'peru'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=6\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'lace'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 6\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'peru'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 795, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/795.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595788.237044
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.237144, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_796.sql", 
                    "second": 0.5631849765777588, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_customer_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_bill_customer_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_bill_customer_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_warehouse_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_warehouse_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_customer_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_bill_customer_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_bill_customer_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_warehouse_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_warehouse_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 796, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/796.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595788.800329
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.80048, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_797.sql", 
                    "second": 0.09260416030883789, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 59 and 59 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1999-01-16' ,'yyyy-mm-dd') and to_date('1999-01-16' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (770,795,668,932)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 59 and 59 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1999-01-16' ,'yyyy-mm-dd') and to_date('1999-01-16' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (770,795,668,932)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 797, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/797.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595788.893084
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.893184, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_798.sql", 
                    "second": 0.2898399829864502, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'GREAT EASTERN' || ',' || 'MSC' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_paid * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 1998\r\n \tand t_time between 33596 and 33596+28800 \r\n \tand sm_carrier in ('GREAT EASTERN','MSC')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'GREAT EASTERN' || ',' || 'MSC' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 1998\r\n \tand t_time between 33596 AND 33596+28800 \r\n \tand sm_carrier in ('GREAT EASTERN','MSC')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'GREAT EASTERN' || ',' || 'MSC' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_paid * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_paid * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_paid * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_paid * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 1998\r  \tand t_time between 33596 and 33596+28800 \r  \tand sm_carrier in ('GREAT EASTERN','MSC')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'GREAT EASTERN' || ',' || 'MSC' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 1998\r  \tand t_time between 33596 AND 33596+28800 \r  \tand sm_carrier in ('GREAT EASTERN','MSC')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 798, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/798.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595789.183024
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.183102, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_799.sql", 
                    "second": 0.5230941772460938, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 10\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 10\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 10\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 10\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 10\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 10\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 799, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/799.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595789.706196
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:50", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.70629, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_800.sql", 
                    "second": 0.3906700611114502, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Electronics', 'Jewelry', 'Music')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2000-03-07' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2000-03-07' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Electronics', 'Jewelry', 'Music')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2000-03-07' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2000-03-07' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 800, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/800.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595790.09696
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:51", 
                    "startTimeFormat": "2019-12-06 09:29:50", 
                    "startTime": 1575595790.097035, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_801.sql", 
                    "second": 0.930915117263794, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-26','yyyy-mm-dd') \r\n                  and to_date('1998-08-26','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-26','yyyy-mm-dd') \r\n                  and to_date('1998-08-26','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-26','yyyy-mm-dd') \r\n                  and to_date('1998-08-26','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-26','yyyy-mm-dd') \r                   and to_date('1998-08-26','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-26','yyyy-mm-dd') \r                   and to_date('1998-08-26','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-26','yyyy-mm-dd') \r                   and to_date('1998-08-26','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 801, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/801.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595791.02795
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:51", 
                    "startTimeFormat": "2019-12-06 09:29:51", 
                    "startTime": 1575595791.028056, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_802.sql", 
                    "second": 0.12760519981384277, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Electronics', 'Men', 'Jewelry')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('1999-01-14' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('1999-01-14' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Electronics', 'Men', 'Jewelry')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('1999-01-14' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('1999-01-14' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 802, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/802.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595791.155661
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:52", 
                    "startTimeFormat": "2019-12-06 09:29:51", 
                    "startTime": 1575595791.155794, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_803.sql", 
                    "second": 1.8094019889831543, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1190 and 1190 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1190+ 12 and 1190 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1190 and 1190 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1190+ 12 and 1190 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 803, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/803.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595792.965196
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:54", 
                    "startTimeFormat": "2019-12-06 09:29:52", 
                    "startTime": 1575595792.965287, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_804.sql", 
                    "second": 1.125615119934082, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1179 and 1179 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1179 and 1179 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1179 and 1179 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1179 and 1179 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 804, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/804.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595794.090902
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:54", 
                    "startTimeFormat": "2019-12-06 09:29:54", 
                    "startTime": 1575595794.090988, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_805.sql", 
                    "second": 0.1775810718536377, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 1999 \r\nand     d_moy                   = 12\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like '501-1000%'\r\nand     ca_gmt_offset           = -7\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 1999 \r and     d_moy                   = 12\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like '501-1000%'\r and     ca_gmt_offset           = -7\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 805, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/805.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595794.268569
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:54", 
                    "startTimeFormat": "2019-12-06 09:29:54", 
                    "startTime": 1575595794.268672, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_806.sql", 
                    "second": 0.5873470306396484, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('OK','TX','VA') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 4 and 4+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 4 and 4+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 4 and 4+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('OK','TX','VA') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 4 and 4+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 4 and 4+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 4 and 4+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 806, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/806.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595794.856019
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:55", 
                    "startTimeFormat": "2019-12-06 09:29:54", 
                    "startTime": 1575595794.856116, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_807.sql", 
                    "second": 0.17326593399047852, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('2002-06-22','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('2002-06-22','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('2002-06-22','yyyy-mm-dd') - 30 )\r\n                and (to_date ('2002-06-22','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('2002-06-22','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('2002-06-22','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('2002-06-22','yyyy-mm-dd') - 30 )\r                 and (to_date ('2002-06-22','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 807, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/807.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595795.029382
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:56", 
                    "startTimeFormat": "2019-12-06 09:29:55", 
                    "startTime": 1575595795.029468, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_808.sql", 
                    "second": 1.3457598686218262, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 808, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/808.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595796.375228
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:57", 
                    "startTimeFormat": "2019-12-06 09:29:56", 
                    "startTime": 1575595796.375328, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_809.sql", 
                    "second": 0.6586329936981201, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2001-3-01','yyyy-mm-dd') and \r\n           (to_date('2001-3-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'NC'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Dauphin County','Williamson County','Barrow County','San Miguel County',\r\n                  'Pennington County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2001-3-01','yyyy-mm-dd') and \r            (to_date('2001-3-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'NC'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Dauphin County','Williamson County','Barrow County','San Miguel County',\r                   'Pennington County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 809, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/809.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595797.033961
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:57", 
                    "startTimeFormat": "2019-12-06 09:29:57", 
                    "startTime": 1575595797.034053, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_810.sql", 
                    "second": 0.22898101806640625, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 166\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 166\r\n                                                    and ss_hdemo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 166\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 166\r\n                                                    and ss_hdemo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 166\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 166\r                                                     and ss_hdemo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 166\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 166\r                                                     and ss_hdemo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 810, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/810.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595797.263034
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:58", 
                    "startTimeFormat": "2019-12-06 09:29:57", 
                    "startTime": 1575595797.263135, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_811.sql", 
                    "second": 1.3184731006622314, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('1998-08-15','yyyy-mm-dd') \r\n                  and to_date('1998-08-15','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-15','yyyy-mm-dd') \r\n                  and to_date('1998-08-15','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-15','yyyy-mm-dd') \r\n                  and to_date('1998-08-15','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('1998-08-15','yyyy-mm-dd') \r                   and to_date('1998-08-15','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('1998-08-15','yyyy-mm-dd') \r                   and to_date('1998-08-15','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('1998-08-15','yyyy-mm-dd') \r                   and to_date('1998-08-15','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 811, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/811.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595798.581608
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:58", 
                    "startTimeFormat": "2019-12-06 09:29:58", 
                    "startTime": 1575595798.581709, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_812.sql", 
                    "second": 0.08214497566223145, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = '5001-10000')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Fairfield County','Levy County','Pennington County','Jefferson Davis Parish')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = '5001-10000')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Fairfield County','Levy County','Pennington County','Jefferson Davis Parish')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 812, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/812.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595798.663854
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:11", 
                    "startTimeFormat": "2019-12-06 09:29:58", 
                    "startTime": 1575595798.663945, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_813.sql", 
                    "second": 13.160675048828125, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1998 AND 1998 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1998 AND 1998 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1998 AND 1998 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 1998+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 1998+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 1998+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1998 AND 1998 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1998 AND 1998 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1998 AND 1998 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1998 and 1998 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1998 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 17)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1998\r\n                       and d_moy = 12\r\n                       and d_dom = 17)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1998 AND 1998 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1998 AND 1998 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1998 AND 1998 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 1998+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 1998+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 1998+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1998 AND 1998 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1998 AND 1998 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1998 AND 1998 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1998 and 1998 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1998 + 1\r                        and d_moy = 12\r                        and d_dom = 17)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1998\r                        and d_moy = 12\r                        and d_dom = 17)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 813, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/813.sql", 
                    "secondFormat": "00:00:13", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595811.82462
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:12", 
                    "startTimeFormat": "2019-12-06 09:30:11", 
                    "startTime": 1575595811.824711, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_814.sql", 
                    "second": 0.689741849899292, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=1998\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=1998\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=1998\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=11\r                    and d_year=1998\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=11\r                    and d_year=1998\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=11\r                    and d_year=1998\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 814, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/814.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595812.514453
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:12", 
                    "startTimeFormat": "2019-12-06 09:30:12", 
                    "startTime": 1575595812.514553, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_815.sql", 
                    "second": 0.2620809078216553, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_ext_discount_amt) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 302\r\n   and dt.d_moy=11\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_ext_discount_amt) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 302\r    and dt.d_moy=11\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 815, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/815.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595812.776634
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:13", 
                    "startTimeFormat": "2019-12-06 09:30:12", 
                    "startTime": 1575595812.776729, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_816.sql", 
                    "second": 0.4101688861846924, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 12\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 12\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2000\r\n                         and d_moy = 12\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 12\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 12\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2000\r                          and d_moy = 12\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 816, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/816.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595813.186898
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:13", 
                    "startTimeFormat": "2019-12-06 09:30:13", 
                    "startTime": 1575595813.186996, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_817.sql", 
                    "second": 0.1560819149017334, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Green Acres'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  19797\r\n   and ib_upper_bound   <=  19797 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Green Acres'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  19797\r    and ib_upper_bound   <=  19797 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 817, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/817.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595813.343078
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:16", 
                    "startTimeFormat": "2019-12-06 09:30:13", 
                    "startTime": 1575595813.343185, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_818.sql", 
                    "second": 2.6853301525115967, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('powder','turquoise','sandy','linen','saddle','papaya') and\r\n         i_current_price between 25 and 25 + 10 and\r\n         i_current_price between 25 + 1 and 25 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2000 and\r\n     cs2.syear = 2000 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('powder','turquoise','sandy','linen','saddle','papaya') and\r          i_current_price between 25 and 25 + 10 and\r          i_current_price between 25 + 1 and 25 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2000 and\r      cs2.syear = 2000 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 818, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/818.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595816.028515
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:16", 
                    "startTimeFormat": "2019-12-06 09:30:16", 
                    "startTime": 1575595816.028599, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_819.sql", 
                    "second": 0.5667669773101807, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'D' and\r\n       cd_education_status = 'College' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2002 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'D' and\r        cd_education_status = 'College' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2002 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 819, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/819.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595816.595366
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:16", 
                    "startTimeFormat": "2019-12-06 09:30:16", 
                    "startTime": 1575595816.59545, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_820.sql", 
                    "second": 0.24526405334472656, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 2002 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('OH','AL','MN','PA',\r\n                 'GA','MI','NY','LA')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 2002 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('OH','AL','MN','PA',\r                  'GA','MI','NY','LA')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 820, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/820.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595816.840714
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:16", 
                    "startTimeFormat": "2019-12-06 09:30:16", 
                    "startTime": 1575595816.840816, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_821.sql", 
                    "second": 0.10271906852722168, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -6\r\n   and   i_category = 'Sports'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -6\r\n   and   d_year = 2001\r\n   and   d_moy  = 11) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -6\r\n   and   i_category = 'Sports'\r\n   and   s_gmt_offset = -6\r\n   and   d_year = 2001\r\n   and   d_moy  = 11) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -6\r    and   i_category = 'Sports'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -6\r    and   d_year = 2001\r    and   d_moy  = 11) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -6\r    and   i_category = 'Sports'\r    and   s_gmt_offset = -6\r    and   d_year = 2001\r    and   d_moy  = 11) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 821, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/821.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595816.943535
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:17", 
                    "startTimeFormat": "2019-12-06 09:30:16", 
                    "startTime": 1575595816.943639, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_822.sql", 
                    "second": 0.13298988342285156, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 822 and 822+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'metallic' or i_color = 'dim') and \r\n        (i_units = 'Dram' or i_units = 'Unknown') and\r\n        (i_size = 'petite' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'red' or i_color = 'azure') and\r\n        (i_units = 'Tsp' or i_units = 'Oz') and\r\n        (i_size = 'N/A' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'navajo' or i_color = 'moccasin') and\r\n        (i_units = 'Lb' or i_units = 'Carton') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'almond' or i_color = 'plum') and\r\n        (i_units = 'Ton' or i_units = 'Each') and\r\n        (i_size = 'petite' or i_size = 'small')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'lavender' or i_color = 'steel') and \r\n        (i_units = 'Bunch' or i_units = 'Dozen') and\r\n        (i_size = 'petite' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'dark' or i_color = 'lace') and\r\n        (i_units = 'Cup' or i_units = 'Box') and\r\n        (i_size = 'N/A' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'cornsilk' or i_color = 'burnished') and\r\n        (i_units = 'Pallet' or i_units = 'N/A') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'turquoise' or i_color = 'cream') and\r\n        (i_units = 'Pound' or i_units = 'Gross') and\r\n        (i_size = 'petite' or i_size = 'small')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 822 and 822+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'metallic' or i_color = 'dim') and \r         (i_units = 'Dram' or i_units = 'Unknown') and\r         (i_size = 'petite' or i_size = 'small')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'red' or i_color = 'azure') and\r         (i_units = 'Tsp' or i_units = 'Oz') and\r         (i_size = 'N/A' or i_size = 'large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'navajo' or i_color = 'moccasin') and\r         (i_units = 'Lb' or i_units = 'Carton') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'almond' or i_color = 'plum') and\r         (i_units = 'Ton' or i_units = 'Each') and\r         (i_size = 'petite' or i_size = 'small')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'lavender' or i_color = 'steel') and \r         (i_units = 'Bunch' or i_units = 'Dozen') and\r         (i_size = 'petite' or i_size = 'small')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'dark' or i_color = 'lace') and\r         (i_units = 'Cup' or i_units = 'Box') and\r         (i_size = 'N/A' or i_size = 'large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'cornsilk' or i_color = 'burnished') and\r         (i_units = 'Pallet' or i_units = 'N/A') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'turquoise' or i_color = 'cream') and\r         (i_units = 'Pound' or i_units = 'Gross') and\r         (i_size = 'petite' or i_size = 'small')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 822, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/822.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595817.076629
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:17", 
                    "startTimeFormat": "2019-12-06 09:30:17", 
                    "startTime": 1575595817.076728, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_823.sql", 
                    "second": 0.7491788864135742, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  max(cd_dep_count) s1,\r\n  sum(cd_dep_count) s2,\r\n  max(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  max(cd_dep_employed_count) s4,\r\n  sum(cd_dep_employed_count) s5,\r\n  max(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  max(cd_dep_college_count) s7,\r\n  sum(cd_dep_college_count) s8,\r\n  max(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   max(cd_dep_count) s1,\r   sum(cd_dep_count) s2,\r   max(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   max(cd_dep_employed_count) s4,\r   sum(cd_dep_employed_count) s5,\r   max(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   max(cd_dep_college_count) s7,\r   sum(cd_dep_college_count) s8,\r   max(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 823, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/823.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595817.825907
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:18", 
                    "startTimeFormat": "2019-12-06 09:30:17", 
                    "startTime": 1575595817.825994, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_824.sql", 
                    "second": 0.35913705825805664, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 2000\r\nand d2.d_moy  = 9\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 2000\r and d2.d_moy  = 9\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 824, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/824.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595818.185131
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:19", 
                    "startTimeFormat": "2019-12-06 09:30:18", 
                    "startTime": 1575595818.185214, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_825.sql", 
                    "second": 0.8565218448638916, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1188 and 1188+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 825, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/825.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595819.041736
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:21", 
                    "startTimeFormat": "2019-12-06 09:30:19", 
                    "startTime": 1575595819.041843, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_826.sql", 
                    "second": 2.1810901165008545, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1216 and 1216+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1216 and 1216+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1216 and 1216+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1216 and 1216+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 826, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/826.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595821.222933
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:24", 
                    "startTimeFormat": "2019-12-06 09:30:21", 
                    "startTime": 1575595821.223025, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_827.sql", 
                    "second": 3.15777587890625, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_sold_year,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r\norder by \r\n  ss_sold_year,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_sold_year,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r order by \r   ss_sold_year,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 827, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/827.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595824.380801
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:24", 
                    "startTimeFormat": "2019-12-06 09:30:24", 
                    "startTime": 1575595824.380898, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_828.sql", 
                    "second": 0.2099170684814453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('2000-04-12' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('2000-04-12' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('2000-04-12' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('2000-04-12' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('2000-04-12' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('2000-04-12' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('2000-04-12' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('2000-04-12' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 828, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/828.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595824.590815
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:31", 
                    "startTimeFormat": "2019-12-06 09:30:24", 
                    "startTime": 1575595824.590927, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_829.sql", 
                    "second": 6.956143140792847, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1218 and 1218+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1218 and 1218+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 829, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/829.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595831.54707
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:31", 
                    "startTime": 1575595831.547195, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_830.sql", 
                    "second": 4.756137132644653, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1215 and 1215 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1215 and 1215 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 830, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/830.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595836.303332
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.303439, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_831.sql", 
                    "second": 0.022886037826538086, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =1999\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MI'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =1999\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MI'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 831, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/831.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595836.326325
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.326435, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_832.sql", 
                    "second": 0.04718494415283203, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 37') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 37') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 832, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/832.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595836.37362
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:37", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.373713, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_833.sql", 
                    "second": 0.6793279647827148, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,max(ss_net_profit) as store_sales_profit\r\n ,max(sr_net_loss) as store_returns_loss\r\n ,max(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 1999\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 1999\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 1999\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,max(ss_net_profit) as store_sales_profit\r  ,max(sr_net_loss) as store_returns_loss\r  ,max(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 1999\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 1999\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 1999\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 833, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/833.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595837.053041
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:37", 
                    "startTimeFormat": "2019-12-06 09:30:37", 
                    "startTime": 1575595837.053143, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_834.sql", 
                    "second": 0.35002803802490234, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'D' and\r\n       cd_education_status = 'Secondary' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1999 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'D' and\r        cd_education_status = 'Secondary' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1999 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 834, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/834.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595837.403171
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:37", 
                    "startTimeFormat": "2019-12-06 09:30:37", 
                    "startTime": 1575595837.40327, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_835.sql", 
                    "second": 0.12927699089050293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 11 and 11+1\r\n         and household_demographics.hd_dep_count = 9\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 17 and 17+1\r\n         and household_demographics.hd_dep_count = 9\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 11 and 11+1\r          and household_demographics.hd_dep_count = 9\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 17 and 17+1\r          and household_demographics.hd_dep_count = 9\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 835, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/835.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595837.532547
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:39", 
                    "startTimeFormat": "2019-12-06 09:30:37", 
                    "startTime": 1575595837.532645, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_836.sql", 
                    "second": 2.1150929927825928, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (1998,1998+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (1998,1998+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 1998\r\n         and t_s_secyear.year = 1998+1\r\n         and t_w_firstyear.year = 1998\r\n         and t_w_secyear.year = 1998+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 3,1,2\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (1998,1998+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (1998,1998+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 1998\r          and t_s_secyear.year = 1998+1\r          and t_w_firstyear.year = 1998\r          and t_w_secyear.year = 1998+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 3,1,2\r  ) where rownum <= 100;\r \r ", 
                    "id": 836, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/836.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595839.647738
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:39", 
                    "startTimeFormat": "2019-12-06 09:30:39", 
                    "startTime": 1575595839.647839, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_837.sql", 
                    "second": 0.021432876586914062, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 467\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2002-02-25','yyyy-mm-dd') and \r\n        to_date('2002-02-25','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2002-02-25','yyyy-mm-dd') and\r\n                             to_date('2002-02-25','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 467\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2002-02-25','yyyy-mm-dd') and \r         to_date('2002-02-25','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2002-02-25','yyyy-mm-dd') and\r                              to_date('2002-02-25','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 837, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/837.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595839.669272
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:40", 
                    "startTimeFormat": "2019-12-06 09:30:39", 
                    "startTime": 1575595839.669357, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_838.sql", 
                    "second": 1.1343660354614258, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Women'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Women'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Women') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2002\r\n   AND prev_yr.d_year=2002-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Women'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Women'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Women') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2002\r    AND prev_yr.d_year=2002-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 838, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/838.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595840.803723
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:41", 
                    "startTimeFormat": "2019-12-06 09:30:40", 
                    "startTime": 1575595840.803826, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_839.sql", 
                    "second": 0.4438459873199463, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Warren County','Kittitas County','Benewah County','Barton County','Brunswick County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 1999 and\r\n                d_moy between 2 and 2+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 1999 and\r\n                  d_moy between 2 and 2+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 1999 and\r\n                  d_moy between 2 and 2+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Warren County','Kittitas County','Benewah County','Barton County','Brunswick County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 1999 and\r                 d_moy between 2 and 2+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 1999 and\r                   d_moy between 2 and 2+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 1999 and\r                   d_moy between 2 and 2+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 839, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/839.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595841.247672
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:41", 
                    "startTimeFormat": "2019-12-06 09:30:41", 
                    "startTime": 1575595841.247762, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_840.sql", 
                    "second": 0.4218270778656006, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1998-02-21','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1998-02-21','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('1998-02-21','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1998-02-21','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1998-02-21','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('1998-02-21','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 840, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/840.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595841.669589
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:14", 
                    "startTimeFormat": "2019-12-06 09:30:41", 
                    "startTime": 1575595841.669689, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_841.sql", 
                    "second": 32.89430904388428, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 2000\r\n \t        and d_moy = 3 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 2000\r  \t        and d_moy = 3 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 841, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/841.sql", 
                    "secondFormat": "00:00:32", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595874.563998
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:16", 
                    "startTimeFormat": "2019-12-06 09:31:14", 
                    "startTime": 1575595874.56411, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_842.sql", 
                    "second": 2.360707998275757, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 842, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/842.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595876.924818
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:16", 
                    "startTimeFormat": "2019-12-06 09:31:16", 
                    "startTime": 1575595876.924919, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_843.sql", 
                    "second": 0.021828174591064453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =1999\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'ID'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =1999\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'ID'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 843, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/843.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595876.946747
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:17", 
                    "startTimeFormat": "2019-12-06 09:31:16", 
                    "startTime": 1575595876.946853, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_844.sql", 
                    "second": 0.3998880386352539, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2001-4-01','yyyy-mm-dd') and \r\n           to_date('2001-4-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'KS'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2001-4-01','yyyy-mm-dd') and \r            to_date('2001-4-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'KS'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 844, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/844.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595877.346741
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:19", 
                    "startTimeFormat": "2019-12-06 09:31:17", 
                    "startTime": 1575595877.346842, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_845.sql", 
                    "second": 1.7880208492279053, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1193 and 1193 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1193 and 1193 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1193 and 1193 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1193 and 1193 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 845, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/845.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595879.134863
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:19", 
                    "startTimeFormat": "2019-12-06 09:31:19", 
                    "startTime": 1575595879.134945, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_846.sql", 
                    "second": 0.2175741195678711, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=75\r\n \tand d_moy=12\r\n \tand d_year=2002\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=75\r  \tand d_moy=12\r  \tand d_year=2002\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 846, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/846.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595879.352519
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:21", 
                    "startTimeFormat": "2019-12-06 09:31:19", 
                    "startTime": 1575595879.352618, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_847.sql", 
                    "second": 2.291882038116455, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '501-1000'\r\n  and d1.d_year = 2000\r\n  and cd_marital_status = 'S'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '501-1000'\r   and d1.d_year = 2000\r   and cd_marital_status = 'S'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 847, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/847.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595881.6445
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:33", 
                    "startTimeFormat": "2019-12-06 09:31:21", 
                    "startTime": 1575595881.64459, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_848.sql", 
                    "second": 11.412134170532227, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-3-01','yyyy-mm-dd') and \r\n            to_date('2002-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'IA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-3-01','yyyy-mm-dd') and \r             to_date('2002-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'IA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 848, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/848.sql", 
                    "secondFormat": "00:00:11", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595893.056724
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:33", 
                    "startTimeFormat": "2019-12-06 09:31:33", 
                    "startTime": 1575595893.056864, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_849.sql", 
                    "second": 0.30556607246398926, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1205 and 1205+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1205 and 1205+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 849, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/849.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595893.36243
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:34", 
                    "startTimeFormat": "2019-12-06 09:31:33", 
                    "startTime": 1575595893.362529, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_850.sql", 
                    "second": 1.4769830703735352, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=4\r\n  and inv2.d_moy=4+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2001\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=4\r\n  and inv2.d_moy=4+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=4\r   and inv2.d_moy=4+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2001\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=4\r   and inv2.d_moy=4+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 850, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/850.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595894.839512
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:34", 
                    "startTime": 1575595894.839612, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_851.sql", 
                    "second": 0.5033190250396729, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '2001Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '2001Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 851, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/851.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595895.342931
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.34303, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_852.sql", 
                    "second": 0.4925649166107178, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=12\r\n \tand dt.d_year=2000\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=12\r  \tand dt.d_year=2000\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 852, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/852.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595895.835595
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:36", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.835697, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_853.sql", 
                    "second": 0.7760591506958008, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'D'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Advanced Degree'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'W'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'College' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'S'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Primary'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('PA', 'SC', 'NH')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('MS', 'ME', 'OK')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('NC', 'IL', 'KY')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 2000\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'D'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Advanced Degree'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'W'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'College' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'S'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Primary'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('PA', 'SC', 'NH')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('MS', 'ME', 'OK')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('NC', 'IL', 'KY')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 853, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/853.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595896.611756
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:38", 
                    "startTimeFormat": "2019-12-06 09:31:36", 
                    "startTime": 1575595896.611866, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_854.sql", 
                    "second": 2.2392020225524902, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 8884535\r\n            then (select avg(ss_ext_discount_amt) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_paid_inc_tax)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 32288809\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_paid_inc_tax)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 15796937\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_paid_inc_tax)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 39968203\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_paid_inc_tax)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 291845\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_paid_inc_tax)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 8884535\r             then (select avg(ss_ext_discount_amt) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_paid_inc_tax)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 32288809\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_paid_inc_tax)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 15796937\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_paid_inc_tax)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 39968203\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_paid_inc_tax)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 291845\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_paid_inc_tax)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 854, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/854.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595898.851068
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:38", 
                    "startTimeFormat": "2019-12-06 09:31:38", 
                    "startTime": 1575595898.85117, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_855.sql", 
                    "second": 0.023007869720458984, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 69\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('2002-03-15','yyyy-mm-dd') and \r\n        to_date('2002-03-15','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('2002-03-15','yyyy-mm-dd') and\r\n                             to_date('2002-03-15','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 69\r and i_item_sk = cs_item_sk \r and d_date between to_date('2002-03-15','yyyy-mm-dd') and \r         to_date('2002-03-15','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('2002-03-15','yyyy-mm-dd') and\r                              to_date('2002-03-15','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 855, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/855.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595898.874178
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:39", 
                    "startTimeFormat": "2019-12-06 09:31:38", 
                    "startTime": 1575595898.874279, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_856.sql", 
                    "second": 0.3827390670776367, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = 'Unknown')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Mesa County','Barrow County','Pennington County','Gage County',\r\n                           'Daviess County','Williamson County','Kittitas County','Ziebach County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = 'Unknown')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Mesa County','Barrow County','Pennington County','Gage County',\r                            'Daviess County','Williamson County','Kittitas County','Ziebach County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 856, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/856.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595899.257018
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:39", 
                    "startTimeFormat": "2019-12-06 09:31:39", 
                    "startTime": 1575595899.257119, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_857.sql", 
                    "second": 0.6297199726104736, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 7 or household_demographics.hd_vehicle_count > 0)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 7 or household_demographics.hd_vehicle_count > 0)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 857, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/857.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595899.886839
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:40", 
                    "startTimeFormat": "2019-12-06 09:31:39", 
                    "startTime": 1575595899.886927, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_858.sql", 
                    "second": 0.7038202285766602, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Men'\r\n         and i_class = 'sports-apparel'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 7\r\n         and d_year = 2000\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2000 and d_moy = 7)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2000 and d_moy = 7)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Men'\r          and i_class = 'sports-apparel'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 7\r          and d_year = 2000\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2000 and d_moy = 7)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2000 and d_moy = 7)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 858, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/858.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595900.590747
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:41", 
                    "startTimeFormat": "2019-12-06 09:31:40", 
                    "startTime": 1575595900.590865, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_859.sql", 
                    "second": 1.2610561847686768, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-17','yyyy-mm-dd') \r\n                  and to_date('1999-08-17','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('1999-08-17','yyyy-mm-dd') \r\n                  and to_date('1999-08-17','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r\n                  and  to_date('1999-08-17','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r\n                  and  to_date('1999-08-17','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r\n                  and  to_date('1999-08-17','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r\n                  and  to_date('1999-08-17','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1999-08-17','yyyy-mm-dd') \r                   and to_date('1999-08-17','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('1999-08-17','yyyy-mm-dd') \r                   and to_date('1999-08-17','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r                   and  to_date('1999-08-17','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r                   and  to_date('1999-08-17','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r                   and  to_date('1999-08-17','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('1999-08-17','yyyy-mm-dd') \r                   and  to_date('1999-08-17','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 859, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/859.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595901.851921
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:41", 
                    "startTime": 1575595901.852008, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_860.sql", 
                    "second": 0.17235398292541504, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2001\r\n group by ca_zip, ca_county\r\n order by ca_zip, ca_county\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2001\r  group by ca_zip, ca_county\r  order by ca_zip, ca_county\r   ) where rownum <= 100;\r \r ", 
                    "id": 860, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/860.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595902.024362
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.02445, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_861.sql", 
                    "second": 0.264279842376709, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 70 and 70+10 \r\n             or ss_coupon_amt between 1163 and 1163+1000\r\n             or ss_wholesale_cost between 39 and 39+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 18 and 18+10\r\n          or ss_coupon_amt between 17605 and 17605+1000\r\n          or ss_wholesale_cost between 31 and 31+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 158 and 158+10\r\n          or ss_coupon_amt between 16731 and 16731+1000\r\n          or ss_wholesale_cost between 57 and 57+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 90 and 90+10\r\n          or ss_coupon_amt between 9436 and 9436+1000\r\n          or ss_wholesale_cost between 28 and 28+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 100 and 100+10\r\n          or ss_coupon_amt between 17058 and 17058+1000\r\n          or ss_wholesale_cost between 11 and 11+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 114 and 114+10\r\n          or ss_coupon_amt between 11281 and 11281+1000\r\n          or ss_wholesale_cost between 78 and 78+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 70 and 70+10 \r              or ss_coupon_amt between 1163 and 1163+1000\r              or ss_wholesale_cost between 39 and 39+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 18 and 18+10\r           or ss_coupon_amt between 17605 and 17605+1000\r           or ss_wholesale_cost between 31 and 31+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 158 and 158+10\r           or ss_coupon_amt between 16731 and 16731+1000\r           or ss_wholesale_cost between 57 and 57+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 90 and 90+10\r           or ss_coupon_amt between 9436 and 9436+1000\r           or ss_wholesale_cost between 28 and 28+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 100 and 100+10\r           or ss_coupon_amt between 17058 and 17058+1000\r           or ss_wholesale_cost between 11 and 11+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 114 and 114+10\r           or ss_coupon_amt between 11281 and 11281+1000\r           or ss_wholesale_cost between 78 and 78+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 861, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/861.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595902.28873
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:43", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.288819, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_862.sql", 
                    "second": 1.47782301902771, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_preferred_cust_flag\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 2000\r\n         and t_s_secyear.dyear = 2000+1\r\n         and t_w_firstyear.dyear = 2000\r\n         and t_w_secyear.dyear = 2000+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_preferred_cust_flag\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_preferred_cust_flag\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 2000\r          and t_s_secyear.dyear = 2000+1\r          and t_w_firstyear.dyear = 2000\r          and t_w_secyear.dyear = 2000+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_preferred_cust_flag\r  ) where rownum <= 100;\r \r ", 
                    "id": 862, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/862.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595903.766642
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:44", 
                    "startTimeFormat": "2019-12-06 09:31:43", 
                    "startTime": 1575595903.766739, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_863.sql", 
                    "second": 0.3896791934967041, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (2000) and\r\n        ((i_category in ('Sports','Shoes','Home') and\r\n          i_class in ('football','athletic','rugs')\r\n         )\r\n      or (i_category in ('Books','Jewelry','Children') and\r\n          i_class in ('romance','rings','newborn') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (2000) and\r         ((i_category in ('Sports','Shoes','Home') and\r           i_class in ('football','athletic','rugs')\r          )\r       or (i_category in ('Books','Jewelry','Children') and\r           i_class in ('romance','rings','newborn') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 863, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/863.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595904.156418
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:44", 
                    "startTimeFormat": "2019-12-06 09:31:44", 
                    "startTime": 1575595904.156501, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_864.sql", 
                    "second": 0.36289405822753906, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('bisque','green','burnished'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 3\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('bisque','green','burnished'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 3\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('bisque','green','burnished'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 3\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -8\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('bisque','green','burnished'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 3\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('bisque','green','burnished'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 3\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('bisque','green','burnished'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 3\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -8\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 864, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/864.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595904.519395
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:44", 
                    "startTimeFormat": "2019-12-06 09:31:44", 
                    "startTime": 1575595904.519476, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_865.sql", 
                    "second": 0.07127594947814941, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 9 or\r\n         household_demographics.hd_vehicle_count= 4)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (1998,1998+1,1998+2) \r\n    and store.s_city in ('Stringtown','Buena Vista','Oakdale','Hillcrest','Glenwood') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 9 or\r          household_demographics.hd_vehicle_count= 4)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (1998,1998+1,1998+2) \r     and store.s_city in ('Stringtown','Buena Vista','Oakdale','Hillcrest','Glenwood') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 865, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/865.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595904.590752
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:44", 
                    "startTimeFormat": "2019-12-06 09:31:44", 
                    "startTime": 1575595904.590859, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_866.sql", 
                    "second": 0.40139317512512207, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=7\r\n   and d_moy=12\r\n   and d_year=2000\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=7\r    and d_moy=12\r    and d_year=2000\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 866, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/866.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595904.992252
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:45", 
                    "startTimeFormat": "2019-12-06 09:31:44", 
                    "startTime": 1575595904.992363, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_867.sql", 
                    "second": 0.3710601329803467, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1211 and 1211 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1211 and 1211 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 867, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/867.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595905.363423
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:45", 
                    "startTimeFormat": "2019-12-06 09:31:45", 
                    "startTime": 1575595905.363527, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_868.sql", 
                    "second": 0.11124801635742188, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '48355','41881','95414','61482','31698','10666',\r\n                          '32012','59880','68644','29221','59986',\r\n                          '79878','63589','10317','41760','80140',\r\n                          '27695','71148','24002','70593','51906',\r\n                          '38973','85505','45131','21263','19837',\r\n                          '90207','27520','41355','90449','71602',\r\n                          '25331','58428','90301','71157','57729',\r\n                          '80566','30533','15995','80311','81417',\r\n                          '21429','68122','42562','10250','56835',\r\n                          '28678','97348','86219','41079','22139',\r\n                          '60130','57129','79864','59358','10939',\r\n                          '76660','36636','66963','48783','60545',\r\n                          '46550','16972','12140','74220','78379',\r\n                          '84839','12642','65201','82862','19209',\r\n                          '63640','80710','27634','32435','58717',\r\n                          '91250','64096','80391','67383','62271',\r\n                          '99439','30294','69074','26943','93351',\r\n                          '36162','33518','39078','32374','54631',\r\n                          '73304','56120','30194','94238','50500',\r\n                          '63635','56166','22592','55998','21946',\r\n                          '67615','11084','80648','73630','31553',\r\n                          '41562','63843','33622','65297','67155',\r\n                          '84080','28218','50195','23833','56729',\r\n                          '91613','29737','91502','79229','96045',\r\n                          '47448','28968','19785','62084','83255',\r\n                          '28357','45945','90102','81453','63203',\r\n                          '58540','30393','54899','24727','22776',\r\n                          '22229','60977','30171','72956','88987',\r\n                          '96092','97658','28498','43195','36517',\r\n                          '90283','85792','85634','37604','52185',\r\n                          '95791','45830','24905','57223','70410',\r\n                          '85698','36206','48244','21877','68875',\r\n                          '76593','15953','97191','34536','35693',\r\n                          '24006','78165','12311','12624','66198',\r\n                          '54006','50625','65951','17372','43038',\r\n                          '34213','51297','10611','53126','16197',\r\n                          '44871','17796','13599','10238','20957',\r\n                          '35243','50467','44819','51784','90432',\r\n                          '44876','56173','19253','56445','81569',\r\n                          '83962','37836','21835','94591','53902',\r\n                          '92359','24311','82059','84682','46501',\r\n                          '65006','95684','78634','60937','89835',\r\n                          '59632','10080','23890','93857','19634',\r\n                          '41414','53710','47550','66057','31353',\r\n                          '23744','82264','22640','87806','82502',\r\n                          '41784','94096','65278','39766','53715',\r\n                          '14861','99147','88407','66957','63712',\r\n                          '77916','45043','57394','95241','11850',\r\n                          '77187','43672','11439','69734','82819',\r\n                          '21811','40061','65031','83875','17830',\r\n                          '66472','79546','96010','87065','95131',\r\n                          '95544','43660','96983','32388','62365',\r\n                          '76725','48741','92907','57057','60139',\r\n                          '38259','23351','54522','92336','62416',\r\n                          '53669','58277','85164','42017','50101',\r\n                          '91097','76288','64892','73526','85619',\r\n                          '18678','29436','82677','63751','35016',\r\n                          '88968','95064','68111','64223','29842',\r\n                          '11874','52501','70802','12420','98998',\r\n                          '50999','74050','22085','33898','70956',\r\n                          '57788','90521','74379','39330','53043',\r\n                          '71280','95420','84251','81785','60190',\r\n                          '98285','41622','20307','83422','91863',\r\n                          '62397','94963','45661','51895','65125',\r\n                          '40398','80107','52048','76673','65477',\r\n                          '28553','11009','99747','21027','17826',\r\n                          '92628','76015','80839','19265','77582',\r\n                          '49830','91539','52731','27882','30635',\r\n                          '22444','51736','85089','70611','78690',\r\n                          '50916','74979','74750','32607','74749',\r\n                          '78388','25411','54493','76409','99418',\r\n                          '86996','75840','44904','88787','37182',\r\n                          '99788','74035','75353','62560','61735',\r\n                          '64727','57299','36843','51334','20156',\r\n                          '67015','19103','84368','92305','69103',\r\n                          '24403','92360','68491','31334','69012',\r\n                          '73454','19179','30670','35731','30435',\r\n                          '37571','83931','34278','49010','89592',\r\n                          '16390','29438','79642','67730','42453',\r\n                          '82153','60438','72395','10312')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 2 and d_year = 2000\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '48355','41881','95414','61482','31698','10666',\r                           '32012','59880','68644','29221','59986',\r                           '79878','63589','10317','41760','80140',\r                           '27695','71148','24002','70593','51906',\r                           '38973','85505','45131','21263','19837',\r                           '90207','27520','41355','90449','71602',\r                           '25331','58428','90301','71157','57729',\r                           '80566','30533','15995','80311','81417',\r                           '21429','68122','42562','10250','56835',\r                           '28678','97348','86219','41079','22139',\r                           '60130','57129','79864','59358','10939',\r                           '76660','36636','66963','48783','60545',\r                           '46550','16972','12140','74220','78379',\r                           '84839','12642','65201','82862','19209',\r                           '63640','80710','27634','32435','58717',\r                           '91250','64096','80391','67383','62271',\r                           '99439','30294','69074','26943','93351',\r                           '36162','33518','39078','32374','54631',\r                           '73304','56120','30194','94238','50500',\r                           '63635','56166','22592','55998','21946',\r                           '67615','11084','80648','73630','31553',\r                           '41562','63843','33622','65297','67155',\r                           '84080','28218','50195','23833','56729',\r                           '91613','29737','91502','79229','96045',\r                           '47448','28968','19785','62084','83255',\r                           '28357','45945','90102','81453','63203',\r                           '58540','30393','54899','24727','22776',\r                           '22229','60977','30171','72956','88987',\r                           '96092','97658','28498','43195','36517',\r                           '90283','85792','85634','37604','52185',\r                           '95791','45830','24905','57223','70410',\r                           '85698','36206','48244','21877','68875',\r                           '76593','15953','97191','34536','35693',\r                           '24006','78165','12311','12624','66198',\r                           '54006','50625','65951','17372','43038',\r                           '34213','51297','10611','53126','16197',\r                           '44871','17796','13599','10238','20957',\r                           '35243','50467','44819','51784','90432',\r                           '44876','56173','19253','56445','81569',\r                           '83962','37836','21835','94591','53902',\r                           '92359','24311','82059','84682','46501',\r                           '65006','95684','78634','60937','89835',\r                           '59632','10080','23890','93857','19634',\r                           '41414','53710','47550','66057','31353',\r                           '23744','82264','22640','87806','82502',\r                           '41784','94096','65278','39766','53715',\r                           '14861','99147','88407','66957','63712',\r                           '77916','45043','57394','95241','11850',\r                           '77187','43672','11439','69734','82819',\r                           '21811','40061','65031','83875','17830',\r                           '66472','79546','96010','87065','95131',\r                           '95544','43660','96983','32388','62365',\r                           '76725','48741','92907','57057','60139',\r                           '38259','23351','54522','92336','62416',\r                           '53669','58277','85164','42017','50101',\r                           '91097','76288','64892','73526','85619',\r                           '18678','29436','82677','63751','35016',\r                           '88968','95064','68111','64223','29842',\r                           '11874','52501','70802','12420','98998',\r                           '50999','74050','22085','33898','70956',\r                           '57788','90521','74379','39330','53043',\r                           '71280','95420','84251','81785','60190',\r                           '98285','41622','20307','83422','91863',\r                           '62397','94963','45661','51895','65125',\r                           '40398','80107','52048','76673','65477',\r                           '28553','11009','99747','21027','17826',\r                           '92628','76015','80839','19265','77582',\r                           '49830','91539','52731','27882','30635',\r                           '22444','51736','85089','70611','78690',\r                           '50916','74979','74750','32607','74749',\r                           '78388','25411','54493','76409','99418',\r                           '86996','75840','44904','88787','37182',\r                           '99788','74035','75353','62560','61735',\r                           '64727','57299','36843','51334','20156',\r                           '67015','19103','84368','92305','69103',\r                           '24403','92360','68491','31334','69012',\r                           '73454','19179','30670','35731','30435',\r                           '37571','83931','34278','49010','89592',\r                           '16390','29438','79642','67730','42453',\r                           '82153','60438','72395','10312')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 2 and d_year = 2000\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 868, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/868.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595905.474775
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:45", 
                    "startTimeFormat": "2019-12-06 09:31:45", 
                    "startTime": 1575595905.474878, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_869.sql", 
                    "second": 0.2542228698730469, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 20\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 0\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 20\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 0\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 869, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/869.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595905.729101
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:45", 
                    "startTimeFormat": "2019-12-06 09:31:45", 
                    "startTime": 1575595905.729197, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_870.sql", 
                    "second": 0.021733999252319336, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_STORE_CREDIT) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =1999\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'WV'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_STORE_CREDIT) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =1999\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'WV'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 870, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/870.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595905.750931
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:55", 
                    "startTimeFormat": "2019-12-06 09:31:45", 
                    "startTime": 1575595905.751029, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_871.sql", 
                    "second": 10.239742994308472, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1998,1998+1,1998+2,1998+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1998,1998+1,1998+2,1998+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 2 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 2 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1998,1998 + 1,1998 + 2,1998 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1998,1998+1,1998+2,1998+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1998 \r\n         and d_moy = 2 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 2 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1998,1998+1,1998+2,1998+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1998,1998+1,1998+2,1998+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 2 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 2 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1998,1998 + 1,1998 + 2,1998 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1998,1998+1,1998+2,1998+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1998 \r          and d_moy = 2 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 2 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 871, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/871.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595915.990772
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:56", 
                    "startTimeFormat": "2019-12-06 09:31:55", 
                    "startTime": 1575595915.990883, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_872.sql", 
                    "second": 0.6750497817993164, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 872, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/872.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595916.665933
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:56", 
                    "startTimeFormat": "2019-12-06 09:31:56", 
                    "startTime": 1575595916.666014, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_873.sql", 
                    "second": 0.1505730152130127, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 71 and 71+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2001-03-06' ,'yyyy-mm-dd') and to_date('2001-03-06' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (891,140,443,185)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 71 and 71+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2001-03-06' ,'yyyy-mm-dd') and to_date('2001-03-06' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (891,140,443,185)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 873, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/873.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595916.816587
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:57", 
                    "startTimeFormat": "2019-12-06 09:31:56", 
                    "startTime": 1575595916.81669, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_874.sql", 
                    "second": 1.1695709228515625, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1213 and 1213+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1213 and 1213+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1213 and 1213+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1213 and 1213+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1213 and 1213+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1213 and 1213+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 874, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/874.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595917.986261
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:57", 
                    "startTime": 1575595917.986348, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_875.sql", 
                    "second": 0.05573701858520508, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -6 and\r\n       d_year = 2001 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -6 and\r        d_year = 2001 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 875, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/875.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595918.042085
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.042177, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_876.sql", 
                    "second": 0.3142969608306885, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1193,1193+1,1193+2,1193+3,1193+4,1193+5,1193+6,1193+7,1193+8,1193+9,1193+10,1193+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1193,1193+1,1193+2,1193+3,1193+4,1193+5,1193+6,1193+7,1193+8,1193+9,1193+10,1193+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 876, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/876.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595918.356474
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.35658, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_877.sql", 
                    "second": 0.19524598121643066, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Children', 'Sports', 'Electronics')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('2001-06-28' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('2001-06-28' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Children', 'Sports', 'Electronics')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('2001-06-28' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('2001-06-28' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 877, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/877.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595918.551826
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.551944, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_878.sql", 
                    "second": 0.24408507347106934, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=12\r\n    and dt.d_year=2000\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=12\r     and dt.d_year=2000\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 878, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/878.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595918.796029
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.79612, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_879.sql", 
                    "second": 0.16945409774780273, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('2002-05-22','yyyy-mm-dd'),to_date('2002-09-28','yyyy-mm-dd'),to_date('2002-11-17','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('2002-05-22','yyyy-mm-dd'),to_date('2002-09-28','yyyy-mm-dd'),to_date('2002-11-17','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('2002-05-22','yyyy-mm-dd'),to_date('2002-09-28','yyyy-mm-dd'),to_date('2002-11-17','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('2002-05-22','yyyy-mm-dd'),to_date('2002-09-28','yyyy-mm-dd'),to_date('2002-11-17','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('2002-05-22','yyyy-mm-dd'),to_date('2002-09-28','yyyy-mm-dd'),to_date('2002-11-17','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('2002-05-22','yyyy-mm-dd'),to_date('2002-09-28','yyyy-mm-dd'),to_date('2002-11-17','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 879, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/879.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595918.965574
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:00", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.965676, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_880.sql", 
                    "second": 1.112048864364624, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1182 and 1182 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1182 and 1182 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1182 and 1182 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1182 and 1182 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1182 and 1182 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1182 and 1182 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 880, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/880.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595920.077725
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:00", 
                    "startTimeFormat": "2019-12-06 09:32:00", 
                    "startTime": 1575595920.077818, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_881.sql", 
                    "second": 0.0910329818725586, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 9 or\r\n             household_demographics.hd_vehicle_count= -1)\r\n        and date_dim.d_year in (1999,1999+1,1999+2)\r\n        and store.s_city in ('Pine Grove','Five Points')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 9 or\r              household_demographics.hd_vehicle_count= -1)\r         and date_dim.d_year in (1999,1999+1,1999+2)\r         and store.s_city in ('Pine Grove','Five Points')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 881, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/881.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595920.168851
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:02", 
                    "startTimeFormat": "2019-12-06 09:32:00", 
                    "startTime": 1575595920.168953, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_882.sql", 
                    "second": 2.765782117843628, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_preferred_cust_flag\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  1998\r\n   and t_s_secyear.dyear = 1998+1\r\n   and t_c_firstyear.dyear =  1998\r\n   and t_c_secyear.dyear =  1998+1\r\n   and t_w_firstyear.dyear = 1998\r\n   and t_w_secyear.dyear = 1998+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_preferred_cust_flag\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_preferred_cust_flag\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  1998\r    and t_s_secyear.dyear = 1998+1\r    and t_c_firstyear.dyear =  1998\r    and t_c_secyear.dyear =  1998+1\r    and t_w_firstyear.dyear = 1998\r    and t_w_secyear.dyear = 1998+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_preferred_cust_flag\r  ) where rownum <= 100;\r \r ", 
                    "id": 882, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/882.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595922.934735
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:04", 
                    "startTimeFormat": "2019-12-06 09:32:02", 
                    "startTime": 1575595922.934841, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_883.sql", 
                    "second": 1.1644439697265625, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = '2 yr Degree'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'M'\r\n  and cd_education_status = 'Secondary'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'D'\r\n  and cd_education_status = 'Unknown'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('MI', 'TN', 'KY')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('GA', 'VA', 'IA')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('WV', 'ID', 'FL')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = '2 yr Degree'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'M'\r   and cd_education_status = 'Secondary'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'D'\r   and cd_education_status = 'Unknown'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('MI', 'TN', 'KY')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('GA', 'VA', 'IA')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('WV', 'ID', 'FL')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 883, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/883.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595924.099285
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:05", 
                    "startTimeFormat": "2019-12-06 09:32:04", 
                    "startTime": 1575595924.099375, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_884.sql", 
                    "second": 0.9937829971313477, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 1999\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = '2 yr Degree'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'M'\r\n   and \r\n   cd_education_status = 'Unknown'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'U'\r\n   and \r\n   cd_education_status = 'College'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('NE', 'MO', 'WV')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('PA', 'TX', 'AR')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('UT', 'NV', 'CA')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 1999\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = '2 yr Degree'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'M'\r    and \r    cd_education_status = 'Unknown'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'U'\r    and \r    cd_education_status = 'College'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('NE', 'MO', 'WV')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('PA', 'TX', 'AR')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('UT', 'NV', 'CA')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 884, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/884.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595925.093158
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:05", 
                    "startTimeFormat": "2019-12-06 09:32:05", 
                    "startTime": 1575595925.093312, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_885.sql", 
                    "second": 0.5512950420379639, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1183 and 1183 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1183 and 1183 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 885, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/885.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595925.644607
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:05", 
                    "startTimeFormat": "2019-12-06 09:32:05", 
                    "startTime": 1575595925.644675, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_886.sql", 
                    "second": 0.07020998001098633, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'M' and\r\n       cd_marital_status = 'W' and\r\n       cd_education_status = '4 yr Degree' and\r\n       d_year = 2002 and\r\n       s_state in ('FL','WA', 'AL', 'IN', 'MO', 'AL')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'M' and\r        cd_marital_status = 'W' and\r        cd_education_status = '4 yr Degree' and\r        d_year = 2002 and\r        s_state in ('FL','WA', 'AL', 'IN', 'MO', 'AL')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 886, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/886.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595925.714885
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:06", 
                    "startTimeFormat": "2019-12-06 09:32:05", 
                    "startTime": 1575595925.714984, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_887.sql", 
                    "second": 0.5854799747467041, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'F' and \r\n       cd1.cd_education_status = 'Unknown' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (1,4,3,7,8,6) and\r\n       d_year = 1998 and\r\n       ca_state in ('KS','MO','OH'\r\n                   ,'IL','IA','ID','SC')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'F' and \r        cd1.cd_education_status = 'Unknown' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (1,4,3,7,8,6) and\r        d_year = 1998 and\r        ca_state in ('KS','MO','OH'\r                    ,'IL','IA','ID','SC')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 887, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/887.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595926.300464
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:06", 
                    "startTimeFormat": "2019-12-06 09:32:06", 
                    "startTime": 1575595926.300565, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_888.sql", 
                    "second": 0.22378897666931152, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2001\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2001\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 888, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/888.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595926.524354
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:06", 
                    "startTime": 1575595926.524437, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_889.sql", 
                    "second": 0.5041899681091309, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 2\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 2\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 889, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/889.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595927.028627
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.028722, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_890.sql", 
                    "second": 0.8175809383392334, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 2002\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 2002\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 2002\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 2002\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 2002\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =2002\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by web_q2_q3_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 2002\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 2002\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 2002\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 2002\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 2002\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =2002\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by web_q2_q3_increase;\r \r ", 
                    "id": 890, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/890.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595927.846303
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:08", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.846407, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_891.sql", 
                    "second": 0.30704617500305176, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_8.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1195,1195+1,1195+2,1195+3,1195+4,1195+5,1195+6,1195+7,1195+8,1195+9,1195+10,1195+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1195,1195+1,1195+2,1195+3,1195+4,1195+5,1195+6,1195+7,1195+8,1195+9,1195+10,1195+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 891, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/891.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_8.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595928.153453
                }
            ], 
            "second": 144.1131980419159, 
            "startTime": 1575595784.04035, 
            "endTime": 1575595928.153548
        }, 
        "secondFormat": "00:02:37", 
        "second": 157.47636818885803, 
        "query_6.sql": {
            "endTimeFormat": "2019-12-06 09:32:21", 
            "startTimeFormat": "2019-12-06 09:29:44", 
            "secondFormat": "00:02:37", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:29:44", 
                    "startTimeFormat": "2019-12-06 09:29:44", 
                    "startTime": 1575595784.037905, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_595.sql", 
                    "second": 0.41855907440185547, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '501-1000' or\r\n         household_demographics.hd_buy_potential = '5001-10000')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Fairfield County','Wadena County','Daviess County','Mobile County',\r\n                           'Dauphin County','Raleigh County','Barrow County','Williamson County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '501-1000' or\r          household_demographics.hd_buy_potential = '5001-10000')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Fairfield County','Wadena County','Daviess County','Mobile County',\r                            'Dauphin County','Raleigh County','Barrow County','Williamson County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 595, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/595.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595784.456464
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:44", 
                    "startTime": 1575595784.456545, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_596.sql", 
                    "second": 0.7946169376373291, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 596, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/596.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595785.251162
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.251257, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_597.sql", 
                    "second": 0.23476195335388184, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 471\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 471\r\n                                                    and ss_cdemo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 471\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 471\r\n                                                    and ss_cdemo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 471\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 471\r                                                     and ss_cdemo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 471\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 471\r                                                     and ss_cdemo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 597, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/597.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595785.486019
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.486122, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_598.sql", 
                    "second": 0.32370615005493164, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2000-2-01','yyyy-mm-dd') and \r\n           to_date('2000-2-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'GA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2000-2-01','yyyy-mm-dd') and \r            to_date('2000-2-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'GA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 598, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/598.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595785.809828
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:46", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.809924, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_599.sql", 
                    "second": 0.6017560958862305, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 1998\r\nand d2.d_moy  = 8\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 1998\r and d2.d_moy  = 8\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 599, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/599.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595786.41168
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:46", 
                    "startTime": 1575595786.41176, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_600.sql", 
                    "second": 2.0977349281311035, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-06','yyyy-mm-dd') \r\n                  and to_date('2001-08-06','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-06','yyyy-mm-dd') \r\n                  and to_date('2001-08-06','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-06','yyyy-mm-dd') \r\n                  and to_date('2001-08-06','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('2001-08-06','yyyy-mm-dd') \r                   and to_date('2001-08-06','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('2001-08-06','yyyy-mm-dd') \r                   and to_date('2001-08-06','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('2001-08-06','yyyy-mm-dd') \r                   and to_date('2001-08-06','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 600, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/600.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595788.509495
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.509584, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_601.sql", 
                    "second": 0.28458309173583984, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1213,1213+1,1213+2,1213+3,1213+4,1213+5,1213+6,1213+7,1213+8,1213+9,1213+10,1213+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1213,1213+1,1213+2,1213+3,1213+4,1213+5,1213+6,1213+7,1213+8,1213+9,1213+10,1213+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 601, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/601.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595788.794167
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.794261, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_602.sql", 
                    "second": 0.5606849193572998, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'F' and \r\n       cd_marital_status = 'S' and\r\n       cd_education_status = 'Primary' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1998 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'F' and \r        cd_marital_status = 'S' and\r        cd_education_status = 'Primary' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1998 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 602, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/602.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595789.354946
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.355041, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_603.sql", 
                    "second": 0.4591529369354248, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('2000-07-13','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('2000-07-13','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('2000-07-13','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('2000-07-13','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('2000-07-13','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('2000-07-13','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 603, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/603.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595789.814194
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.81428, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_604.sql", 
                    "second": 0.1691570281982422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Music', 'Children', 'Electronics')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('2002-01-15' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('2002-01-15' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Music', 'Children', 'Electronics')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('2002-01-15' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('2002-01-15' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 604, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/604.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595789.983437
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:50", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.983532, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_605.sql", 
                    "second": 0.8860321044921875, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Music'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Music'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Music') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2000\r\n   AND prev_yr.d_year=2000-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Music'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Music'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Music') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2000\r    AND prev_yr.d_year=2000-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 605, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/605.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595790.869564
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:50", 
                    "startTimeFormat": "2019-12-06 09:29:50", 
                    "startTime": 1575595790.869657, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_606.sql", 
                    "second": 0.06955194473266602, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '501-1000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Richland County','Bronx County','Kittitas County','Mobile County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '501-1000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Richland County','Bronx County','Kittitas County','Mobile County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 606, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/606.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595790.939209
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:51", 
                    "startTimeFormat": "2019-12-06 09:29:50", 
                    "startTime": 1575595790.93931, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_607.sql", 
                    "second": 0.20890188217163086, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 2002 \r\nand     d_moy                   = 12\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like '501-1000%'\r\nand     ca_gmt_offset           = -7\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 2002 \r and     d_moy                   = 12\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like '501-1000%'\r and     ca_gmt_offset           = -7\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 607, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/607.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595791.148212
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:51", 
                    "startTimeFormat": "2019-12-06 09:29:51", 
                    "startTime": 1575595791.148304, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_608.sql", 
                    "second": 0.8219599723815918, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 2001 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('TN','NM','NM','SD',\r\n                 'AL','IN','AL','FL')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 2001 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('TN','NM','NM','SD',\r                  'AL','IN','AL','FL')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 608, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/608.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595791.970264
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:53", 
                    "startTimeFormat": "2019-12-06 09:29:51", 
                    "startTime": 1575595791.970359, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_609.sql", 
                    "second": 1.5204408168792725, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_birth_country\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1999\r\n         and t_s_secyear.dyear = 1999+1\r\n         and t_w_firstyear.dyear = 1999\r\n         and t_w_secyear.dyear = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_birth_country\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_birth_country\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1999\r          and t_s_secyear.dyear = 1999+1\r          and t_w_firstyear.dyear = 1999\r          and t_w_secyear.dyear = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_birth_country\r  ) where rownum <= 100;\r \r ", 
                    "id": 609, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/609.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595793.4908
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:54", 
                    "startTimeFormat": "2019-12-06 09:29:53", 
                    "startTime": 1575595793.490896, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_610.sql", 
                    "second": 0.5725460052490234, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-04','yyyy-mm-dd') \r\n                  and to_date('2001-08-04','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-04','yyyy-mm-dd') \r\n                  and to_date('2001-08-04','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-04','yyyy-mm-dd') \r\n                  and to_date('2001-08-04','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-04','yyyy-mm-dd') \r                   and to_date('2001-08-04','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-04','yyyy-mm-dd') \r                   and to_date('2001-08-04','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-04','yyyy-mm-dd') \r                   and to_date('2001-08-04','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 610, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/610.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595794.063442
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:56", 
                    "startTimeFormat": "2019-12-06 09:29:54", 
                    "startTime": 1575595794.063549, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_611.sql", 
                    "second": 2.312537908554077, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 13633021\r\n            then (select avg(ss_ext_discount_amt) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 19218370\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 2178632\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 39518364\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 15715113\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 13633021\r             then (select avg(ss_ext_discount_amt) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 19218370\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 2178632\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 39518364\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 15715113\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 611, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/611.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595796.376087
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:56", 
                    "startTimeFormat": "2019-12-06 09:29:56", 
                    "startTime": 1575595796.376159, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_612.sql", 
                    "second": 0.056307077407836914, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 73') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 73') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 612, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/612.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595796.432466
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:56", 
                    "startTimeFormat": "2019-12-06 09:29:56", 
                    "startTime": 1575595796.432569, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_613.sql", 
                    "second": 0.021585941314697266, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 182\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('2000-01-07','yyyy-mm-dd') and \r\n        to_date('2000-01-07','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('2000-01-07','yyyy-mm-dd') and\r\n                             to_date('2000-01-07','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 182\r and i_item_sk = cs_item_sk \r and d_date between to_date('2000-01-07','yyyy-mm-dd') and \r         to_date('2000-01-07','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('2000-01-07','yyyy-mm-dd') and\r                              to_date('2000-01-07','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 613, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/613.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595796.454155
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:56", 
                    "startTimeFormat": "2019-12-06 09:29:56", 
                    "startTime": 1575595796.454233, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_614.sql", 
                    "second": 0.34961795806884766, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (1999) and\r\n        ((i_category in ('Sports','Women','Books') and\r\n          i_class in ('fitness','swimwear','arts')\r\n         )\r\n      or (i_category in ('Electronics','Jewelry','Shoes') and\r\n          i_class in ('memory','semi-precious','womens') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (1999) and\r         ((i_category in ('Sports','Women','Books') and\r           i_class in ('fitness','swimwear','arts')\r          )\r       or (i_category in ('Electronics','Jewelry','Shoes') and\r           i_class in ('memory','semi-precious','womens') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 614, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/614.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595796.803851
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:57", 
                    "startTimeFormat": "2019-12-06 09:29:56", 
                    "startTime": 1575595796.803948, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_615.sql", 
                    "second": 0.3059091567993164, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 74 and 74+10 \r\n             or ss_coupon_amt between 8725 and 8725+1000\r\n             or ss_wholesale_cost between 8 and 8+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 62 and 62+10\r\n          or ss_coupon_amt between 2859 and 2859+1000\r\n          or ss_wholesale_cost between 42 and 42+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 142 and 142+10\r\n          or ss_coupon_amt between 4576 and 4576+1000\r\n          or ss_wholesale_cost between 50 and 50+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 110 and 110+10\r\n          or ss_coupon_amt between 2090 and 2090+1000\r\n          or ss_wholesale_cost between 58 and 58+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 22 and 22+10\r\n          or ss_coupon_amt between 2352 and 2352+1000\r\n          or ss_wholesale_cost between 51 and 51+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 73 and 73+10\r\n          or ss_coupon_amt between 17111 and 17111+1000\r\n          or ss_wholesale_cost between 17 and 17+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 74 and 74+10 \r              or ss_coupon_amt between 8725 and 8725+1000\r              or ss_wholesale_cost between 8 and 8+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 62 and 62+10\r           or ss_coupon_amt between 2859 and 2859+1000\r           or ss_wholesale_cost between 42 and 42+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 142 and 142+10\r           or ss_coupon_amt between 4576 and 4576+1000\r           or ss_wholesale_cost between 50 and 50+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 110 and 110+10\r           or ss_coupon_amt between 2090 and 2090+1000\r           or ss_wholesale_cost between 58 and 58+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 22 and 22+10\r           or ss_coupon_amt between 2352 and 2352+1000\r           or ss_wholesale_cost between 51 and 51+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 73 and 73+10\r           or ss_coupon_amt between 17111 and 17111+1000\r           or ss_wholesale_cost between 17 and 17+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 615, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/615.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595797.109857
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:58", 
                    "startTimeFormat": "2019-12-06 09:29:57", 
                    "startTime": 1575595797.109963, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_616.sql", 
                    "second": 1.1201231479644775, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1180 and 1180+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1180 and 1180+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1180 and 1180+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1180 and 1180+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1180 and 1180+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1180 and 1180+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 616, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/616.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595798.230086
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:58", 
                    "startTimeFormat": "2019-12-06 09:29:58", 
                    "startTime": 1575595798.230172, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_617.sql", 
                    "second": 0.5821020603179932, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'M' and \r\n       cd1.cd_education_status = '4 yr Degree' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (5,4,3,9,2,7) and\r\n       d_year = 2002 and\r\n       ca_state in ('AR','PA','MS'\r\n                   ,'KS','WA','IL','GA')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'M' and \r        cd1.cd_education_status = '4 yr Degree' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (5,4,3,9,2,7) and\r        d_year = 2002 and\r        ca_state in ('AR','PA','MS'\r                    ,'KS','WA','IL','GA')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 617, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/617.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595798.812274
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:59", 
                    "startTimeFormat": "2019-12-06 09:29:58", 
                    "startTime": 1575595798.812374, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_618.sql", 
                    "second": 1.0923149585723877, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,min(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (2000,2000+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,min(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (2000,2000+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 2000\r\n         and t_s_secyear.year = 2000+1\r\n         and t_w_firstyear.year = 2000\r\n         and t_w_secyear.year = 2000+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 1,3,2\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,min(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (2000,2000+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,min(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (2000,2000+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 2000\r          and t_s_secyear.year = 2000+1\r          and t_w_firstyear.year = 2000\r          and t_w_secyear.year = 2000+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 1,3,2\r  ) where rownum <= 100;\r \r ", 
                    "id": 618, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/618.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595799.904689
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:32", 
                    "startTimeFormat": "2019-12-06 09:29:59", 
                    "startTime": 1575595799.904779, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_619.sql", 
                    "second": 32.977487087249756, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 1999\r\n \t        and d_moy = 2 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 1999\r  \t        and d_moy = 2 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 619, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/619.sql", 
                    "secondFormat": "00:00:32", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595832.882266
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:33", 
                    "startTimeFormat": "2019-12-06 09:30:32", 
                    "startTime": 1575595832.882379, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_620.sql", 
                    "second": 0.9115090370178223, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 620, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/620.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595833.793888
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:34", 
                    "startTimeFormat": "2019-12-06 09:30:33", 
                    "startTime": 1575595833.793984, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_621.sql", 
                    "second": 0.2531161308288574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Glenwood'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  45428\r\n   and ib_upper_bound   <=  45428 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Glenwood'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  45428\r    and ib_upper_bound   <=  45428 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 621, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/621.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595834.0471
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:47", 
                    "startTimeFormat": "2019-12-06 09:30:34", 
                    "startTime": 1575595834.047199, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_622.sql", 
                    "second": 13.50385308265686, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 11)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999\r\n                       and d_moy = 12\r\n                       and d_dom = 11)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 1999+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999 + 1\r                        and d_moy = 12\r                        and d_dom = 11)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999\r                        and d_moy = 12\r                        and d_dom = 11)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 622, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/622.sql", 
                    "secondFormat": "00:00:13", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595847.551052
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:48", 
                    "startTimeFormat": "2019-12-06 09:30:47", 
                    "startTime": 1575595847.551136, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_623.sql", 
                    "second": 1.1791260242462158, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1214 and 1214 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1214 and 1214 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1214 and 1214 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1214 and 1214 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1214 and 1214 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1214 and 1214 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 623, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/623.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595848.730262
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:49", 
                    "startTimeFormat": "2019-12-06 09:30:48", 
                    "startTime": 1575595848.730376, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_624.sql", 
                    "second": 0.39424705505371094, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=5\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'salmon'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 5\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'orange'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=5\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'salmon'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 5\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'orange'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 624, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/624.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595849.124623
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:49", 
                    "startTimeFormat": "2019-12-06 09:30:49", 
                    "startTime": 1575595849.124721, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_625.sql", 
                    "second": 0.2761709690093994, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=11\r\n \tand dt.d_year=1999\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=11\r  \tand dt.d_year=1999\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 625, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/625.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595849.400892
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:49", 
                    "startTimeFormat": "2019-12-06 09:30:49", 
                    "startTime": 1575595849.400987, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_626.sql", 
                    "second": 0.43613409996032715, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,avg(ss_quantity)        as store_sales_quantity\r\n    ,avg(sr_return_quantity) as store_returns_quantity\r\n    ,avg(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 1999\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 1999\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (1999,1999+1,1999+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,avg(ss_quantity)        as store_sales_quantity\r     ,avg(sr_return_quantity) as store_returns_quantity\r     ,avg(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 1999\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 1999\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (1999,1999+1,1999+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 626, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/626.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595849.837121
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:52", 
                    "startTimeFormat": "2019-12-06 09:30:49", 
                    "startTime": 1575595849.837213, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_627.sql", 
                    "second": 2.9587340354919434, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '501-1000'\r\n  and d1.d_year = 2002\r\n  and cd_marital_status = 'D'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '501-1000'\r   and d1.d_year = 2002\r   and cd_marital_status = 'D'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 627, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/627.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595852.795947
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:02", 
                    "startTimeFormat": "2019-12-06 09:30:52", 
                    "startTime": 1575595852.796063, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_628.sql", 
                    "second": 10.155943155288696, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1999,1999+1,1999+2,1999+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 7 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 7 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1999 \r\n         and d_moy = 7 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 7 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1999,1999+1,1999+2,1999+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 7 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 7 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1999 \r          and d_moy = 7 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 7 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 628, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/628.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595862.952006
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:02", 
                    "startTime": 1575595862.952103, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_629.sql", 
                    "second": 0.34834814071655273, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'W' and\r\n       cd_education_status = '2 yr Degree' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2002 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'W' and\r        cd_education_status = '2 yr Degree' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2002 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 629, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/629.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595863.300451
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:04", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.30054, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_630.sql", 
                    "second": 0.8305521011352539, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('KY','GA','WA') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 2 and 2+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 2 and 2+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_moy between 2 and 2+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('KY','GA','WA') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 2 and 2+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 2 and 2+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_moy between 2 and 2+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 630, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/630.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595864.131092
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:06", 
                    "startTimeFormat": "2019-12-06 09:31:04", 
                    "startTime": 1575595864.131196, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_631.sql", 
                    "second": 2.0324769020080566, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 2000 or\r\n         ( d_year = 2000-1 and d_moy =12) or\r\n         ( d_year = 2000+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.s_company_name\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2000 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 2000 or\r          ( d_year = 2000-1 and d_moy =12) or\r          ( d_year = 2000+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.s_company_name\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2000 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 631, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/631.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595866.163673
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:06", 
                    "startTimeFormat": "2019-12-06 09:31:06", 
                    "startTime": 1575595866.163767, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_632.sql", 
                    "second": 0.06986880302429199, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 87 and 87+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2000-06-01' ,'yyyy-mm-dd') and to_date('2000-06-01' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (118,906,983,927)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 87 and 87+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2000-06-01' ,'yyyy-mm-dd') and to_date('2000-06-01' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (118,906,983,927)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 632, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/632.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595866.233636
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:07", 
                    "startTimeFormat": "2019-12-06 09:31:06", 
                    "startTime": 1575595866.233719, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_633.sql", 
                    "second": 1.2534008026123047, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 1998\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 1998\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 1998\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 1998\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 1998\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =1998\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by web_q2_q3_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 1998\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 1998\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 1998\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 1998\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 1998\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =1998\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by web_q2_q3_increase;\r \r ", 
                    "id": 633, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/633.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595867.48712
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:09", 
                    "startTimeFormat": "2019-12-06 09:31:07", 
                    "startTime": 1575595867.487225, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_634.sql", 
                    "second": 1.8710658550262451, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1194 and 1194 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1194+ 12 and 1194 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1194 and 1194 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1194+ 12 and 1194 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 634, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/634.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595869.358291
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:09", 
                    "startTimeFormat": "2019-12-06 09:31:09", 
                    "startTime": 1575595869.358386, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_635.sql", 
                    "second": 0.3924548625946045, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2001\r\n                         and d_moy = 12\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2001\r\n                         and d_moy = 12\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2001\r\n                         and d_moy = 12\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2001\r                          and d_moy = 12\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2001\r                          and d_moy = 12\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2001\r                          and d_moy = 12\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 635, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/635.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595869.750841
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:10", 
                    "startTimeFormat": "2019-12-06 09:31:09", 
                    "startTime": 1575595869.750928, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_636.sql", 
                    "second": 0.4620800018310547, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Sports'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 6\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Sports'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 6\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Sports'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 6\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Sports'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 6\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Sports'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 6\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Sports'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 6\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 636, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/636.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595870.213008
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:10", 
                    "startTimeFormat": "2019-12-06 09:31:10", 
                    "startTime": 1575595870.213103, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_637.sql", 
                    "second": 0.3027918338775635, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1198 and 1198+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1198 and 1198+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 637, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/637.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595870.515895
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:11", 
                    "startTimeFormat": "2019-12-06 09:31:10", 
                    "startTime": 1575595870.51599, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_638.sql", 
                    "second": 0.5028760433197021, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1198 and 1198 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1198 and 1198 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 638, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/638.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595871.018866
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:13", 
                    "startTimeFormat": "2019-12-06 09:31:11", 
                    "startTime": 1575595871.018959, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_639.sql", 
                    "second": 2.6611509323120117, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_preferred_cust_flag\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  1999\r\n   and t_s_secyear.dyear = 1999+1\r\n   and t_c_firstyear.dyear =  1999\r\n   and t_c_secyear.dyear =  1999+1\r\n   and t_w_firstyear.dyear = 1999\r\n   and t_w_secyear.dyear = 1999+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_preferred_cust_flag\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_preferred_cust_flag\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  1999\r    and t_s_secyear.dyear = 1999+1\r    and t_c_firstyear.dyear =  1999\r    and t_c_secyear.dyear =  1999+1\r    and t_w_firstyear.dyear = 1999\r    and t_w_secyear.dyear = 1999+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_preferred_cust_flag\r  ) where rownum <= 100;\r \r ", 
                    "id": 639, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/639.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595873.68011
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:13", 
                    "startTimeFormat": "2019-12-06 09:31:13", 
                    "startTime": 1575595873.680205, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_640.sql", 
                    "second": 0.18822693824768066, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  ca_zip, ca_city, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 1 and d_year = 2002\r\n group by ca_zip, ca_city\r\n order by ca_zip, ca_city\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_city, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 1 and d_year = 2002\r  group by ca_zip, ca_city\r  order by ca_zip, ca_city\r   ) where rownum <= 100;\r \r ", 
                    "id": 640, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/640.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595873.868432
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:13", 
                    "startTime": 1575595873.868535, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_641.sql", 
                    "second": 1.3076069355010986, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'M'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Secondary'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'D'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '4 yr Degree' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'W'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Unknown'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('TX', 'WI', 'TN')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('KY', 'IA', 'PA')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('MN', 'NM', 'CA')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 2000\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'M'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Secondary'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'D'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '4 yr Degree' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'W'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Unknown'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('TX', 'WI', 'TN')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('KY', 'IA', 'PA')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('MN', 'NM', 'CA')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 641, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/641.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595875.176142
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.176232, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_642.sql", 
                    "second": 0.15151691436767578, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '98600','71612','73532','38894','73373','40181',\r\n                          '82960','33414','82532','15401','43049',\r\n                          '39197','35554','19280','85031','18490',\r\n                          '61579','76908','27003','10891','20818',\r\n                          '74732','62382','68880','98052','72455',\r\n                          '81551','24817','94750','30185','72510',\r\n                          '86129','73077','20412','46839','53175',\r\n                          '78256','72901','21909','17991','49089',\r\n                          '14724','47886','64307','47304','50493',\r\n                          '39259','23300','11882','25471','95777',\r\n                          '55416','21219','98653','46687','61714',\r\n                          '14311','38302','15162','73028','23362',\r\n                          '76971','97124','29732','51413','28259',\r\n                          '11855','61953','88098','66057','81167',\r\n                          '14655','33303','96270','73359','40826',\r\n                          '59882','22664','66673','59236','76112',\r\n                          '43189','59354','23258','37211','50861',\r\n                          '10172','79333','51948','22591','34427',\r\n                          '57283','40307','14072','41626','15055',\r\n                          '40184','75610','52979','66506','79083',\r\n                          '73406','72201','13336','60268','94204',\r\n                          '55807','82604','47738','21105','70586',\r\n                          '74246','14900','38407','68295','89783',\r\n                          '39739','10586','33626','46851','98057',\r\n                          '87540','17587','97245','48304','36338',\r\n                          '32354','82245','26135','50063','55887',\r\n                          '75430','53232','19582','86100','18998',\r\n                          '83137','97449','20247','53687','63989',\r\n                          '97450','42663','53358','84622','76664',\r\n                          '89475','92496','18395','44916','24778',\r\n                          '63984','77480','77987','22349','49543',\r\n                          '91554','21740','37561','89333','18178',\r\n                          '83595','25290','97968','19378','32004',\r\n                          '98937','94715','66943','13688','43174',\r\n                          '70880','93379','60160','37515','73057',\r\n                          '37124','43304','87019','87589','29123',\r\n                          '55349','67941','36351','45715','21942',\r\n                          '76360','90193','18030','88422','26514',\r\n                          '78637','67654','51032','19527','14262',\r\n                          '68363','69118','57523','40628','57929',\r\n                          '34120','66995','58998','15959','30285',\r\n                          '93688','81909','52472','53474','50792',\r\n                          '75351','66333','67734','17076','47014',\r\n                          '14716','31265','53682','84437','24717',\r\n                          '32920','65793','58853','23142','18228',\r\n                          '36739','69875','92352','80813','97857',\r\n                          '30719','77023','22924','37785','69814',\r\n                          '84545','86047','98689','49278','11789',\r\n                          '97187','22986','63372','85557','48466',\r\n                          '12934','94019','33398','94389','41276',\r\n                          '54679','57542','28653','27762','40250',\r\n                          '44348','46010','66443','82576','25175',\r\n                          '85302','54717','64326','39176','49503',\r\n                          '84280','71107','76528','80267','54711',\r\n                          '63448','32588','31012','43715','22890',\r\n                          '15187','40064','98304','90245','89839',\r\n                          '27304','26408','65233','71533','32210',\r\n                          '82708','45844','55920','96358','11372',\r\n                          '29657','60836','30802','25821','71420',\r\n                          '77639','75525','91506','13925','50337',\r\n                          '99761','81884','57733','71337','78804',\r\n                          '64178','95536','62046','95450','75043',\r\n                          '39748','98055','32331','86824','46966',\r\n                          '76201','34030','42314','80965','84011',\r\n                          '43408','48939','70407','12211','86886',\r\n                          '73266','83367','95186','61589','30445',\r\n                          '97170','33443','57666','80764','62751',\r\n                          '84223','42369','91363','98882','21844',\r\n                          '96802','82168','16775','49894','76884',\r\n                          '58421','52197','81607','18761','63710',\r\n                          '64349','59477','81918','51823','70887',\r\n                          '66865','31932','53818','93497','49350',\r\n                          '84702','61966','57683','56386','82160',\r\n                          '53989','49988','58103','10262','97083',\r\n                          '32289','53244','28178','14048','62841',\r\n                          '46590','66394','66970','59087','14437',\r\n                          '18923','83614','88021','61172','72371',\r\n                          '26414','31123','64526','89431','12295',\r\n                          '19972','72464','71719','19606','52028',\r\n                          '22196','70293','31016','91601')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 2 and d_year = 2001\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '98600','71612','73532','38894','73373','40181',\r                           '82960','33414','82532','15401','43049',\r                           '39197','35554','19280','85031','18490',\r                           '61579','76908','27003','10891','20818',\r                           '74732','62382','68880','98052','72455',\r                           '81551','24817','94750','30185','72510',\r                           '86129','73077','20412','46839','53175',\r                           '78256','72901','21909','17991','49089',\r                           '14724','47886','64307','47304','50493',\r                           '39259','23300','11882','25471','95777',\r                           '55416','21219','98653','46687','61714',\r                           '14311','38302','15162','73028','23362',\r                           '76971','97124','29732','51413','28259',\r                           '11855','61953','88098','66057','81167',\r                           '14655','33303','96270','73359','40826',\r                           '59882','22664','66673','59236','76112',\r                           '43189','59354','23258','37211','50861',\r                           '10172','79333','51948','22591','34427',\r                           '57283','40307','14072','41626','15055',\r                           '40184','75610','52979','66506','79083',\r                           '73406','72201','13336','60268','94204',\r                           '55807','82604','47738','21105','70586',\r                           '74246','14900','38407','68295','89783',\r                           '39739','10586','33626','46851','98057',\r                           '87540','17587','97245','48304','36338',\r                           '32354','82245','26135','50063','55887',\r                           '75430','53232','19582','86100','18998',\r                           '83137','97449','20247','53687','63989',\r                           '97450','42663','53358','84622','76664',\r                           '89475','92496','18395','44916','24778',\r                           '63984','77480','77987','22349','49543',\r                           '91554','21740','37561','89333','18178',\r                           '83595','25290','97968','19378','32004',\r                           '98937','94715','66943','13688','43174',\r                           '70880','93379','60160','37515','73057',\r                           '37124','43304','87019','87589','29123',\r                           '55349','67941','36351','45715','21942',\r                           '76360','90193','18030','88422','26514',\r                           '78637','67654','51032','19527','14262',\r                           '68363','69118','57523','40628','57929',\r                           '34120','66995','58998','15959','30285',\r                           '93688','81909','52472','53474','50792',\r                           '75351','66333','67734','17076','47014',\r                           '14716','31265','53682','84437','24717',\r                           '32920','65793','58853','23142','18228',\r                           '36739','69875','92352','80813','97857',\r                           '30719','77023','22924','37785','69814',\r                           '84545','86047','98689','49278','11789',\r                           '97187','22986','63372','85557','48466',\r                           '12934','94019','33398','94389','41276',\r                           '54679','57542','28653','27762','40250',\r                           '44348','46010','66443','82576','25175',\r                           '85302','54717','64326','39176','49503',\r                           '84280','71107','76528','80267','54711',\r                           '63448','32588','31012','43715','22890',\r                           '15187','40064','98304','90245','89839',\r                           '27304','26408','65233','71533','32210',\r                           '82708','45844','55920','96358','11372',\r                           '29657','60836','30802','25821','71420',\r                           '77639','75525','91506','13925','50337',\r                           '99761','81884','57733','71337','78804',\r                           '64178','95536','62046','95450','75043',\r                           '39748','98055','32331','86824','46966',\r                           '76201','34030','42314','80965','84011',\r                           '43408','48939','70407','12211','86886',\r                           '73266','83367','95186','61589','30445',\r                           '97170','33443','57666','80764','62751',\r                           '84223','42369','91363','98882','21844',\r                           '96802','82168','16775','49894','76884',\r                           '58421','52197','81607','18761','63710',\r                           '64349','59477','81918','51823','70887',\r                           '66865','31932','53818','93497','49350',\r                           '84702','61966','57683','56386','82160',\r                           '53989','49988','58103','10262','97083',\r                           '32289','53244','28178','14048','62841',\r                           '46590','66394','66970','59087','14437',\r                           '18923','83614','88021','61172','72371',\r                           '26414','31123','64526','89431','12295',\r                           '19972','72464','71719','19606','52028',\r                           '22196','70293','31016','91601')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 2 and d_year = 2001\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 642, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/642.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595875.327749
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.327878, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_643.sql", 
                    "second": 0.33966708183288574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=63\r\n   and d_moy=11\r\n   and d_year=1998\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=63\r    and d_moy=11\r    and d_year=1998\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 643, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/643.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595875.667545
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.667643, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_644.sql", 
                    "second": 0.10905194282531738, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Books'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 1999\r\n   and   d_moy  = 12) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Books'\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 1999\r\n   and   d_moy  = 12) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -7\r    and   i_category = 'Books'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -7\r    and   d_year = 1999\r    and   d_moy  = 12) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -7\r    and   i_category = 'Books'\r    and   s_gmt_offset = -7\r    and   d_year = 1999\r    and   d_moy  = 12) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 644, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/644.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595875.776695
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:16", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.776777, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_645.sql", 
                    "second": 0.28114795684814453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_ext_discount_amt) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 131\r\n   and dt.d_moy=12\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_ext_discount_amt) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 131\r    and dt.d_moy=12\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 645, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/645.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595876.057925
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:16", 
                    "startTimeFormat": "2019-12-06 09:31:16", 
                    "startTime": 1575595876.058019, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_646.sql", 
                    "second": 0.06456112861633301, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 926 and 926+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'royal' or i_color = 'lace') and \r\n        (i_units = 'Ounce' or i_units = 'Gram') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'peach' or i_color = 'peru') and\r\n        (i_units = 'Tsp' or i_units = 'Bunch') and\r\n        (i_size = 'large' or i_size = 'petite')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'deep' or i_color = 'blue') and\r\n        (i_units = 'Lb' or i_units = 'Pallet') and\r\n        (i_size = 'small' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'yellow' or i_color = 'floral') and\r\n        (i_units = 'Box' or i_units = 'Oz') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'light' or i_color = 'white') and \r\n        (i_units = 'Dozen' or i_units = 'Carton') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'medium' or i_color = 'dodger') and\r\n        (i_units = 'Pound' or i_units = 'N/A') and\r\n        (i_size = 'large' or i_size = 'petite')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'almond' or i_color = 'ivory') and\r\n        (i_units = 'Bundle' or i_units = 'Gross') and\r\n        (i_size = 'small' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'forest' or i_color = 'puff') and\r\n        (i_units = 'Case' or i_units = 'Unknown') and\r\n        (i_size = 'extra large' or i_size = 'economy')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 926 and 926+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'royal' or i_color = 'lace') and \r         (i_units = 'Ounce' or i_units = 'Gram') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'peach' or i_color = 'peru') and\r         (i_units = 'Tsp' or i_units = 'Bunch') and\r         (i_size = 'large' or i_size = 'petite')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'deep' or i_color = 'blue') and\r         (i_units = 'Lb' or i_units = 'Pallet') and\r         (i_size = 'small' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'yellow' or i_color = 'floral') and\r         (i_units = 'Box' or i_units = 'Oz') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'light' or i_color = 'white') and \r         (i_units = 'Dozen' or i_units = 'Carton') and\r         (i_size = 'extra large' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'medium' or i_color = 'dodger') and\r         (i_units = 'Pound' or i_units = 'N/A') and\r         (i_size = 'large' or i_size = 'petite')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'almond' or i_color = 'ivory') and\r         (i_units = 'Bundle' or i_units = 'Gross') and\r         (i_size = 'small' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'forest' or i_color = 'puff') and\r         (i_units = 'Case' or i_units = 'Unknown') and\r         (i_size = 'extra large' or i_size = 'economy')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 646, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/646.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595876.12258
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:16", 
                    "startTimeFormat": "2019-12-06 09:31:16", 
                    "startTime": 1575595876.122672, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_647.sql", 
                    "second": 0.7722070217132568, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Home'\r\n         and i_class = 'bedding'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 5\r\n         and d_year = 1999\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 1999 and d_moy = 5)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 1999 and d_moy = 5)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Home'\r          and i_class = 'bedding'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 5\r          and d_year = 1999\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 1999 and d_moy = 5)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 1999 and d_moy = 5)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 647, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/647.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595876.894879
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:23", 
                    "startTimeFormat": "2019-12-06 09:31:16", 
                    "startTime": 1575595876.894984, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_648.sql", 
                    "second": 7.046328067779541, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1220 and 1220+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1220 and 1220+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 648, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/648.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595883.941312
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:24", 
                    "startTimeFormat": "2019-12-06 09:31:23", 
                    "startTime": 1575595883.941405, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_649.sql", 
                    "second": 0.5520908832550049, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-08','yyyy-mm-dd') \r\n                  and to_date('2001-08-08','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-08','yyyy-mm-dd') \r\n                  and to_date('2001-08-08','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r\n                  and  to_date('2001-08-08','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r\n                  and  to_date('2001-08-08','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r\n                  and  to_date('2001-08-08','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r\n                  and  to_date('2001-08-08','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-08','yyyy-mm-dd') \r                   and to_date('2001-08-08','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('2001-08-08','yyyy-mm-dd') \r                   and to_date('2001-08-08','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r                   and  to_date('2001-08-08','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r                   and  to_date('2001-08-08','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r                   and  to_date('2001-08-08','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-08','yyyy-mm-dd') \r                   and  to_date('2001-08-08','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 649, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/649.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595884.493496
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:24", 
                    "startTimeFormat": "2019-12-06 09:31:24", 
                    "startTime": 1575595884.493597, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_650.sql", 
                    "second": 0.445497989654541, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 1 and d_year = 2001\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 1 and d_year = 2001\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 650, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/650.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595884.939095
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:27", 
                    "startTimeFormat": "2019-12-06 09:31:24", 
                    "startTime": 1575595884.939196, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_651.sql", 
                    "second": 2.4074668884277344, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1185 and 1185+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1185 and 1185+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1185 and 1185+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1185 and 1185+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 651, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/651.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595887.346663
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:27", 
                    "startTimeFormat": "2019-12-06 09:31:27", 
                    "startTime": 1575595887.346754, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_652.sql", 
                    "second": 0.4197080135345459, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Home', 'Music', 'Children')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2001-01-03' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2001-01-03' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Home', 'Music', 'Children')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2001-01-03' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2001-01-03' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 652, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/652.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595887.766462
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:28", 
                    "startTimeFormat": "2019-12-06 09:31:27", 
                    "startTime": 1575595887.766545, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_653.sql", 
                    "second": 0.29365992546081543, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1219 and 1219 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1219 and 1219 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 653, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/653.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595888.060205
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:29", 
                    "startTimeFormat": "2019-12-06 09:31:28", 
                    "startTime": 1575595888.060308, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_654.sql", 
                    "second": 1.7174339294433594, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1222 and 1222 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1222 and 1222 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1222 and 1222 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1222 and 1222 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 654, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/654.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595889.777742
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:37", 
                    "startTimeFormat": "2019-12-06 09:31:29", 
                    "startTime": 1575595889.777838, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_655.sql", 
                    "second": 7.42449688911438, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1193 and 1193 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1193 and 1193 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 655, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/655.sql", 
                    "secondFormat": "00:00:07", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595897.202335
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:38", 
                    "startTimeFormat": "2019-12-06 09:31:37", 
                    "startTime": 1575595897.202447, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_656.sql", 
                    "second": 0.962224006652832, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'W'\r\n   and \r\n   cd_education_status = '4 yr Degree'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = 'Secondary'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('WA', 'UT', 'TX')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('OK', 'IL', 'IA')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('NJ', 'MN', 'AR')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'W'\r    and \r    cd_education_status = '4 yr Degree'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = 'Secondary'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('WA', 'UT', 'TX')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('OK', 'IL', 'IA')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('NJ', 'MN', 'AR')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 656, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/656.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595898.164671
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:39", 
                    "startTimeFormat": "2019-12-06 09:31:38", 
                    "startTime": 1575595898.164751, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_657.sql", 
                    "second": 1.4433319568634033, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 1998) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 1998+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 1998) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 1998+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 657, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/657.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595899.608083
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:40", 
                    "startTimeFormat": "2019-12-06 09:31:39", 
                    "startTime": 1575595899.608178, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_658.sql", 
                    "second": 0.4604780673980713, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 3)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (1998,1998+1,1998+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 3)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (1998,1998+1,1998+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 658, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/658.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595900.068656
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:40", 
                    "startTimeFormat": "2019-12-06 09:31:40", 
                    "startTime": 1575595900.068746, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_659.sql", 
                    "second": 0.43206000328063965, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('steel','medium','powder'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2001\r\n and     d_moy                   = 5\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('steel','medium','powder'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2001\r\n and     d_moy                   = 5\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('steel','medium','powder'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2001\r\n and     d_moy                   = 5\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('steel','medium','powder'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2001\r  and     d_moy                   = 5\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('steel','medium','powder'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2001\r  and     d_moy                   = 5\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('steel','medium','powder'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2001\r  and     d_moy                   = 5\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 659, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/659.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595900.500806
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:40", 
                    "startTimeFormat": "2019-12-06 09:31:40", 
                    "startTime": 1575595900.500906, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_660.sql", 
                    "second": 0.17497491836547852, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 37 and 37 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2000-04-03' ,'yyyy-mm-dd') and to_date('2000-04-03' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (814,930,917,767)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 37 and 37 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2000-04-03' ,'yyyy-mm-dd') and to_date('2000-04-03' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (814,930,917,767)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 660, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/660.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595900.675881
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:41", 
                    "startTimeFormat": "2019-12-06 09:31:40", 
                    "startTime": 1575595900.675981, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_661.sql", 
                    "second": 0.714789867401123, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Harlan County','Lincoln County','Utah County','Dickinson County','Dawes County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_moy between 4 and 4+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2000 and\r\n                  d_moy between 4 and 4+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2000 and\r\n                  d_moy between 4 and 4+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Harlan County','Lincoln County','Utah County','Dickinson County','Dawes County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_moy between 4 and 4+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2000 and\r                   d_moy between 4 and 4+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2000 and\r                   d_moy between 4 and 4+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 661, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/661.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595901.390771
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:41", 
                    "startTimeFormat": "2019-12-06 09:31:41", 
                    "startTime": 1575595901.390876, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_662.sql", 
                    "second": 0.21246790885925293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 12 and 12+1\r\n         and household_demographics.hd_dep_count = 8\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 17 and 17+1\r\n         and household_demographics.hd_dep_count = 8\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 12 and 12+1\r          and household_demographics.hd_dep_count = 8\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 17 and 17+1\r          and household_demographics.hd_dep_count = 8\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 662, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/662.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595901.603344
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:41", 
                    "startTimeFormat": "2019-12-06 09:31:41", 
                    "startTime": 1575595901.603442, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_663.sql", 
                    "second": 0.18082594871520996, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('1998-02-16' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('1998-02-16' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('1998-02-16' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('1998-02-16' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('1998-02-16' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('1998-02-16' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('1998-02-16' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('1998-02-16' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 663, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/663.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595901.784268
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:41", 
                    "startTimeFormat": "2019-12-06 09:31:41", 
                    "startTime": 1575595901.784367, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_664.sql", 
                    "second": 0.07301497459411621, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 2 or\r\n         household_demographics.hd_vehicle_count= 4)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_city in ('Lakeside','Glenwood','Georgetown','Greenville','Riverside') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 2 or\r          household_demographics.hd_vehicle_count= 4)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_city in ('Lakeside','Glenwood','Georgetown','Greenville','Riverside') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 664, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/664.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595901.857382
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:41", 
                    "startTime": 1575595901.857548, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_665.sql", 
                    "second": 0.17306995391845703, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('1998-02-11','yyyy-mm-dd'),to_date('1998-08-06','yyyy-mm-dd'),to_date('1998-11-16','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('1998-02-11','yyyy-mm-dd'),to_date('1998-08-06','yyyy-mm-dd'),to_date('1998-11-16','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('1998-02-11','yyyy-mm-dd'),to_date('1998-08-06','yyyy-mm-dd'),to_date('1998-11-16','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('1998-02-11','yyyy-mm-dd'),to_date('1998-08-06','yyyy-mm-dd'),to_date('1998-11-16','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('1998-02-11','yyyy-mm-dd'),to_date('1998-08-06','yyyy-mm-dd'),to_date('1998-11-16','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('1998-02-11','yyyy-mm-dd'),to_date('1998-08-06','yyyy-mm-dd'),to_date('1998-11-16','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 665, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/665.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595902.030618
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.03077, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_666.sql", 
                    "second": 0.33874082565307617, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 8\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 6\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 8\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 6\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 666, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/666.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595902.369511
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.369606, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_667.sql", 
                    "second": 0.0849609375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 9 or\r\n             household_demographics.hd_vehicle_count= 1)\r\n        and date_dim.d_year in (2000,2000+1,2000+2)\r\n        and store.s_city in ('Lakeview','Oakdale')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 9 or\r              household_demographics.hd_vehicle_count= 1)\r         and date_dim.d_year in (2000,2000+1,2000+2)\r         and store.s_city in ('Lakeview','Oakdale')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 667, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/667.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595902.454567
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.454653, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_668.sql", 
                    "second": 0.4207630157470703, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 668, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/668.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595902.875416
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.875501, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_669.sql", 
                    "second": 0.020893096923828125, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 256\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2000-03-30','yyyy-mm-dd') and \r\n        to_date('2000-03-30','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2000-03-30','yyyy-mm-dd') and\r\n                             to_date('2000-03-30','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 256\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2000-03-30','yyyy-mm-dd') and \r         to_date('2000-03-30','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2000-03-30','yyyy-mm-dd') and\r                              to_date('2000-03-30','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 669, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/669.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595902.896394
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:43", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.896475, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_670.sql", 
                    "second": 0.6130409240722656, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'F' and\r\n       cd_marital_status = 'D' and\r\n       cd_education_status = 'Unknown' and\r\n       d_year = 2001 and\r\n       s_state in ('MI','GA', 'MO', 'TN', 'LA', 'NM')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'F' and\r        cd_marital_status = 'D' and\r        cd_education_status = 'Unknown' and\r        d_year = 2001 and\r        s_state in ('MI','GA', 'MO', 'TN', 'LA', 'NM')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 670, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/670.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595903.509516
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:43", 
                    "startTimeFormat": "2019-12-06 09:31:43", 
                    "startTime": 1575595903.50961, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_671.sql", 
                    "second": 0.14947199821472168, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Women', 'Books', 'Men')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('1999-03-27' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('1999-03-27' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Women', 'Books', 'Men')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('1999-03-27' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('1999-03-27' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 671, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/671.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595903.659082
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:43", 
                    "startTime": 1575595903.659184, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_672.sql", 
                    "second": 14.426788091659546, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('royal','medium','indian','moccasin','dim','papaya') and\r\n         i_current_price between 80 and 80 + 10 and\r\n         i_current_price between 80 + 1 and 80 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2001 and\r\n     cs2.syear = 2001 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('royal','medium','indian','moccasin','dim','papaya') and\r          i_current_price between 80 and 80 + 10 and\r          i_current_price between 80 + 1 and 80 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2001 and\r      cs2.syear = 2001 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 672, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/672.sql", 
                    "secondFormat": "00:00:14", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595918.085972
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:09", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.086069, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_673.sql", 
                    "second": 11.177889823913574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2000-3-01','yyyy-mm-dd') and \r\n            to_date('2000-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'MO'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2000-3-01','yyyy-mm-dd') and \r             to_date('2000-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'MO'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 673, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/673.sql", 
                    "secondFormat": "00:00:11", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595929.263959
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:10", 
                    "startTimeFormat": "2019-12-06 09:32:09", 
                    "startTime": 1575595929.264035, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_674.sql", 
                    "second": 1.3660399913787842, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2000\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=1\r\n  and inv2.d_moy=1+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2000\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=1\r\n  and inv2.d_moy=1+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2000\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=1\r   and inv2.d_moy=1+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2000\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=1\r   and inv2.d_moy=1+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 674, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/674.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595930.630075
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:11", 
                    "startTimeFormat": "2019-12-06 09:32:10", 
                    "startTime": 1575595930.630159, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_675.sql", 
                    "second": 0.7895560264587402, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  stddev_samp(cd_dep_count) s1,\r\n  max(cd_dep_count) s2,\r\n  min(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  stddev_samp(cd_dep_employed_count) s4,\r\n  max(cd_dep_employed_count) s5,\r\n  min(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  stddev_samp(cd_dep_college_count) s7,\r\n  max(cd_dep_college_count) s8,\r\n  min(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   stddev_samp(cd_dep_count) s1,\r   max(cd_dep_count) s2,\r   min(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   stddev_samp(cd_dep_employed_count) s4,\r   max(cd_dep_employed_count) s5,\r   min(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   stddev_samp(cd_dep_college_count) s7,\r   max(cd_dep_college_count) s8,\r   min(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 675, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/675.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595931.419715
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:14", 
                    "startTimeFormat": "2019-12-06 09:32:11", 
                    "startTime": 1575595931.41982, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_676.sql", 
                    "second": 2.861171007156372, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_item_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1999\r\norder by \r\n  ss_item_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_item_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1999\r order by \r   ss_item_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 676, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/676.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595934.280991
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:15", 
                    "startTimeFormat": "2019-12-06 09:32:14", 
                    "startTime": 1575595934.281066, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_677.sql", 
                    "second": 1.0375580787658691, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 2000 or\r\n         ( d_year = 2000-1 and d_moy =12) or\r\n         ( d_year = 2000+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.cc_name\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2000 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 2000 or\r          ( d_year = 2000-1 and d_moy =12) or\r          ( d_year = 2000+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.cc_name\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2000 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 677, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/677.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595935.318624
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:15", 
                    "startTimeFormat": "2019-12-06 09:32:15", 
                    "startTime": 1575595935.318726, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_678.sql", 
                    "second": 0.2966330051422119, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'AIRBORNE' || ',' || 'LATVIAN' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 40922 and 40922+28800 \r\n \tand sm_carrier in ('AIRBORNE','LATVIAN')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'AIRBORNE' || ',' || 'LATVIAN' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 40922 AND 40922+28800 \r\n \tand sm_carrier in ('AIRBORNE','LATVIAN')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'AIRBORNE' || ',' || 'LATVIAN' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 40922 and 40922+28800 \r  \tand sm_carrier in ('AIRBORNE','LATVIAN')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'AIRBORNE' || ',' || 'LATVIAN' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 40922 AND 40922+28800 \r  \tand sm_carrier in ('AIRBORNE','LATVIAN')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 678, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/678.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595935.615359
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:16", 
                    "startTimeFormat": "2019-12-06 09:32:15", 
                    "startTime": 1575595935.61546, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_679.sql", 
                    "second": 0.5699210166931152, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=2001\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=11\r                    and d_year=2001\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 679, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/679.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595936.185381
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:16", 
                    "startTimeFormat": "2019-12-06 09:32:16", 
                    "startTime": 1575595936.185466, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_680.sql", 
                    "second": 0.02089405059814453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =1999\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'KY'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =1999\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'KY'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 680, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/680.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595936.20636
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:16", 
                    "startTimeFormat": "2019-12-06 09:32:16", 
                    "startTime": 1575595936.206457, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_681.sql", 
                    "second": 0.019726991653442383, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_REVERSED_CHARGE) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =2001\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'TX'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_REVERSED_CHARGE) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =2001\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'TX'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 681, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/681.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595936.226184
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:16", 
                    "startTimeFormat": "2019-12-06 09:32:16", 
                    "startTime": 1575595936.226281, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_682.sql", 
                    "second": 0.018731117248535156, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =1998\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'NE'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =1998\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'NE'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 682, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/682.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595936.245012
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:16", 
                    "startTimeFormat": "2019-12-06 09:32:16", 
                    "startTime": 1575595936.245096, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_683.sql", 
                    "second": 0.5925190448760986, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 1998 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 1998 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 683, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/683.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595936.837615
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:17", 
                    "startTimeFormat": "2019-12-06 09:32:16", 
                    "startTime": 1575595936.837713, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_684.sql", 
                    "second": 0.2443370819091797, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=11\r\n    and dt.d_year=2002\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=11\r     and dt.d_year=2002\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 684, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/684.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595937.08205
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:18", 
                    "startTimeFormat": "2019-12-06 09:32:17", 
                    "startTime": 1575595937.082152, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_685.sql", 
                    "second": 1.1486430168151855, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'W'\r\n  and cd_education_status = 'Advanced Degree'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = '2 yr Degree'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'M'\r\n  and cd_education_status = 'Primary'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('NM', 'IL', 'NY')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('CA', 'MO', 'WI')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('FL', 'ND', 'PA')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'W'\r   and cd_education_status = 'Advanced Degree'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = '2 yr Degree'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'M'\r   and cd_education_status = 'Primary'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('NM', 'IL', 'NY')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('CA', 'MO', 'WI')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('FL', 'ND', 'PA')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 685, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/685.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595938.230795
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:18", 
                    "startTimeFormat": "2019-12-06 09:32:18", 
                    "startTime": 1575595938.230889, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_686.sql", 
                    "second": 0.5158908367156982, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_addr_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_promo_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_promo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_promo_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_addr_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_promo_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_promo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_promo_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 686, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/686.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595938.74678
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:19", 
                    "startTimeFormat": "2019-12-06 09:32:18", 
                    "startTime": 1575595938.746886, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_687.sql", 
                    "second": 0.3317410945892334, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '1998Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '1998Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 687, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/687.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595939.078627
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:19", 
                    "startTimeFormat": "2019-12-06 09:32:19", 
                    "startTime": 1575595939.078728, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_688.sql", 
                    "second": 0.30573010444641113, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,max(ss_net_profit) as store_sales_profit\r\n ,max(sr_net_loss) as store_returns_loss\r\n ,max(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 1999\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 1999\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 1999\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,max(ss_net_profit) as store_sales_profit\r  ,max(sr_net_loss) as store_returns_loss\r  ,max(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 1999\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 1999\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 1999\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 688, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/688.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595939.384458
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:19", 
                    "startTimeFormat": "2019-12-06 09:32:19", 
                    "startTime": 1575595939.384553, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_689.sql", 
                    "second": 0.16741394996643066, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('1998-02-22','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('1998-02-22','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('1998-02-22','yyyy-mm-dd') - 30 )\r\n                and (to_date ('1998-02-22','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('1998-02-22','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('1998-02-22','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('1998-02-22','yyyy-mm-dd') - 30 )\r                 and (to_date ('1998-02-22','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 689, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/689.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595939.551967
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:20", 
                    "startTimeFormat": "2019-12-06 09:32:19", 
                    "startTime": 1575595939.552065, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_690.sql", 
                    "second": 1.2020390033721924, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1197 and 1197 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1197 and 1197 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1197 and 1197 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1197 and 1197 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 690, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/690.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595940.754104
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:20", 
                    "startTimeFormat": "2019-12-06 09:32:20", 
                    "startTime": 1575595940.754182, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_691.sql", 
                    "second": 0.23584198951721191, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=49\r\n \tand d_moy=11\r\n \tand d_year=1999\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=49\r  \tand d_moy=11\r  \tand d_year=1999\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 691, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/691.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595940.990024
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:21", 
                    "startTimeFormat": "2019-12-06 09:32:20", 
                    "startTime": 1575595940.990124, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_692.sql", 
                    "second": 0.44051289558410645, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 8\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -7 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 8\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -7 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Children'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 8\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -7\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 8\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -7 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 8\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -7 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Children'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 8\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -7\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 692, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/692.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595941.430637
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:21", 
                    "startTimeFormat": "2019-12-06 09:32:21", 
                    "startTime": 1575595941.430729, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_693.sql", 
                    "second": 0.08108997344970703, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_6.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2000-4-01','yyyy-mm-dd') and \r\n           (to_date('2000-4-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'KY'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Kittitas County','Wadena County','Jefferson Davis Parish','Barrow County',\r\n                  'Mobile County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2000-4-01','yyyy-mm-dd') and \r            (to_date('2000-4-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'KY'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Kittitas County','Wadena County','Jefferson Davis Parish','Barrow County',\r                   'Mobile County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 693, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/693.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_6.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595941.511819
                }
            ], 
            "second": 157.47412180900574, 
            "startTime": 1575595784.0378, 
            "endTime": 1575595941.511922
        }, 
        "startTime": 1575595784.036543, 
        "query_7.sql": {
            "endTimeFormat": "2019-12-06 09:32:08", 
            "startTimeFormat": "2019-12-06 09:29:44", 
            "secondFormat": "00:02:24", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:44", 
                    "startTime": 1575595784.039226, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_694.sql", 
                    "second": 1.370694875717163, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1204 and 1204 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1204 and 1204 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1204 and 1204 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1204 and 1204 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 694, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/694.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595785.409921
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.410003, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_695.sql", 
                    "second": 0.29506802558898926, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1189,1189+1,1189+2,1189+3,1189+4,1189+5,1189+6,1189+7,1189+8,1189+9,1189+10,1189+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1189,1189+1,1189+2,1189+3,1189+4,1189+5,1189+6,1189+7,1189+8,1189+9,1189+10,1189+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 695, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/695.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595785.705071
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.705163, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_696.sql", 
                    "second": 0.022277116775512695, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 513\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2002-01-16','yyyy-mm-dd') and \r\n        to_date('2002-01-16','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2002-01-16','yyyy-mm-dd') and\r\n                             to_date('2002-01-16','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 513\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2002-01-16','yyyy-mm-dd') and \r         to_date('2002-01-16','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2002-01-16','yyyy-mm-dd') and\r                              to_date('2002-01-16','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 696, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/696.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595785.72744
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:46", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.727532, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_697.sql", 
                    "second": 0.6899499893188477, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1222 and 1222 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1222 and 1222 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 697, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/697.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595786.417482
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:47", 
                    "startTimeFormat": "2019-12-06 09:29:46", 
                    "startTime": 1575595786.417632, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_698.sql", 
                    "second": 0.7746319770812988, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 1999\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 1999\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 1999\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 1999\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 1999\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =1999\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by store_q2_q3_increase;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 1999\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 1999\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 1999\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 1999\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 1999\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =1999\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by store_q2_q3_increase;\r \r ", 
                    "id": 698, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/698.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595787.192264
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:47", 
                    "startTime": 1575595787.192364, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_699.sql", 
                    "second": 1.3239550590515137, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2002\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=2\r\n  and inv2.d_moy=2+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2002\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=2\r\n  and inv2.d_moy=2+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2002\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=2\r   and inv2.d_moy=2+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2002\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=2\r   and inv2.d_moy=2+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 699, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/699.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595788.516319
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.516467, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_700.sql", 
                    "second": 0.4279189109802246, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,min(ss_quantity)        as store_sales_quantity\r\n    ,min(sr_return_quantity) as store_returns_quantity\r\n    ,min(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 2000\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 2000\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (2000,2000+1,2000+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,min(ss_quantity)        as store_sales_quantity\r     ,min(sr_return_quantity) as store_returns_quantity\r     ,min(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 2000\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 2000\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (2000,2000+1,2000+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 700, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/700.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595788.944386
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.94449, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_701.sql", 
                    "second": 0.021106958389282227, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 481\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('1999-02-04','yyyy-mm-dd') and \r\n        to_date('1999-02-04','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('1999-02-04','yyyy-mm-dd') and\r\n                             to_date('1999-02-04','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 481\r and i_item_sk = cs_item_sk \r and d_date between to_date('1999-02-04','yyyy-mm-dd') and \r         to_date('1999-02-04','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('1999-02-04','yyyy-mm-dd') and\r                              to_date('1999-02-04','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 701, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/701.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595788.965597
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:22", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.96568, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_702.sql", 
                    "second": 33.3891282081604, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 2001\r\n \t        and d_moy = 2 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 2001\r  \t        and d_moy = 2 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 702, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/702.sql", 
                    "secondFormat": "00:00:33", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595822.354808
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:25", 
                    "startTimeFormat": "2019-12-06 09:30:22", 
                    "startTime": 1575595822.354914, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_703.sql", 
                    "second": 2.8715291023254395, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('salmon','pink','tan','firebrick','papaya','magenta') and\r\n         i_current_price between 40 and 40 + 10 and\r\n         i_current_price between 40 + 1 and 40 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2000 and\r\n     cs2.syear = 2000 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('salmon','pink','tan','firebrick','papaya','magenta') and\r          i_current_price between 40 and 40 + 10 and\r          i_current_price between 40 + 1 and 40 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2000 and\r      cs2.syear = 2000 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 703, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/703.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595825.226443
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:25", 
                    "startTimeFormat": "2019-12-06 09:30:25", 
                    "startTime": 1575595825.22654, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_704.sql", 
                    "second": 0.025111913681030273, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2000\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'MS'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2000\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'MS'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 704, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/704.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595825.251652
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:25", 
                    "startTimeFormat": "2019-12-06 09:30:25", 
                    "startTime": 1575595825.251749, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_705.sql", 
                    "second": 0.08217787742614746, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Dauphin County','Maverick County','Pennington County','Walker County',\r\n                           'Gage County','Luce County','Richland County','Mobile County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Dauphin County','Maverick County','Pennington County','Walker County',\r                            'Gage County','Luce County','Richland County','Mobile County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 705, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/705.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595825.333927
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:26", 
                    "startTimeFormat": "2019-12-06 09:30:25", 
                    "startTime": 1575595825.334012, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_706.sql", 
                    "second": 1.2469558715820312, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'D'\r\n  and cd_education_status = 'Secondary'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'M'\r\n  and cd_education_status = 'Advanced Degree'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'W'\r\n  and cd_education_status = '2 yr Degree'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('MT', 'WY', 'KY')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('UT', 'MN', 'VA')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('GA', 'NE', 'FL')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'D'\r   and cd_education_status = 'Secondary'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'M'\r   and cd_education_status = 'Advanced Degree'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'W'\r   and cd_education_status = '2 yr Degree'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('MT', 'WY', 'KY')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('UT', 'MN', 'VA')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('GA', 'NE', 'FL')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 706, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/706.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595826.580968
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:26", 
                    "startTimeFormat": "2019-12-06 09:30:26", 
                    "startTime": 1575595826.581018, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_707.sql", 
                    "second": 0.2727630138397217, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 16 and 16+10 \r\n             or ss_coupon_amt between 13762 and 13762+1000\r\n             or ss_wholesale_cost between 25 and 25+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 87 and 87+10\r\n          or ss_coupon_amt between 1558 and 1558+1000\r\n          or ss_wholesale_cost between 79 and 79+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 30 and 30+10\r\n          or ss_coupon_amt between 15385 and 15385+1000\r\n          or ss_wholesale_cost between 46 and 46+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 156 and 156+10\r\n          or ss_coupon_amt between 2234 and 2234+1000\r\n          or ss_wholesale_cost between 20 and 20+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 95 and 95+10\r\n          or ss_coupon_amt between 790 and 790+1000\r\n          or ss_wholesale_cost between 64 and 64+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 127 and 127+10\r\n          or ss_coupon_amt between 17154 and 17154+1000\r\n          or ss_wholesale_cost between 13 and 13+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 16 and 16+10 \r              or ss_coupon_amt between 13762 and 13762+1000\r              or ss_wholesale_cost between 25 and 25+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 87 and 87+10\r           or ss_coupon_amt between 1558 and 1558+1000\r           or ss_wholesale_cost between 79 and 79+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 30 and 30+10\r           or ss_coupon_amt between 15385 and 15385+1000\r           or ss_wholesale_cost between 46 and 46+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 156 and 156+10\r           or ss_coupon_amt between 2234 and 2234+1000\r           or ss_wholesale_cost between 20 and 20+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 95 and 95+10\r           or ss_coupon_amt between 790 and 790+1000\r           or ss_wholesale_cost between 64 and 64+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 127 and 127+10\r           or ss_coupon_amt between 17154 and 17154+1000\r           or ss_wholesale_cost between 13 and 13+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 707, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/707.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595826.853781
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:27", 
                    "startTimeFormat": "2019-12-06 09:30:26", 
                    "startTime": 1575595826.853896, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_708.sql", 
                    "second": 0.2556650638580322, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1184 and 1184+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1184 and 1184+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 708, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/708.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595827.109561
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:27", 
                    "startTimeFormat": "2019-12-06 09:30:27", 
                    "startTime": 1575595827.109663, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_709.sql", 
                    "second": 0.13674306869506836, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Newtown'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  21717\r\n   and ib_upper_bound   <=  21717 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Newtown'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  21717\r    and ib_upper_bound   <=  21717 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 709, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/709.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595827.246406
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:27", 
                    "startTimeFormat": "2019-12-06 09:30:27", 
                    "startTime": 1575595827.246501, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_710.sql", 
                    "second": 0.37014007568359375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,stddev_samp(ss_net_profit) as store_sales_profit\r\n ,stddev_samp(sr_net_loss) as store_returns_loss\r\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 1998\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 1998\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 1998\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,stddev_samp(ss_net_profit) as store_sales_profit\r  ,stddev_samp(sr_net_loss) as store_returns_loss\r  ,stddev_samp(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 1998\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 1998\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 1998\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 710, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/710.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595827.616641
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:30", 
                    "startTimeFormat": "2019-12-06 09:30:27", 
                    "startTime": 1575595827.616742, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_711.sql", 
                    "second": 2.5137550830841064, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_login\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  2000\r\n   and t_s_secyear.dyear = 2000+1\r\n   and t_c_firstyear.dyear =  2000\r\n   and t_c_secyear.dyear =  2000+1\r\n   and t_w_firstyear.dyear = 2000\r\n   and t_w_secyear.dyear = 2000+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_login\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_login\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  2000\r    and t_s_secyear.dyear = 2000+1\r    and t_c_firstyear.dyear =  2000\r    and t_c_secyear.dyear =  2000+1\r    and t_w_firstyear.dyear = 2000\r    and t_w_secyear.dyear = 2000+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_login\r  ) where rownum <= 100;\r \r ", 
                    "id": 711, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/711.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595830.130497
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:30", 
                    "startTimeFormat": "2019-12-06 09:30:30", 
                    "startTime": 1575595830.130574, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_712.sql", 
                    "second": 0.43787693977355957, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Women', 'Home', 'Shoes')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('1999-06-10' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('1999-06-10' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Women', 'Home', 'Shoes')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('1999-06-10' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('1999-06-10' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 712, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/712.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595830.568451
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:31", 
                    "startTimeFormat": "2019-12-06 09:30:30", 
                    "startTime": 1575595830.568547, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_713.sql", 
                    "second": 0.4688289165496826, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 7 or household_demographics.hd_vehicle_count > 3)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 7 or household_demographics.hd_vehicle_count > 3)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 713, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/713.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595831.037376
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:31", 
                    "startTimeFormat": "2019-12-06 09:30:31", 
                    "startTime": 1575595831.037457, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_714.sql", 
                    "second": 0.6537060737609863, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('TN','CO','WA') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2002 and\r\n                d_moy between 2 and 2+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_moy between 2 and 2+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_moy between 2 and 2+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('TN','CO','WA') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2002 and\r                 d_moy between 2 and 2+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_moy between 2 and 2+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_moy between 2 and 2+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 714, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/714.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595831.691163
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:34", 
                    "startTimeFormat": "2019-12-06 09:30:31", 
                    "startTime": 1575595831.691265, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_715.sql", 
                    "second": 2.896390914916992, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '501-1000'\r\n  and d1.d_year = 2002\r\n  and cd_marital_status = 'W'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '501-1000'\r   and d1.d_year = 2002\r   and cd_marital_status = 'W'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 715, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/715.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595834.587656
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:34", 
                    "startTimeFormat": "2019-12-06 09:30:34", 
                    "startTime": 1575595834.587753, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_716.sql", 
                    "second": 0.1993858814239502, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 1999\r\n group by ca_zip, ca_county\r\n order by ca_zip, ca_county\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 1999\r  group by ca_zip, ca_county\r  order by ca_zip, ca_county\r   ) where rownum <= 100;\r \r ", 
                    "id": 716, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/716.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595834.787139
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:35", 
                    "startTimeFormat": "2019-12-06 09:30:34", 
                    "startTime": 1575595834.787232, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_717.sql", 
                    "second": 1.0850141048431396, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2002\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'S'\r\n   and \r\n   cd_education_status = 'College'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = 'Advanced Degree'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'W'\r\n   and \r\n   cd_education_status = '4 yr Degree'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('WV', 'WI', 'KY')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('OR', 'ID', 'PA')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('NC', 'ND', 'TX')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2002\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'S'\r    and \r    cd_education_status = 'College'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = 'Advanced Degree'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'W'\r    and \r    cd_education_status = '4 yr Degree'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('WV', 'WI', 'KY')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('OR', 'ID', 'PA')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('NC', 'ND', 'TX')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 717, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/717.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595835.872246
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:35", 
                    "startTime": 1575595835.872351, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_718.sql", 
                    "second": 0.591792106628418, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2000-08-08','yyyy-mm-dd') \r\n                  and to_date('2000-08-08','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2000-08-08','yyyy-mm-dd') \r\n                  and to_date('2000-08-08','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2000-08-08','yyyy-mm-dd') \r\n                  and to_date('2000-08-08','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2000-08-08','yyyy-mm-dd') \r                   and to_date('2000-08-08','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('2000-08-08','yyyy-mm-dd') \r                   and to_date('2000-08-08','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('2000-08-08','yyyy-mm-dd') \r                   and to_date('2000-08-08','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 718, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/718.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595836.464143
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.464242, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_719.sql", 
                    "second": 0.42851901054382324, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Electronics', 'Children', 'Sports')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('1999-06-13' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('1999-06-13' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Electronics', 'Children', 'Sports')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('1999-06-13' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('1999-06-13' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 719, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/719.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595836.892761
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:38", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.892863, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_720.sql", 
                    "second": 1.4870269298553467, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 720, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/720.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595838.37989
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:38", 
                    "startTimeFormat": "2019-12-06 09:30:38", 
                    "startTime": 1575595838.379984, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_721.sql", 
                    "second": 0.2737770080566406, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('1998-05-02' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('1998-05-02' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('1998-05-02' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('1998-05-02' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('1998-05-02' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('1998-05-02' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('1998-05-02' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('1998-05-02' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 721, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/721.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595838.653761
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:40", 
                    "startTimeFormat": "2019-12-06 09:30:38", 
                    "startTime": 1575595838.653875, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_722.sql", 
                    "second": 1.8821837902069092, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1209 and 1209 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1209 and 1209 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1209 and 1209 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1209 and 1209 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 722, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/722.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595840.536059
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:40", 
                    "startTimeFormat": "2019-12-06 09:30:40", 
                    "startTime": 1575595840.536156, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_723.sql", 
                    "second": 0.3904869556427002, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1200 and 1200 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1200 and 1200 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 723, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/723.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595840.926643
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:42", 
                    "startTimeFormat": "2019-12-06 09:30:40", 
                    "startTime": 1575595840.926735, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_724.sql", 
                    "second": 1.8502001762390137, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 2001 or\r\n         ( d_year = 2001-1 and d_moy =12) or\r\n         ( d_year = 2001+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.s_company_name\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2001 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 2001 or\r          ( d_year = 2001-1 and d_moy =12) or\r          ( d_year = 2001+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.s_company_name\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2001 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 724, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/724.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595842.776935
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:43", 
                    "startTimeFormat": "2019-12-06 09:30:42", 
                    "startTime": 1575595842.777041, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_725.sql", 
                    "second": 0.6645510196685791, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Men'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Men'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Men'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2002\r\n and     d_moy                   = 8\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Men'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Men'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Men'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2002\r  and     d_moy                   = 8\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 725, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/725.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595843.441592
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:43", 
                    "startTimeFormat": "2019-12-06 09:30:43", 
                    "startTime": 1575595843.441671, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_726.sql", 
                    "second": 0.5572981834411621, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=12\r\n                   and d_year=2001\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=12\r                    and d_year=2001\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 726, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/726.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595843.998969
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:44", 
                    "startTimeFormat": "2019-12-06 09:30:43", 
                    "startTime": 1575595843.99906, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_727.sql", 
                    "second": 0.10558605194091797, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 9 or\r\n         household_demographics.hd_vehicle_count= 2)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (1998,1998+1,1998+2) \r\n    and store.s_city in ('Shiloh','Pleasant Hill','New Hope','Harmony','Woodlawn') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 9 or\r          household_demographics.hd_vehicle_count= 2)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (1998,1998+1,1998+2) \r     and store.s_city in ('Shiloh','Pleasant Hill','New Hope','Harmony','Woodlawn') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 727, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/727.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595844.104646
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:44", 
                    "startTimeFormat": "2019-12-06 09:30:44", 
                    "startTime": 1575595844.104743, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_728.sql", 
                    "second": 0.4705801010131836, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Scotland County','Grant County','Columbus County','Washington County','Sullivan County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2002 and\r\n                d_moy between 1 and 1+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2002 and\r\n                  d_moy between 1 and 1+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2002 and\r\n                  d_moy between 1 and 1+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Scotland County','Grant County','Columbus County','Washington County','Sullivan County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2002 and\r                 d_moy between 1 and 1+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2002 and\r                   d_moy between 1 and 1+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2002 and\r                   d_moy between 1 and 1+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 728, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/728.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595844.575323
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:58", 
                    "startTimeFormat": "2019-12-06 09:30:44", 
                    "startTime": 1575595844.575421, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_729.sql", 
                    "second": 14.147866010665894, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 2000 AND 2000 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 2000 AND 2000 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 2000+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 2000 AND 2000 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 2000 AND 2000 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 2000 and 2000 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 2000 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 19)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 2000\r\n                       and d_moy = 12\r\n                       and d_dom = 19)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 2000 AND 2000 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 2000 AND 2000 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 2000 AND 2000 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 2000+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 2000+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 2000+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 2000 AND 2000 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 2000 AND 2000 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 2000 AND 2000 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 2000 and 2000 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 2000 + 1\r                        and d_moy = 12\r                        and d_dom = 19)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 2000\r                        and d_moy = 12\r                        and d_dom = 19)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 729, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/729.sql", 
                    "secondFormat": "00:00:14", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595858.723287
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:59", 
                    "startTimeFormat": "2019-12-06 09:30:58", 
                    "startTime": 1575595858.723383, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_730.sql", 
                    "second": 0.7356410026550293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  avg(cd_dep_count) s1,\r\n  max(cd_dep_count) s2,\r\n  avg(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  avg(cd_dep_employed_count) s4,\r\n  max(cd_dep_employed_count) s5,\r\n  avg(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  avg(cd_dep_college_count) s7,\r\n  max(cd_dep_college_count) s8,\r\n  avg(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2002 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2002 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   avg(cd_dep_count) s1,\r   max(cd_dep_count) s2,\r   avg(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   avg(cd_dep_employed_count) s4,\r   max(cd_dep_employed_count) s5,\r   avg(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   avg(cd_dep_college_count) s7,\r   max(cd_dep_college_count) s8,\r   avg(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2002 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2002 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 730, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/730.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595859.459024
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:59", 
                    "startTimeFormat": "2019-12-06 09:30:59", 
                    "startTime": 1575595859.459126, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_731.sql", 
                    "second": 0.23479104042053223, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=54\r\n \tand d_moy=12\r\n \tand d_year=2000\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=54\r  \tand d_moy=12\r  \tand d_year=2000\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 731, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/731.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595859.693917
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:59", 
                    "startTimeFormat": "2019-12-06 09:30:59", 
                    "startTime": 1575595859.693993, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_732.sql", 
                    "second": 0.1449108123779297, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 27 and 27 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2000-07-03' ,'yyyy-mm-dd') and to_date('2000-07-03' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (885,701,946,783)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 27 and 27 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2000-07-03' ,'yyyy-mm-dd') and to_date('2000-07-03' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (885,701,946,783)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 732, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/732.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595859.838904
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:00", 
                    "startTimeFormat": "2019-12-06 09:30:59", 
                    "startTime": 1575595859.838998, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_733.sql", 
                    "second": 0.236677885055542, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=11\r\n    and dt.d_year=2000\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=11\r     and dt.d_year=2000\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 733, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/733.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595860.075676
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:02", 
                    "startTimeFormat": "2019-12-06 09:31:00", 
                    "startTime": 1575595860.075769, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_734.sql", 
                    "second": 2.2820770740509033, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 31634196\r\n            then (select avg(ss_ext_list_price) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 15727758\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 15014704\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 9640340\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 32557685\r\n            then (select avg(ss_ext_list_price)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 31634196\r             then (select avg(ss_ext_list_price) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 15727758\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 15014704\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 9640340\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 32557685\r             then (select avg(ss_ext_list_price)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 734, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/734.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595862.357846
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:02", 
                    "startTime": 1575595862.357939, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_735.sql", 
                    "second": 0.7809550762176514, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 2001\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'W'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Secondary'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'M'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'College' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'U'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = '2 yr Degree'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('OK', 'WV', 'MO')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('KS', 'OH', 'ID')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('MN', 'LA', 'SD')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 2001\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'W'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Secondary'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'M'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'College' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'U'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = '2 yr Degree'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('OK', 'WV', 'MO')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('KS', 'OH', 'ID')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('MN', 'LA', 'SD')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 735, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/735.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595863.138894
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.138985, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_736.sql", 
                    "second": 0.25217318534851074, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('2000-03-14','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('2000-03-14','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('2000-03-14','yyyy-mm-dd') - 30 )\r\n                and (to_date ('2000-03-14','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('2000-03-14','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('2000-03-14','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('2000-03-14','yyyy-mm-dd') - 30 )\r                 and (to_date ('2000-03-14','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 736, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/736.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595863.391158
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.391245, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_737.sql", 
                    "second": 0.5126640796661377, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_addr_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_bill_addr_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_ship_mode_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_ship_mode_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_addr_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_bill_addr_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_ship_mode_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_ship_mode_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 737, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/737.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595863.903909
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:04", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.903991, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_738.sql", 
                    "second": 0.26572108268737793, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 203\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 203\r\n                                                    and ss_hdemo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 203\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 203\r\n                                                    and ss_hdemo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 203\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 203\r                                                     and ss_hdemo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 203\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 203\r                                                     and ss_hdemo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 738, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/738.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595864.169712
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:04", 
                    "startTimeFormat": "2019-12-06 09:31:04", 
                    "startTime": 1575595864.169812, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_739.sql", 
                    "second": 0.2127361297607422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_net_profit) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 421\r\n   and dt.d_moy=12\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_net_profit) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 421\r    and dt.d_moy=12\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 739, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/739.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595864.382548
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:04", 
                    "startTimeFormat": "2019-12-06 09:31:04", 
                    "startTime": 1575595864.38263, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_740.sql", 
                    "second": 0.3791849613189697, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'W' and\r\n       cd_education_status = 'Unknown' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2002 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'W' and\r        cd_education_status = 'Unknown' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2002 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 740, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/740.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595864.761815
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:05", 
                    "startTimeFormat": "2019-12-06 09:31:04", 
                    "startTime": 1575595864.761929, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_741.sql", 
                    "second": 0.3299388885498047, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=6\r\n   and d_moy=12\r\n   and d_year=2002\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=6\r    and d_moy=12\r    and d_year=2002\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 741, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/741.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595865.091868
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:05", 
                    "startTimeFormat": "2019-12-06 09:31:05", 
                    "startTime": 1575595865.091958, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_742.sql", 
                    "second": 0.4016399383544922, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1998-01-22','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1998-01-22','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('1998-01-22','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1998-01-22','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1998-01-22','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('1998-01-22','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 742, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/742.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595865.493598
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:05", 
                    "startTimeFormat": "2019-12-06 09:31:05", 
                    "startTime": 1575595865.493693, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_743.sql", 
                    "second": 0.25163984298706055, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=12\r\n \tand dt.d_year=2000\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=12\r  \tand dt.d_year=2000\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 743, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/743.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595865.745333
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:06", 
                    "startTimeFormat": "2019-12-06 09:31:05", 
                    "startTime": 1575595865.745427, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_744.sql", 
                    "second": 0.9468162059783936, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Home'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Home'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Home') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2000\r\n   AND prev_yr.d_year=2000-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Home'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Home'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Home') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2000\r    AND prev_yr.d_year=2000-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 744, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/744.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595866.692243
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:07", 
                    "startTimeFormat": "2019-12-06 09:31:06", 
                    "startTime": 1575595866.692294, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_745.sql", 
                    "second": 0.4683501720428467, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '2000Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '2000Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 745, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/745.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595867.160644
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:08", 
                    "startTimeFormat": "2019-12-06 09:31:07", 
                    "startTime": 1575595867.160745, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_746.sql", 
                    "second": 1.1943731307983398, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1200 and 1200 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1200 and 1200 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1200 and 1200 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1200 and 1200 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1200 and 1200 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1200 and 1200 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 746, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/746.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595868.355118
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:08", 
                    "startTimeFormat": "2019-12-06 09:31:08", 
                    "startTime": 1575595868.355215, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_747.sql", 
                    "second": 0.171875, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 53 and 53+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('2001-07-23' ,'yyyy-mm-dd') and to_date('2001-07-23' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (670,970,901,338)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 53 and 53+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('2001-07-23' ,'yyyy-mm-dd') and to_date('2001-07-23' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (670,970,901,338)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 747, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/747.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595868.52709
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:09", 
                    "startTimeFormat": "2019-12-06 09:31:08", 
                    "startTime": 1575595868.527178, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_748.sql", 
                    "second": 1.16998291015625, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1207 and 1207+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1207 and 1207+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1207 and 1207+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1207 and 1207+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1207 and 1207+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1207 and 1207+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 748, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/748.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595869.697161
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:10", 
                    "startTimeFormat": "2019-12-06 09:31:09", 
                    "startTime": 1575595869.697257, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_749.sql", 
                    "second": 0.631464958190918, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 1999 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 1999 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 749, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/749.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595870.328722
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:11", 
                    "startTimeFormat": "2019-12-06 09:31:10", 
                    "startTime": 1575595870.328824, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_750.sql", 
                    "second": 1.5249919891357422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_birth_country\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1998\r\n         and t_s_secyear.dyear = 1998+1\r\n         and t_w_firstyear.dyear = 1998\r\n         and t_w_secyear.dyear = 1998+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_birth_country\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_birth_country\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1998\r          and t_s_secyear.dyear = 1998+1\r          and t_w_firstyear.dyear = 1998\r          and t_w_secyear.dyear = 1998+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_birth_country\r  ) where rownum <= 100;\r \r ", 
                    "id": 750, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/750.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595871.853816
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:13", 
                    "startTimeFormat": "2019-12-06 09:31:11", 
                    "startTime": 1575595871.853924, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_751.sql", 
                    "second": 1.5330028533935547, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('2002-08-18','yyyy-mm-dd') \r\n                  and to_date('2002-08-18','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-18','yyyy-mm-dd') \r\n                  and to_date('2002-08-18','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-18','yyyy-mm-dd') \r\n                  and to_date('2002-08-18','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('2002-08-18','yyyy-mm-dd') \r                   and to_date('2002-08-18','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('2002-08-18','yyyy-mm-dd') \r                   and to_date('2002-08-18','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('2002-08-18','yyyy-mm-dd') \r                   and to_date('2002-08-18','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 751, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/751.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595873.386927
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:13", 
                    "startTimeFormat": "2019-12-06 09:31:13", 
                    "startTime": 1575595873.387019, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_752.sql", 
                    "second": 0.07607316970825195, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 892 and 892+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'ivory' or i_color = 'cream') and \r\n        (i_units = 'Case' or i_units = 'Pound') and\r\n        (i_size = 'large' or i_size = 'petite')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'white' or i_color = 'violet') and\r\n        (i_units = 'Gram' or i_units = 'Carton') and\r\n        (i_size = 'N/A' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'powder' or i_color = 'orchid') and\r\n        (i_units = 'Pallet' or i_units = 'Cup') and\r\n        (i_size = 'economy' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'moccasin' or i_color = 'lavender') and\r\n        (i_units = 'Dozen' or i_units = 'N/A') and\r\n        (i_size = 'large' or i_size = 'petite')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'hot' or i_color = 'cyan') and \r\n        (i_units = 'Oz' or i_units = 'Unknown') and\r\n        (i_size = 'large' or i_size = 'petite')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'khaki' or i_color = 'burlywood') and\r\n        (i_units = 'Gross' or i_units = 'Lb') and\r\n        (i_size = 'N/A' or i_size = 'medium')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'papaya' or i_color = 'olive') and\r\n        (i_units = 'Tsp' or i_units = 'Tbl') and\r\n        (i_size = 'economy' or i_size = 'small')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'aquamarine' or i_color = 'coral') and\r\n        (i_units = 'Ton' or i_units = 'Each') and\r\n        (i_size = 'large' or i_size = 'petite')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 892 and 892+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'ivory' or i_color = 'cream') and \r         (i_units = 'Case' or i_units = 'Pound') and\r         (i_size = 'large' or i_size = 'petite')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'white' or i_color = 'violet') and\r         (i_units = 'Gram' or i_units = 'Carton') and\r         (i_size = 'N/A' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'powder' or i_color = 'orchid') and\r         (i_units = 'Pallet' or i_units = 'Cup') and\r         (i_size = 'economy' or i_size = 'small')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'moccasin' or i_color = 'lavender') and\r         (i_units = 'Dozen' or i_units = 'N/A') and\r         (i_size = 'large' or i_size = 'petite')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'hot' or i_color = 'cyan') and \r         (i_units = 'Oz' or i_units = 'Unknown') and\r         (i_size = 'large' or i_size = 'petite')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'khaki' or i_color = 'burlywood') and\r         (i_units = 'Gross' or i_units = 'Lb') and\r         (i_size = 'N/A' or i_size = 'medium')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'papaya' or i_color = 'olive') and\r         (i_units = 'Tsp' or i_units = 'Tbl') and\r         (i_size = 'economy' or i_size = 'small')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'aquamarine' or i_color = 'coral') and\r         (i_units = 'Ton' or i_units = 'Each') and\r         (i_size = 'large' or i_size = 'petite')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 752, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/752.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595873.463092
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:13", 
                    "startTimeFormat": "2019-12-06 09:31:13", 
                    "startTime": 1575595873.463194, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_753.sql", 
                    "second": 0.10188102722167969, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Sports'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 1999\r\n   and   d_moy  = 12) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Sports'\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 1999\r\n   and   d_moy  = 12) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -7\r    and   i_category = 'Sports'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -7\r    and   d_year = 1999\r    and   d_moy  = 12) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -7\r    and   i_category = 'Sports'\r    and   s_gmt_offset = -7\r    and   d_year = 1999\r    and   d_moy  = 12) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 753, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/753.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595873.565075
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:14", 
                    "startTimeFormat": "2019-12-06 09:31:13", 
                    "startTime": 1575595873.565173, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_754.sql", 
                    "second": 0.47778797149658203, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 1\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -7 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 1\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -7 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Books'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 1\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -7\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 1\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -7 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 1\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -7 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Books'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 1\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -7\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 754, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/754.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595874.042961
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:14", 
                    "startTimeFormat": "2019-12-06 09:31:14", 
                    "startTime": 1575595874.043069, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_755.sql", 
                    "second": 0.43732404708862305, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 2002\r\n                         and d_moy = 11\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 2002\r                          and d_moy = 11\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 755, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/755.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595874.480393
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:14", 
                    "startTime": 1575595874.480496, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_756.sql", 
                    "second": 0.634315013885498, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'W' and\r\n       cd_education_status = 'College' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2002 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'W' and\r        cd_education_status = 'College' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2002 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 756, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/756.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595875.114811
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.114911, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_757.sql", 
                    "second": 0.07965803146362305, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '>10000' or\r\n         household_demographics.hd_buy_potential = 'Unknown')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1998,1998+1,1998+2)\r\n    and store.s_county in ('Daviess County','Jackson County','Bronx County','Gage County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '>10000' or\r          household_demographics.hd_buy_potential = 'Unknown')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1998,1998+1,1998+2)\r     and store.s_county in ('Daviess County','Jackson County','Bronx County','Gage County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 757, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/757.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595875.194569
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.19465, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_758.sql", 
                    "second": 0.49312710762023926, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (1999) and\r\n        ((i_category in ('Home','Music','Sports') and\r\n          i_class in ('mattresses','rock','outdoor')\r\n         )\r\n      or (i_category in ('Children','Women','Books') and\r\n          i_class in ('toddlers','swimwear','business') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (1999) and\r         ((i_category in ('Home','Music','Sports') and\r           i_class in ('mattresses','rock','outdoor')\r          )\r       or (i_category in ('Children','Women','Books') and\r           i_class in ('toddlers','swimwear','business') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 758, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/758.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595875.687777
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:15", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.687888, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_759.sql", 
                    "second": 0.022549152374267578, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =2000\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'KY'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =2000\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'KY'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 759, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/759.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595875.710437
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:18", 
                    "startTimeFormat": "2019-12-06 09:31:15", 
                    "startTime": 1575595875.710518, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_760.sql", 
                    "second": 3.283950090408325, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_sold_year, ss_item_sk, ss_customer_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r\norder by \r\n  ss_sold_year, ss_item_sk, ss_customer_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_sold_year, ss_item_sk, ss_customer_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r order by \r   ss_sold_year, ss_item_sk, ss_customer_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 760, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/760.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595878.994468
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:19", 
                    "startTimeFormat": "2019-12-06 09:31:18", 
                    "startTime": 1575595878.994568, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_761.sql", 
                    "second": 0.5648038387298584, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'M' and \r\n       cd1.cd_education_status = 'Secondary' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (6,1,2,10,5,9) and\r\n       d_year = 1998 and\r\n       ca_state in ('TX','GA','MI'\r\n                   ,'NC','OH','NJ','NH')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'M' and \r        cd1.cd_education_status = 'Secondary' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (6,1,2,10,5,9) and\r        d_year = 1998 and\r        ca_state in ('TX','GA','MI'\r                    ,'NC','OH','NJ','NH')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 761, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/761.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595879.559372
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:19", 
                    "startTimeFormat": "2019-12-06 09:31:19", 
                    "startTime": 1575595879.559462, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_762.sql", 
                    "second": 0.13838601112365723, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 1999 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('LA','GA','AL','GA',\r\n                 'GA','IN','NM','NM')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 1999 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('LA','GA','AL','GA',\r                  'GA','IN','NM','NM')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 762, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/762.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595879.697848
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:22", 
                    "startTimeFormat": "2019-12-06 09:31:19", 
                    "startTime": 1575595879.697953, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_763.sql", 
                    "second": 2.3432490825653076, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1198 and 1198+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1198 and 1198+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1198 and 1198+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1198 and 1198+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 763, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/763.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595882.041202
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:22", 
                    "startTimeFormat": "2019-12-06 09:31:22", 
                    "startTime": 1575595882.041305, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_764.sql", 
                    "second": 0.36012983322143555, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('cyan','cornflower','frosted'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 4\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('cyan','cornflower','frosted'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 4\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('cyan','cornflower','frosted'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 4\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('cyan','cornflower','frosted'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 4\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('cyan','cornflower','frosted'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 4\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('cyan','cornflower','frosted'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 4\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 764, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/764.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595882.401435
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:22", 
                    "startTimeFormat": "2019-12-06 09:31:22", 
                    "startTime": 1575595882.401534, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_765.sql", 
                    "second": 0.1663358211517334, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('2001-07-04','yyyy-mm-dd'),to_date('2001-08-12','yyyy-mm-dd'),to_date('2001-11-23','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('2001-07-04','yyyy-mm-dd'),to_date('2001-08-12','yyyy-mm-dd'),to_date('2001-11-23','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('2001-07-04','yyyy-mm-dd'),to_date('2001-08-12','yyyy-mm-dd'),to_date('2001-11-23','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('2001-07-04','yyyy-mm-dd'),to_date('2001-08-12','yyyy-mm-dd'),to_date('2001-11-23','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('2001-07-04','yyyy-mm-dd'),to_date('2001-08-12','yyyy-mm-dd'),to_date('2001-11-23','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('2001-07-04','yyyy-mm-dd'),to_date('2001-08-12','yyyy-mm-dd'),to_date('2001-11-23','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 765, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/765.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595882.56787
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:33", 
                    "startTimeFormat": "2019-12-06 09:31:22", 
                    "startTime": 1575595882.567971, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_766.sql", 
                    "second": 10.521456003189087, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1998,1998+1,1998+2,1998+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1998,1998+1,1998+2,1998+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 2 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 2 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1998,1998 + 1,1998 + 2,1998 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1998,1998+1,1998+2,1998+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1998 \r\n         and d_moy = 2 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1998 \r\n         and d_moy = 2 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1998,1998+1,1998+2,1998+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1998,1998+1,1998+2,1998+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 2 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 2 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1998,1998 + 1,1998 + 2,1998 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1998,1998+1,1998+2,1998+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1998 \r          and d_moy = 2 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1998 \r          and d_moy = 2 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 766, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/766.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595893.089427
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:33", 
                    "startTimeFormat": "2019-12-06 09:31:33", 
                    "startTime": 1575595893.089504, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_767.sql", 
                    "second": 0.1927180290222168, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '38822','54547','26671','79514','70304','47621',\r\n                          '45898','26120','74066','33176','57359',\r\n                          '17076','43079','40467','69987','11847',\r\n                          '25657','44642','82119','73347','91729',\r\n                          '75965','28590','51110','84029','71766',\r\n                          '31499','56318','41564','57279','27040',\r\n                          '29344','17198','91736','84614','25168',\r\n                          '84814','93920','16738','84438','35397',\r\n                          '62161','62354','49430','24060','73807',\r\n                          '30488','48265','57080','59111','55764',\r\n                          '61425','26064','64865','95892','13207',\r\n                          '34396','95265','14499','40888','31917',\r\n                          '62306','15617','53635','40936','11329',\r\n                          '59189','45992','19895','66817','24955',\r\n                          '59497','31604','92150','42315','49160',\r\n                          '62745','15271','14845','70519','91562',\r\n                          '83043','70009','30515','87532','52085',\r\n                          '24315','68910','56345','18968','33929',\r\n                          '85043','20187','59210','53297','70103',\r\n                          '10485','77115','87895','88175','12740',\r\n                          '40500','34261','75187','26524','39681',\r\n                          '11452','24275','88001','34563','68404',\r\n                          '97254','29178','25289','55664','93954',\r\n                          '99132','53741','63667','73844','66453',\r\n                          '27191','45361','58832','78691','81909',\r\n                          '42131','25949','24351','39154','25257',\r\n                          '85025','11332','48064','10373','65014',\r\n                          '16634','43059','30759','11720','77420',\r\n                          '32711','25623','18081','63651','22008',\r\n                          '78909','32606','87558','32083','41355',\r\n                          '52953','58688','65820','48301','83251',\r\n                          '88315','98710','25775','58386','77531',\r\n                          '41188','53411','86292','94852','59761',\r\n                          '63251','14803','61853','87245','64041',\r\n                          '44317','96847','37936','76672','13947',\r\n                          '51312','16982','46647','62500','42901',\r\n                          '46525','64890','92144','81926','37245',\r\n                          '30189','41910','73675','58803','58542',\r\n                          '32163','64777','76945','17304','24281',\r\n                          '12759','17132','93870','43283','49706',\r\n                          '61846','83668','22865','53531','15164',\r\n                          '87381','34576','97494','55204','71044',\r\n                          '25550','10126','16447','88557','92185',\r\n                          '89236','30742','81777','68516','98064',\r\n                          '72256','83412','74460','35931','74295',\r\n                          '27862','17646','93000','95932','99755',\r\n                          '53216','16736','58190','70375','69730',\r\n                          '65961','29849','57484','24627','79574',\r\n                          '76605','18230','60447','70461','46785',\r\n                          '98902','73782','67632','19009','33740',\r\n                          '53267','93820','52472','10500','50858',\r\n                          '35723','14408','11174','55882','77440',\r\n                          '47969','51983','98139','81303','60502',\r\n                          '41391','42814','17833','38415','33147',\r\n                          '26385','41820','31871','99226','82772',\r\n                          '28683','98998','18489','64299','10902',\r\n                          '80715','81423','58541','25077','87317',\r\n                          '52301','44019','48783','27745','19889',\r\n                          '37851','14600','36172','36950','18764',\r\n                          '50329','60295','85386','83232','74371',\r\n                          '65822','13068','34436','49494','20114',\r\n                          '23042','56704','40160','66287','80033',\r\n                          '75090','22579','10161','23007','56045',\r\n                          '69307','41027','25840','11752','39066',\r\n                          '56687','61430','37423','51327','87228',\r\n                          '79027','14589','18291','47098','22529',\r\n                          '79621','14900','15870','72282','98044',\r\n                          '94923','18014','19608','39890','41099',\r\n                          '77014','34909','62839','87103','49672',\r\n                          '72753','62182','73586','42675','77186',\r\n                          '95754','87495','51100','71868','17795',\r\n                          '67541','71448','86598','77803','65811',\r\n                          '55879','57036','63254','18633','49054',\r\n                          '98381','18583','60327','34703','47644',\r\n                          '67621','48419','63005','68144','96745',\r\n                          '76524','99229','64905','95058','16891',\r\n                          '60133','11015','22087','88968','86884',\r\n                          '14434','92636','29949','95366','78533',\r\n                          '40960','98079','34227','96369','24630',\r\n                          '50697','51541','24489','85610')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 2 and d_year = 2002\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '38822','54547','26671','79514','70304','47621',\r                           '45898','26120','74066','33176','57359',\r                           '17076','43079','40467','69987','11847',\r                           '25657','44642','82119','73347','91729',\r                           '75965','28590','51110','84029','71766',\r                           '31499','56318','41564','57279','27040',\r                           '29344','17198','91736','84614','25168',\r                           '84814','93920','16738','84438','35397',\r                           '62161','62354','49430','24060','73807',\r                           '30488','48265','57080','59111','55764',\r                           '61425','26064','64865','95892','13207',\r                           '34396','95265','14499','40888','31917',\r                           '62306','15617','53635','40936','11329',\r                           '59189','45992','19895','66817','24955',\r                           '59497','31604','92150','42315','49160',\r                           '62745','15271','14845','70519','91562',\r                           '83043','70009','30515','87532','52085',\r                           '24315','68910','56345','18968','33929',\r                           '85043','20187','59210','53297','70103',\r                           '10485','77115','87895','88175','12740',\r                           '40500','34261','75187','26524','39681',\r                           '11452','24275','88001','34563','68404',\r                           '97254','29178','25289','55664','93954',\r                           '99132','53741','63667','73844','66453',\r                           '27191','45361','58832','78691','81909',\r                           '42131','25949','24351','39154','25257',\r                           '85025','11332','48064','10373','65014',\r                           '16634','43059','30759','11720','77420',\r                           '32711','25623','18081','63651','22008',\r                           '78909','32606','87558','32083','41355',\r                           '52953','58688','65820','48301','83251',\r                           '88315','98710','25775','58386','77531',\r                           '41188','53411','86292','94852','59761',\r                           '63251','14803','61853','87245','64041',\r                           '44317','96847','37936','76672','13947',\r                           '51312','16982','46647','62500','42901',\r                           '46525','64890','92144','81926','37245',\r                           '30189','41910','73675','58803','58542',\r                           '32163','64777','76945','17304','24281',\r                           '12759','17132','93870','43283','49706',\r                           '61846','83668','22865','53531','15164',\r                           '87381','34576','97494','55204','71044',\r                           '25550','10126','16447','88557','92185',\r                           '89236','30742','81777','68516','98064',\r                           '72256','83412','74460','35931','74295',\r                           '27862','17646','93000','95932','99755',\r                           '53216','16736','58190','70375','69730',\r                           '65961','29849','57484','24627','79574',\r                           '76605','18230','60447','70461','46785',\r                           '98902','73782','67632','19009','33740',\r                           '53267','93820','52472','10500','50858',\r                           '35723','14408','11174','55882','77440',\r                           '47969','51983','98139','81303','60502',\r                           '41391','42814','17833','38415','33147',\r                           '26385','41820','31871','99226','82772',\r                           '28683','98998','18489','64299','10902',\r                           '80715','81423','58541','25077','87317',\r                           '52301','44019','48783','27745','19889',\r                           '37851','14600','36172','36950','18764',\r                           '50329','60295','85386','83232','74371',\r                           '65822','13068','34436','49494','20114',\r                           '23042','56704','40160','66287','80033',\r                           '75090','22579','10161','23007','56045',\r                           '69307','41027','25840','11752','39066',\r                           '56687','61430','37423','51327','87228',\r                           '79027','14589','18291','47098','22529',\r                           '79621','14900','15870','72282','98044',\r                           '94923','18014','19608','39890','41099',\r                           '77014','34909','62839','87103','49672',\r                           '72753','62182','73586','42675','77186',\r                           '95754','87495','51100','71868','17795',\r                           '67541','71448','86598','77803','65811',\r                           '55879','57036','63254','18633','49054',\r                           '98381','18583','60327','34703','47644',\r                           '67621','48419','63005','68144','96745',\r                           '76524','99229','64905','95058','16891',\r                           '60133','11015','22087','88968','86884',\r                           '14434','92636','29949','95366','78533',\r                           '40960','98079','34227','96369','24630',\r                           '50697','51541','24489','85610')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 2 and d_year = 2002\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 767, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/767.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595893.282222
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:33", 
                    "startTime": 1575595893.282325, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_768.sql", 
                    "second": 1.972795009613037, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_ext_sales_price) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=6\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'medium'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_ext_sales_price) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 6\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'brown'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_ext_sales_price) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=6\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'medium'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_ext_sales_price) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 6\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'brown'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 768, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/768.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595895.25512
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.255197, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_769.sql", 
                    "second": 0.3051478862762451, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1204,1204+1,1204+2,1204+3,1204+4,1204+5,1204+6,1204+7,1204+8,1204+9,1204+10,1204+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1204,1204+1,1204+2,1204+3,1204+4,1204+5,1204+6,1204+7,1204+8,1204+9,1204+10,1204+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 769, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/769.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595895.560345
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.560445, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_770.sql", 
                    "second": 0.021816015243530273, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_REVERSED_CHARGE) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =2000\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'OH'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_REVERSED_CHARGE) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =2000\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'OH'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 770, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/770.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595895.582261
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.582357, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_771.sql", 
                    "second": 0.15567803382873535, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Electronics', 'Jewelry', 'Sports')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('2002-01-03' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('2002-01-03' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Electronics', 'Jewelry', 'Sports')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('2002-01-03' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('2002-01-03' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 771, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/771.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595895.738035
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.738131, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_772.sql", 
                    "second": 0.08936190605163574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 8 or\r\n             household_demographics.hd_vehicle_count= -1)\r\n        and date_dim.d_year in (1999,1999+1,1999+2)\r\n        and store.s_city in ('Pleasant Valley','Lakewood')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 8 or\r              household_demographics.hd_vehicle_count= -1)\r         and date_dim.d_year in (1999,1999+1,1999+2)\r         and store.s_city in ('Pleasant Valley','Lakewood')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 772, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/772.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595895.827493
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:36", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.827588, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_773.sql", 
                    "second": 0.3358919620513916, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'ZHOU' || ',' || 'DHL' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 23674 and 23674+28800 \r\n \tand sm_carrier in ('ZHOU','DHL')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'ZHOU' || ',' || 'DHL' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 23674 AND 23674+28800 \r\n \tand sm_carrier in ('ZHOU','DHL')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'ZHOU' || ',' || 'DHL' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 23674 and 23674+28800 \r  \tand sm_carrier in ('ZHOU','DHL')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'ZHOU' || ',' || 'DHL' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 23674 AND 23674+28800 \r  \tand sm_carrier in ('ZHOU','DHL')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 773, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/773.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595896.16348
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:42", 
                    "startTimeFormat": "2019-12-06 09:31:36", 
                    "startTime": 1575595896.163564, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_774.sql", 
                    "second": 6.455559968948364, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1191 and 1191+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1191 and 1191+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 774, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/774.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595902.619124
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:43", 
                    "startTimeFormat": "2019-12-06 09:31:42", 
                    "startTime": 1575595902.619245, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_775.sql", 
                    "second": 0.5188019275665283, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-21','yyyy-mm-dd') \r\n                  and to_date('2001-08-21','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-21','yyyy-mm-dd') \r\n                  and to_date('2001-08-21','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r\n                  and  to_date('2001-08-21','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r\n                  and  to_date('2001-08-21','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r\n                  and  to_date('2001-08-21','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r\n                  and  to_date('2001-08-21','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-21','yyyy-mm-dd') \r                   and to_date('2001-08-21','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('2001-08-21','yyyy-mm-dd') \r                   and to_date('2001-08-21','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r                   and  to_date('2001-08-21','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r                   and  to_date('2001-08-21','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r                   and  to_date('2001-08-21','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-21','yyyy-mm-dd') \r                   and  to_date('2001-08-21','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 775, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/775.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595903.138047
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:43", 
                    "startTimeFormat": "2019-12-06 09:31:43", 
                    "startTime": 1575595903.138146, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_776.sql", 
                    "second": 0.3097209930419922, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 1999\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 1999\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 776, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/776.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595903.447867
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:44", 
                    "startTimeFormat": "2019-12-06 09:31:43", 
                    "startTime": 1575595903.447978, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_777.sql", 
                    "second": 0.6812820434570312, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or\r           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 777, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/777.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595904.12926
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:44", 
                    "startTimeFormat": "2019-12-06 09:31:44", 
                    "startTime": 1575595904.129358, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_778.sql", 
                    "second": 0.8456499576568604, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1204 and 1204+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 778, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/778.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595904.975008
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:46", 
                    "startTimeFormat": "2019-12-06 09:31:44", 
                    "startTime": 1575595904.975113, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_779.sql", 
                    "second": 1.8462471961975098, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1206 and 1206 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1206+ 12 and 1206 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1206 and 1206 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1206+ 12 and 1206 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 779, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/779.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595906.82136
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:47", 
                    "startTimeFormat": "2019-12-06 09:31:46", 
                    "startTime": 1575595906.821449, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_780.sql", 
                    "second": 0.2717900276184082, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 20\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 5\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 20\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 5\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 780, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/780.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595907.093239
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:47", 
                    "startTimeFormat": "2019-12-06 09:31:47", 
                    "startTime": 1575595907.093315, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_781.sql", 
                    "second": 0.6462240219116211, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Electronics'\r\n         and i_class = 'camcorders'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 7\r\n         and d_year = 2001\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2001 and d_moy = 7)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2001 and d_moy = 7)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Electronics'\r          and i_class = 'camcorders'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 7\r          and d_year = 2001\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2001 and d_moy = 7)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2001 and d_moy = 7)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 781, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/781.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595907.739539
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:47", 
                    "startTime": 1575595907.739633, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_782.sql", 
                    "second": 11.129321813583374, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-4-01','yyyy-mm-dd') and \r\n            to_date('2002-4-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'ND'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-4-01','yyyy-mm-dd') and \r             to_date('2002-4-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'ND'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 782, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/782.sql", 
                    "secondFormat": "00:00:11", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595918.868955
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:58", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.869066, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_783.sql", 
                    "second": 0.05736994743347168, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'reason 60') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'reason 60') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 783, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/783.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595918.926436
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:59", 
                    "startTimeFormat": "2019-12-06 09:31:58", 
                    "startTime": 1575595918.926529, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_784.sql", 
                    "second": 0.1775660514831543, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 2000 \r\nand     d_moy                   = 11\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like '0-500%'\r\nand     ca_gmt_offset           = -7\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 2000 \r and     d_moy                   = 11\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like '0-500%'\r and     ca_gmt_offset           = -7\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 784, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/784.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595919.104095
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:00", 
                    "startTimeFormat": "2019-12-06 09:31:59", 
                    "startTime": 1575595919.104194, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_785.sql", 
                    "second": 1.2067630290985107, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (1998,1998+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,stddev_samp(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (1998,1998+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 1998\r\n         and t_s_secyear.year = 1998+1\r\n         and t_w_firstyear.year = 1998\r\n         and t_w_secyear.year = 1998+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 3,2,1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (1998,1998+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,stddev_samp(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (1998,1998+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 1998\r          and t_s_secyear.year = 1998+1\r          and t_w_firstyear.year = 1998\r          and t_w_secyear.year = 1998+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 3,2,1\r  ) where rownum <= 100;\r \r ", 
                    "id": 785, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/785.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595920.310957
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:00", 
                    "startTimeFormat": "2019-12-06 09:32:00", 
                    "startTime": 1575595920.311062, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_786.sql", 
                    "second": 0.31463098526000977, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2000-3-01','yyyy-mm-dd') and \r\n           to_date('2000-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'NE'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2000-3-01','yyyy-mm-dd') and \r            to_date('2000-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'NE'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 786, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/786.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595920.625693
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:01", 
                    "startTimeFormat": "2019-12-06 09:32:00", 
                    "startTime": 1575595920.6258, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_787.sql", 
                    "second": 1.0863380432128906, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2001-2-01','yyyy-mm-dd') and \r\n           (to_date('2001-2-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'SD'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('Walker County','Richland County','Bronx County','San Miguel County',\r\n                  'Williamson County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2001-2-01','yyyy-mm-dd') and \r            (to_date('2001-2-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'SD'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('Walker County','Richland County','Bronx County','San Miguel County',\r                   'Williamson County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 787, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/787.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595921.712138
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:01", 
                    "startTimeFormat": "2019-12-06 09:32:01", 
                    "startTime": 1575595921.712239, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_788.sql", 
                    "second": 0.1543290615081787, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 12 and 12+1\r\n         and household_demographics.hd_dep_count = 4\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 19 and 19+1\r\n         and household_demographics.hd_dep_count = 4\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 12 and 12+1\r          and household_demographics.hd_dep_count = 4\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 19 and 19+1\r          and household_demographics.hd_dep_count = 4\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 788, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/788.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595921.866568
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:02", 
                    "startTimeFormat": "2019-12-06 09:32:01", 
                    "startTime": 1575595921.866678, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_789.sql", 
                    "second": 1.095555067062378, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_category\r\n        ,v1.d_year, v1.d_moy\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_category\r         ,v1.d_year, v1.d_moy\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 789, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/789.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595922.962233
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:02", 
                    "startTime": 1575595922.962319, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_790.sql", 
                    "second": 4.631968021392822, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1207 and 1207 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1207 and 1207 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 790, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/790.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595927.594287
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:08", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.594389, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_791.sql", 
                    "second": 0.4295339584350586, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 1999\r\nand d2.d_moy  = 10\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 1999\r and d2.d_moy  = 10\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 791, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/791.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595928.023923
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:08", 
                    "startTimeFormat": "2019-12-06 09:32:08", 
                    "startTime": 1575595928.024027, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_792.sql", 
                    "second": 0.06313896179199219, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_7.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'M' and\r\n       cd_marital_status = 'D' and\r\n       cd_education_status = 'Unknown' and\r\n       d_year = 2001 and\r\n       s_state in ('GA','SD', 'MN', 'MI', 'NM', 'MI')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'M' and\r        cd_marital_status = 'D' and\r        cd_education_status = 'Unknown' and\r        d_year = 2001 and\r        s_state in ('GA','SD', 'MN', 'MI', 'NM', 'MI')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 792, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/792.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_7.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595928.087166
                }
            ], 
            "second": 144.0480978488922, 
            "startTime": 1575595784.039163, 
            "endTime": 1575595928.087261
        }, 
        "query_5.sql": {
            "endTimeFormat": "2019-12-06 09:32:08", 
            "startTimeFormat": "2019-12-06 09:29:44", 
            "secondFormat": "00:02:24", 
            "sqls": [
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:44", 
                    "startTime": 1575595784.038928, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_496.sql", 
                    "second": 1.1262660026550293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag \r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and date_dim.d_dom between 1 and 2 \r\n    and (household_demographics.hd_buy_potential = '1001-5000' or\r\n         household_demographics.hd_buy_potential = '0-500')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and case when household_demographics.hd_vehicle_count > 0 then \r\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Richland County','Gage County','Daviess County','Bronx County')\r\n    group by ss_ticket_number,ss_customer_sk) dj,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 1 and 5\r\n    order by cnt desc, c_last_name asc;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag \r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and date_dim.d_dom between 1 and 2 \r     and (household_demographics.hd_buy_potential = '1001-5000' or\r          household_demographics.hd_buy_potential = '0-500')\r     and household_demographics.hd_vehicle_count > 0\r     and case when household_demographics.hd_vehicle_count > 0 then \r              household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Richland County','Gage County','Daviess County','Bronx County')\r     group by ss_ticket_number,ss_customer_sk) dj,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 1 and 5\r     order by cnt desc, c_last_name asc;\r \r ", 
                    "id": 496, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/496.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query73.tpl\r", 
                    "sid": 1, 
                    "endTime": 1575595785.165194
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:45", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.165285, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_497.sql", 
                    "second": 0.356813907623291, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select   \r\n         w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n        ,ship_carriers\r\n        ,year\r\n \t,sum(jan_sales) as jan_sales\r\n \t,sum(feb_sales) as feb_sales\r\n \t,sum(mar_sales) as mar_sales\r\n \t,sum(apr_sales) as apr_sales\r\n \t,sum(may_sales) as may_sales\r\n \t,sum(jun_sales) as jun_sales\r\n \t,sum(jul_sales) as jul_sales\r\n \t,sum(aug_sales) as aug_sales\r\n \t,sum(sep_sales) as sep_sales\r\n \t,sum(oct_sales) as oct_sales\r\n \t,sum(nov_sales) as nov_sales\r\n \t,sum(dec_sales) as dec_sales\r\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r\n \t,sum(jan_net) as jan_net\r\n \t,sum(feb_net) as feb_net\r\n \t,sum(mar_net) as mar_net\r\n \t,sum(apr_net) as apr_net\r\n \t,sum(may_net) as may_net\r\n \t,sum(jun_net) as jun_net\r\n \t,sum(jul_net) as jul_net\r\n \t,sum(aug_net) as aug_net\r\n \t,sum(sep_net) as sep_net\r\n \t,sum(oct_net) as oct_net\r\n \t,sum(nov_net) as nov_net\r\n \t,sum(dec_net) as dec_net\r\n from (\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'DHL' || ',' || 'AIRBORNE' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net\r\n     from\r\n          web_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t  ,ship_mode\r\n     where\r\n            ws_warehouse_sk =  w_warehouse_sk\r\n        and ws_sold_date_sk = d_date_sk\r\n        and ws_sold_time_sk = t_time_sk\r\n \tand ws_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 30232 and 30232+28800 \r\n \tand sm_carrier in ('DHL','AIRBORNE')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n union all\r\n     select \r\n \tw_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,'DHL' || ',' || 'AIRBORNE' as ship_carriers\r\n       ,d_year as year\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales\r\n \t,sum(case when d_moy = 1 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net\r\n \t,sum(case when d_moy = 2 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net\r\n \t,sum(case when d_moy = 3 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net\r\n \t,sum(case when d_moy = 4 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net\r\n \t,sum(case when d_moy = 5 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net\r\n \t,sum(case when d_moy = 6 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net\r\n \t,sum(case when d_moy = 7 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net\r\n \t,sum(case when d_moy = 8 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net\r\n \t,sum(case when d_moy = 9 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net\r\n \t,sum(case when d_moy = 10 \r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net\r\n \t,sum(case when d_moy = 11\r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net\r\n \t,sum(case when d_moy = 12\r\n \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net\r\n     from\r\n          catalog_sales\r\n         ,warehouse\r\n         ,date_dim\r\n         ,time_dim\r\n \t ,ship_mode\r\n     where\r\n            cs_warehouse_sk =  w_warehouse_sk\r\n        and cs_sold_date_sk = d_date_sk\r\n        and cs_sold_time_sk = t_time_sk\r\n \tand cs_ship_mode_sk = sm_ship_mode_sk\r\n        and d_year = 2001\r\n \tand t_time between 30232 AND 30232+28800 \r\n \tand sm_carrier in ('DHL','AIRBORNE')\r\n     group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n       ,d_year\r\n ) x\r\n group by \r\n        w_warehouse_name\r\n \t,w_warehouse_sq_ft\r\n \t,w_city\r\n \t,w_county\r\n \t,w_state\r\n \t,w_country\r\n \t,ship_carriers\r\n       ,year\r\n order by w_warehouse_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r          w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r         ,ship_carriers\r         ,year\r  \t,sum(jan_sales) as jan_sales\r  \t,sum(feb_sales) as feb_sales\r  \t,sum(mar_sales) as mar_sales\r  \t,sum(apr_sales) as apr_sales\r  \t,sum(may_sales) as may_sales\r  \t,sum(jun_sales) as jun_sales\r  \t,sum(jul_sales) as jul_sales\r  \t,sum(aug_sales) as aug_sales\r  \t,sum(sep_sales) as sep_sales\r  \t,sum(oct_sales) as oct_sales\r  \t,sum(nov_sales) as nov_sales\r  \t,sum(dec_sales) as dec_sales\r  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\r  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\r  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\r  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\r  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\r  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\r  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\r  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\r  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\r  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\r  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\r  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\r  \t,sum(jan_net) as jan_net\r  \t,sum(feb_net) as feb_net\r  \t,sum(mar_net) as mar_net\r  \t,sum(apr_net) as apr_net\r  \t,sum(may_net) as may_net\r  \t,sum(jun_net) as jun_net\r  \t,sum(jul_net) as jul_net\r  \t,sum(aug_net) as aug_net\r  \t,sum(sep_net) as sep_net\r  \t,sum(oct_net) as oct_net\r  \t,sum(nov_net) as nov_net\r  \t,sum(dec_net) as dec_net\r  from (\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'DHL' || ',' || 'AIRBORNE' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net\r      from\r           web_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t  ,ship_mode\r      where\r             ws_warehouse_sk =  w_warehouse_sk\r         and ws_sold_date_sk = d_date_sk\r         and ws_sold_time_sk = t_time_sk\r  \tand ws_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 30232 and 30232+28800 \r  \tand sm_carrier in ('DHL','AIRBORNE')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  union all\r      select \r  \tw_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,'DHL' || ',' || 'AIRBORNE' as ship_carriers\r        ,d_year as year\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales\r  \t,sum(case when d_moy = 1 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net\r  \t,sum(case when d_moy = 2 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net\r  \t,sum(case when d_moy = 3 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net\r  \t,sum(case when d_moy = 4 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net\r  \t,sum(case when d_moy = 5 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net\r  \t,sum(case when d_moy = 6 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net\r  \t,sum(case when d_moy = 7 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net\r  \t,sum(case when d_moy = 8 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net\r  \t,sum(case when d_moy = 9 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net\r  \t,sum(case when d_moy = 10 \r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net\r  \t,sum(case when d_moy = 11\r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net\r  \t,sum(case when d_moy = 12\r  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net\r      from\r           catalog_sales\r          ,warehouse\r          ,date_dim\r          ,time_dim\r  \t ,ship_mode\r      where\r             cs_warehouse_sk =  w_warehouse_sk\r         and cs_sold_date_sk = d_date_sk\r         and cs_sold_time_sk = t_time_sk\r  \tand cs_ship_mode_sk = sm_ship_mode_sk\r         and d_year = 2001\r  \tand t_time between 30232 AND 30232+28800 \r  \tand sm_carrier in ('DHL','AIRBORNE')\r      group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r        ,d_year\r  ) x\r  group by \r         w_warehouse_name\r  \t,w_warehouse_sq_ft\r  \t,w_city\r  \t,w_county\r  \t,w_state\r  \t,w_country\r  \t,ship_carriers\r        ,year\r  order by w_warehouse_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 497, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/497.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query66.tpl\r", 
                    "sid": 2, 
                    "endTime": 1575595785.522099
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:47", 
                    "startTimeFormat": "2019-12-06 09:29:45", 
                    "startTime": 1575595785.522182, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_498.sql", 
                    "second": 2.4143359661102295, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r\n       ,'c' sale_type\r\n from customer\r\n     ,catalog_sales\r\n     ,date_dim\r\n where c_customer_sk = cs_bill_customer_sk\r\n   and cs_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\nunion all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag\r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\nselect * from (  select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_login\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_c_firstyear\r\n     ,year_total t_c_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\r\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n   and t_s_firstyear.sale_type = 's'\r\n   and t_c_firstyear.sale_type = 'c'\r\n   and t_w_firstyear.sale_type = 'w'\r\n   and t_s_secyear.sale_type = 's'\r\n   and t_c_secyear.sale_type = 'c'\r\n   and t_w_secyear.sale_type = 'w'\r\n   and t_s_firstyear.dyear =  2000\r\n   and t_s_secyear.dyear = 2000+1\r\n   and t_c_firstyear.dyear =  2000\r\n   and t_c_secyear.dyear =  2000+1\r\n   and t_w_firstyear.dyear = 2000\r\n   and t_w_secyear.dyear = 2000+1\r\n   and t_s_firstyear.year_total > 0\r\n   and t_c_firstyear.year_total > 0\r\n   and t_w_firstyear.year_total > 0\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_login\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\r        ,'c' sale_type\r  from customer\r      ,catalog_sales\r      ,date_dim\r  where c_customer_sk = cs_bill_customer_sk\r    and cs_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag\r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r select * from (  select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_login\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_c_firstyear\r      ,year_total t_c_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_c_secyear.customer_id\r    and t_s_firstyear.customer_id = t_c_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r    and t_s_firstyear.customer_id = t_w_secyear.customer_id\r    and t_s_firstyear.sale_type = 's'\r    and t_c_firstyear.sale_type = 'c'\r    and t_w_firstyear.sale_type = 'w'\r    and t_s_secyear.sale_type = 's'\r    and t_c_secyear.sale_type = 'c'\r    and t_w_secyear.sale_type = 'w'\r    and t_s_firstyear.dyear =  2000\r    and t_s_secyear.dyear = 2000+1\r    and t_c_firstyear.dyear =  2000\r    and t_c_secyear.dyear =  2000+1\r    and t_w_firstyear.dyear = 2000\r    and t_w_secyear.dyear = 2000+1\r    and t_s_firstyear.year_total > 0\r    and t_c_firstyear.year_total > 0\r    and t_w_firstyear.year_total > 0\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\r            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_login\r  ) where rownum <= 100;\r \r ", 
                    "id": 498, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/498.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query4.tpl\r", 
                    "sid": 3, 
                    "endTime": 1575595787.936518
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:47", 
                    "startTime": 1575595787.936624, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_499.sql", 
                    "second": 0.33425092697143555, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,s_state\r\n       ,count(ss_quantity) as store_sales_quantitycount\r\n       ,avg(ss_quantity) as store_sales_quantityave\r\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r\n       ,count(sr_return_quantity) as store_returns_quantitycount\r\n       ,avg(sr_return_quantity) as store_returns_quantityave\r\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r\n from store_sales\r\n     ,store_returns\r\n     ,catalog_sales\r\n     ,date_dim d1\r\n     ,date_dim d2\r\n     ,date_dim d3\r\n     ,store\r\n     ,item\r\n where d1.d_quarter_name = '1999Q1'\r\n   and d1.d_date_sk = ss_sold_date_sk\r\n   and i_item_sk = ss_item_sk\r\n   and s_store_sk = ss_store_sk\r\n   and ss_customer_sk = sr_customer_sk\r\n   and ss_item_sk = sr_item_sk\r\n   and ss_ticket_number = sr_ticket_number\r\n   and sr_returned_date_sk = d2.d_date_sk\r\n   and d2.d_quarter_name in ('1999Q1','1999Q2','1999Q3')\r\n   and sr_customer_sk = cs_bill_customer_sk\r\n   and sr_item_sk = cs_item_sk\r\n   and cs_sold_date_sk = d3.d_date_sk\r\n   and d3.d_quarter_name in ('1999Q1','1999Q2','1999Q3')\r\n group by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n order by i_item_id\r\n         ,i_item_desc\r\n         ,s_state\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,s_state\r        ,count(ss_quantity) as store_sales_quantitycount\r        ,avg(ss_quantity) as store_sales_quantityave\r        ,stddev_samp(ss_quantity) as store_sales_quantitystdev\r        ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\r        ,count(sr_return_quantity) as store_returns_quantitycount\r        ,avg(sr_return_quantity) as store_returns_quantityave\r        ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\r        ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\r        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\r        ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\r        ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\r  from store_sales\r      ,store_returns\r      ,catalog_sales\r      ,date_dim d1\r      ,date_dim d2\r      ,date_dim d3\r      ,store\r      ,item\r  where d1.d_quarter_name = '1999Q1'\r    and d1.d_date_sk = ss_sold_date_sk\r    and i_item_sk = ss_item_sk\r    and s_store_sk = ss_store_sk\r    and ss_customer_sk = sr_customer_sk\r    and ss_item_sk = sr_item_sk\r    and ss_ticket_number = sr_ticket_number\r    and sr_returned_date_sk = d2.d_date_sk\r    and d2.d_quarter_name in ('1999Q1','1999Q2','1999Q3')\r    and sr_customer_sk = cs_bill_customer_sk\r    and sr_item_sk = cs_item_sk\r    and cs_sold_date_sk = d3.d_date_sk\r    and d3.d_quarter_name in ('1999Q1','1999Q2','1999Q3')\r  group by i_item_id\r          ,i_item_desc\r          ,s_state\r  order by i_item_id\r          ,i_item_desc\r          ,s_state\r  ) where rownum <= 100;\r \r ", 
                    "id": 499, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/499.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query17.tpl\r", 
                    "sid": 4, 
                    "endTime": 1575595788.270875
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:48", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.270963, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_500.sql", 
                    "second": 0.49300098419189453, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Music'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 8\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n cs as (\r\n select\r\n          i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Music'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 8\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6 \r\n group by i_item_id),\r\n ws as (\r\n select\r\n          i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom\r\n item\r\nwhere i_category in ('Music'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1998\r\n and     d_moy                   = 8\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -6\r\n group by i_item_id)\r\n select * from ( select   \r\n  i_item_id\r\n,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by i_item_id\r\n      ,total_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id in (select\r   i_item_id\r from\r  item\r where i_category in ('Music'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 8\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  cs as (\r  select\r           i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Music'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 8\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6 \r  group by i_item_id),\r  ws as (\r  select\r           i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from\r  item\r where i_category in ('Music'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1998\r  and     d_moy                   = 8\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -6\r  group by i_item_id)\r  select * from ( select   \r   i_item_id\r ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by i_item_id\r       ,total_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 500, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/500.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query60.tpl\r", 
                    "sid": 5, 
                    "endTime": 1575595788.763964
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:48", 
                    "startTime": 1575595788.764061, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_501.sql", 
                    "second": 0.3929729461669922, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ss_ext_sales_price) as itemrevenue \r\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tstore_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tss_item_sk = i_item_sk \r\n  \tand i_category in ('Children', 'Electronics', 'Music')\r\n  \tand ss_sold_date_sk = d_date_sk\r\n\tand d_date between to_date('2000-02-12' ,'yyyy-mm-dd') \r\n\t\t\t\tand to_date('2000-02-12' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio;\r\n\r\n", 
                    "oneline_sql": "select i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ss_ext_sales_price) as itemrevenue \r       ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tstore_sales\r     \t,item \r     \t,date_dim\r where \r \tss_item_sk = i_item_sk \r   \tand i_category in ('Children', 'Electronics', 'Music')\r   \tand ss_sold_date_sk = d_date_sk\r \tand d_date between to_date('2000-02-12' ,'yyyy-mm-dd') \r \t\t\t\tand to_date('2000-02-12' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio;\r \r ", 
                    "id": 501, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/501.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query98.tpl\r", 
                    "sid": 6, 
                    "endTime": 1575595789.157034
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:49", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.157136, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_502.sql", 
                    "second": 0.5719079971313477, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select  *\r\nfrom\r\n (select count(*) h8_30_to_9\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk   \r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 8\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2)) \r\n     and store.s_store_name = 'ese') s1,\r\n (select count(*) h9_to_9_30 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 9 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s2,\r\n (select count(*) h9_30_to_10 \r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 9\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s3,\r\n (select count(*) h10_to_10_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s4,\r\n (select count(*) h10_30_to_11\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 10 \r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s5,\r\n (select count(*) h11_to_11_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk \r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s6,\r\n (select count(*) h11_30_to_12\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 11\r\n     and time_dim.t_minute >= 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s7,\r\n (select count(*) h12_to_12_30\r\n from store_sales, household_demographics , time_dim, store\r\n where ss_sold_time_sk = time_dim.t_time_sk\r\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\r\n     and ss_store_sk = s_store_sk\r\n     and time_dim.t_hour = 12\r\n     and time_dim.t_minute < 30\r\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r\n          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r\n     and store.s_store_name = 'ese') s8\r\n;\r\n\r\n", 
                    "oneline_sql": "select  *\r from\r  (select count(*) h8_30_to_9\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk   \r      and ss_hdemo_sk = household_demographics.hd_demo_sk \r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 8\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2)) \r      and store.s_store_name = 'ese') s1,\r  (select count(*) h9_to_9_30 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 9 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s2,\r  (select count(*) h9_30_to_10 \r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 9\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s3,\r  (select count(*) h10_to_10_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s4,\r  (select count(*) h10_30_to_11\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 10 \r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s5,\r  (select count(*) h11_to_11_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk \r      and time_dim.t_hour = 11\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s6,\r  (select count(*) h11_30_to_12\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 11\r      and time_dim.t_minute >= 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s7,\r  (select count(*) h12_to_12_30\r  from store_sales, household_demographics , time_dim, store\r  where ss_sold_time_sk = time_dim.t_time_sk\r      and ss_hdemo_sk = household_demographics.hd_demo_sk\r      and ss_store_sk = s_store_sk\r      and time_dim.t_hour = 12\r      and time_dim.t_minute < 30\r      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\r           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or\r           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))\r      and store.s_store_name = 'ese') s8\r ;\r \r ", 
                    "id": 502, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/502.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query88.tpl\r", 
                    "sid": 7, 
                    "endTime": 1575595789.729044
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:51", 
                    "startTimeFormat": "2019-12-06 09:29:49", 
                    "startTime": 1575595789.729149, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_503.sql", 
                    "second": 1.4362637996673584, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with wscs as\r\n (select sold_date_sk\r\n        ,sales_price\r\n  from  (select ws_sold_date_sk sold_date_sk\r\n              ,ws_ext_sales_price sales_price\r\n        from web_sales \r\n        union all\r\n        select cs_sold_date_sk sold_date_sk\r\n              ,cs_ext_sales_price sales_price\r\n        from catalog_sales)),\r\n wswscs as \r\n (select d_week_seq,\r\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r\n from wscs\r\n     ,date_dim\r\n where d_date_sk = sold_date_sk\r\n group by d_week_seq)\r\n select d_week_seq1\r\n       ,round(sun_sales1/sun_sales2,2)\r\n       ,round(mon_sales1/mon_sales2,2)\r\n       ,round(tue_sales1/tue_sales2,2)\r\n       ,round(wed_sales1/wed_sales2,2)\r\n       ,round(thu_sales1/thu_sales2,2)\r\n       ,round(fri_sales1/fri_sales2,2)\r\n       ,round(sat_sales1/sat_sales2,2)\r\n from\r\n (select wswscs.d_week_seq d_week_seq1\r\n        ,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1\r\n        ,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1\r\n        ,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1\r\n        ,sat_sales sat_sales1\r\n  from wswscs,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000) y,\r\n (select wswscs.d_week_seq d_week_seq2\r\n        ,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2\r\n        ,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2\r\n        ,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2\r\n        ,sat_sales sat_sales2\r\n  from wswscs\r\n      ,date_dim \r\n  where date_dim.d_week_seq = wswscs.d_week_seq and\r\n        d_year = 2000+1) z\r\n where d_week_seq1=d_week_seq2-53\r\n order by d_week_seq1;\r\n\r\n", 
                    "oneline_sql": "with wscs as\r  (select sold_date_sk\r         ,sales_price\r   from  (select ws_sold_date_sk sold_date_sk\r               ,ws_ext_sales_price sales_price\r         from web_sales \r         union all\r         select cs_sold_date_sk sold_date_sk\r               ,cs_ext_sales_price sales_price\r         from catalog_sales)),\r  wswscs as \r  (select d_week_seq,\r         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\r  from wscs\r      ,date_dim\r  where d_date_sk = sold_date_sk\r  group by d_week_seq)\r  select d_week_seq1\r        ,round(sun_sales1/sun_sales2,2)\r        ,round(mon_sales1/mon_sales2,2)\r        ,round(tue_sales1/tue_sales2,2)\r        ,round(wed_sales1/wed_sales2,2)\r        ,round(thu_sales1/thu_sales2,2)\r        ,round(fri_sales1/fri_sales2,2)\r        ,round(sat_sales1/sat_sales2,2)\r  from\r  (select wswscs.d_week_seq d_week_seq1\r         ,sun_sales sun_sales1\r         ,mon_sales mon_sales1\r         ,tue_sales tue_sales1\r         ,wed_sales wed_sales1\r         ,thu_sales thu_sales1\r         ,fri_sales fri_sales1\r         ,sat_sales sat_sales1\r   from wswscs,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000) y,\r  (select wswscs.d_week_seq d_week_seq2\r         ,sun_sales sun_sales2\r         ,mon_sales mon_sales2\r         ,tue_sales tue_sales2\r         ,wed_sales wed_sales2\r         ,thu_sales thu_sales2\r         ,fri_sales fri_sales2\r         ,sat_sales sat_sales2\r   from wswscs\r       ,date_dim \r   where date_dim.d_week_seq = wswscs.d_week_seq and\r         d_year = 2000+1) z\r  where d_week_seq1=d_week_seq2-53\r  order by d_week_seq1;\r \r ", 
                    "id": 503, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/503.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query2.tpl\r", 
                    "sid": 8, 
                    "endTime": 1575595791.165413
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:51", 
                    "startTimeFormat": "2019-12-06 09:29:51", 
                    "startTime": 1575595791.165513, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_504.sql", 
                    "second": 0.34538698196411133, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item,customer,customer_address,store\r\n where d_date_sk = ss_sold_date_sk\r\n   and ss_item_sk = i_item_sk\r\n   and i_manager_id=6\r\n   and d_moy=11\r\n   and d_year=1999\r\n   and ss_customer_sk = c_customer_sk \r\n   and c_current_addr_sk = ca_address_sk\r\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r\n   and ss_store_sk = s_store_sk \r\n group by i_brand\r\n      ,i_brand_id\r\n      ,i_manufact_id\r\n      ,i_manufact\r\n order by ext_price desc\r\n         ,i_brand\r\n         ,i_brand_id\r\n         ,i_manufact_id\r\n         ,i_manufact\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item,customer,customer_address,store\r  where d_date_sk = ss_sold_date_sk\r    and ss_item_sk = i_item_sk\r    and i_manager_id=6\r    and d_moy=11\r    and d_year=1999\r    and ss_customer_sk = c_customer_sk \r    and c_current_addr_sk = ca_address_sk\r    and substr(ca_zip,1,5) <> substr(s_zip,1,5) \r    and ss_store_sk = s_store_sk \r  group by i_brand\r       ,i_brand_id\r       ,i_manufact_id\r       ,i_manufact\r  order by ext_price desc\r          ,i_brand\r          ,i_brand_id\r          ,i_manufact_id\r          ,i_manufact\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 504, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/504.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query19.tpl\r", 
                    "sid": 9, 
                    "endTime": 1575595791.5109
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:52", 
                    "startTimeFormat": "2019-12-06 09:29:51", 
                    "startTime": 1575595791.511002, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_505.sql", 
                    "second": 0.9338209629058838, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select \r\n\ts_store_name,\r\n\ti_item_desc,\r\n\tsc.revenue,\r\n\ti_current_price,\r\n\ti_wholesale_cost,\r\n\ti_brand\r\n from store, item,\r\n     (select ss_store_sk, avg(revenue) as ave\r\n \tfrom\r\n \t    (select  ss_store_sk, ss_item_sk, \r\n \t\t     sum(ss_sales_price) as revenue\r\n \t\tfrom store_sales, date_dim\r\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11\r\n \t\tgroup by ss_store_sk, ss_item_sk) sa\r\n \tgroup by ss_store_sk) sb,\r\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r\n \tfrom store_sales, date_dim\r\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11\r\n \tgroup by ss_store_sk, ss_item_sk) sc\r\n where sb.ss_store_sk = sc.ss_store_sk and \r\n       sc.revenue <= 0.1 * sb.ave and\r\n       s_store_sk = sc.ss_store_sk and\r\n       i_item_sk = sc.ss_item_sk\r\n order by s_store_name, i_item_desc\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r \ts_store_name,\r \ti_item_desc,\r \tsc.revenue,\r \ti_current_price,\r \ti_wholesale_cost,\r \ti_brand\r  from store, item,\r      (select ss_store_sk, avg(revenue) as ave\r  \tfrom\r  \t    (select  ss_store_sk, ss_item_sk, \r  \t\t     sum(ss_sales_price) as revenue\r  \t\tfrom store_sales, date_dim\r  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11\r  \t\tgroup by ss_store_sk, ss_item_sk) sa\r  \tgroup by ss_store_sk) sb,\r      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\r  \tfrom store_sales, date_dim\r  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1196 and 1196+11\r  \tgroup by ss_store_sk, ss_item_sk) sc\r  where sb.ss_store_sk = sc.ss_store_sk and \r        sc.revenue <= 0.1 * sb.ave and\r        s_store_sk = sc.ss_store_sk and\r        i_item_sk = sc.ss_item_sk\r  order by s_store_name, i_item_desc\r  ) where rownum <= 100;\r \r ", 
                    "id": 505, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/505.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query65.tpl\r", 
                    "sid": 10, 
                    "endTime": 1575595792.444823
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:52", 
                    "startTimeFormat": "2019-12-06 09:29:52", 
                    "startTime": 1575595792.444937, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_506.sql", 
                    "second": 0.05740690231323242, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  dt.d_year \r\n       ,item.i_brand_id brand_id \r\n       ,item.i_brand brand\r\n       ,sum(ss_net_profit) sum_agg\r\n from  date_dim dt \r\n      ,store_sales\r\n      ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n   and store_sales.ss_item_sk = item.i_item_sk\r\n   and item.i_manufact_id = 902\r\n   and dt.d_moy=11\r\n group by dt.d_year\r\n      ,item.i_brand\r\n      ,item.i_brand_id\r\n order by dt.d_year\r\n         ,sum_agg desc\r\n         ,brand_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year \r        ,item.i_brand_id brand_id \r        ,item.i_brand brand\r        ,sum(ss_net_profit) sum_agg\r  from  date_dim dt \r       ,store_sales\r       ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r    and store_sales.ss_item_sk = item.i_item_sk\r    and item.i_manufact_id = 902\r    and dt.d_moy=11\r  group by dt.d_year\r       ,item.i_brand\r       ,item.i_brand_id\r  order by dt.d_year\r          ,sum_agg desc\r          ,brand_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 506, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/506.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query3.tpl\r", 
                    "sid": 11, 
                    "endTime": 1575595792.502344
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:53", 
                    "startTimeFormat": "2019-12-06 09:29:52", 
                    "startTime": 1575595792.502444, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_507.sql", 
                    "second": 0.7130119800567627, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select \r\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r\n  from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,store.s_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (household_demographics.hd_dep_count = 1 or household_demographics.hd_vehicle_count > -1)\r\n    and date_dim.d_dow = 1\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_number_employees between 200 and 295\r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r\n    where ss_customer_sk = c_customer_sk\r\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select \r   c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\r   from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,store.s_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (household_demographics.hd_dep_count = 1 or household_demographics.hd_vehicle_count > -1)\r     and date_dim.d_dow = 1\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_number_employees between 200 and 295\r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\r     where ss_customer_sk = c_customer_sk\r  order by c_last_name,c_first_name,substr(s_city,1,30), profit\r  ) where rownum <= 100;\r \r ", 
                    "id": 507, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/507.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query79.tpl\r", 
                    "sid": 12, 
                    "endTime": 1575595793.215456
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:54", 
                    "startTimeFormat": "2019-12-06 09:29:53", 
                    "startTime": 1575595793.215562, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_508.sql", 
                    "second": 1.210413932800293, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select avg(ss_quantity)\r\n       ,avg(ss_ext_sales_price)\r\n       ,avg(ss_ext_wholesale_cost)\r\n       ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n     ,store\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,customer_address\r\n     ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'U'\r\n  and cd_education_status = '2 yr Degree'\r\n  and ss_sales_price between 100.00 and 150.00\r\n  and hd_dep_count = 3   \r\n     )or\r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'W'\r\n  and cd_education_status = 'Advanced Degree'\r\n  and ss_sales_price between 50.00 and 100.00   \r\n  and hd_dep_count = 1\r\n     ) or \r\n     (ss_hdemo_sk=hd_demo_sk\r\n  and cd_demo_sk = ss_cdemo_sk\r\n  and cd_marital_status = 'S'\r\n  and cd_education_status = 'College'\r\n  and ss_sales_price between 150.00 and 200.00 \r\n  and hd_dep_count = 1  \r\n     ))\r\n and((ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('NM', 'ND', 'SC')\r\n  and ss_net_profit between 100 and 200  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('PA', 'MD', 'GA')\r\n  and ss_net_profit between 150 and 300  \r\n     ) or\r\n     (ss_addr_sk = ca_address_sk\r\n  and ca_country = 'United States'\r\n  and ca_state in ('OH', 'UT', 'VT')\r\n  and ss_net_profit between 50 and 250  \r\n     ))\r\n;\r\n\r\n", 
                    "oneline_sql": "select avg(ss_quantity)\r        ,avg(ss_ext_sales_price)\r        ,avg(ss_ext_wholesale_cost)\r        ,sum(ss_ext_wholesale_cost)\r  from store_sales\r      ,store\r      ,customer_demographics\r      ,household_demographics\r      ,customer_address\r      ,date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2001\r  and((ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'U'\r   and cd_education_status = '2 yr Degree'\r   and ss_sales_price between 100.00 and 150.00\r   and hd_dep_count = 3   \r      )or\r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'W'\r   and cd_education_status = 'Advanced Degree'\r   and ss_sales_price between 50.00 and 100.00   \r   and hd_dep_count = 1\r      ) or \r      (ss_hdemo_sk=hd_demo_sk\r   and cd_demo_sk = ss_cdemo_sk\r   and cd_marital_status = 'S'\r   and cd_education_status = 'College'\r   and ss_sales_price between 150.00 and 200.00 \r   and hd_dep_count = 1  \r      ))\r  and((ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('NM', 'ND', 'SC')\r   and ss_net_profit between 100 and 200  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('PA', 'MD', 'GA')\r   and ss_net_profit between 150 and 300  \r      ) or\r      (ss_addr_sk = ca_address_sk\r   and ca_country = 'United States'\r   and ca_state in ('OH', 'UT', 'VT')\r   and ss_net_profit between 50 and 250  \r      ))\r ;\r \r ", 
                    "id": 508, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/508.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query13.tpl\r", 
                    "sid": 13, 
                    "endTime": 1575595794.425976
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:54", 
                    "startTimeFormat": "2019-12-06 09:29:54", 
                    "startTime": 1575595794.426081, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_509.sql", 
                    "second": 0.25667810440063477, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  *\r\n from(select w_warehouse_name\r\n            ,i_item_id\r\n            ,sum(case when (cast(d_date as date) < to_date ('1998-06-24' ,'yyyy-mm-dd'))\r\n\t                then inv_quantity_on_hand \r\n                      else 0 end) as inv_before\r\n            ,sum(case when (cast(d_date as date) >= to_date ('1998-06-24' ,'yyyy-mm-dd'))\r\n                      then inv_quantity_on_hand \r\n                      else 0 end) as inv_after\r\n   from inventory\r\n       ,warehouse\r\n       ,item\r\n       ,date_dim\r\n   where i_current_price between 0.99 and 1.49\r\n     and i_item_sk          = inv_item_sk\r\n     and inv_warehouse_sk   = w_warehouse_sk\r\n     and inv_date_sk    = d_date_sk\r\n     and d_date between (to_date ('1998-06-24' ,'yyyy-mm-dd') - 30 )\r\n                    and (to_date ('1998-06-24' ,'yyyy-mm-dd') + 30 )\r\n   group by w_warehouse_name, i_item_id) x\r\n where (case when inv_before > 0 \r\n             then inv_after / inv_before \r\n             else null\r\n             end) between 2.0/3.0 and 3.0/2.0\r\n order by w_warehouse_name\r\n         ,i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r  from(select w_warehouse_name\r             ,i_item_id\r             ,sum(case when (cast(d_date as date) < to_date ('1998-06-24' ,'yyyy-mm-dd'))\r \t                then inv_quantity_on_hand \r                       else 0 end) as inv_before\r             ,sum(case when (cast(d_date as date) >= to_date ('1998-06-24' ,'yyyy-mm-dd'))\r                       then inv_quantity_on_hand \r                       else 0 end) as inv_after\r    from inventory\r        ,warehouse\r        ,item\r        ,date_dim\r    where i_current_price between 0.99 and 1.49\r      and i_item_sk          = inv_item_sk\r      and inv_warehouse_sk   = w_warehouse_sk\r      and inv_date_sk    = d_date_sk\r      and d_date between (to_date ('1998-06-24' ,'yyyy-mm-dd') - 30 )\r                     and (to_date ('1998-06-24' ,'yyyy-mm-dd') + 30 )\r    group by w_warehouse_name, i_item_id) x\r  where (case when inv_before > 0 \r              then inv_after / inv_before \r              else null\r              end) between 2.0/3.0 and 3.0/2.0\r  order by w_warehouse_name\r          ,i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 509, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/509.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query21.tpl\r", 
                    "sid": 14, 
                    "endTime": 1575595794.682759
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:29:57", 
                    "startTimeFormat": "2019-12-06 09:29:54", 
                    "startTime": 1575595794.682866, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_510.sql", 
                    "second": 2.4966888427734375, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "WITH web_v1 as (\r\nselect\r\n  ws_item_sk item_sk, d_date,\r\n  sum(sum(ws_sales_price))\r\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom web_sales\r\n    ,date_dim\r\nwhere ws_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1183 and 1183+11\r\n  and ws_item_sk is not NULL\r\ngroup by ws_item_sk, d_date),\r\nstore_v1 as (\r\nselect\r\n  ss_item_sk item_sk, d_date,\r\n  sum(sum(ss_sales_price))\r\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r\nfrom store_sales\r\n    ,date_dim\r\nwhere ss_sold_date_sk=d_date_sk\r\n  and d_month_seq between 1183 and 1183+11\r\n  and ss_item_sk is not NULL\r\ngroup by ss_item_sk, d_date)\r\nselect * from ( select  *\r\nfrom (select item_sk\r\n     ,d_date\r\n     ,web_sales\r\n     ,store_sales\r\n     ,max(web_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r\n     ,max(store_sales)\r\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r\n                 ,web.cume_sales web_sales\r\n                 ,store.cume_sales store_sales\r\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r\n                                                          and web.d_date = store.d_date)\r\n          )x )y\r\nwhere web_cumulative > store_cumulative\r\norder by item_sk\r\n        ,d_date\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH web_v1 as (\r select\r   ws_item_sk item_sk, d_date,\r   sum(sum(ws_sales_price))\r       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from web_sales\r     ,date_dim\r where ws_sold_date_sk=d_date_sk\r   and d_month_seq between 1183 and 1183+11\r   and ws_item_sk is not NULL\r group by ws_item_sk, d_date),\r store_v1 as (\r select\r   ss_item_sk item_sk, d_date,\r   sum(sum(ss_sales_price))\r       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\r from store_sales\r     ,date_dim\r where ss_sold_date_sk=d_date_sk\r   and d_month_seq between 1183 and 1183+11\r   and ss_item_sk is not NULL\r group by ss_item_sk, d_date)\r select * from ( select  *\r from (select item_sk\r      ,d_date\r      ,web_sales\r      ,store_sales\r      ,max(web_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\r      ,max(store_sales)\r          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\r      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\r                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date\r                  ,web.cume_sales web_sales\r                  ,store.cume_sales store_sales\r            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\r                                                           and web.d_date = store.d_date)\r           )x )y\r where web_cumulative > store_cumulative\r order by item_sk\r         ,d_date\r  ) where rownum <= 100;\r \r ", 
                    "id": 510, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/510.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query51.tpl\r", 
                    "sid": 15, 
                    "endTime": 1575595797.179555
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:30", 
                    "startTimeFormat": "2019-12-06 09:29:57", 
                    "startTime": 1575595797.179647, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_511.sql", 
                    "second": 32.96111297607422, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  a.ca_state state, count(*) cnt\r\n from customer_address a\r\n     ,customer c\r\n     ,store_sales s\r\n     ,date_dim d\r\n     ,item i\r\n where       a.ca_address_sk = c.c_current_addr_sk\r\n \tand c.c_customer_sk = s.ss_customer_sk\r\n \tand s.ss_sold_date_sk = d.d_date_sk\r\n \tand s.ss_item_sk = i.i_item_sk\r\n \tand d.d_month_seq = \r\n \t     (select distinct (d_month_seq)\r\n \t      from date_dim\r\n               where d_year = 1998\r\n \t        and d_moy = 3 )\r\n \tand i.i_current_price > 1.2 * \r\n             (select avg(j.i_current_price) \r\n \t     from item j \r\n \t     where j.i_category = i.i_category)\r\n group by a.ca_state\r\n having count(*) >= 10\r\n order by cnt, a.ca_state \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  a.ca_state state, count(*) cnt\r  from customer_address a\r      ,customer c\r      ,store_sales s\r      ,date_dim d\r      ,item i\r  where       a.ca_address_sk = c.c_current_addr_sk\r  \tand c.c_customer_sk = s.ss_customer_sk\r  \tand s.ss_sold_date_sk = d.d_date_sk\r  \tand s.ss_item_sk = i.i_item_sk\r  \tand d.d_month_seq = \r  \t     (select distinct (d_month_seq)\r  \t      from date_dim\r                where d_year = 1998\r  \t        and d_moy = 3 )\r  \tand i.i_current_price > 1.2 * \r              (select avg(j.i_current_price) \r  \t     from item j \r  \t     where j.i_category = i.i_category)\r  group by a.ca_state\r  having count(*) >= 10\r  order by cnt, a.ca_state \r   ) where rownum <= 100;\r \r ", 
                    "id": 511, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/511.sql", 
                    "secondFormat": "00:00:32", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query6.tpl\r", 
                    "sid": 16, 
                    "endTime": 1575595830.14076
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:30", 
                    "startTimeFormat": "2019-12-06 09:30:30", 
                    "startTime": 1575595830.140887, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_512.sql", 
                    "second": 0.3763298988342285, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r\n (select\r\n 'web' as channel\r\n ,web.item\r\n ,web.return_ratio\r\n ,web.return_rank\r\n ,web.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect ws.ws_item_sk as item\r\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\t web_sales ws left outer join web_returns wr \r\n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r\n \t\t\tws.ws_item_sk = wr.wr_item_sk)\r\n                 ,date_dim\r\n \t\twhere \r\n \t\t\twr.wr_return_amt > 10000 \r\n \t\t\tand ws.ws_net_profit > 1\r\n                         and ws.ws_net_paid > 0\r\n                         and ws.ws_quantity > 0\r\n                         and ws_sold_date_sk = d_date_sk\r\n                         and d_year = 1998\r\n                         and d_moy = 12\r\n \t\tgroup by ws.ws_item_sk\r\n \t) in_web\r\n ) web\r\n where \r\n (\r\n web.return_rank <= 10\r\n or\r\n web.currency_rank <= 10\r\n )\r\n union\r\n select \r\n 'catalog' as channel\r\n ,catalog.item\r\n ,catalog.return_ratio\r\n ,catalog.return_rank\r\n ,catalog.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect \r\n \t\tcs.cs_item_sk as item\r\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tcatalog_sales cs left outer join catalog_returns cr\r\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r\n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tcr.cr_return_amount > 10000 \r\n \t\t\tand cs.cs_net_profit > 1\r\n                         and cs.cs_net_paid > 0\r\n                         and cs.cs_quantity > 0\r\n                         and cs_sold_date_sk = d_date_sk\r\n                         and d_year = 1998\r\n                         and d_moy = 12\r\n                 group by cs.cs_item_sk\r\n \t) in_cat\r\n ) catalog\r\n where \r\n (\r\n catalog.return_rank <= 10\r\n or\r\n catalog.currency_rank <=10\r\n )\r\n union\r\n select \r\n 'store' as channel\r\n ,store.item\r\n ,store.return_ratio\r\n ,store.return_rank\r\n ,store.currency_rank\r\n from (\r\n \tselect \r\n \t item\r\n \t,return_ratio\r\n \t,currency_ratio\r\n \t,rank() over (order by return_ratio) as return_rank\r\n \t,rank() over (order by currency_ratio) as currency_rank\r\n \tfrom\r\n \t(\tselect sts.ss_item_sk as item\r\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r\n \t\tfrom \r\n \t\tstore_sales sts left outer join store_returns sr\r\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r\n                ,date_dim\r\n \t\twhere \r\n \t\t\tsr.sr_return_amt > 10000 \r\n \t\t\tand sts.ss_net_profit > 1\r\n                         and sts.ss_net_paid > 0 \r\n                         and sts.ss_quantity > 0\r\n                         and ss_sold_date_sk = d_date_sk\r\n                         and d_year = 1998\r\n                         and d_moy = 12\r\n \t\tgroup by sts.ss_item_sk\r\n \t) in_store\r\n ) store\r\n where  (\r\n store.return_rank <= 10\r\n or \r\n store.currency_rank <= 10\r\n )\r\n )\r\n order by 1,4,5,2\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, item, return_ratio, return_rank, currency_rank from\r  (select\r  'web' as channel\r  ,web.item\r  ,web.return_ratio\r  ,web.return_rank\r  ,web.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect ws.ws_item_sk as item\r  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\t web_sales ws left outer join web_returns wr \r  \t\t\ton (ws.ws_order_number = wr.wr_order_number and \r  \t\t\tws.ws_item_sk = wr.wr_item_sk)\r                  ,date_dim\r  \t\twhere \r  \t\t\twr.wr_return_amt > 10000 \r  \t\t\tand ws.ws_net_profit > 1\r                          and ws.ws_net_paid > 0\r                          and ws.ws_quantity > 0\r                          and ws_sold_date_sk = d_date_sk\r                          and d_year = 1998\r                          and d_moy = 12\r  \t\tgroup by ws.ws_item_sk\r  \t) in_web\r  ) web\r  where \r  (\r  web.return_rank <= 10\r  or\r  web.currency_rank <= 10\r  )\r  union\r  select \r  'catalog' as channel\r  ,catalog.item\r  ,catalog.return_ratio\r  ,catalog.return_rank\r  ,catalog.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect \r  \t\tcs.cs_item_sk as item\r  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\r  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tcatalog_sales cs left outer join catalog_returns cr\r  \t\t\ton (cs.cs_order_number = cr.cr_order_number and \r  \t\t\tcs.cs_item_sk = cr.cr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tcr.cr_return_amount > 10000 \r  \t\t\tand cs.cs_net_profit > 1\r                          and cs.cs_net_paid > 0\r                          and cs.cs_quantity > 0\r                          and cs_sold_date_sk = d_date_sk\r                          and d_year = 1998\r                          and d_moy = 12\r                  group by cs.cs_item_sk\r  \t) in_cat\r  ) catalog\r  where \r  (\r  catalog.return_rank <= 10\r  or\r  catalog.currency_rank <=10\r  )\r  union\r  select \r  'store' as channel\r  ,store.item\r  ,store.return_ratio\r  ,store.return_rank\r  ,store.currency_rank\r  from (\r  \tselect \r  \t item\r  \t,return_ratio\r  \t,currency_ratio\r  \t,rank() over (order by return_ratio) as return_rank\r  \t,rank() over (order by currency_ratio) as currency_rank\r  \tfrom\r  \t(\tselect sts.ss_item_sk as item\r  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\r  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\r  \t\tfrom \r  \t\tstore_sales sts left outer join store_returns sr\r  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\r                 ,date_dim\r  \t\twhere \r  \t\t\tsr.sr_return_amt > 10000 \r  \t\t\tand sts.ss_net_profit > 1\r                          and sts.ss_net_paid > 0 \r                          and sts.ss_quantity > 0\r                          and ss_sold_date_sk = d_date_sk\r                          and d_year = 1998\r                          and d_moy = 12\r  \t\tgroup by sts.ss_item_sk\r  \t) in_store\r  ) store\r  where  (\r  store.return_rank <= 10\r  or \r  store.currency_rank <= 10\r  )\r  )\r  order by 1,4,5,2\r   ) where rownum <= 100;\r \r ", 
                    "id": 512, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/512.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query49.tpl\r", 
                    "sid": 17, 
                    "endTime": 1575595830.517217
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:30", 
                    "startTimeFormat": "2019-12-06 09:30:30", 
                    "startTime": 1575595830.517313, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_513.sql", 
                    "second": 0.24671411514282227, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_brand_id brand_id\r\n \t,item.i_brand brand\r\n \t,sum(ss_ext_sales_price) ext_price\r\n from date_dim dt\r\n     ,store_sales\r\n     ,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n    and store_sales.ss_item_sk = item.i_item_sk\r\n    and item.i_manager_id = 1\r\n    and dt.d_moy=11\r\n    and dt.d_year=2001\r\n group by dt.d_year\r\n \t,item.i_brand\r\n \t,item.i_brand_id\r\n order by dt.d_year\r\n \t,ext_price desc\r\n \t,brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_brand_id brand_id\r  \t,item.i_brand brand\r  \t,sum(ss_ext_sales_price) ext_price\r  from date_dim dt\r      ,store_sales\r      ,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r     and store_sales.ss_item_sk = item.i_item_sk\r     and item.i_manager_id = 1\r     and dt.d_moy=11\r     and dt.d_year=2001\r  group by dt.d_year\r  \t,item.i_brand\r  \t,item.i_brand_id\r  order by dt.d_year\r  \t,ext_price desc\r  \t,brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 513, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/513.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query52.tpl\r", 
                    "sid": 18, 
                    "endTime": 1575595830.764027
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:31", 
                    "startTimeFormat": "2019-12-06 09:30:30", 
                    "startTime": 1575595830.764123, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_514.sql", 
                    "second": 0.557927131652832, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4 \r\n from store_sales, customer_demographics, date_dim, item, promotion\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       ss_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'W' and\r\n       cd_education_status = 'Primary' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 1998 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4 \r  from store_sales, customer_demographics, date_dim, item, promotion\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        ss_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'W' and\r        cd_education_status = 'Primary' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 1998 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 514, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/514.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query7.tpl\r", 
                    "sid": 19, 
                    "endTime": 1575595831.32205
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:31", 
                    "startTimeFormat": "2019-12-06 09:30:31", 
                    "startTime": 1575595831.322148, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_515.sql", 
                    "second": 0.3818349838256836, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ss as (\r\n select i_item_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where i_item_id in (select\r\n     i_item_id\r\nfrom item\r\nwhere i_color in ('antique','cyan','coral'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 5\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -7 \r\n group by i_item_id),\r\n cs as (\r\n select i_item_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('antique','cyan','coral'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 5\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -7 \r\n group by i_item_id),\r\n ws as (\r\n select i_item_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_item_id               in (select\r\n  i_item_id\r\nfrom item\r\nwhere i_color in ('antique','cyan','coral'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 1999\r\n and     d_moy                   = 5\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -7\r\n group by i_item_id)\r\n select * from ( select  i_item_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_item_id\r\n order by total_sales,\r\n          i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select i_item_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where i_item_id in (select\r      i_item_id\r from item\r where i_color in ('antique','cyan','coral'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 5\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -7 \r  group by i_item_id),\r  cs as (\r  select i_item_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('antique','cyan','coral'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 5\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -7 \r  group by i_item_id),\r  ws as (\r  select i_item_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_item_id               in (select\r   i_item_id\r from item\r where i_color in ('antique','cyan','coral'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 1999\r  and     d_moy                   = 5\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -7\r  group by i_item_id)\r  select * from ( select  i_item_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_item_id\r  order by total_sales,\r           i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 515, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/515.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query56.tpl\r", 
                    "sid": 20, 
                    "endTime": 1575595831.703983
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:32", 
                    "startTimeFormat": "2019-12-06 09:30:31", 
                    "startTime": 1575595831.704081, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_516.sql", 
                    "second": 0.4028449058532715, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with results as\r\n (select \r\n    sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r\n   ,i_category\r\n   ,i_class\r\n   ,0 as g_category, 0 as g_class\r\n from\r\n    store_sales\r\n   ,date_dim       d1\r\n   ,item\r\n   ,store\r\n where\r\n    d1.d_year = 1999 \r\n    and d1.d_date_sk = ss_sold_date_sk\r\n    and i_item_sk  = ss_item_sk \r\n    and s_store_sk  = ss_store_sk\r\n    and s_state in ('FL','MN','PA','FL',\r\n                 'WA','MI','AL','NY')\r\n group by i_category,i_class)\r\n ,\r\n results_rollup as\r\n (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r\n union\r\n select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r\n   NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r\n select * from ( select \r\n  gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r\n \tpartition by lochierarchy, case when t_class = 0 then i_category end \r\n \torder by gross_margin asc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n   lochierarchy desc\r\n  ,case when lochierarchy = 0 then i_category end\r\n  ,rank_within_parent\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r  (select \r     sum(ss_net_profit) as ss_net_profit, sum(ss_ext_sales_price) as ss_ext_sales_price,\r     sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\r    ,i_category\r    ,i_class\r    ,0 as g_category, 0 as g_class\r  from\r     store_sales\r    ,date_dim       d1\r    ,item\r    ,store\r  where\r     d1.d_year = 1999 \r     and d1.d_date_sk = ss_sold_date_sk\r     and i_item_sk  = ss_item_sk \r     and s_store_sk  = ss_store_sk\r     and s_state in ('FL','MN','PA','FL',\r                  'WA','MI','AL','NY')\r  group by i_category,i_class)\r  ,\r  results_rollup as\r  (select gross_margin ,i_category ,i_class,0 as t_category, 0 as t_class, 0 as lochierarchy from results\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    i_category, NULL AS i_class, 0 as t_category, 1 as t_class, 1 as lochierarchy from results group by i_category\r  union\r  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin,\r    NULL AS i_category ,NULL AS i_class, 1 as t_category, 1 as t_class, 2 as lochierarchy from results)\r  select * from ( select \r   gross_margin ,i_category ,i_class, lochierarchy,rank() over (\r  \tpartition by lochierarchy, case when t_class = 0 then i_category end \r  \torder by gross_margin asc) as rank_within_parent\r  from results_rollup\r  order by\r    lochierarchy desc\r   ,case when lochierarchy = 0 then i_category end\r   ,rank_within_parent\r    ) where rownum <= 100;\r \r ", 
                    "id": 516, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/516.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query36.tpl\r", 
                    "sid": 21, 
                    "endTime": 1575595832.106926
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:32", 
                    "startTimeFormat": "2019-12-06 09:30:32", 
                    "startTime": 1575595832.107031, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_517.sql", 
                    "second": 0.4794018268585205, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ss as\r\n (select s_store_sk,\r\n         sum(ss_ext_sales_price) as sales,\r\n         sum(ss_net_profit) as profit\r\n from store_sales,\r\n      date_dim,\r\n      store\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-03','yyyy-mm-dd') \r\n                  and to_date('2001-08-03','yyyy-mm-dd') +  30\r\n       and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n         sum(sr_return_amt) as returns,\r\n         sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n      date_dim,\r\n      store\r\n where sr_returned_date_sk = d_date_sk\r\n       and d_date between to_date('2001-08-03','yyyy-mm-dd') \r\n                  and to_date('2001-08-03','yyyy-mm-dd') +  30\r\n       and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n        sum(cs_ext_sales_price) as sales,\r\n        sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n      date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r\n                  and  to_date('2001-08-03','yyyy-mm-dd') + 30\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n         sum(cr_return_amount) as returns,\r\n         sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n      date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r\n                  and  to_date('2001-08-03','yyyy-mm-dd') + 30\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n        sum(ws_ext_sales_price) as sales,\r\n        sum(ws_net_profit) as profit\r\n from web_sales,\r\n      date_dim,\r\n      web_page\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r\n                  and  to_date('2001-08-03','yyyy-mm-dd') + 30\r\n       and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n        sum(wr_return_amt) as returns,\r\n        sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n      date_dim,\r\n      web_page\r\n where wr_returned_date_sk = d_date_sk\r\n       and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r\n                  and  to_date('2001-08-03','yyyy-mm-dd') + 30\r\n       and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , ss.s_store_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ss left join sr\r\n        on  ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n        , cs_call_center_sk as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  cs\r\n       , cr\r\n union all\r\n select 'web channel' as channel\r\n        , ws.wp_web_page_sk as id\r\n        , sales\r\n        , coalesce(returns, 0) as returns\r\n        , (profit - coalesce(profit_loss,0)) as profit\r\n from   ws left join wr\r\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select s_store_sk,\r          sum(ss_ext_sales_price) as sales,\r          sum(ss_net_profit) as profit\r  from store_sales,\r       date_dim,\r       store\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('2001-08-03','yyyy-mm-dd') \r                   and to_date('2001-08-03','yyyy-mm-dd') +  30\r        and ss_store_sk = s_store_sk\r  group by s_store_sk)\r  ,\r  sr as\r  (select s_store_sk,\r          sum(sr_return_amt) as returns,\r          sum(sr_net_loss) as profit_loss\r  from store_returns,\r       date_dim,\r       store\r  where sr_returned_date_sk = d_date_sk\r        and d_date between to_date('2001-08-03','yyyy-mm-dd') \r                   and to_date('2001-08-03','yyyy-mm-dd') +  30\r        and sr_store_sk = s_store_sk\r  group by s_store_sk), \r  cs as\r  (select cs_call_center_sk,\r         sum(cs_ext_sales_price) as sales,\r         sum(cs_net_profit) as profit\r  from catalog_sales,\r       date_dim\r  where cs_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r                   and  to_date('2001-08-03','yyyy-mm-dd') + 30\r  group by cs_call_center_sk \r  ), \r  cr as\r  (select cr_call_center_sk,\r          sum(cr_return_amount) as returns,\r          sum(cr_net_loss) as profit_loss\r  from catalog_returns,\r       date_dim\r  where cr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r                   and  to_date('2001-08-03','yyyy-mm-dd') + 30\r  group by cr_call_center_sk\r  ), \r  ws as\r  ( select wp_web_page_sk,\r         sum(ws_ext_sales_price) as sales,\r         sum(ws_net_profit) as profit\r  from web_sales,\r       date_dim,\r       web_page\r  where ws_sold_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r                   and  to_date('2001-08-03','yyyy-mm-dd') + 30\r        and ws_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk), \r  wr as\r  (select wp_web_page_sk,\r         sum(wr_return_amt) as returns,\r         sum(wr_net_loss) as profit_loss\r  from web_returns,\r       date_dim,\r       web_page\r  where wr_returned_date_sk = d_date_sk\r        and d_date between  to_date('2001-08-03','yyyy-mm-dd') \r                   and  to_date('2001-08-03','yyyy-mm-dd') + 30\r        and wr_web_page_sk = wp_web_page_sk\r  group by wp_web_page_sk)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , ss.s_store_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ss left join sr\r         on  ss.s_store_sk = sr.s_store_sk\r  union all\r  select 'catalog channel' as channel\r         , cs_call_center_sk as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  cs\r        , cr\r  union all\r  select 'web channel' as channel\r         , ws.wp_web_page_sk as id\r         , sales\r         , coalesce(returns, 0) as returns\r         , (profit - coalesce(profit_loss,0)) as profit\r  from   ws left join wr\r         on  ws.wp_web_page_sk = wr.wp_web_page_sk\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 517, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/517.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query77.tpl\r", 
                    "sid": 22, 
                    "endTime": 1575595832.586433
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:32", 
                    "startTimeFormat": "2019-12-06 09:30:32", 
                    "startTime": 1575595832.586539, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_518.sql", 
                    "second": 0.1501450538635254, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r\n from ( select count(*) amc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 10 and 10+1\r\n         and household_demographics.hd_dep_count = 3\r\n         and web_page.wp_char_count between 5000 and 5200) att,\r\n      ( select count(*) pmc\r\n       from web_sales, household_demographics , time_dim, web_page\r\n       where ws_sold_time_sk = time_dim.t_time_sk\r\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r\n         and ws_web_page_sk = web_page.wp_web_page_sk\r\n         and time_dim.t_hour between 18 and 18+1\r\n         and household_demographics.hd_dep_count = 3\r\n         and web_page.wp_char_count between 5000 and 5200) pt\r\n order by am_pm_ratio\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\r  from ( select count(*) amc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 10 and 10+1\r          and household_demographics.hd_dep_count = 3\r          and web_page.wp_char_count between 5000 and 5200) att,\r       ( select count(*) pmc\r        from web_sales, household_demographics , time_dim, web_page\r        where ws_sold_time_sk = time_dim.t_time_sk\r          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\r          and ws_web_page_sk = web_page.wp_web_page_sk\r          and time_dim.t_hour between 18 and 18+1\r          and household_demographics.hd_dep_count = 3\r          and web_page.wp_char_count between 5000 and 5200) pt\r  order by am_pm_ratio\r   ) where rownum <= 100;\r \r ", 
                    "id": 518, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/518.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query90.tpl\r", 
                    "sid": 23, 
                    "endTime": 1575595832.736684
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:33", 
                    "startTimeFormat": "2019-12-06 09:30:32", 
                    "startTime": 1575595832.736764, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_519.sql", 
                    "second": 0.5531890392303467, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r\n        SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r\n         FROM store_sales, item, date_dim\r\n         WHERE ss_addr_sk IS NULL\r\n           AND ss_sold_date_sk=d_date_sk\r\n           AND ss_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'web' as channel, 'ws_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r\n         FROM web_sales, item, date_dim\r\n         WHERE ws_ship_hdemo_sk IS NULL\r\n           AND ws_sold_date_sk=d_date_sk\r\n           AND ws_item_sk=i_item_sk\r\n        UNION ALL\r\n        SELECT 'catalog' as channel, 'cs_ship_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r\n         FROM catalog_sales, item, date_dim\r\n         WHERE cs_ship_addr_sk IS NULL\r\n           AND cs_sold_date_sk=d_date_sk\r\n           AND cs_item_sk=i_item_sk) foo\r\nGROUP BY channel, col_name, d_year, d_qoy, i_category\r\nORDER BY channel, col_name, d_year, d_qoy, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\r         SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\r          FROM store_sales, item, date_dim\r          WHERE ss_addr_sk IS NULL\r            AND ss_sold_date_sk=d_date_sk\r            AND ss_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'web' as channel, 'ws_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\r          FROM web_sales, item, date_dim\r          WHERE ws_ship_hdemo_sk IS NULL\r            AND ws_sold_date_sk=d_date_sk\r            AND ws_item_sk=i_item_sk\r         UNION ALL\r         SELECT 'catalog' as channel, 'cs_ship_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\r          FROM catalog_sales, item, date_dim\r          WHERE cs_ship_addr_sk IS NULL\r            AND cs_sold_date_sk=d_date_sk\r            AND cs_item_sk=i_item_sk) foo\r GROUP BY channel, col_name, d_year, d_qoy, i_category\r ORDER BY channel, col_name, d_year, d_qoy, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 519, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/519.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query76.tpl\r", 
                    "sid": 24, 
                    "endTime": 1575595833.289953
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:33", 
                    "startTimeFormat": "2019-12-06 09:30:33", 
                    "startTime": 1575595833.290057, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_520.sql", 
                    "second": 0.3776099681854248, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ss_items as\r\n (select i_item_id item_id\r\n        ,sum(ss_ext_sales_price) ss_item_rev \r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk = i_item_sk\r\n   and d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1999-05-17','yyyy-mm-dd')))\r\n   and ss_sold_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cs_items as\r\n (select i_item_id item_id\r\n        ,sum(cs_ext_sales_price) cs_item_rev\r\n  from catalog_sales\r\n      ,item\r\n      ,date_dim\r\n where cs_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq = (select d_week_seq \r\n                                      from date_dim\r\n                                      where d_date = to_date('1999-05-17','yyyy-mm-dd')))\r\n  and  cs_sold_date_sk = d_date_sk\r\n group by i_item_id),\r\n ws_items as\r\n (select i_item_id item_id\r\n        ,sum(ws_ext_sales_price) ws_item_rev\r\n  from web_sales\r\n      ,item\r\n      ,date_dim\r\n where ws_item_sk = i_item_sk\r\n  and  d_date in (select d_date\r\n                  from date_dim\r\n                  where d_week_seq =(select d_week_seq \r\n                                     from date_dim\r\n                                     where d_date = to_date('1999-05-17','yyyy-mm-dd')))\r\n  and ws_sold_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  ss_items.item_id\r\n       ,ss_item_rev\r\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r\n       ,cs_item_rev\r\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r\n       ,ws_item_rev\r\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r\n from ss_items,cs_items,ws_items\r\n where ss_items.item_id=cs_items.item_id\r\n   and ss_items.item_id=ws_items.item_id \r\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r\n order by item_id\r\n         ,ss_item_rev\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss_items as\r  (select i_item_id item_id\r         ,sum(ss_ext_sales_price) ss_item_rev \r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk = i_item_sk\r    and d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1999-05-17','yyyy-mm-dd')))\r    and ss_sold_date_sk   = d_date_sk\r  group by i_item_id),\r  cs_items as\r  (select i_item_id item_id\r         ,sum(cs_ext_sales_price) cs_item_rev\r   from catalog_sales\r       ,item\r       ,date_dim\r  where cs_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq = (select d_week_seq \r                                       from date_dim\r                                       where d_date = to_date('1999-05-17','yyyy-mm-dd')))\r   and  cs_sold_date_sk = d_date_sk\r  group by i_item_id),\r  ws_items as\r  (select i_item_id item_id\r         ,sum(ws_ext_sales_price) ws_item_rev\r   from web_sales\r       ,item\r       ,date_dim\r  where ws_item_sk = i_item_sk\r   and  d_date in (select d_date\r                   from date_dim\r                   where d_week_seq =(select d_week_seq \r                                      from date_dim\r                                      where d_date = to_date('1999-05-17','yyyy-mm-dd')))\r   and ws_sold_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  ss_items.item_id\r        ,ss_item_rev\r        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\r        ,cs_item_rev\r        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\r        ,ws_item_rev\r        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\r        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\r  from ss_items,cs_items,ws_items\r  where ss_items.item_id=cs_items.item_id\r    and ss_items.item_id=ws_items.item_id \r    and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\r    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\r    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\r  order by item_id\r          ,ss_item_rev\r   ) where rownum <= 100;\r \r ", 
                    "id": 520, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/520.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query58.tpl\r", 
                    "sid": 25, 
                    "endTime": 1575595833.667667
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:34", 
                    "startTimeFormat": "2019-12-06 09:30:33", 
                    "startTime": 1575595833.667768, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_521.sql", 
                    "second": 0.5663700103759766, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r\n \tsum(ext_price) ext_price\r\n from item, (select ws_ext_sales_price as ext_price, \r\n                        ws_sold_date_sk as sold_date_sk,\r\n                        ws_item_sk as sold_item_sk,\r\n                        ws_sold_time_sk as time_sk  \r\n                 from web_sales,date_dim\r\n                 where d_date_sk = ws_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=1999\r\n                 union all\r\n                 select cs_ext_sales_price as ext_price,\r\n                        cs_sold_date_sk as sold_date_sk,\r\n                        cs_item_sk as sold_item_sk,\r\n                        cs_sold_time_sk as time_sk\r\n                 from catalog_sales,date_dim\r\n                 where d_date_sk = cs_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=1999\r\n                 union all\r\n                 select ss_ext_sales_price as ext_price,\r\n                        ss_sold_date_sk as sold_date_sk,\r\n                        ss_item_sk as sold_item_sk,\r\n                        ss_sold_time_sk as time_sk\r\n                 from store_sales,date_dim\r\n                 where d_date_sk = ss_sold_date_sk\r\n                   and d_moy=11\r\n                   and d_year=1999\r\n                 ) tmp,time_dim\r\n where\r\n   sold_item_sk = i_item_sk\r\n   and i_manager_id=1\r\n   and time_sk = t_time_sk\r\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r\n group by i_brand, i_brand_id,t_hour,t_minute\r\n order by ext_price desc, i_brand_id\r\n ;\r\n\r\n", 
                    "oneline_sql": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\r  \tsum(ext_price) ext_price\r  from item, (select ws_ext_sales_price as ext_price, \r                         ws_sold_date_sk as sold_date_sk,\r                         ws_item_sk as sold_item_sk,\r                         ws_sold_time_sk as time_sk  \r                  from web_sales,date_dim\r                  where d_date_sk = ws_sold_date_sk\r                    and d_moy=11\r                    and d_year=1999\r                  union all\r                  select cs_ext_sales_price as ext_price,\r                         cs_sold_date_sk as sold_date_sk,\r                         cs_item_sk as sold_item_sk,\r                         cs_sold_time_sk as time_sk\r                  from catalog_sales,date_dim\r                  where d_date_sk = cs_sold_date_sk\r                    and d_moy=11\r                    and d_year=1999\r                  union all\r                  select ss_ext_sales_price as ext_price,\r                         ss_sold_date_sk as sold_date_sk,\r                         ss_item_sk as sold_item_sk,\r                         ss_sold_time_sk as time_sk\r                  from store_sales,date_dim\r                  where d_date_sk = ss_sold_date_sk\r                    and d_moy=11\r                    and d_year=1999\r                  ) tmp,time_dim\r  where\r    sold_item_sk = i_item_sk\r    and i_manager_id=1\r    and time_sk = t_time_sk\r    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\r  group by i_brand, i_brand_id,t_hour,t_minute\r  order by ext_price desc, i_brand_id\r  ;\r \r ", 
                    "id": 521, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/521.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query71.tpl\r", 
                    "sid": 26, 
                    "endTime": 1575595834.234138
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:34", 
                    "startTimeFormat": "2019-12-06 09:30:34", 
                    "startTime": 1575595834.234234, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_522.sql", 
                    "second": 0.7558050155639648, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ssr as\r\n (select  s_store_id as store_id,\r\n          sum(ss_ext_sales_price) as sales,\r\n          sum(coalesce(sr_return_amt, 0)) as returns,\r\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r\n  from store_sales left outer join store_returns on\r\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r\n     date_dim,\r\n     store,\r\n     item,\r\n     promotion\r\n where ss_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-03','yyyy-mm-dd') \r\n                  and to_date('1998-08-03','yyyy-mm-dd') + 30\r\n       and ss_store_sk = s_store_sk\r\n       and ss_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ss_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select  cp_catalog_page_id as catalog_page_id,\r\n          sum(cs_ext_sales_price) as sales,\r\n          sum(coalesce(cr_return_amount, 0)) as returns,\r\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r\n  from catalog_sales left outer join catalog_returns on\r\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r\n     date_dim,\r\n     catalog_page,\r\n     item,\r\n     promotion\r\n where cs_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-03','yyyy-mm-dd') \r\n                  and to_date('1998-08-03','yyyy-mm-dd') + 30\r\n        and cs_catalog_page_sk = cp_catalog_page_sk\r\n       and cs_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and cs_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select  web_site_id,\r\n          sum(ws_ext_sales_price) as sales,\r\n          sum(coalesce(wr_return_amt, 0)) as returns,\r\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r\n  from web_sales left outer join web_returns on\r\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r\n     date_dim,\r\n     web_site,\r\n     item,\r\n     promotion\r\n where ws_sold_date_sk = d_date_sk\r\n       and d_date between to_date('1998-08-03','yyyy-mm-dd') \r\n                  and to_date('1998-08-03','yyyy-mm-dd') + 30\r\n        and ws_web_site_sk = web_site_sk\r\n       and ws_item_sk = i_item_sk\r\n       and i_current_price > 50\r\n       and ws_promo_sk = p_promo_sk\r\n       and p_channel_tv = 'N'\r\ngroup by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || store_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select  s_store_id as store_id,\r           sum(ss_ext_sales_price) as sales,\r           sum(coalesce(sr_return_amt, 0)) as returns,\r           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\r   from store_sales left outer join store_returns on\r          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\r      date_dim,\r      store,\r      item,\r      promotion\r  where ss_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-03','yyyy-mm-dd') \r                   and to_date('1998-08-03','yyyy-mm-dd') + 30\r        and ss_store_sk = s_store_sk\r        and ss_item_sk = i_item_sk\r        and i_current_price > 50\r        and ss_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r  group by s_store_id)\r  ,\r  csr as\r  (select  cp_catalog_page_id as catalog_page_id,\r           sum(cs_ext_sales_price) as sales,\r           sum(coalesce(cr_return_amount, 0)) as returns,\r           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\r   from catalog_sales left outer join catalog_returns on\r          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\r      date_dim,\r      catalog_page,\r      item,\r      promotion\r  where cs_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-03','yyyy-mm-dd') \r                   and to_date('1998-08-03','yyyy-mm-dd') + 30\r         and cs_catalog_page_sk = cp_catalog_page_sk\r        and cs_item_sk = i_item_sk\r        and i_current_price > 50\r        and cs_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select  web_site_id,\r           sum(ws_ext_sales_price) as sales,\r           sum(coalesce(wr_return_amt, 0)) as returns,\r           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\r   from web_sales left outer join web_returns on\r          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\r      date_dim,\r      web_site,\r      item,\r      promotion\r  where ws_sold_date_sk = d_date_sk\r        and d_date between to_date('1998-08-03','yyyy-mm-dd') \r                   and to_date('1998-08-03','yyyy-mm-dd') + 30\r         and ws_web_site_sk = web_site_sk\r        and ws_item_sk = i_item_sk\r        and i_current_price > 50\r        and ws_promo_sk = p_promo_sk\r        and p_channel_tv = 'N'\r group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || store_id as id\r         , sales\r         , returns\r         , profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || catalog_page_id as id\r         , sales\r         , returns\r         , profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 522, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/522.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query80.tpl\r", 
                    "sid": 27, 
                    "endTime": 1575595834.990039
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:35", 
                    "startTimeFormat": "2019-12-06 09:30:34", 
                    "startTime": 1575595834.990121, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_523.sql", 
                    "second": 0.8416500091552734, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_state in ('OH','TN','TX') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2000 and\r\n                d_moy between 3 and 3+2) and\r\n   (not exists (select *\r\n            from web_sales,date_dim\r\n            where c.c_customer_sk = ws_bill_customer_sk and\r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_moy between 3 and 3+2) and\r\n    not exists (select * \r\n            from catalog_sales,date_dim\r\n            where c.c_customer_sk = cs_ship_customer_sk and\r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2000 and\r\n                  d_moy between 3 and 3+2))\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_state in ('OH','TN','TX') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2000 and\r                 d_moy between 3 and 3+2) and\r    (not exists (select *\r             from web_sales,date_dim\r             where c.c_customer_sk = ws_bill_customer_sk and\r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_moy between 3 and 3+2) and\r     not exists (select * \r             from catalog_sales,date_dim\r             where c.c_customer_sk = cs_ship_customer_sk and\r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2000 and\r                   d_moy between 3 and 3+2))\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating\r   ) where rownum <= 100;\r \r ", 
                    "id": 523, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/523.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query69.tpl\r", 
                    "sid": 28, 
                    "endTime": 1575595835.831771
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:35", 
                    "startTime": 1575595835.831882, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_524.sql", 
                    "second": 0.6686780452728271, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with my_customers as (\r\n select distinct c_customer_sk\r\n        , c_current_addr_sk\r\n from   \r\n        ( select cs_sold_date_sk sold_date_sk,\r\n                 cs_bill_customer_sk customer_sk,\r\n                 cs_item_sk item_sk\r\n          from   catalog_sales\r\n          union all\r\n          select ws_sold_date_sk sold_date_sk,\r\n                 ws_bill_customer_sk customer_sk,\r\n                 ws_item_sk item_sk\r\n          from   web_sales\r\n         ) cs_or_ws_sales,\r\n         item,\r\n         date_dim,\r\n         customer\r\n where   sold_date_sk = d_date_sk\r\n         and item_sk = i_item_sk\r\n         and i_category = 'Electronics'\r\n         and i_class = 'memory'\r\n         and c_customer_sk = cs_or_ws_sales.customer_sk\r\n         and d_moy = 2\r\n         and d_year = 2002\r\n )\r\n , my_revenue as (\r\n select c_customer_sk,\r\n        sum(ss_ext_sales_price) as revenue\r\n from   my_customers,\r\n        store_sales,\r\n        customer_address,\r\n        store,\r\n        date_dim\r\n where  c_current_addr_sk = ca_address_sk\r\n        and ca_county = s_county\r\n        and ca_state = s_state\r\n        and ss_sold_date_sk = d_date_sk\r\n        and c_customer_sk = ss_customer_sk\r\n        and d_month_seq between (select distinct d_month_seq+1\r\n                                 from   date_dim where d_year = 2002 and d_moy = 2)\r\n                           and  (select distinct d_month_seq+3\r\n                                 from   date_dim where d_year = 2002 and d_moy = 2)\r\n group by c_customer_sk\r\n )\r\n , segments as\r\n (select cast((revenue/50) as int) as segment\r\n  from   my_revenue\r\n )\r\n select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r\n from segments\r\n group by segment\r\n order by segment, num_customers\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with my_customers as (\r  select distinct c_customer_sk\r         , c_current_addr_sk\r  from   \r         ( select cs_sold_date_sk sold_date_sk,\r                  cs_bill_customer_sk customer_sk,\r                  cs_item_sk item_sk\r           from   catalog_sales\r           union all\r           select ws_sold_date_sk sold_date_sk,\r                  ws_bill_customer_sk customer_sk,\r                  ws_item_sk item_sk\r           from   web_sales\r          ) cs_or_ws_sales,\r          item,\r          date_dim,\r          customer\r  where   sold_date_sk = d_date_sk\r          and item_sk = i_item_sk\r          and i_category = 'Electronics'\r          and i_class = 'memory'\r          and c_customer_sk = cs_or_ws_sales.customer_sk\r          and d_moy = 2\r          and d_year = 2002\r  )\r  , my_revenue as (\r  select c_customer_sk,\r         sum(ss_ext_sales_price) as revenue\r  from   my_customers,\r         store_sales,\r         customer_address,\r         store,\r         date_dim\r  where  c_current_addr_sk = ca_address_sk\r         and ca_county = s_county\r         and ca_state = s_state\r         and ss_sold_date_sk = d_date_sk\r         and c_customer_sk = ss_customer_sk\r         and d_month_seq between (select distinct d_month_seq+1\r                                  from   date_dim where d_year = 2002 and d_moy = 2)\r                            and  (select distinct d_month_seq+3\r                                  from   date_dim where d_year = 2002 and d_moy = 2)\r  group by c_customer_sk\r  )\r  , segments as\r  (select cast((revenue/50) as int) as segment\r   from   my_revenue\r  )\r  select * from ( select  segment, count(*) as num_customers, segment*50 as segment_base\r  from segments\r  group by segment\r  order by segment, num_customers\r   ) where rownum <= 100;\r \r ", 
                    "id": 524, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/524.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query54.tpl\r", 
                    "sid": 29, 
                    "endTime": 1575595836.50056
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.500643, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_525.sql", 
                    "second": 0.09656691551208496, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r\nfrom \r\n    web_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 774\r\nand i_item_sk = ws_item_sk \r\nand d_date between  to_date('2001-02-06','yyyy-mm-dd') and \r\n        to_date('2001-02-06','yyyy-mm-dd') + 90 \r\nand d_date_sk = ws_sold_date_sk \r\nand ws_ext_discount_amt  \r\n     > ( \r\n         SELECT \r\n            1.3 * avg(ws_ext_discount_amt) \r\n         FROM \r\n            web_sales \r\n           ,date_dim\r\n         WHERE \r\n              ws_item_sk = i_item_sk \r\n          and d_date between to_date('2001-02-06','yyyy-mm-dd') and\r\n                             to_date('2001-02-06','yyyy-mm-dd')+ 90\r\n          and d_date_sk = ws_sold_date_sk \r\n      ) \r\norder by sum(ws_ext_discount_amt)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \r from \r     web_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 774\r and i_item_sk = ws_item_sk \r and d_date between  to_date('2001-02-06','yyyy-mm-dd') and \r         to_date('2001-02-06','yyyy-mm-dd') + 90 \r and d_date_sk = ws_sold_date_sk \r and ws_ext_discount_amt  \r      > ( \r          SELECT \r             1.3 * avg(ws_ext_discount_amt) \r          FROM \r             web_sales \r            ,date_dim\r          WHERE \r               ws_item_sk = i_item_sk \r           and d_date between to_date('2001-02-06','yyyy-mm-dd') and\r                              to_date('2001-02-06','yyyy-mm-dd')+ 90\r           and d_date_sk = ws_sold_date_sk \r       ) \r order by sum(ws_ext_discount_amt)\r  ) where rownum <= 100;\r \r ", 
                    "id": 525, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/525.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query92.tpl\r", 
                    "sid": 30, 
                    "endTime": 1575595836.59721
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:36", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.597309, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_526.sql", 
                    "second": 0.2552969455718994, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r\nfrom\r\n  (select sum(ss_ext_sales_price) promotions\r\n   from  store_sales\r\n        ,store\r\n        ,promotion\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address \r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_promo_sk = p_promo_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk \r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Books'\r\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 2000\r\n   and   d_moy  = 12) promotional_sales,\r\n  (select sum(ss_ext_sales_price) total\r\n   from  store_sales\r\n        ,store\r\n        ,date_dim\r\n        ,customer\r\n        ,customer_address\r\n        ,item\r\n   where ss_sold_date_sk = d_date_sk\r\n   and   ss_store_sk = s_store_sk\r\n   and   ss_customer_sk= c_customer_sk\r\n   and   ca_address_sk = c_current_addr_sk\r\n   and   ss_item_sk = i_item_sk\r\n   and   ca_gmt_offset = -7\r\n   and   i_category = 'Books'\r\n   and   s_gmt_offset = -7\r\n   and   d_year = 2000\r\n   and   d_moy  = 12) all_sales\r\norder by promotions, total\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\r from\r   (select sum(ss_ext_sales_price) promotions\r    from  store_sales\r         ,store\r         ,promotion\r         ,date_dim\r         ,customer\r         ,customer_address \r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_promo_sk = p_promo_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk \r    and   ca_gmt_offset = -7\r    and   i_category = 'Books'\r    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\r    and   s_gmt_offset = -7\r    and   d_year = 2000\r    and   d_moy  = 12) promotional_sales,\r   (select sum(ss_ext_sales_price) total\r    from  store_sales\r         ,store\r         ,date_dim\r         ,customer\r         ,customer_address\r         ,item\r    where ss_sold_date_sk = d_date_sk\r    and   ss_store_sk = s_store_sk\r    and   ss_customer_sk= c_customer_sk\r    and   ca_address_sk = c_current_addr_sk\r    and   ss_item_sk = i_item_sk\r    and   ca_gmt_offset = -7\r    and   i_category = 'Books'\r    and   s_gmt_offset = -7\r    and   d_year = 2000\r    and   d_moy  = 12) all_sales\r order by promotions, total\r  ) where rownum <= 100;\r \r ", 
                    "id": 526, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/526.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query61.tpl\r", 
                    "sid": 31, 
                    "endTime": 1575595836.852606
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:37", 
                    "startTimeFormat": "2019-12-06 09:30:36", 
                    "startTime": 1575595836.852704, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_527.sql", 
                    "second": 0.2881948947906494, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  * from \r\n(select i_manufact_id,\r\nsum(ss_sales_price) sum_sales,\r\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\nss_sold_date_sk = d_date_sk and\r\nss_store_sk = s_store_sk and\r\nd_month_seq in (1193,1193+1,1193+2,1193+3,1193+4,1193+5,1193+6,1193+7,1193+8,1193+9,1193+10,1193+11) and\r\n((i_category in ('Books','Children','Electronics') and\r\ni_class in ('personal','portable','reference','self-help') and\r\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r\nor(i_category in ('Women','Music','Men') and\r\ni_class in ('accessories','classical','fragrances','pants') and\r\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t'importoamalg #1')))\r\ngroup by i_manufact_id, d_qoy ) tmp1\r\nwhere case when avg_quarterly_sales > 0 \r\n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r\n\telse null end > 0.1\r\norder by avg_quarterly_sales,\r\n\t sum_sales,\r\n\t i_manufact_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * from \r (select i_manufact_id,\r sum(ss_sales_price) sum_sales,\r avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r ss_sold_date_sk = d_date_sk and\r ss_store_sk = s_store_sk and\r d_month_seq in (1193,1193+1,1193+2,1193+3,1193+4,1193+5,1193+6,1193+7,1193+8,1193+9,1193+10,1193+11) and\r ((i_category in ('Books','Children','Electronics') and\r i_class in ('personal','portable','reference','self-help') and\r i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t'exportiunivamalg #9','scholaramalgamalg #9'))\r or(i_category in ('Women','Music','Men') and\r i_class in ('accessories','classical','fragrances','pants') and\r i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t'importoamalg #1')))\r group by i_manufact_id, d_qoy ) tmp1\r where case when avg_quarterly_sales > 0 \r \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \r \telse null end > 0.1\r order by avg_quarterly_sales,\r \t sum_sales,\r \t i_manufact_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 527, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/527.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query53.tpl\r", 
                    "sid": 32, 
                    "endTime": 1575595837.140899
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:38", 
                    "startTimeFormat": "2019-12-06 09:30:37", 
                    "startTime": 1575595837.14099, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_528.sql", 
                    "second": 1.2659099102020264, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select count(*) \r\nfrom ((select distinct c_last_name, c_first_name, d_date\r\n       from store_sales, date_dim, customer\r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1181 and 1181+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from catalog_sales, date_dim, customer\r\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1181 and 1181+11)\r\n       except\r\n      (select distinct c_last_name, c_first_name, d_date\r\n       from web_sales, date_dim, customer\r\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n         and d_month_seq between 1181 and 1181+11)\r\n) cool_cust\r\n;\r\n\r\n", 
                    "oneline_sql": "select count(*) \r from ((select distinct c_last_name, c_first_name, d_date\r        from store_sales, date_dim, customer\r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1181 and 1181+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from catalog_sales, date_dim, customer\r        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1181 and 1181+11)\r        except\r       (select distinct c_last_name, c_first_name, d_date\r        from web_sales, date_dim, customer\r        where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r          and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r          and d_month_seq between 1181 and 1181+11)\r ) cool_cust\r ;\r \r ", 
                    "id": 528, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/528.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query87.tpl\r", 
                    "sid": 33, 
                    "endTime": 1575595838.4069
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:38", 
                    "startTimeFormat": "2019-12-06 09:30:38", 
                    "startTime": 1575595838.406998, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_529.sql", 
                    "second": 0.16430997848510742, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,extended_price\r\n       ,extended_tax\r\n       ,list_price\r\n from (select ss_ticket_number\r\n             ,ss_customer_sk\r\n             ,ca_city bought_city\r\n             ,sum(ss_ext_sales_price) extended_price \r\n             ,sum(ss_ext_list_price) list_price\r\n             ,sum(ss_ext_tax) extended_tax \r\n       from store_sales\r\n           ,date_dim\r\n           ,store\r\n           ,household_demographics\r\n           ,customer_address \r\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n         and store_sales.ss_store_sk = store.s_store_sk  \r\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n        and date_dim.d_dom between 1 and 2 \r\n        and (household_demographics.hd_dep_count = 3 or\r\n             household_demographics.hd_vehicle_count= 0)\r\n        and date_dim.d_year in (1999,1999+1,1999+2)\r\n        and store.s_city in ('Oakdale','Pleasant Grove')\r\n       group by ss_ticket_number\r\n               ,ss_customer_sk\r\n               ,ss_addr_sk,ca_city) dn\r\n      ,customer\r\n      ,customer_address current_addr\r\n where ss_customer_sk = c_customer_sk\r\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n   and current_addr.ca_city <> bought_city\r\n order by c_last_name\r\n         ,ss_ticket_number\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,extended_price\r        ,extended_tax\r        ,list_price\r  from (select ss_ticket_number\r              ,ss_customer_sk\r              ,ca_city bought_city\r              ,sum(ss_ext_sales_price) extended_price \r              ,sum(ss_ext_list_price) list_price\r              ,sum(ss_ext_tax) extended_tax \r        from store_sales\r            ,date_dim\r            ,store\r            ,household_demographics\r            ,customer_address \r        where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r          and store_sales.ss_store_sk = store.s_store_sk  \r         and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r         and store_sales.ss_addr_sk = customer_address.ca_address_sk\r         and date_dim.d_dom between 1 and 2 \r         and (household_demographics.hd_dep_count = 3 or\r              household_demographics.hd_vehicle_count= 0)\r         and date_dim.d_year in (1999,1999+1,1999+2)\r         and store.s_city in ('Oakdale','Pleasant Grove')\r        group by ss_ticket_number\r                ,ss_customer_sk\r                ,ss_addr_sk,ca_city) dn\r       ,customer\r       ,customer_address current_addr\r  where ss_customer_sk = c_customer_sk\r    and customer.c_current_addr_sk = current_addr.ca_address_sk\r    and current_addr.ca_city <> bought_city\r  order by c_last_name\r          ,ss_ticket_number\r   ) where rownum <= 100;\r \r ", 
                    "id": 529, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/529.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query68.tpl\r", 
                    "sid": 34, 
                    "endTime": 1575595838.571308
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:38", 
                    "startTimeFormat": "2019-12-06 09:30:38", 
                    "startTime": 1575595838.571416, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_530.sql", 
                    "second": 0.4068729877471924, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  substr(r_reason_desc,1,20)\r\n       ,avg(ws_quantity)\r\n       ,avg(wr_refunded_cash)\r\n       ,avg(wr_fee)\r\n from web_sales, web_returns, web_page, customer_demographics cd1,\r\n      customer_demographics cd2, customer_address, date_dim, reason \r\n where ws_web_page_sk = wp_web_page_sk\r\n   and ws_item_sk = wr_item_sk\r\n   and ws_order_number = wr_order_number\r\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\r\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\r\n   and ca_address_sk = wr_refunded_addr_sk\r\n   and r_reason_sk = wr_reason_sk\r\n   and\r\n   (\r\n    (\r\n     cd1.cd_marital_status = 'D'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Secondary'\r\n     and \r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 100.00 and 150.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'S'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'Unknown' \r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 50.00 and 100.00\r\n    )\r\n   or\r\n    (\r\n     cd1.cd_marital_status = 'M'\r\n     and\r\n     cd1.cd_marital_status = cd2.cd_marital_status\r\n     and\r\n     cd1.cd_education_status = 'College'\r\n     and\r\n     cd1.cd_education_status = cd2.cd_education_status\r\n     and\r\n     ws_sales_price between 150.00 and 200.00\r\n    )\r\n   )\r\n   and\r\n   (\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('MA', 'TX', 'GA')\r\n     and ws_net_profit between 100 and 200  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('KY', 'MD', 'NJ')\r\n     and ws_net_profit between 150 and 300  \r\n    )\r\n    or\r\n    (\r\n     ca_country = 'United States'\r\n     and\r\n     ca_state in ('ID', 'SC', 'FL')\r\n     and ws_net_profit between 50 and 250  \r\n    )\r\n   )\r\ngroup by r_reason_desc\r\norder by substr(r_reason_desc,1,20)\r\n        ,avg(ws_quantity)\r\n        ,avg(wr_refunded_cash)\r\n        ,avg(wr_fee)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  substr(r_reason_desc,1,20)\r        ,avg(ws_quantity)\r        ,avg(wr_refunded_cash)\r        ,avg(wr_fee)\r  from web_sales, web_returns, web_page, customer_demographics cd1,\r       customer_demographics cd2, customer_address, date_dim, reason \r  where ws_web_page_sk = wp_web_page_sk\r    and ws_item_sk = wr_item_sk\r    and ws_order_number = wr_order_number\r    and ws_sold_date_sk = d_date_sk and d_year = 2000\r    and cd1.cd_demo_sk = wr_refunded_cdemo_sk \r    and cd2.cd_demo_sk = wr_returning_cdemo_sk\r    and ca_address_sk = wr_refunded_addr_sk\r    and r_reason_sk = wr_reason_sk\r    and\r    (\r     (\r      cd1.cd_marital_status = 'D'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Secondary'\r      and \r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 100.00 and 150.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'S'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'Unknown' \r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 50.00 and 100.00\r     )\r    or\r     (\r      cd1.cd_marital_status = 'M'\r      and\r      cd1.cd_marital_status = cd2.cd_marital_status\r      and\r      cd1.cd_education_status = 'College'\r      and\r      cd1.cd_education_status = cd2.cd_education_status\r      and\r      ws_sales_price between 150.00 and 200.00\r     )\r    )\r    and\r    (\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('MA', 'TX', 'GA')\r      and ws_net_profit between 100 and 200  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('KY', 'MD', 'NJ')\r      and ws_net_profit between 150 and 300  \r     )\r     or\r     (\r      ca_country = 'United States'\r      and\r      ca_state in ('ID', 'SC', 'FL')\r      and ws_net_profit between 50 and 250  \r     )\r    )\r group by r_reason_desc\r order by substr(r_reason_desc,1,20)\r         ,avg(ws_quantity)\r         ,avg(wr_refunded_cash)\r         ,avg(wr_fee)\r  ) where rownum <= 100;\r \r ", 
                    "id": 530, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/530.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query85.tpl\r", 
                    "sid": 35, 
                    "endTime": 1575595838.978289
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:39", 
                    "startTimeFormat": "2019-12-06 09:30:38", 
                    "startTime": 1575595838.978375, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_531.sql", 
                    "second": 0.32843804359436035, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  *\r\nfrom (select avg(ss_list_price) B1_LP\r\n            ,count(ss_list_price) B1_CNT\r\n            ,count(distinct ss_list_price) B1_CNTD\r\n      from store_sales\r\n      where ss_quantity between 0 and 5\r\n        and (ss_list_price between 175 and 175+10 \r\n             or ss_coupon_amt between 13455 and 13455+1000\r\n             or ss_wholesale_cost between 1 and 1+20)) B1,\r\n     (select avg(ss_list_price) B2_LP\r\n            ,count(ss_list_price) B2_CNT\r\n            ,count(distinct ss_list_price) B2_CNTD\r\n      from store_sales\r\n      where ss_quantity between 6 and 10\r\n        and (ss_list_price between 146 and 146+10\r\n          or ss_coupon_amt between 4185 and 4185+1000\r\n          or ss_wholesale_cost between 60 and 60+20)) B2,\r\n     (select avg(ss_list_price) B3_LP\r\n            ,count(ss_list_price) B3_CNT\r\n            ,count(distinct ss_list_price) B3_CNTD\r\n      from store_sales\r\n      where ss_quantity between 11 and 15\r\n        and (ss_list_price between 6 and 6+10\r\n          or ss_coupon_amt between 8389 and 8389+1000\r\n          or ss_wholesale_cost between 39 and 39+20)) B3,\r\n     (select avg(ss_list_price) B4_LP\r\n            ,count(ss_list_price) B4_CNT\r\n            ,count(distinct ss_list_price) B4_CNTD\r\n      from store_sales\r\n      where ss_quantity between 16 and 20\r\n        and (ss_list_price between 77 and 77+10\r\n          or ss_coupon_amt between 2787 and 2787+1000\r\n          or ss_wholesale_cost between 79 and 79+20)) B4,\r\n     (select avg(ss_list_price) B5_LP\r\n            ,count(ss_list_price) B5_CNT\r\n            ,count(distinct ss_list_price) B5_CNTD\r\n      from store_sales\r\n      where ss_quantity between 21 and 25\r\n        and (ss_list_price between 47 and 47+10\r\n          or ss_coupon_amt between 5656 and 5656+1000\r\n          or ss_wholesale_cost between 78 and 78+20)) B5,\r\n     (select avg(ss_list_price) B6_LP\r\n            ,count(ss_list_price) B6_CNT\r\n            ,count(distinct ss_list_price) B6_CNTD\r\n      from store_sales\r\n      where ss_quantity between 26 and 30\r\n        and (ss_list_price between 33 and 33+10\r\n          or ss_coupon_amt between 9372 and 9372+1000\r\n          or ss_wholesale_cost between 77 and 77+20)) B6\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select avg(ss_list_price) B1_LP\r             ,count(ss_list_price) B1_CNT\r             ,count(distinct ss_list_price) B1_CNTD\r       from store_sales\r       where ss_quantity between 0 and 5\r         and (ss_list_price between 175 and 175+10 \r              or ss_coupon_amt between 13455 and 13455+1000\r              or ss_wholesale_cost between 1 and 1+20)) B1,\r      (select avg(ss_list_price) B2_LP\r             ,count(ss_list_price) B2_CNT\r             ,count(distinct ss_list_price) B2_CNTD\r       from store_sales\r       where ss_quantity between 6 and 10\r         and (ss_list_price between 146 and 146+10\r           or ss_coupon_amt between 4185 and 4185+1000\r           or ss_wholesale_cost between 60 and 60+20)) B2,\r      (select avg(ss_list_price) B3_LP\r             ,count(ss_list_price) B3_CNT\r             ,count(distinct ss_list_price) B3_CNTD\r       from store_sales\r       where ss_quantity between 11 and 15\r         and (ss_list_price between 6 and 6+10\r           or ss_coupon_amt between 8389 and 8389+1000\r           or ss_wholesale_cost between 39 and 39+20)) B3,\r      (select avg(ss_list_price) B4_LP\r             ,count(ss_list_price) B4_CNT\r             ,count(distinct ss_list_price) B4_CNTD\r       from store_sales\r       where ss_quantity between 16 and 20\r         and (ss_list_price between 77 and 77+10\r           or ss_coupon_amt between 2787 and 2787+1000\r           or ss_wholesale_cost between 79 and 79+20)) B4,\r      (select avg(ss_list_price) B5_LP\r             ,count(ss_list_price) B5_CNT\r             ,count(distinct ss_list_price) B5_CNTD\r       from store_sales\r       where ss_quantity between 21 and 25\r         and (ss_list_price between 47 and 47+10\r           or ss_coupon_amt between 5656 and 5656+1000\r           or ss_wholesale_cost between 78 and 78+20)) B5,\r      (select avg(ss_list_price) B6_LP\r             ,count(ss_list_price) B6_CNT\r             ,count(distinct ss_list_price) B6_CNTD\r       from store_sales\r       where ss_quantity between 26 and 30\r         and (ss_list_price between 33 and 33+10\r           or ss_coupon_amt between 9372 and 9372+1000\r           or ss_wholesale_cost between 77 and 77+20)) B6\r  ) where rownum <= 100;\r \r ", 
                    "id": 531, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/531.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query28.tpl\r", 
                    "sid": 36, 
                    "endTime": 1575595839.306813
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:39", 
                    "startTimeFormat": "2019-12-06 09:30:39", 
                    "startTime": 1575595839.306914, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_532.sql", 
                    "second": 0.24288296699523926, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  dt.d_year\r\n \t,item.i_category_id\r\n \t,item.i_category\r\n \t,sum(ss_ext_sales_price)\r\n from \tdate_dim dt\r\n \t,store_sales\r\n \t,item\r\n where dt.d_date_sk = store_sales.ss_sold_date_sk\r\n \tand store_sales.ss_item_sk = item.i_item_sk\r\n \tand item.i_manager_id = 1  \t\r\n \tand dt.d_moy=11\r\n \tand dt.d_year=2002\r\n group by \tdt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n order by       sum(ss_ext_sales_price) desc,dt.d_year\r\n \t\t,item.i_category_id\r\n \t\t,item.i_category\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  dt.d_year\r  \t,item.i_category_id\r  \t,item.i_category\r  \t,sum(ss_ext_sales_price)\r  from \tdate_dim dt\r  \t,store_sales\r  \t,item\r  where dt.d_date_sk = store_sales.ss_sold_date_sk\r  \tand store_sales.ss_item_sk = item.i_item_sk\r  \tand item.i_manager_id = 1  \t\r  \tand dt.d_moy=11\r  \tand dt.d_year=2002\r  group by \tdt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  order by       sum(ss_ext_sales_price) desc,dt.d_year\r  \t\t,item.i_category_id\r  \t\t,item.i_category\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 532, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/532.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query42.tpl\r", 
                    "sid": 37, 
                    "endTime": 1575595839.549797
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:46", 
                    "startTimeFormat": "2019-12-06 09:30:39", 
                    "startTime": 1575595839.5499, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_533.sql", 
                    "second": 6.849407911300659, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  *\r\nfrom (select i_category\r\n            ,i_class\r\n            ,i_brand\r\n            ,i_product_name\r\n            ,d_year\r\n            ,d_qoy\r\n            ,d_moy\r\n            ,s_store_id\r\n            ,sumsales\r\n            ,rank() over (partition by i_category order by sumsales desc) rk\r\n      from (select i_category\r\n                  ,i_class\r\n                  ,i_brand\r\n                  ,i_product_name\r\n                  ,d_year\r\n                  ,d_qoy\r\n                  ,d_moy\r\n                  ,s_store_id\r\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r\n            from store_sales\r\n                ,date_dim\r\n                ,store\r\n                ,item\r\n       where  ss_sold_date_sk=d_date_sk\r\n          and ss_item_sk=i_item_sk\r\n          and ss_store_sk = s_store_sk\r\n          and d_month_seq between 1210 and 1210+11\r\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r\nwhere rk <= 100\r\norder by i_category\r\n        ,i_class\r\n        ,i_brand\r\n        ,i_product_name\r\n        ,d_year\r\n        ,d_qoy\r\n        ,d_moy\r\n        ,s_store_id\r\n        ,sumsales\r\n        ,rk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from (select i_category\r             ,i_class\r             ,i_brand\r             ,i_product_name\r             ,d_year\r             ,d_qoy\r             ,d_moy\r             ,s_store_id\r             ,sumsales\r             ,rank() over (partition by i_category order by sumsales desc) rk\r       from (select i_category\r                   ,i_class\r                   ,i_brand\r                   ,i_product_name\r                   ,d_year\r                   ,d_qoy\r                   ,d_moy\r                   ,s_store_id\r                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\r             from store_sales\r                 ,date_dim\r                 ,store\r                 ,item\r        where  ss_sold_date_sk=d_date_sk\r           and ss_item_sk=i_item_sk\r           and ss_store_sk = s_store_sk\r           and d_month_seq between 1210 and 1210+11\r        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\r where rk <= 100\r order by i_category\r         ,i_class\r         ,i_brand\r         ,i_product_name\r         ,d_year\r         ,d_qoy\r         ,d_moy\r         ,s_store_id\r         ,sumsales\r         ,rk\r  ) where rownum <= 100;\r \r ", 
                    "id": 533, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/533.sql", 
                    "secondFormat": "00:00:06", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query67.tpl\r", 
                    "sid": 38, 
                    "endTime": 1575595846.399308
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:46", 
                    "startTimeFormat": "2019-12-06 09:30:46", 
                    "startTime": 1575595846.399408, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_534.sql", 
                    "second": 0.39967799186706543, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   store_sales\r\n  ,store_returns\r\n  ,store\r\n  ,date_dim d1\r\n  ,date_dim d2\r\nwhere\r\n    d2.d_year = 2002\r\nand d2.d_moy  = 8\r\nand ss_ticket_number = sr_ticket_number\r\nand ss_item_sk = sr_item_sk\r\nand ss_sold_date_sk   = d1.d_date_sk\r\nand sr_returned_date_sk   = d2.d_date_sk\r\nand ss_customer_sk = sr_customer_sk\r\nand ss_store_sk = s_store_sk\r\ngroup by\r\n   s_store_name\r\n  ,s_company_id\r\n  ,s_street_number\r\n  ,s_street_name\r\n  ,s_street_type\r\n  ,s_suite_number\r\n  ,s_city\r\n  ,s_county\r\n  ,s_state\r\n  ,s_zip\r\norder by s_store_name\r\n        ,s_company_id\r\n        ,s_street_number\r\n        ,s_street_name\r\n        ,s_street_type\r\n        ,s_suite_number\r\n        ,s_city\r\n        ,s_county\r\n        ,s_state\r\n        ,s_zip\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \r                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\r                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    store_sales\r   ,store_returns\r   ,store\r   ,date_dim d1\r   ,date_dim d2\r where\r     d2.d_year = 2002\r and d2.d_moy  = 8\r and ss_ticket_number = sr_ticket_number\r and ss_item_sk = sr_item_sk\r and ss_sold_date_sk   = d1.d_date_sk\r and sr_returned_date_sk   = d2.d_date_sk\r and ss_customer_sk = sr_customer_sk\r and ss_store_sk = s_store_sk\r group by\r    s_store_name\r   ,s_company_id\r   ,s_street_number\r   ,s_street_name\r   ,s_street_type\r   ,s_suite_number\r   ,s_city\r   ,s_county\r   ,s_state\r   ,s_zip\r order by s_store_name\r         ,s_company_id\r         ,s_street_number\r         ,s_street_name\r         ,s_street_type\r         ,s_suite_number\r         ,s_city\r         ,s_county\r         ,s_state\r         ,s_zip\r  ) where rownum <= 100;\r \r ", 
                    "id": 534, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/534.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query50.tpl\r", 
                    "sid": 39, 
                    "endTime": 1575595846.799086
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:46", 
                    "startTimeFormat": "2019-12-06 09:30:46", 
                    "startTime": 1575595846.799193, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_535.sql", 
                    "second": 0.023119211196899414, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with customer_total_return as\r\n (select wr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(wr_return_amt) as ctr_total_return\r\n from web_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where wr_returned_date_sk = d_date_sk \r\n   and d_year =2002\r\n   and wr_returning_addr_sk = ca_address_sk \r\n group by wr_returning_customer_sk\r\n         ,ca_state)\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n       ,c_last_review_date_sk,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'VA'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r\n                  ,c_last_review_date_sk,ctr_total_return\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select wr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(wr_return_amt) as ctr_total_return\r  from web_returns\r      ,date_dim\r      ,customer_address\r  where wr_returned_date_sk = d_date_sk \r    and d_year =2002\r    and wr_returning_addr_sk = ca_address_sk \r  group by wr_returning_customer_sk\r          ,ca_state)\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r        ,c_last_review_date_sk,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'VA'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\r                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\r                   ,c_last_review_date_sk,ctr_total_return\r  ) where rownum <= 100;\r \r ", 
                    "id": 535, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/535.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query30.tpl\r", 
                    "sid": 40, 
                    "endTime": 1575595846.822312
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:47", 
                    "startTimeFormat": "2019-12-06 09:30:46", 
                    "startTime": 1575595846.822409, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_536.sql", 
                    "second": 0.9922950267791748, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select sum (ss_quantity)\r\n from store_sales, store, customer_demographics, customer_address, date_dim\r\n where s_store_sk = ss_store_sk\r\n and  ss_sold_date_sk = d_date_sk and d_year = 2000\r\n and  \r\n (\r\n  (\r\n   cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'W'\r\n   and \r\n   cd_education_status = 'Primary'\r\n   and \r\n   ss_sales_price between 100.00 and 150.00  \r\n   )\r\n or\r\n  (\r\n  cd_demo_sk = ss_cdemo_sk\r\n   and \r\n   cd_marital_status = 'D'\r\n   and \r\n   cd_education_status = 'Unknown'\r\n   and \r\n   ss_sales_price between 50.00 and 100.00   \r\n  )\r\n or \r\n (\r\n  cd_demo_sk = ss_cdemo_sk\r\n  and \r\n   cd_marital_status = 'M'\r\n   and \r\n   cd_education_status = 'Advanced Degree'\r\n   and \r\n   ss_sales_price between 150.00 and 200.00  \r\n )\r\n )\r\n and\r\n (\r\n  (\r\n  ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('WA', 'MI', 'SD')\r\n  and ss_net_profit between 0 and 2000  \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('VA', 'NC', 'CA')\r\n  and ss_net_profit between 150 and 3000 \r\n  )\r\n or\r\n  (ss_addr_sk = ca_address_sk\r\n  and\r\n  ca_country = 'United States'\r\n  and\r\n  ca_state in ('GA', 'AL', 'MN')\r\n  and ss_net_profit between 50 and 25000 \r\n  )\r\n )\r\n;\r\n\r\n", 
                    "oneline_sql": "select sum (ss_quantity)\r  from store_sales, store, customer_demographics, customer_address, date_dim\r  where s_store_sk = ss_store_sk\r  and  ss_sold_date_sk = d_date_sk and d_year = 2000\r  and  \r  (\r   (\r    cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'W'\r    and \r    cd_education_status = 'Primary'\r    and \r    ss_sales_price between 100.00 and 150.00  \r    )\r  or\r   (\r   cd_demo_sk = ss_cdemo_sk\r    and \r    cd_marital_status = 'D'\r    and \r    cd_education_status = 'Unknown'\r    and \r    ss_sales_price between 50.00 and 100.00   \r   )\r  or \r  (\r   cd_demo_sk = ss_cdemo_sk\r   and \r    cd_marital_status = 'M'\r    and \r    cd_education_status = 'Advanced Degree'\r    and \r    ss_sales_price between 150.00 and 200.00  \r  )\r  )\r  and\r  (\r   (\r   ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('WA', 'MI', 'SD')\r   and ss_net_profit between 0 and 2000  \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('VA', 'NC', 'CA')\r   and ss_net_profit between 150 and 3000 \r   )\r  or\r   (ss_addr_sk = ca_address_sk\r   and\r   ca_country = 'United States'\r   and\r   ca_state in ('GA', 'AL', 'MN')\r   and ss_net_profit between 50 and 25000 \r   )\r  )\r ;\r \r ", 
                    "id": 536, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/536.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query48.tpl\r", 
                    "sid": 41, 
                    "endTime": 1575595847.814704
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:52", 
                    "startTimeFormat": "2019-12-06 09:30:47", 
                    "startTime": 1575595847.814802, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_537.sql", 
                    "second": 4.313876152038574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_product_name\r\n             ,i_brand\r\n             ,i_class\r\n             ,i_category\r\n             ,avg(inv_quantity_on_hand) qoh\r\n       from inventory\r\n           ,date_dim\r\n           ,item\r\n       where inv_date_sk=d_date_sk\r\n              and inv_item_sk=i_item_sk\r\n              and d_month_seq between 1219 and 1219 + 11\r\n       group by rollup(i_product_name\r\n                       ,i_brand\r\n                       ,i_class\r\n                       ,i_category)\r\norder by qoh, i_product_name, i_brand, i_class, i_category\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_product_name\r              ,i_brand\r              ,i_class\r              ,i_category\r              ,avg(inv_quantity_on_hand) qoh\r        from inventory\r            ,date_dim\r            ,item\r        where inv_date_sk=d_date_sk\r               and inv_item_sk=i_item_sk\r               and d_month_seq between 1219 and 1219 + 11\r        group by rollup(i_product_name\r                        ,i_brand\r                        ,i_class\r                        ,i_category)\r order by qoh, i_product_name, i_brand, i_class, i_category\r  ) where rownum <= 100;\r \r ", 
                    "id": 537, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/537.sql", 
                    "secondFormat": "00:00:04", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query22.tpl\r", 
                    "sid": 42, 
                    "endTime": 1575595852.128678
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:53", 
                    "startTimeFormat": "2019-12-06 09:30:52", 
                    "startTime": 1575595852.128763, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_538.sql", 
                    "second": 1.7241990566253662, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year \r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,c_preferred_cust_flag customer_preferred_cust_flag\r\n       ,c_birth_country customer_birth_country\r\n       ,c_login customer_login\r\n       ,c_email_address customer_email_address\r\n       ,d_year dyear\r\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,c_preferred_cust_flag \r\n         ,c_birth_country\r\n         ,c_login\r\n         ,c_email_address\r\n         ,d_year\r\n         )\r\n select * from ( select  \r\n                  t_s_secyear.customer_id\r\n                 ,t_s_secyear.customer_first_name\r\n                 ,t_s_secyear.customer_last_name\r\n                 ,t_s_secyear.customer_email_address\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.dyear = 1998\r\n         and t_s_secyear.dyear = 1998+1\r\n         and t_w_firstyear.dyear = 1998\r\n         and t_w_secyear.dyear = 1998+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r\n order by t_s_secyear.customer_id\r\n         ,t_s_secyear.customer_first_name\r\n         ,t_s_secyear.customer_last_name\r\n         ,t_s_secyear.customer_email_address\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year \r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,c_preferred_cust_flag customer_preferred_cust_flag\r        ,c_birth_country customer_birth_country\r        ,c_login customer_login\r        ,c_email_address customer_email_address\r        ,d_year dyear\r        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,c_preferred_cust_flag \r          ,c_birth_country\r          ,c_login\r          ,c_email_address\r          ,d_year\r          )\r  select * from ( select  \r                   t_s_secyear.customer_id\r                  ,t_s_secyear.customer_first_name\r                  ,t_s_secyear.customer_last_name\r                  ,t_s_secyear.customer_email_address\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.dyear = 1998\r          and t_s_secyear.dyear = 1998+1\r          and t_w_firstyear.dyear = 1998\r          and t_w_secyear.dyear = 1998+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\r              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\r  order by t_s_secyear.customer_id\r          ,t_s_secyear.customer_first_name\r          ,t_s_secyear.customer_last_name\r          ,t_s_secyear.customer_email_address\r  ) where rownum <= 100;\r \r ", 
                    "id": 538, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/538.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query11.tpl\r", 
                    "sid": 43, 
                    "endTime": 1575595853.852962
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:54", 
                    "startTimeFormat": "2019-12-06 09:30:53", 
                    "startTime": 1575595853.853056, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_539.sql", 
                    "second": 0.32751011848449707, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2001-3-01','yyyy-mm-dd') and \r\n           to_date('2001-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'VA'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand exists (select *\r\n            from web_sales ws2\r\n            where ws1.ws_order_number = ws2.ws_order_number\r\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nand not exists(select *\r\n               from web_returns wr1\r\n               where ws1.ws_order_number = wr1.wr_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2001-3-01','yyyy-mm-dd') and \r            to_date('2001-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'VA'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and exists (select *\r             from web_sales ws2\r             where ws1.ws_order_number = ws2.ws_order_number\r               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r and not exists(select *\r                from web_returns wr1\r                where ws1.ws_order_number = wr1.wr_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 539, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/539.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query94.tpl\r", 
                    "sid": 44, 
                    "endTime": 1575595854.180566
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:54", 
                    "startTimeFormat": "2019-12-06 09:30:54", 
                    "startTime": 1575595854.180665, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_540.sql", 
                    "second": 0.43059206008911133, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  ss_customer_sk\r\n            ,sum(act_sales) sumsales\r\n      from (select ss_item_sk\r\n                  ,ss_ticket_number\r\n                  ,ss_customer_sk\r\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r\n                                                            else (ss_quantity*ss_sales_price) end act_sales\r\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r\n                                                               and sr_ticket_number = ss_ticket_number)\r\n                ,reason\r\n            where sr_reason_sk = r_reason_sk\r\n              and r_reason_desc = 'Found a better price in a store') t\r\n      group by ss_customer_sk\r\n      order by sumsales, ss_customer_sk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ss_customer_sk\r             ,sum(act_sales) sumsales\r       from (select ss_item_sk\r                   ,ss_ticket_number\r                   ,ss_customer_sk\r                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\r                                                             else (ss_quantity*ss_sales_price) end act_sales\r             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\r                                                                and sr_ticket_number = ss_ticket_number)\r                 ,reason\r             where sr_reason_sk = r_reason_sk\r               and r_reason_desc = 'Found a better price in a store') t\r       group by ss_customer_sk\r       order by sumsales, ss_customer_sk\r  ) where rownum <= 100;\r \r ", 
                    "id": 540, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/540.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query93.tpl\r", 
                    "sid": 45, 
                    "endTime": 1575595854.611257
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:55", 
                    "startTimeFormat": "2019-12-06 09:30:54", 
                    "startTime": 1575595854.611357, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_541.sql", 
                    "second": 0.636497974395752, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        ca_country,\r\n        ca_state, \r\n        ca_county,\r\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\r\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\r\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\r\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\r\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\r\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r\n from catalog_sales, customer_demographics cd1, \r\n      customer_demographics cd2, customer, customer_address, date_dim, item\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\r\n       cs_bill_customer_sk = c_customer_sk and\r\n       cd1.cd_gender = 'M' and \r\n       cd1.cd_education_status = '4 yr Degree' and\r\n       c_current_cdemo_sk = cd2.cd_demo_sk and\r\n       c_current_addr_sk = ca_address_sk and\r\n       c_birth_month in (9,3,8,11,4,6) and\r\n       d_year = 1999 and\r\n       ca_state in ('CA','KS','NY'\r\n                   ,'OH','TX','FL','AL')\r\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\r\n order by ca_country,\r\n        ca_state, \r\n        ca_county,\r\n\ti_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         ca_country,\r         ca_state, \r         ca_county,\r         avg( cast(cs_quantity as decimal(12,2))) agg1,\r         avg( cast(cs_list_price as decimal(12,2))) agg2,\r         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\r         avg( cast(cs_sales_price as decimal(12,2))) agg4,\r         avg( cast(cs_net_profit as decimal(12,2))) agg5,\r         avg( cast(c_birth_year as decimal(12,2))) agg6,\r         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\r  from catalog_sales, customer_demographics cd1, \r       customer_demographics cd2, customer, customer_address, date_dim, item\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd1.cd_demo_sk and\r        cs_bill_customer_sk = c_customer_sk and\r        cd1.cd_gender = 'M' and \r        cd1.cd_education_status = '4 yr Degree' and\r        c_current_cdemo_sk = cd2.cd_demo_sk and\r        c_current_addr_sk = ca_address_sk and\r        c_birth_month in (9,3,8,11,4,6) and\r        d_year = 1999 and\r        ca_state in ('CA','KS','NY'\r                    ,'OH','TX','FL','AL')\r  group by rollup (i_item_id, ca_country, ca_state, ca_county)\r  order by ca_country,\r         ca_state, \r         ca_county,\r \ti_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 541, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/541.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query18.tpl\r", 
                    "sid": 46, 
                    "endTime": 1575595855.247855
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:55", 
                    "startTimeFormat": "2019-12-06 09:30:55", 
                    "startTime": 1575595855.247961, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_542.sql", 
                    "second": 0.47666001319885254, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ss as (\r\n select\r\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\r\n from\r\n \tstore_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     ss_item_sk              = i_item_sk\r\n and     ss_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 2\r\n and     ss_addr_sk              = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n cs as (\r\n select\r\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\r\n from\r\n \tcatalog_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     cs_item_sk              = i_item_sk\r\n and     cs_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 2\r\n and     cs_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5 \r\n group by i_manufact_id),\r\n ws as (\r\n select\r\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\r\n from\r\n \tweb_sales,\r\n \tdate_dim,\r\n         customer_address,\r\n         item\r\n where\r\n         i_manufact_id               in (select\r\n  i_manufact_id\r\nfrom\r\n item\r\nwhere i_category in ('Electronics'))\r\n and     ws_item_sk              = i_item_sk\r\n and     ws_sold_date_sk         = d_date_sk\r\n and     d_year                  = 2000\r\n and     d_moy                   = 2\r\n and     ws_bill_addr_sk         = ca_address_sk\r\n and     ca_gmt_offset           = -5\r\n group by i_manufact_id)\r\n select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r\n from  (select * from ss \r\n        union all\r\n        select * from cs \r\n        union all\r\n        select * from ws) tmp1\r\n group by i_manufact_id\r\n order by total_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ss as (\r  select\r           i_manufact_id,sum(ss_ext_sales_price) total_sales\r  from\r  \tstore_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     ss_item_sk              = i_item_sk\r  and     ss_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 2\r  and     ss_addr_sk              = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  cs as (\r  select\r           i_manufact_id,sum(cs_ext_sales_price) total_sales\r  from\r  \tcatalog_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     cs_item_sk              = i_item_sk\r  and     cs_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 2\r  and     cs_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5 \r  group by i_manufact_id),\r  ws as (\r  select\r           i_manufact_id,sum(ws_ext_sales_price) total_sales\r  from\r  \tweb_sales,\r  \tdate_dim,\r          customer_address,\r          item\r  where\r          i_manufact_id               in (select\r   i_manufact_id\r from\r  item\r where i_category in ('Electronics'))\r  and     ws_item_sk              = i_item_sk\r  and     ws_sold_date_sk         = d_date_sk\r  and     d_year                  = 2000\r  and     d_moy                   = 2\r  and     ws_bill_addr_sk         = ca_address_sk\r  and     ca_gmt_offset           = -5\r  group by i_manufact_id)\r  select * from ( select  i_manufact_id ,sum(total_sales) total_sales\r  from  (select * from ss \r         union all\r         select * from cs \r         union all\r         select * from ws) tmp1\r  group by i_manufact_id\r  order by total_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 542, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/542.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query33.tpl\r", 
                    "sid": 47, 
                    "endTime": 1575595855.724621
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:56", 
                    "startTimeFormat": "2019-12-06 09:30:55", 
                    "startTime": 1575595855.724716, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_543.sql", 
                    "second": 0.28325510025024414, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  * \r\nfrom (select i_manager_id\r\n             ,sum(ss_sales_price) sum_sales\r\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r\n      from item\r\n          ,store_sales\r\n          ,date_dim\r\n          ,store\r\n      where ss_item_sk = i_item_sk\r\n        and ss_sold_date_sk = d_date_sk\r\n        and ss_store_sk = s_store_sk\r\n        and d_month_seq in (1207,1207+1,1207+2,1207+3,1207+4,1207+5,1207+6,1207+7,1207+8,1207+9,1207+10,1207+11)\r\n        and ((    i_category in ('Books','Children','Electronics')\r\n              and i_class in ('personal','portable','reference','self-help')\r\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r\n           or(    i_category in ('Women','Music','Men')\r\n              and i_class in ('accessories','classical','fragrances','pants')\r\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r\n\t\t                 'importoamalg #1')))\r\ngroup by i_manager_id, d_moy) tmp1\r\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\norder by i_manager_id\r\n        ,avg_monthly_sales\r\n        ,sum_sales\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  * \r from (select i_manager_id\r              ,sum(ss_sales_price) sum_sales\r              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\r       from item\r           ,store_sales\r           ,date_dim\r           ,store\r       where ss_item_sk = i_item_sk\r         and ss_sold_date_sk = d_date_sk\r         and ss_store_sk = s_store_sk\r         and d_month_seq in (1207,1207+1,1207+2,1207+3,1207+4,1207+5,1207+6,1207+7,1207+8,1207+9,1207+10,1207+11)\r         and ((    i_category in ('Books','Children','Electronics')\r               and i_class in ('personal','portable','reference','self-help')\r               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\r \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\r            or(    i_category in ('Women','Music','Men')\r               and i_class in ('accessories','classical','fragrances','pants')\r               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\r \t\t                 'importoamalg #1')))\r group by i_manager_id, d_moy) tmp1\r where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r order by i_manager_id\r         ,avg_monthly_sales\r         ,sum_sales\r  ) where rownum <= 100;\r \r ", 
                    "id": 543, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/543.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query63.tpl\r", 
                    "sid": 48, 
                    "endTime": 1575595856.007971
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:56", 
                    "startTimeFormat": "2019-12-06 09:30:56", 
                    "startTime": 1575595856.008042, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_544.sql", 
                    "second": 0.371959924697876, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  s_store_name\r\n      ,sum(ss_net_profit)\r\n from store_sales\r\n     ,date_dim\r\n     ,store,\r\n     (select ca_zip\r\n     from (\r\n      SELECT substr(ca_zip,1,5) ca_zip\r\n      FROM customer_address\r\n      WHERE substr(ca_zip,1,5) IN (\r\n                          '20650','56852','13199','56404','38976','40491',\r\n                          '99829','88353','77129','34863','67699',\r\n                          '98790','49112','85538','97681','75126',\r\n                          '56795','12853','67961','19468','63768',\r\n                          '19288','38963','34820','64962','49995',\r\n                          '81060','48417','34766','93718','37410',\r\n                          '50141','81088','19523','98443','43639',\r\n                          '22552','99888','23523','44368','30939',\r\n                          '98485','58881','95475','46032','19429',\r\n                          '54881','68518','64161','85452','67731',\r\n                          '39456','61911','91694','14294','33125',\r\n                          '65891','50374','74208','10987','17165',\r\n                          '22266','29430','19725','92003','23377',\r\n                          '48372','96224','84744','41454','76205',\r\n                          '62384','86964','86300','26023','72570',\r\n                          '36661','18087','10726','28689','63959',\r\n                          '69513','98969','99789','50752','88679',\r\n                          '65863','65987','26104','16450','58190',\r\n                          '25767','85768','42751','46762','20509',\r\n                          '72579','45362','34192','71528','17599',\r\n                          '21074','73285','88496','82469','58287',\r\n                          '13186','32236','41255','41221','20377',\r\n                          '30260','32438','57384','47018','94447',\r\n                          '70208','55240','66521','56561','28905',\r\n                          '45075','23904','43156','39787','45051',\r\n                          '19916','82978','41790','37297','30072',\r\n                          '21143','37565','44601','45652','94777',\r\n                          '26279','50025','95122','93738','30691',\r\n                          '30292','95193','75201','31118','39326',\r\n                          '41975','58023','35857','36632','81622',\r\n                          '24900','10906','52993','93330','60975',\r\n                          '84578','90287','94207','54354','64899',\r\n                          '83523','65327','48082','87127','16867',\r\n                          '43196','56716','12135','34994','48526',\r\n                          '39368','51609','31963','12265','57241',\r\n                          '16753','99838','16427','18037','79540',\r\n                          '45962','91599','85261','12330','22924',\r\n                          '50115','87380','80218','94197','44458',\r\n                          '37895','24638','77521','94658','95133',\r\n                          '73421','20282','29124','19957','83595',\r\n                          '40119','23065','68743','93359','90272',\r\n                          '77122','81877','13005','91391','70734',\r\n                          '54539','58026','23389','58555','97329',\r\n                          '49860','54585','53722','53693','83218',\r\n                          '36658','43053','25017','78939','20660',\r\n                          '83405','25185','69464','90509','67605',\r\n                          '16807','69338','72607','55143','24553',\r\n                          '52114','85014','69831','99641','79376',\r\n                          '81778','94222','36982','83052','27121',\r\n                          '87021','33457','76545','80523','46061',\r\n                          '78555','97238','17859','39567','76138',\r\n                          '80163','83060','66115','61944','46149',\r\n                          '68053','77513','15944','35281','98602',\r\n                          '11455','44645','46889','48098','27888',\r\n                          '56758','54429','57335','57480','39205',\r\n                          '17696','82852','37469','61551','87767',\r\n                          '97025','59647','84654','16451','25218',\r\n                          '92534','72999','66768','44121','87237',\r\n                          '48641','88422','59919','79335','15262',\r\n                          '76017','72561','27111','96374','21351',\r\n                          '98954','37852','88562','94595','28933',\r\n                          '20110','77988','67486','72015','95591',\r\n                          '46627','95056','53673','19878','13096',\r\n                          '36802','54349','73750','28166','79224',\r\n                          '63012','50835','49097','43561','50470',\r\n                          '51447','52273','76575','74939','53539',\r\n                          '52406','63060','29556','37478','24618',\r\n                          '83135','26476','12826','56406','37054',\r\n                          '45703','12286','70142','41403','80320',\r\n                          '78802','28369','52039','13250','57467',\r\n                          '56603','45528','51262','85465','25889',\r\n                          '81155','27028','14868','15038','22277',\r\n                          '56255','29392','46047','23204','26406',\r\n                          '63633','63654','51874','86829','22929',\r\n                          '11267','73582','98762','33936','47182',\r\n                          '37673','66511','37357','83887','20881',\r\n                          '77911','24961','61987','60096','47588',\r\n                          '67331','88252','10606','37994','60787',\r\n                          '39595','60986','85130','14226','97844',\r\n                          '27985','21170','74283','62724')\r\n     intersect\r\n      select ca_zip\r\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r\n            FROM customer_address, customer\r\n            WHERE ca_address_sk = c_current_addr_sk and\r\n                  c_preferred_cust_flag='Y'\r\n            group by ca_zip\r\n            having count(*) > 10)A1)A2) V1\r\n where ss_store_sk = s_store_sk\r\n  and ss_sold_date_sk = d_date_sk\r\n  and d_qoy = 1 and d_year = 2001\r\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r\n group by s_store_name\r\n order by s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name\r       ,sum(ss_net_profit)\r  from store_sales\r      ,date_dim\r      ,store,\r      (select ca_zip\r      from (\r       SELECT substr(ca_zip,1,5) ca_zip\r       FROM customer_address\r       WHERE substr(ca_zip,1,5) IN (\r                           '20650','56852','13199','56404','38976','40491',\r                           '99829','88353','77129','34863','67699',\r                           '98790','49112','85538','97681','75126',\r                           '56795','12853','67961','19468','63768',\r                           '19288','38963','34820','64962','49995',\r                           '81060','48417','34766','93718','37410',\r                           '50141','81088','19523','98443','43639',\r                           '22552','99888','23523','44368','30939',\r                           '98485','58881','95475','46032','19429',\r                           '54881','68518','64161','85452','67731',\r                           '39456','61911','91694','14294','33125',\r                           '65891','50374','74208','10987','17165',\r                           '22266','29430','19725','92003','23377',\r                           '48372','96224','84744','41454','76205',\r                           '62384','86964','86300','26023','72570',\r                           '36661','18087','10726','28689','63959',\r                           '69513','98969','99789','50752','88679',\r                           '65863','65987','26104','16450','58190',\r                           '25767','85768','42751','46762','20509',\r                           '72579','45362','34192','71528','17599',\r                           '21074','73285','88496','82469','58287',\r                           '13186','32236','41255','41221','20377',\r                           '30260','32438','57384','47018','94447',\r                           '70208','55240','66521','56561','28905',\r                           '45075','23904','43156','39787','45051',\r                           '19916','82978','41790','37297','30072',\r                           '21143','37565','44601','45652','94777',\r                           '26279','50025','95122','93738','30691',\r                           '30292','95193','75201','31118','39326',\r                           '41975','58023','35857','36632','81622',\r                           '24900','10906','52993','93330','60975',\r                           '84578','90287','94207','54354','64899',\r                           '83523','65327','48082','87127','16867',\r                           '43196','56716','12135','34994','48526',\r                           '39368','51609','31963','12265','57241',\r                           '16753','99838','16427','18037','79540',\r                           '45962','91599','85261','12330','22924',\r                           '50115','87380','80218','94197','44458',\r                           '37895','24638','77521','94658','95133',\r                           '73421','20282','29124','19957','83595',\r                           '40119','23065','68743','93359','90272',\r                           '77122','81877','13005','91391','70734',\r                           '54539','58026','23389','58555','97329',\r                           '49860','54585','53722','53693','83218',\r                           '36658','43053','25017','78939','20660',\r                           '83405','25185','69464','90509','67605',\r                           '16807','69338','72607','55143','24553',\r                           '52114','85014','69831','99641','79376',\r                           '81778','94222','36982','83052','27121',\r                           '87021','33457','76545','80523','46061',\r                           '78555','97238','17859','39567','76138',\r                           '80163','83060','66115','61944','46149',\r                           '68053','77513','15944','35281','98602',\r                           '11455','44645','46889','48098','27888',\r                           '56758','54429','57335','57480','39205',\r                           '17696','82852','37469','61551','87767',\r                           '97025','59647','84654','16451','25218',\r                           '92534','72999','66768','44121','87237',\r                           '48641','88422','59919','79335','15262',\r                           '76017','72561','27111','96374','21351',\r                           '98954','37852','88562','94595','28933',\r                           '20110','77988','67486','72015','95591',\r                           '46627','95056','53673','19878','13096',\r                           '36802','54349','73750','28166','79224',\r                           '63012','50835','49097','43561','50470',\r                           '51447','52273','76575','74939','53539',\r                           '52406','63060','29556','37478','24618',\r                           '83135','26476','12826','56406','37054',\r                           '45703','12286','70142','41403','80320',\r                           '78802','28369','52039','13250','57467',\r                           '56603','45528','51262','85465','25889',\r                           '81155','27028','14868','15038','22277',\r                           '56255','29392','46047','23204','26406',\r                           '63633','63654','51874','86829','22929',\r                           '11267','73582','98762','33936','47182',\r                           '37673','66511','37357','83887','20881',\r                           '77911','24961','61987','60096','47588',\r                           '67331','88252','10606','37994','60787',\r                           '39595','60986','85130','14226','97844',\r                           '27985','21170','74283','62724')\r      intersect\r       select ca_zip\r       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\r             FROM customer_address, customer\r             WHERE ca_address_sk = c_current_addr_sk and\r                   c_preferred_cust_flag='Y'\r             group by ca_zip\r             having count(*) > 10)A1)A2) V1\r  where ss_store_sk = s_store_sk\r   and ss_sold_date_sk = d_date_sk\r   and d_qoy = 1 and d_year = 2001\r   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\r  group by s_store_name\r  order by s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 544, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/544.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query8.tpl\r", 
                    "sid": 49, 
                    "endTime": 1575595856.380002
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:58", 
                    "startTimeFormat": "2019-12-06 09:30:56", 
                    "startTime": 1575595856.3801, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_545.sql", 
                    "second": 2.0149950981140137, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ssci as (\r\nselect ss_customer_sk customer_sk\r\n      ,ss_item_sk item_sk\r\nfrom store_sales,date_dim\r\nwhere ss_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1223 and 1223 + 11\r\ngroup by ss_customer_sk\r\n        ,ss_item_sk),\r\ncsci as(\r\n select cs_bill_customer_sk customer_sk\r\n      ,cs_item_sk item_sk\r\nfrom catalog_sales,date_dim\r\nwhere cs_sold_date_sk = d_date_sk\r\n  and d_month_seq between 1223 and 1223 + 11\r\ngroup by cs_bill_customer_sk\r\n        ,cs_item_sk)\r\nselect * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r\n                               and ssci.item_sk = csci.item_sk)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssci as (\r select ss_customer_sk customer_sk\r       ,ss_item_sk item_sk\r from store_sales,date_dim\r where ss_sold_date_sk = d_date_sk\r   and d_month_seq between 1223 and 1223 + 11\r group by ss_customer_sk\r         ,ss_item_sk),\r csci as(\r  select cs_bill_customer_sk customer_sk\r       ,cs_item_sk item_sk\r from catalog_sales,date_dim\r where cs_sold_date_sk = d_date_sk\r   and d_month_seq between 1223 and 1223 + 11\r group by cs_bill_customer_sk\r         ,cs_item_sk)\r select * from ( select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\r       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\r       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\r from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\r                                and ssci.item_sk = csci.item_sk)\r  ) where rownum <= 100;\r \r ", 
                    "id": 545, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/545.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query97.tpl\r", 
                    "sid": 50, 
                    "endTime": 1575595858.395095
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:58", 
                    "startTimeFormat": "2019-12-06 09:30:58", 
                    "startTime": 1575595858.395183, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_546.sql", 
                    "second": 0.20415902137756348, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r\n from web_sales, customer, customer_address, date_dim, item\r\n where ws_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ws_item_sk = i_item_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r\n \t      or \r\n \t      i_item_id in (select i_item_id\r\n                             from item\r\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r\n                             )\r\n \t    )\r\n \tand ws_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2001\r\n group by ca_zip, ca_county\r\n order by ca_zip, ca_county\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip, ca_county, sum(ws_sales_price)\r  from web_sales, customer, customer_address, date_dim, item\r  where ws_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ws_item_sk = i_item_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\r  \t      or \r  \t      i_item_id in (select i_item_id\r                              from item\r                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\r                              )\r  \t    )\r  \tand ws_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2001\r  group by ca_zip, ca_county\r  order by ca_zip, ca_county\r   ) where rownum <= 100;\r \r ", 
                    "id": 546, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/546.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query45.tpl\r", 
                    "sid": 51, 
                    "endTime": 1575595858.599342
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:58", 
                    "startTimeFormat": "2019-12-06 09:30:58", 
                    "startTime": 1575595858.599438, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_547.sql", 
                    "second": 0.313107967376709, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   web_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,web_site\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1219 and 1219 + 11\r\nand ws_ship_date_sk   = d_date_sk\r\nand ws_warehouse_sk   = w_warehouse_sk\r\nand ws_ship_mode_sk   = sm_ship_mode_sk\r\nand ws_web_site_sk    = web_site_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,web_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n       ,web_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \r                  (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\r                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    web_sales\r   ,warehouse\r   ,ship_mode\r   ,web_site\r   ,date_dim\r where\r     d_month_seq between 1219 and 1219 + 11\r and ws_ship_date_sk   = d_date_sk\r and ws_warehouse_sk   = w_warehouse_sk\r and ws_ship_mode_sk   = sm_ship_mode_sk\r and ws_web_site_sk    = web_site_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,web_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r        ,web_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 547, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/547.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query62.tpl\r", 
                    "sid": 52, 
                    "endTime": 1575595858.912546
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:58", 
                    "startTimeFormat": "2019-12-06 09:30:58", 
                    "startTime": 1575595858.912642, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_548.sql", 
                    "second": 0.022424936294555664, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with customer_total_return as\r\n (select cr_returning_customer_sk as ctr_customer_sk\r\n        ,ca_state as ctr_state, \r\n \tsum(cr_return_amt_inc_tax) as ctr_total_return\r\n from catalog_returns\r\n     ,date_dim\r\n     ,customer_address\r\n where cr_returned_date_sk = d_date_sk \r\n   and d_year =2002\r\n   and cr_returning_addr_sk = ca_address_sk \r\n group by cr_returning_customer_sk\r\n         ,ca_state )\r\n select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n from customer_total_return ctr1\r\n     ,customer_address\r\n     ,customer\r\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\n \t\t\t  from customer_total_return ctr2 \r\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\r\n       and ca_address_sk = c_current_addr_sk\r\n       and ca_state = 'GA'\r\n       and ctr1.ctr_customer_sk = c_customer_sk\r\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r\n                  ,ca_location_type,ctr_total_return\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r  (select cr_returning_customer_sk as ctr_customer_sk\r         ,ca_state as ctr_state, \r  \tsum(cr_return_amt_inc_tax) as ctr_total_return\r  from catalog_returns\r      ,date_dim\r      ,customer_address\r  where cr_returned_date_sk = d_date_sk \r    and d_year =2002\r    and cr_returning_addr_sk = ca_address_sk \r  group by cr_returning_customer_sk\r          ,ca_state )\r  select * from ( select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r  from customer_total_return ctr1\r      ,customer_address\r      ,customer\r  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r  \t\t\t  from customer_total_return ctr2 \r                   \t  where ctr1.ctr_state = ctr2.ctr_state)\r        and ca_address_sk = c_current_addr_sk\r        and ca_state = 'GA'\r        and ctr1.ctr_customer_sk = c_customer_sk\r  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\r                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\r                   ,ca_location_type,ctr_total_return\r   ) where rownum <= 100;\r \r ", 
                    "id": 548, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/548.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query81.tpl\r", 
                    "sid": 53, 
                    "endTime": 1575595858.935067
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:30:59", 
                    "startTimeFormat": "2019-12-06 09:30:58", 
                    "startTime": 1575595858.935178, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_549.sql", 
                    "second": 0.7154190540313721, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select   \r\n  ca_state,\r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_dep_count,\r\n  count(*) cnt1,\r\n  stddev_samp(cd_dep_count) s1,\r\n  max(cd_dep_count) s2,\r\n  avg(cd_dep_count) s3,\r\n  cd_dep_employed_count,\r\n  count(*) cnt2,\r\n  stddev_samp(cd_dep_employed_count) s4,\r\n  max(cd_dep_employed_count) s5,\r\n  avg(cd_dep_employed_count) s6,\r\n  cd_dep_college_count,\r\n  count(*) cnt3,\r\n  stddev_samp(cd_dep_college_count) s7,\r\n  max(cd_dep_college_count) s8,\r\n  avg(cd_dep_college_count) s9\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_qoy < 4) and\r\n   exists (select * from\r\n\t   (select ws_bill_customer_sk customsk\r\n            from web_sales,date_dim\r\n            where \r\n                  ws_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_qoy < 4\r\n\t    union all \r\n    \t    select cs_ship_customer_sk customsk\r\n            from catalog_sales,date_dim\r\n            where \r\n                  cs_sold_date_sk = d_date_sk and\r\n                  d_year = 2001 and\r\n                  d_qoy < 4)x \r\n           where x.customsk = c.c_customer_sk)\r\n group by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by ca_state,\r\n          cd_gender,\r\n          cd_marital_status,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r   ca_state,\r   cd_gender,\r   cd_marital_status,\r   cd_dep_count,\r   count(*) cnt1,\r   stddev_samp(cd_dep_count) s1,\r   max(cd_dep_count) s2,\r   avg(cd_dep_count) s3,\r   cd_dep_employed_count,\r   count(*) cnt2,\r   stddev_samp(cd_dep_employed_count) s4,\r   max(cd_dep_employed_count) s5,\r   avg(cd_dep_employed_count) s6,\r   cd_dep_college_count,\r   count(*) cnt3,\r   stddev_samp(cd_dep_college_count) s7,\r   max(cd_dep_college_count) s8,\r   avg(cd_dep_college_count) s9\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_qoy < 4) and\r    exists (select * from\r \t   (select ws_bill_customer_sk customsk\r             from web_sales,date_dim\r             where \r                   ws_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_qoy < 4\r \t    union all \r     \t    select cs_ship_customer_sk customsk\r             from catalog_sales,date_dim\r             where \r                   cs_sold_date_sk = d_date_sk and\r                   d_year = 2001 and\r                   d_qoy < 4)x \r            where x.customsk = c.c_customer_sk)\r  group by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by ca_state,\r           cd_gender,\r           cd_marital_status,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r   ) where rownum <= 100;\r \r ", 
                    "id": 549, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/549.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query35.tpl\r", 
                    "sid": 54, 
                    "endTime": 1575595859.650597
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:02", 
                    "startTimeFormat": "2019-12-06 09:30:59", 
                    "startTime": 1575595859.650696, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_550.sql", 
                    "second": 3.0858099460601807, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ws as\r\n  (select d_year AS ws_sold_year, ws_item_sk,\r\n    ws_bill_customer_sk ws_customer_sk,\r\n    sum(ws_quantity) ws_qty,\r\n    sum(ws_wholesale_cost) ws_wc,\r\n    sum(ws_sales_price) ws_sp\r\n   from web_sales\r\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r\n   join date_dim on ws_sold_date_sk = d_date_sk\r\n   where wr_order_number is null\r\n   group by d_year, ws_item_sk, ws_bill_customer_sk\r\n   ),\r\ncs as\r\n  (select d_year AS cs_sold_year, cs_item_sk,\r\n    cs_bill_customer_sk cs_customer_sk,\r\n    sum(cs_quantity) cs_qty,\r\n    sum(cs_wholesale_cost) cs_wc,\r\n    sum(cs_sales_price) cs_sp\r\n   from catalog_sales\r\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r\n   join date_dim on cs_sold_date_sk = d_date_sk\r\n   where cr_order_number is null\r\n   group by d_year, cs_item_sk, cs_bill_customer_sk\r\n   ),\r\nss as\r\n  (select d_year AS ss_sold_year, ss_item_sk,\r\n    ss_customer_sk,\r\n    sum(ss_quantity) ss_qty,\r\n    sum(ss_wholesale_cost) ss_wc,\r\n    sum(ss_sales_price) ss_sp\r\n   from store_sales\r\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r\n   join date_dim on ss_sold_date_sk = d_date_sk\r\n   where sr_ticket_number is null\r\n   group by d_year, ss_item_sk, ss_customer_sk\r\n   )\r\nselect * from ( select \r\nss_item_sk,\r\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r\nfrom ss\r\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r\norder by \r\n  ss_item_sk,\r\n  ss_qty desc, ss_wc desc, ss_sp desc,\r\n  other_chan_qty,\r\n  other_chan_wholesale_cost,\r\n  other_chan_sales_price,\r\n  ratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws as\r   (select d_year AS ws_sold_year, ws_item_sk,\r     ws_bill_customer_sk ws_customer_sk,\r     sum(ws_quantity) ws_qty,\r     sum(ws_wholesale_cost) ws_wc,\r     sum(ws_sales_price) ws_sp\r    from web_sales\r    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\r    join date_dim on ws_sold_date_sk = d_date_sk\r    where wr_order_number is null\r    group by d_year, ws_item_sk, ws_bill_customer_sk\r    ),\r cs as\r   (select d_year AS cs_sold_year, cs_item_sk,\r     cs_bill_customer_sk cs_customer_sk,\r     sum(cs_quantity) cs_qty,\r     sum(cs_wholesale_cost) cs_wc,\r     sum(cs_sales_price) cs_sp\r    from catalog_sales\r    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\r    join date_dim on cs_sold_date_sk = d_date_sk\r    where cr_order_number is null\r    group by d_year, cs_item_sk, cs_bill_customer_sk\r    ),\r ss as\r   (select d_year AS ss_sold_year, ss_item_sk,\r     ss_customer_sk,\r     sum(ss_quantity) ss_qty,\r     sum(ss_wholesale_cost) ss_wc,\r     sum(ss_sales_price) ss_sp\r    from store_sales\r    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\r    join date_dim on ss_sold_date_sk = d_date_sk\r    where sr_ticket_number is null\r    group by d_year, ss_item_sk, ss_customer_sk\r    )\r select * from ( select \r ss_item_sk,\r round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,\r ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\r coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\r coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\r coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\r from ss\r left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\r left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\r where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\r order by \r   ss_item_sk,\r   ss_qty desc, ss_wc desc, ss_sp desc,\r   other_chan_qty,\r   other_chan_wholesale_cost,\r   other_chan_sales_price,\r   ratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 550, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/550.sql", 
                    "secondFormat": "00:00:03", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query78.tpl\r", 
                    "sid": 55, 
                    "endTime": 1575595862.736506
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:02", 
                    "startTime": 1575595862.736612, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_551.sql", 
                    "second": 0.9390079975128174, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        cc_name,\r\n        d_year, d_moy,\r\n        sum(cs_sales_price) sum_sales,\r\n        avg(sum(cs_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     cc_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     cc_name\r\n           order by d_year, d_moy) rn\r\n from item, catalog_sales, date_dim, call_center\r\n where cs_item_sk = i_item_sk and\r\n       cs_sold_date_sk = d_date_sk and\r\n       cc_call_center_sk= cs_call_center_sk and\r\n       (\r\n         d_year = 2001 or\r\n         ( d_year = 2001-1 and d_moy =12) or\r\n         ( d_year = 2001+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          cc_name , d_year, d_moy),\r\n v2 as(\r\n select v1.i_category, v1.i_brand\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1. cc_name = v1_lag. cc_name and\r\n       v1. cc_name = v1_lead. cc_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 2001 and\r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         cc_name,\r         d_year, d_moy,\r         sum(cs_sales_price) sum_sales,\r         avg(sum(cs_sales_price)) over\r           (partition by i_category, i_brand,\r                      cc_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      cc_name\r            order by d_year, d_moy) rn\r  from item, catalog_sales, date_dim, call_center\r  where cs_item_sk = i_item_sk and\r        cs_sold_date_sk = d_date_sk and\r        cc_call_center_sk= cs_call_center_sk and\r        (\r          d_year = 2001 or\r          ( d_year = 2001-1 and d_moy =12) or\r          ( d_year = 2001+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           cc_name , d_year, d_moy),\r  v2 as(\r  select v1.i_category, v1.i_brand\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1. cc_name = v1_lag. cc_name and\r        v1. cc_name = v1_lead. cc_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 2001 and\r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 551, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/551.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query57.tpl\r", 
                    "sid": 56, 
                    "endTime": 1575595863.67562
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.675727, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_552.sql", 
                    "second": 0.07333111763000488, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  c_last_name\r\n       ,c_first_name\r\n       ,ca_city\r\n       ,bought_city\r\n       ,ss_ticket_number\r\n       ,amt,profit \r\n from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,ca_city bought_city\r\n          ,sum(ss_coupon_amt) amt\r\n          ,sum(ss_net_profit) profit\r\n    from store_sales,date_dim,store,household_demographics,customer_address \r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\r\n    and (household_demographics.hd_dep_count = 4 or\r\n         household_demographics.hd_vehicle_count= -1)\r\n    and date_dim.d_dow in (6,0)\r\n    and date_dim.d_year in (2000,2000+1,2000+2) \r\n    and store.s_city in ('Shady Grove','Riverview','Centerville','Pine Grove','Concord') \r\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r\n    where ss_customer_sk = c_customer_sk\r\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\r\n      and current_addr.ca_city <> bought_city\r\n  order by c_last_name\r\n          ,c_first_name\r\n          ,ca_city\r\n          ,bought_city\r\n          ,ss_ticket_number\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_last_name\r        ,c_first_name\r        ,ca_city\r        ,bought_city\r        ,ss_ticket_number\r        ,amt,profit \r  from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,ca_city bought_city\r           ,sum(ss_coupon_amt) amt\r           ,sum(ss_net_profit) profit\r     from store_sales,date_dim,store,household_demographics,customer_address \r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and store_sales.ss_addr_sk = customer_address.ca_address_sk\r     and (household_demographics.hd_dep_count = 4 or\r          household_demographics.hd_vehicle_count= -1)\r     and date_dim.d_dow in (6,0)\r     and date_dim.d_year in (2000,2000+1,2000+2) \r     and store.s_city in ('Shady Grove','Riverview','Centerville','Pine Grove','Concord') \r     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\r     where ss_customer_sk = c_customer_sk\r       and customer.c_current_addr_sk = current_addr.ca_address_sk\r       and current_addr.ca_city <> bought_city\r   order by c_last_name\r           ,c_first_name\r           ,ca_city\r           ,bought_city\r           ,ss_ticket_number\r    ) where rownum <= 100;\r \r ", 
                    "id": 552, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/552.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query46.tpl\r", 
                    "sid": 57, 
                    "endTime": 1575595863.749058
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:03", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.749154, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_553.sql", 
                    "second": 0.021808862686157227, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r\nfrom \r\n   catalog_sales \r\n   ,item \r\n   ,date_dim\r\nwhere\r\ni_manufact_id = 637\r\nand i_item_sk = cs_item_sk \r\nand d_date between to_date('2001-03-10','yyyy-mm-dd') and \r\n        to_date('2001-03-10','yyyy-mm-dd') + 90 \r\nand d_date_sk = cs_sold_date_sk \r\nand cs_ext_discount_amt  \r\n     > ( \r\n         select \r\n            1.3 * avg(cs_ext_discount_amt) \r\n         from \r\n            catalog_sales \r\n           ,date_dim\r\n         where \r\n              cs_item_sk = i_item_sk \r\n          and d_date between to_date('2001-03-10','yyyy-mm-dd') and\r\n                             to_date('2001-03-10','yyyy-mm-dd')+90\r\n          and d_date_sk = cs_sold_date_sk \r\n      ) \r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" \r from \r    catalog_sales \r    ,item \r    ,date_dim\r where\r i_manufact_id = 637\r and i_item_sk = cs_item_sk \r and d_date between to_date('2001-03-10','yyyy-mm-dd') and \r         to_date('2001-03-10','yyyy-mm-dd') + 90 \r and d_date_sk = cs_sold_date_sk \r and cs_ext_discount_amt  \r      > ( \r          select \r             1.3 * avg(cs_ext_discount_amt) \r          from \r             catalog_sales \r            ,date_dim\r          where \r               cs_item_sk = i_item_sk \r           and d_date between to_date('2001-03-10','yyyy-mm-dd') and\r                              to_date('2001-03-10','yyyy-mm-dd')+90\r           and d_date_sk = cs_sold_date_sk \r       ) \r  ) where rownum <= 100;\r \r ", 
                    "id": 553, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/553.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query32.tpl\r", 
                    "sid": 58, 
                    "endTime": 1575595863.770963
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:04", 
                    "startTimeFormat": "2019-12-06 09:31:03", 
                    "startTime": 1575595863.771069, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_554.sql", 
                    "second": 1.122154951095581, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid_inc_tax) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\nand s_market_id=10\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'deep'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                                 from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\nwith ssales as\r\n(select c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,ca_state\r\n      ,s_state\r\n      ,i_color\r\n      ,i_current_price\r\n      ,i_manager_id\r\n      ,i_units\r\n      ,i_size\r\n      ,sum(ss_net_paid_inc_tax) netpaid\r\nfrom store_sales\r\n    ,store_returns\r\n    ,store\r\n    ,item\r\n    ,customer\r\n    ,customer_address\r\nwhere ss_ticket_number = sr_ticket_number\r\n  and ss_item_sk = sr_item_sk\r\n  and ss_customer_sk = c_customer_sk\r\n  and ss_item_sk = i_item_sk\r\n  and ss_store_sk = s_store_sk\r\n  and c_current_addr_sk = ca_address_sk\r\n  and c_birth_country <> upper(ca_country)\r\n  and s_zip = ca_zip\r\n  and s_market_id = 10\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n        ,ca_state\r\n        ,s_state\r\n        ,i_color\r\n        ,i_current_price\r\n        ,i_manager_id\r\n        ,i_units\r\n        ,i_size)\r\nselect c_last_name\r\n      ,c_first_name\r\n      ,s_store_name\r\n      ,sum(netpaid) paid\r\nfrom ssales\r\nwhere i_color = 'spring'\r\ngroup by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\r\n                           from ssales)\r\norder by c_last_name\r\n        ,c_first_name\r\n        ,s_store_name\r\n;\r\n\r\n", 
                    "oneline_sql": "with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid_inc_tax) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r and s_market_id=10\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'deep'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                                  from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r with ssales as\r (select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,ca_state\r       ,s_state\r       ,i_color\r       ,i_current_price\r       ,i_manager_id\r       ,i_units\r       ,i_size\r       ,sum(ss_net_paid_inc_tax) netpaid\r from store_sales\r     ,store_returns\r     ,store\r     ,item\r     ,customer\r     ,customer_address\r where ss_ticket_number = sr_ticket_number\r   and ss_item_sk = sr_item_sk\r   and ss_customer_sk = c_customer_sk\r   and ss_item_sk = i_item_sk\r   and ss_store_sk = s_store_sk\r   and c_current_addr_sk = ca_address_sk\r   and c_birth_country <> upper(ca_country)\r   and s_zip = ca_zip\r   and s_market_id = 10\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r         ,ca_state\r         ,s_state\r         ,i_color\r         ,i_current_price\r         ,i_manager_id\r         ,i_units\r         ,i_size)\r select c_last_name\r       ,c_first_name\r       ,s_store_name\r       ,sum(netpaid) paid\r from ssales\r where i_color = 'spring'\r group by c_last_name\r         ,c_first_name\r         ,s_store_name\r having sum(netpaid) > (select 0.05*avg(netpaid)\r                            from ssales)\r order by c_last_name\r         ,c_first_name\r         ,s_store_name\r ;\r \r ", 
                    "id": 554, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/554.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query24.tpl\r", 
                    "sid": 59, 
                    "endTime": 1575595864.893224
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:05", 
                    "startTimeFormat": "2019-12-06 09:31:04", 
                    "startTime": 1575595864.893322, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_555.sql", 
                    "second": 1.050926923751831, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  count(*) from (\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from store_sales, date_dim, customer\r\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n      and store_sales.ss_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1213 and 1213 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from catalog_sales, date_dim, customer\r\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1213 and 1213 + 11\r\n  intersect\r\n    select distinct c_last_name, c_first_name, d_date\r\n    from web_sales, date_dim, customer\r\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r\n      and d_month_seq between 1213 and 1213 + 11\r\n) hot_cust\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) from (\r     select distinct c_last_name, c_first_name, d_date\r     from store_sales, date_dim, customer\r           where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r       and store_sales.ss_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1213 and 1213 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from catalog_sales, date_dim, customer\r           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\r       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1213 and 1213 + 11\r   intersect\r     select distinct c_last_name, c_first_name, d_date\r     from web_sales, date_dim, customer\r           where web_sales.ws_sold_date_sk = date_dim.d_date_sk\r       and web_sales.ws_bill_customer_sk = customer.c_customer_sk\r       and d_month_seq between 1213 and 1213 + 11\r ) hot_cust\r  ) where rownum <= 100;\r \r ", 
                    "id": 555, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/555.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query38.tpl\r", 
                    "sid": 60, 
                    "endTime": 1575595865.944249
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:06", 
                    "startTimeFormat": "2019-12-06 09:31:05", 
                    "startTime": 1575595865.94435, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_556.sql", 
                    "second": 0.24210691452026367, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r\n \tsum(ss_ext_sales_price) ext_price\r\n from date_dim, store_sales, item\r\n where d_date_sk = ss_sold_date_sk\r\n \tand ss_item_sk = i_item_sk\r\n \tand i_manager_id=2\r\n \tand d_moy=11\r\n \tand d_year=1998\r\n group by i_brand, i_brand_id\r\n order by ext_price desc, i_brand_id\r\n ) where rownum <= 100 ;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_brand_id brand_id, i_brand brand,\r  \tsum(ss_ext_sales_price) ext_price\r  from date_dim, store_sales, item\r  where d_date_sk = ss_sold_date_sk\r  \tand ss_item_sk = i_item_sk\r  \tand i_manager_id=2\r  \tand d_moy=11\r  \tand d_year=1998\r  group by i_brand, i_brand_id\r  order by ext_price desc, i_brand_id\r  ) where rownum <= 100 ;\r \r ", 
                    "id": 556, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/556.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query55.tpl\r", 
                    "sid": 61, 
                    "endTime": 1575595866.186457
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:08", 
                    "startTimeFormat": "2019-12-06 09:31:06", 
                    "startTime": 1575595866.186559, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_557.sql", 
                    "second": 1.9219369888305664, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with year_total as (\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,max(ss_net_paid) year_total\r\n       ,'s' sale_type\r\n from customer\r\n     ,store_sales\r\n     ,date_dim\r\n where c_customer_sk = ss_customer_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_year in (1999,1999+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n union all\r\n select c_customer_id customer_id\r\n       ,c_first_name customer_first_name\r\n       ,c_last_name customer_last_name\r\n       ,d_year as year\r\n       ,max(ws_net_paid) year_total\r\n       ,'w' sale_type\r\n from customer\r\n     ,web_sales\r\n     ,date_dim\r\n where c_customer_sk = ws_bill_customer_sk\r\n   and ws_sold_date_sk = d_date_sk\r\n   and d_year in (1999,1999+1)\r\n group by c_customer_id\r\n         ,c_first_name\r\n         ,c_last_name\r\n         ,d_year\r\n         )\r\n select * from ( select \r\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r\n from year_total t_s_firstyear\r\n     ,year_total t_s_secyear\r\n     ,year_total t_w_firstyear\r\n     ,year_total t_w_secyear\r\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\r\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r\n         and t_s_firstyear.sale_type = 's'\r\n         and t_w_firstyear.sale_type = 'w'\r\n         and t_s_secyear.sale_type = 's'\r\n         and t_w_secyear.sale_type = 'w'\r\n         and t_s_firstyear.year = 1999\r\n         and t_s_secyear.year = 1999+1\r\n         and t_w_firstyear.year = 1999\r\n         and t_w_secyear.year = 1999+1\r\n         and t_s_firstyear.year_total > 0\r\n         and t_w_firstyear.year_total > 0\r\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r\n order by 3,1,2\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with year_total as (\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,max(ss_net_paid) year_total\r        ,'s' sale_type\r  from customer\r      ,store_sales\r      ,date_dim\r  where c_customer_sk = ss_customer_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_year in (1999,1999+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r  union all\r  select c_customer_id customer_id\r        ,c_first_name customer_first_name\r        ,c_last_name customer_last_name\r        ,d_year as year\r        ,max(ws_net_paid) year_total\r        ,'w' sale_type\r  from customer\r      ,web_sales\r      ,date_dim\r  where c_customer_sk = ws_bill_customer_sk\r    and ws_sold_date_sk = d_date_sk\r    and d_year in (1999,1999+1)\r  group by c_customer_id\r          ,c_first_name\r          ,c_last_name\r          ,d_year\r          )\r  select * from ( select \r         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\r  from year_total t_s_firstyear\r      ,year_total t_s_secyear\r      ,year_total t_w_firstyear\r      ,year_total t_w_secyear\r  where t_s_secyear.customer_id = t_s_firstyear.customer_id\r          and t_s_firstyear.customer_id = t_w_secyear.customer_id\r          and t_s_firstyear.customer_id = t_w_firstyear.customer_id\r          and t_s_firstyear.sale_type = 's'\r          and t_w_firstyear.sale_type = 'w'\r          and t_s_secyear.sale_type = 's'\r          and t_w_secyear.sale_type = 'w'\r          and t_s_firstyear.year = 1999\r          and t_s_secyear.year = 1999+1\r          and t_w_firstyear.year = 1999\r          and t_w_secyear.year = 1999+1\r          and t_s_firstyear.year_total > 0\r          and t_w_firstyear.year_total > 0\r          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\r            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\r  order by 3,1,2\r  ) where rownum <= 100;\r \r ", 
                    "id": 557, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/557.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query74.tpl\r", 
                    "sid": 62, 
                    "endTime": 1575595868.108496
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:08", 
                    "startTimeFormat": "2019-12-06 09:31:08", 
                    "startTime": 1575595868.108588, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_558.sql", 
                    "second": 0.14293503761291504, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  c_customer_id as customer_id\r\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r\n from customer\r\n     ,customer_address\r\n     ,customer_demographics\r\n     ,household_demographics\r\n     ,income_band\r\n     ,store_returns\r\n where ca_city\t        =  'Riverview'\r\n   and c_current_addr_sk = ca_address_sk\r\n   and ib_lower_bound   >=  51797\r\n   and ib_upper_bound   <=  51797 + 50000\r\n   and ib_income_band_sk = hd_income_band_sk\r\n   and cd_demo_sk = c_current_cdemo_sk\r\n   and hd_demo_sk = c_current_hdemo_sk\r\n   and sr_cdemo_sk = cd_demo_sk\r\n order by c_customer_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  c_customer_id as customer_id\r        , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\r  from customer\r      ,customer_address\r      ,customer_demographics\r      ,household_demographics\r      ,income_band\r      ,store_returns\r  where ca_city\t        =  'Riverview'\r    and c_current_addr_sk = ca_address_sk\r    and ib_lower_bound   >=  51797\r    and ib_upper_bound   <=  51797 + 50000\r    and ib_income_band_sk = hd_income_band_sk\r    and cd_demo_sk = c_current_cdemo_sk\r    and hd_demo_sk = c_current_hdemo_sk\r    and sr_cdemo_sk = cd_demo_sk\r  order by c_customer_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 558, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/558.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query84.tpl\r", 
                    "sid": 63, 
                    "endTime": 1575595868.251523
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:08", 
                    "startTimeFormat": "2019-12-06 09:31:08", 
                    "startTime": 1575595868.251628, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_559.sql", 
                    "second": 0.3957231044769287, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  *\r\nfrom(\r\nselect i_category, i_class, i_brand,\r\n       s_store_name, s_company_name,\r\n       d_moy,\r\n       sum(ss_sales_price) sum_sales,\r\n       avg(sum(ss_sales_price)) over\r\n         (partition by i_category, i_brand, s_store_name, s_company_name)\r\n         avg_monthly_sales\r\nfrom item, store_sales, date_dim, store\r\nwhere ss_item_sk = i_item_sk and\r\n      ss_sold_date_sk = d_date_sk and\r\n      ss_store_sk = s_store_sk and\r\n      d_year in (2002) and\r\n        ((i_category in ('Books','Sports','Women') and\r\n          i_class in ('cooking','golf','swimwear')\r\n         )\r\n      or (i_category in ('Music','Electronics','Children') and\r\n          i_class in ('pop','karoke','newborn') \r\n        ))\r\ngroup by i_category, i_class, i_brand,\r\n         s_store_name, s_company_name, d_moy) tmp1\r\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r\norder by sum_sales - avg_monthly_sales, s_store_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  *\r from(\r select i_category, i_class, i_brand,\r        s_store_name, s_company_name,\r        d_moy,\r        sum(ss_sales_price) sum_sales,\r        avg(sum(ss_sales_price)) over\r          (partition by i_category, i_brand, s_store_name, s_company_name)\r          avg_monthly_sales\r from item, store_sales, date_dim, store\r where ss_item_sk = i_item_sk and\r       ss_sold_date_sk = d_date_sk and\r       ss_store_sk = s_store_sk and\r       d_year in (2002) and\r         ((i_category in ('Books','Sports','Women') and\r           i_class in ('cooking','golf','swimwear')\r          )\r       or (i_category in ('Music','Electronics','Children') and\r           i_class in ('pop','karoke','newborn') \r         ))\r group by i_category, i_class, i_brand,\r          s_store_name, s_company_name, d_moy) tmp1\r where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\r order by sum_sales - avg_monthly_sales, s_store_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 559, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/559.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query89.tpl\r", 
                    "sid": 64, 
                    "endTime": 1575595868.647351
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:08", 
                    "startTimeFormat": "2019-12-06 09:31:08", 
                    "startTime": 1575595868.647433, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_560.sql", 
                    "second": 0.16784000396728516, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with sr_items as\r\n (select i_item_id item_id,\r\n        sum(sr_return_quantity) sr_item_qty\r\n from store_returns,\r\n      item,\r\n      date_dim\r\n where sr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in (to_date('2000-06-09','yyyy-mm-dd'),to_date('2000-09-24','yyyy-mm-dd'),to_date('2000-11-20','yyyy-mm-dd'))))\r\n and   sr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n cr_items as\r\n (select i_item_id item_id,\r\n        sum(cr_return_quantity) cr_item_qty\r\n from catalog_returns,\r\n      item,\r\n      date_dim\r\n where cr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t  where d_date in  (to_date('2000-06-09','yyyy-mm-dd'),to_date('2000-09-24','yyyy-mm-dd'),to_date('2000-11-20','yyyy-mm-dd'))))\r\n and   cr_returned_date_sk   = d_date_sk\r\n group by i_item_id),\r\n wr_items as\r\n (select i_item_id item_id,\r\n        sum(wr_return_quantity) wr_item_qty\r\n from web_returns,\r\n      item,\r\n      date_dim\r\n where wr_item_sk = i_item_sk\r\n and   d_date    in \r\n\t(select d_date\r\n\tfrom date_dim\r\n\twhere d_week_seq in \r\n\t\t(select d_week_seq\r\n\t\tfrom date_dim\r\n\t\twhere d_date in  (to_date('2000-06-09','yyyy-mm-dd'),to_date('2000-09-24','yyyy-mm-dd'),to_date('2000-11-20','yyyy-mm-dd'))))\r\n and   wr_returned_date_sk   = d_date_sk\r\n group by i_item_id)\r\n select * from ( select  sr_items.item_id\r\n       ,sr_item_qty\r\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r\n       ,cr_item_qty\r\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r\n       ,wr_item_qty\r\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r\n from sr_items\r\n     ,cr_items\r\n     ,wr_items\r\n where sr_items.item_id=cr_items.item_id\r\n   and sr_items.item_id=wr_items.item_id \r\n order by sr_items.item_id\r\n         ,sr_item_qty\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with sr_items as\r  (select i_item_id item_id,\r         sum(sr_return_quantity) sr_item_qty\r  from store_returns,\r       item,\r       date_dim\r  where sr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in (to_date('2000-06-09','yyyy-mm-dd'),to_date('2000-09-24','yyyy-mm-dd'),to_date('2000-11-20','yyyy-mm-dd'))))\r  and   sr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  cr_items as\r  (select i_item_id item_id,\r         sum(cr_return_quantity) cr_item_qty\r  from catalog_returns,\r       item,\r       date_dim\r  where cr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t  where d_date in  (to_date('2000-06-09','yyyy-mm-dd'),to_date('2000-09-24','yyyy-mm-dd'),to_date('2000-11-20','yyyy-mm-dd'))))\r  and   cr_returned_date_sk   = d_date_sk\r  group by i_item_id),\r  wr_items as\r  (select i_item_id item_id,\r         sum(wr_return_quantity) wr_item_qty\r  from web_returns,\r       item,\r       date_dim\r  where wr_item_sk = i_item_sk\r  and   d_date    in \r \t(select d_date\r \tfrom date_dim\r \twhere d_week_seq in \r \t\t(select d_week_seq\r \t\tfrom date_dim\r \t\twhere d_date in  (to_date('2000-06-09','yyyy-mm-dd'),to_date('2000-09-24','yyyy-mm-dd'),to_date('2000-11-20','yyyy-mm-dd'))))\r  and   wr_returned_date_sk   = d_date_sk\r  group by i_item_id)\r  select * from ( select  sr_items.item_id\r        ,sr_item_qty\r        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\r        ,cr_item_qty\r        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\r        ,wr_item_qty\r        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\r        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\r  from sr_items\r      ,cr_items\r      ,wr_items\r  where sr_items.item_id=cr_items.item_id\r    and sr_items.item_id=wr_items.item_id \r  order by sr_items.item_id\r          ,sr_item_qty\r   ) where rownum <= 100;\r \r ", 
                    "id": 560, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/560.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query83.tpl\r", 
                    "sid": 65, 
                    "endTime": 1575595868.815273
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:09", 
                    "startTimeFormat": "2019-12-06 09:31:08", 
                    "startTime": 1575595868.81537, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_561.sql", 
                    "second": 0.6363229751586914, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ss as\r\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r\n from store_sales,date_dim,customer_address\r\n where ss_sold_date_sk = d_date_sk\r\n  and ss_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year),\r\n ws as\r\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r\n from web_sales,date_dim,customer_address\r\n where ws_sold_date_sk = d_date_sk\r\n  and ws_bill_addr_sk=ca_address_sk\r\n group by ca_county,d_qoy, d_year)\r\n select \r\n        ss1.ca_county\r\n       ,ss1.d_year\r\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r\n from\r\n        ss ss1\r\n       ,ss ss2\r\n       ,ss ss3\r\n       ,ws ws1\r\n       ,ws ws2\r\n       ,ws ws3\r\n where\r\n    ss1.d_qoy = 1\r\n    and ss1.d_year = 1999\r\n    and ss1.ca_county = ss2.ca_county\r\n    and ss2.d_qoy = 2\r\n    and ss2.d_year = 1999\r\n and ss2.ca_county = ss3.ca_county\r\n    and ss3.d_qoy = 3\r\n    and ss3.d_year = 1999\r\n    and ss1.ca_county = ws1.ca_county\r\n    and ws1.d_qoy = 1\r\n    and ws1.d_year = 1999\r\n    and ws1.ca_county = ws2.ca_county\r\n    and ws2.d_qoy = 2\r\n    and ws2.d_year = 1999\r\n    and ws1.ca_county = ws3.ca_county\r\n    and ws3.d_qoy = 3\r\n    and ws3.d_year =1999\r\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r\n order by ss1.d_year;\r\n\r\n", 
                    "oneline_sql": "with ss as\r  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\r  from store_sales,date_dim,customer_address\r  where ss_sold_date_sk = d_date_sk\r   and ss_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year),\r  ws as\r  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\r  from web_sales,date_dim,customer_address\r  where ws_sold_date_sk = d_date_sk\r   and ws_bill_addr_sk=ca_address_sk\r  group by ca_county,d_qoy, d_year)\r  select \r         ss1.ca_county\r        ,ss1.d_year\r        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\r        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\r        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\r        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\r  from\r         ss ss1\r        ,ss ss2\r        ,ss ss3\r        ,ws ws1\r        ,ws ws2\r        ,ws ws3\r  where\r     ss1.d_qoy = 1\r     and ss1.d_year = 1999\r     and ss1.ca_county = ss2.ca_county\r     and ss2.d_qoy = 2\r     and ss2.d_year = 1999\r  and ss2.ca_county = ss3.ca_county\r     and ss3.d_qoy = 3\r     and ss3.d_year = 1999\r     and ss1.ca_county = ws1.ca_county\r     and ws1.d_qoy = 1\r     and ws1.d_year = 1999\r     and ws1.ca_county = ws2.ca_county\r     and ws2.d_qoy = 2\r     and ws2.d_year = 1999\r     and ws1.ca_county = ws3.ca_county\r     and ws3.d_qoy = 3\r     and ws3.d_year =1999\r     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \r        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\r     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\r        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\r  order by ss1.d_year;\r \r ", 
                    "id": 561, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/561.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query31.tpl\r", 
                    "sid": 66, 
                    "endTime": 1575595869.451693
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:09", 
                    "startTimeFormat": "2019-12-06 09:31:09", 
                    "startTime": 1575595869.451797, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_562.sql", 
                    "second": 0.33822107315063477, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id, \r\n        avg(cs_quantity) agg1,\r\n        avg(cs_list_price) agg2,\r\n        avg(cs_coupon_amt) agg3,\r\n        avg(cs_sales_price) agg4 \r\n from catalog_sales, customer_demographics, date_dim, item, promotion\r\n where cs_sold_date_sk = d_date_sk and\r\n       cs_item_sk = i_item_sk and\r\n       cs_bill_cdemo_sk = cd_demo_sk and\r\n       cs_promo_sk = p_promo_sk and\r\n       cd_gender = 'M' and \r\n       cd_marital_status = 'M' and\r\n       cd_education_status = 'Advanced Degree' and\r\n       (p_channel_email = 'N' or p_channel_event = 'N') and\r\n       d_year = 2000 \r\n group by i_item_id\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id, \r         avg(cs_quantity) agg1,\r         avg(cs_list_price) agg2,\r         avg(cs_coupon_amt) agg3,\r         avg(cs_sales_price) agg4 \r  from catalog_sales, customer_demographics, date_dim, item, promotion\r  where cs_sold_date_sk = d_date_sk and\r        cs_item_sk = i_item_sk and\r        cs_bill_cdemo_sk = cd_demo_sk and\r        cs_promo_sk = p_promo_sk and\r        cd_gender = 'M' and \r        cd_marital_status = 'M' and\r        cd_education_status = 'Advanced Degree' and\r        (p_channel_email = 'N' or p_channel_event = 'N') and\r        d_year = 2000 \r  group by i_item_id\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 562, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/562.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query26.tpl\r", 
                    "sid": 67, 
                    "endTime": 1575595869.790018
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:10", 
                    "startTimeFormat": "2019-12-06 09:31:09", 
                    "startTime": 1575595869.790111, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_563.sql", 
                    "second": 0.2564208507537842, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   w_state\r\n  ,i_item_id\r\n  ,sum(case when (cast(d_date as date) < to_date ('1998-05-01','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r\n  ,sum(case when (cast(d_date as date) >= to_date ('1998-05-01','yyyy-mm-dd')) \r\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r\n from\r\n   catalog_sales left outer join catalog_returns on\r\n       (cs_order_number = cr_order_number \r\n        and cs_item_sk = cr_item_sk)\r\n  ,warehouse \r\n  ,item\r\n  ,date_dim\r\n where\r\n     i_current_price between 0.99 and 1.49\r\n and i_item_sk          = cs_item_sk\r\n and cs_warehouse_sk    = w_warehouse_sk \r\n and cs_sold_date_sk    = d_date_sk\r\n and d_date between (to_date ('1998-05-01','yyyy-mm-dd') - 30 )\r\n                and (to_date ('1998-05-01','yyyy-mm-dd') + 30 ) \r\n group by\r\n    w_state,i_item_id\r\n order by w_state,i_item_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    w_state\r   ,i_item_id\r   ,sum(case when (cast(d_date as date) < to_date ('1998-05-01','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\r   ,sum(case when (cast(d_date as date) >= to_date ('1998-05-01','yyyy-mm-dd')) \r  \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\r  from\r    catalog_sales left outer join catalog_returns on\r        (cs_order_number = cr_order_number \r         and cs_item_sk = cr_item_sk)\r   ,warehouse \r   ,item\r   ,date_dim\r  where\r      i_current_price between 0.99 and 1.49\r  and i_item_sk          = cs_item_sk\r  and cs_warehouse_sk    = w_warehouse_sk \r  and cs_sold_date_sk    = d_date_sk\r  and d_date between (to_date ('1998-05-01','yyyy-mm-dd') - 30 )\r                 and (to_date ('1998-05-01','yyyy-mm-dd') + 30 ) \r  group by\r     w_state,i_item_id\r  order by w_state,i_item_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 563, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/563.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query40.tpl\r", 
                    "sid": 68, 
                    "endTime": 1575595870.046532
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:24", 
                    "startTimeFormat": "2019-12-06 09:31:10", 
                    "startTime": 1575595870.046623, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_564.sql", 
                    "second": 14.202325105667114, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect \r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2)\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n (select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all \r\n       select cs_quantity quantity \r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2 \r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r\n from(\r\n       select 'store' channel, i_brand_id,i_class_id\r\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\r\n             , count(*) number_sales\r\n       from store_sales\r\n           ,item\r\n           ,date_dim\r\n       where ss_item_sk in (select ss_item_sk from cross_items)\r\n         and ss_item_sk = i_item_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r\n       from catalog_sales\r\n           ,item\r\n           ,date_dim\r\n       where cs_item_sk in (select ss_item_sk from cross_items)\r\n         and cs_item_sk = i_item_sk\r\n         and cs_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2 \r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r\n       union all\r\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r\n       from web_sales\r\n           ,item\r\n           ,date_dim\r\n       where ws_item_sk in (select ss_item_sk from cross_items)\r\n         and ws_item_sk = i_item_sk\r\n         and ws_sold_date_sk = d_date_sk\r\n         and d_year = 1999+2\r\n         and d_moy = 11\r\n       group by i_brand_id,i_class_id,i_category_id\r\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r\n ) y\r\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r\n order by channel,i_brand_id,i_class_id,i_category_id\r\n  ) where rownum <= 100;\r\nwith  cross_items as\r\n (select i_item_sk ss_item_sk\r\n from item,\r\n (select iss.i_brand_id brand_id\r\n     ,iss.i_class_id class_id\r\n     ,iss.i_category_id category_id\r\n from store_sales\r\n     ,item iss\r\n     ,date_dim d1\r\n where ss_item_sk = iss.i_item_sk\r\n   and ss_sold_date_sk = d1.d_date_sk\r\n   and d1.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select ics.i_brand_id\r\n     ,ics.i_class_id\r\n     ,ics.i_category_id\r\n from catalog_sales\r\n     ,item ics\r\n     ,date_dim d2\r\n where cs_item_sk = ics.i_item_sk\r\n   and cs_sold_date_sk = d2.d_date_sk\r\n   and d2.d_year between 1999 AND 1999 + 2\r\n intersect\r\n select iws.i_brand_id\r\n     ,iws.i_class_id\r\n     ,iws.i_category_id\r\n from web_sales\r\n     ,item iws\r\n     ,date_dim d3\r\n where ws_item_sk = iws.i_item_sk\r\n   and ws_sold_date_sk = d3.d_date_sk\r\n   and d3.d_year between 1999 AND 1999 + 2) x\r\n where i_brand_id = brand_id\r\n      and i_class_id = class_id\r\n      and i_category_id = category_id\r\n),\r\n avg_sales as\r\n(select avg(quantity*list_price) average_sales\r\n  from (select ss_quantity quantity\r\n             ,ss_list_price list_price\r\n       from store_sales\r\n           ,date_dim\r\n       where ss_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select cs_quantity quantity\r\n             ,cs_list_price list_price\r\n       from catalog_sales\r\n           ,date_dim\r\n       where cs_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2\r\n       union all\r\n       select ws_quantity quantity\r\n             ,ws_list_price list_price\r\n       from web_sales\r\n           ,date_dim\r\n       where ws_sold_date_sk = d_date_sk\r\n         and d_year between 1999 and 1999 + 2) x)\r\n select * from ( select  * from\r\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\r\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r\n from store_sales \r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999 + 1\r\n                       and d_moy = 12\r\n                       and d_dom = 3)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r\n (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r\n        ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r\n from store_sales\r\n     ,item\r\n     ,date_dim\r\n where ss_item_sk in (select ss_item_sk from cross_items)\r\n   and ss_item_sk = i_item_sk\r\n   and ss_sold_date_sk = d_date_sk\r\n   and d_week_seq = (select d_week_seq\r\n                     from date_dim\r\n                     where d_year = 1999\r\n                       and d_moy = 12\r\n                       and d_dom = 3)\r\n group by i_brand_id,i_class_id,i_category_id\r\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r\n where this_year.i_brand_id= last_year.i_brand_id2\r\n   and this_year.i_class_id = last_year.i_class_id2\r\n   and this_year.i_category_id = last_year.i_category_id2\r\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect \r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2)\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r  (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all \r        select cs_quantity quantity \r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2 \r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\r  from(\r        select 'store' channel, i_brand_id,i_class_id\r              ,i_category_id,sum(ss_quantity*ss_list_price) sales\r              , count(*) number_sales\r        from store_sales\r            ,item\r            ,date_dim\r        where ss_item_sk in (select ss_item_sk from cross_items)\r          and ss_item_sk = i_item_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\r        from catalog_sales\r            ,item\r            ,date_dim\r        where cs_item_sk in (select ss_item_sk from cross_items)\r          and cs_item_sk = i_item_sk\r          and cs_sold_date_sk = d_date_sk\r          and d_year = 1999+2 \r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\r        union all\r        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\r        from web_sales\r            ,item\r            ,date_dim\r        where ws_item_sk in (select ss_item_sk from cross_items)\r          and ws_item_sk = i_item_sk\r          and ws_sold_date_sk = d_date_sk\r          and d_year = 1999+2\r          and d_moy = 11\r        group by i_brand_id,i_class_id,i_category_id\r        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\r  ) y\r  group by rollup (channel, i_brand_id,i_class_id,i_category_id)\r  order by channel,i_brand_id,i_class_id,i_category_id\r   ) where rownum <= 100;\r with  cross_items as\r  (select i_item_sk ss_item_sk\r  from item,\r  (select iss.i_brand_id brand_id\r      ,iss.i_class_id class_id\r      ,iss.i_category_id category_id\r  from store_sales\r      ,item iss\r      ,date_dim d1\r  where ss_item_sk = iss.i_item_sk\r    and ss_sold_date_sk = d1.d_date_sk\r    and d1.d_year between 1999 AND 1999 + 2\r  intersect\r  select ics.i_brand_id\r      ,ics.i_class_id\r      ,ics.i_category_id\r  from catalog_sales\r      ,item ics\r      ,date_dim d2\r  where cs_item_sk = ics.i_item_sk\r    and cs_sold_date_sk = d2.d_date_sk\r    and d2.d_year between 1999 AND 1999 + 2\r  intersect\r  select iws.i_brand_id\r      ,iws.i_class_id\r      ,iws.i_category_id\r  from web_sales\r      ,item iws\r      ,date_dim d3\r  where ws_item_sk = iws.i_item_sk\r    and ws_sold_date_sk = d3.d_date_sk\r    and d3.d_year between 1999 AND 1999 + 2) x\r  where i_brand_id = brand_id\r       and i_class_id = class_id\r       and i_category_id = category_id\r ),\r  avg_sales as\r (select avg(quantity*list_price) average_sales\r   from (select ss_quantity quantity\r              ,ss_list_price list_price\r        from store_sales\r            ,date_dim\r        where ss_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select cs_quantity quantity\r              ,cs_list_price list_price\r        from catalog_sales\r            ,date_dim\r        where cs_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2\r        union all\r        select ws_quantity quantity\r              ,ws_list_price list_price\r        from web_sales\r            ,date_dim\r        where ws_sold_date_sk = d_date_sk\r          and d_year between 1999 and 1999 + 2) x)\r  select * from ( select  * from\r  (select 'store' channel, i_brand_id,i_class_id,i_category_id\r         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\r  from store_sales \r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999 + 1\r                        and d_moy = 12\r                        and d_dom = 3)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\r  (select 'store' channe2, i_brand_id i_brand_id2,i_class_id i_class_id2\r         ,i_category_id i_category_id2, sum(ss_quantity*ss_list_price) sales2, count(*) number_sales2\r  from store_sales\r      ,item\r      ,date_dim\r  where ss_item_sk in (select ss_item_sk from cross_items)\r    and ss_item_sk = i_item_sk\r    and ss_sold_date_sk = d_date_sk\r    and d_week_seq = (select d_week_seq\r                      from date_dim\r                      where d_year = 1999\r                        and d_moy = 12\r                        and d_dom = 3)\r  group by i_brand_id,i_class_id,i_category_id\r  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\r  where this_year.i_brand_id= last_year.i_brand_id2\r    and this_year.i_class_id = last_year.i_class_id2\r    and this_year.i_category_id = last_year.i_category_id2\r  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 564, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/564.sql", 
                    "secondFormat": "00:00:14", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query14.tpl\r", 
                    "sid": 69, 
                    "endTime": 1575595884.248948
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:34", 
                    "startTimeFormat": "2019-12-06 09:31:24", 
                    "startTime": 1575595884.249055, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_565.sql", 
                    "second": 10.514971017837524, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with frequent_ss_items as \r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim \r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk \r\n    and d_year in (1999,1999+1,1999+2,1999+3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax \r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3) \r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\nfrom\r\n max_store_sales))\r\n select * from ( select  sum(sales)\r\n from (select cs_quantity*cs_list_price sales\r\n       from catalog_sales\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 6 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n      union all\r\n      select ws_quantity*ws_list_price sales\r\n       from web_sales \r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 6 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r\n  ) where rownum <= 100;\r\nwith frequent_ss_items as\r\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r\n  from store_sales\r\n      ,date_dim\r\n      ,item\r\n  where ss_sold_date_sk = d_date_sk\r\n    and ss_item_sk = i_item_sk\r\n    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\r\n  having count(*) >4),\r\n max_store_sales as\r\n (select max(csales) tpcds_cmax\r\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r\n        from store_sales\r\n            ,customer\r\n            ,date_dim \r\n        where ss_customer_sk = c_customer_sk\r\n         and ss_sold_date_sk = d_date_sk\r\n         and d_year in (1999,1999+1,1999+2,1999+3)\r\n        group by c_customer_sk)),\r\n best_ss_customer as\r\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r\n  from store_sales\r\n      ,customer\r\n  where ss_customer_sk = c_customer_sk\r\n  group by c_customer_sk\r\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r\n  *\r\n from max_store_sales))\r\n select * from ( select  c_last_name,c_first_name,sales\r\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r\n        from catalog_sales\r\n            ,customer\r\n            ,date_dim \r\n        where d_year = 1999 \r\n         and d_moy = 6 \r\n         and cs_sold_date_sk = d_date_sk \r\n         and cs_item_sk in (select item_sk from frequent_ss_items)\r\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and cs_bill_customer_sk = c_customer_sk \r\n       group by c_last_name,c_first_name\r\n      union all\r\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r\n       from web_sales\r\n           ,customer\r\n           ,date_dim \r\n       where d_year = 1999 \r\n         and d_moy = 6 \r\n         and ws_sold_date_sk = d_date_sk \r\n         and ws_item_sk in (select item_sk from frequent_ss_items)\r\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r\n         and ws_bill_customer_sk = c_customer_sk\r\n       group by c_last_name,c_first_name) \r\n     order by c_last_name,c_first_name,sales\r\n   ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with frequent_ss_items as \r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim \r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk \r     and d_year in (1999,1999+1,1999+2,1999+3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax \r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3) \r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r from\r  max_store_sales))\r  select * from ( select  sum(sales)\r  from (select cs_quantity*cs_list_price sales\r        from catalog_sales\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 6 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r       union all\r       select ws_quantity*ws_list_price sales\r        from web_sales \r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 6 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \r   ) where rownum <= 100;\r with frequent_ss_items as\r  (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\r   from store_sales\r       ,date_dim\r       ,item\r   where ss_sold_date_sk = d_date_sk\r     and ss_item_sk = i_item_sk\r     and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\r   group by substr(i_item_desc,1,30),i_item_sk,d_date\r   having count(*) >4),\r  max_store_sales as\r  (select max(csales) tpcds_cmax\r   from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\r         from store_sales\r             ,customer\r             ,date_dim \r         where ss_customer_sk = c_customer_sk\r          and ss_sold_date_sk = d_date_sk\r          and d_year in (1999,1999+1,1999+2,1999+3)\r         group by c_customer_sk)),\r  best_ss_customer as\r  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\r   from store_sales\r       ,customer\r   where ss_customer_sk = c_customer_sk\r   group by c_customer_sk\r   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\r   *\r  from max_store_sales))\r  select * from ( select  c_last_name,c_first_name,sales\r  from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\r         from catalog_sales\r             ,customer\r             ,date_dim \r         where d_year = 1999 \r          and d_moy = 6 \r          and cs_sold_date_sk = d_date_sk \r          and cs_item_sk in (select item_sk from frequent_ss_items)\r          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and cs_bill_customer_sk = c_customer_sk \r        group by c_last_name,c_first_name\r       union all\r       select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\r        from web_sales\r            ,customer\r            ,date_dim \r        where d_year = 1999 \r          and d_moy = 6 \r          and ws_sold_date_sk = d_date_sk \r          and ws_item_sk in (select item_sk from frequent_ss_items)\r          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\r          and ws_bill_customer_sk = c_customer_sk\r        group by c_last_name,c_first_name) \r      order by c_last_name,c_first_name,sales\r    ) where rownum <= 100;\r \r ", 
                    "id": 565, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/565.sql", 
                    "secondFormat": "00:00:10", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query23.tpl\r", 
                    "sid": 70, 
                    "endTime": 1575595894.764026
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:34", 
                    "startTime": 1575595894.76412, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_566.sql", 
                    "second": 0.4901468753814697, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  count(*) \r\nfrom store_sales\r\n    ,household_demographics \r\n    ,time_dim, store\r\nwhere ss_sold_time_sk = time_dim.t_time_sk   \r\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \r\n    and ss_store_sk = s_store_sk\r\n    and time_dim.t_hour = 16\r\n    and time_dim.t_minute >= 30\r\n    and household_demographics.hd_dep_count = 8\r\n    and store.s_store_name = 'ese'\r\norder by count(*)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  count(*) \r from store_sales\r     ,household_demographics \r     ,time_dim, store\r where ss_sold_time_sk = time_dim.t_time_sk   \r     and ss_hdemo_sk = household_demographics.hd_demo_sk \r     and ss_store_sk = s_store_sk\r     and time_dim.t_hour = 16\r     and time_dim.t_minute >= 30\r     and household_demographics.hd_dep_count = 8\r     and store.s_store_name = 'ese'\r order by count(*)\r  ) where rownum <= 100;\r \r ", 
                    "id": 566, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/566.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query96.tpl\r", 
                    "sid": 71, 
                    "endTime": 1575595895.254267
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:35", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.254372, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_567.sql", 
                    "second": 0.02405405044555664, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with customer_total_return as\r\n(select sr_customer_sk as ctr_customer_sk\r\n,sr_store_sk as ctr_store_sk\r\n,sum(SR_FEE) as ctr_total_return\r\nfrom store_returns\r\n,date_dim\r\nwhere sr_returned_date_sk = d_date_sk\r\nand d_year =2001\r\ngroup by sr_customer_sk\r\n,sr_store_sk)\r\nselect * from ( select  c_customer_id\r\nfrom customer_total_return ctr1\r\n,store\r\n,customer\r\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r\nfrom customer_total_return ctr2\r\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r\nand s_store_sk = ctr1.ctr_store_sk\r\nand s_state = 'IN'\r\nand ctr1.ctr_customer_sk = c_customer_sk\r\norder by c_customer_id\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with customer_total_return as\r (select sr_customer_sk as ctr_customer_sk\r ,sr_store_sk as ctr_store_sk\r ,sum(SR_FEE) as ctr_total_return\r from store_returns\r ,date_dim\r where sr_returned_date_sk = d_date_sk\r and d_year =2001\r group by sr_customer_sk\r ,sr_store_sk)\r select * from ( select  c_customer_id\r from customer_total_return ctr1\r ,store\r ,customer\r where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\r from customer_total_return ctr2\r where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\r and s_store_sk = ctr1.ctr_store_sk\r and s_state = 'IN'\r and ctr1.ctr_customer_sk = c_customer_sk\r order by c_customer_id\r  ) where rownum <= 100;\r \r ", 
                    "id": 567, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/567.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query1.tpl\r", 
                    "sid": 72, 
                    "endTime": 1575595895.278426
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:47", 
                    "startTimeFormat": "2019-12-06 09:31:35", 
                    "startTime": 1575595895.278527, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_568.sql", 
                    "second": 11.726680994033813, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ws_wh as\r\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r\n from web_sales ws1,web_sales ws2\r\n where ws1.ws_order_number = ws2.ws_order_number\r\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r\nselect * from ( select  \r\n   count(distinct ws_order_number) as \"order count\"\r\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(ws_net_profit) as \"total net profit\"\r\nfrom\r\n   web_sales ws1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,web_site\r\nwhere\r\n    d_date between to_date('2002-3-01','yyyy-mm-dd') and \r\n            to_date('2002-3-01','yyyy-mm-dd') + 60\r\nand ws1.ws_ship_date_sk = d_date_sk\r\nand ws1.ws_ship_addr_sk = ca_address_sk\r\nand ca_state = 'SC'\r\nand ws1.ws_web_site_sk = web_site_sk\r\nand web_company_name = 'pri'\r\nand ws1.ws_order_number in (select ws_order_number\r\n                            from ws_wh)\r\nand ws1.ws_order_number in (select wr_order_number\r\n                            from web_returns,ws_wh\r\n                            where wr_order_number = ws_wh.ws_order_number)\r\norder by count(distinct ws_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ws_wh as\r (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\r  from web_sales ws1,web_sales ws2\r  where ws1.ws_order_number = ws2.ws_order_number\r    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\r select * from ( select  \r    count(distinct ws_order_number) as \"order count\"\r   ,sum(ws_ext_ship_cost) as \"total shipping cost\"\r   ,sum(ws_net_profit) as \"total net profit\"\r from\r    web_sales ws1\r   ,date_dim\r   ,customer_address\r   ,web_site\r where\r     d_date between to_date('2002-3-01','yyyy-mm-dd') and \r             to_date('2002-3-01','yyyy-mm-dd') + 60\r and ws1.ws_ship_date_sk = d_date_sk\r and ws1.ws_ship_addr_sk = ca_address_sk\r and ca_state = 'SC'\r and ws1.ws_web_site_sk = web_site_sk\r and web_company_name = 'pri'\r and ws1.ws_order_number in (select ws_order_number\r                             from ws_wh)\r and ws1.ws_order_number in (select wr_order_number\r                             from web_returns,ws_wh\r                             where wr_order_number = ws_wh.ws_order_number)\r order by count(distinct ws_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 568, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/568.sql", 
                    "secondFormat": "00:00:11", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query95.tpl\r", 
                    "sid": 73, 
                    "endTime": 1575595907.005208
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:47", 
                    "startTimeFormat": "2019-12-06 09:31:47", 
                    "startTime": 1575595907.005319, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_569.sql", 
                    "second": 0.07441377639770508, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id,\r\n        s_state, grouping(s_state) g_state,\r\n        avg(ss_quantity) agg1,\r\n        avg(ss_list_price) agg2,\r\n        avg(ss_coupon_amt) agg3,\r\n        avg(ss_sales_price) agg4\r\n from store_sales, customer_demographics, date_dim, store, item\r\n where ss_sold_date_sk = d_date_sk and\r\n       ss_item_sk = i_item_sk and\r\n       ss_store_sk = s_store_sk and\r\n       ss_cdemo_sk = cd_demo_sk and\r\n       cd_gender = 'M' and\r\n       cd_marital_status = 'D' and\r\n       cd_education_status = 'Secondary' and\r\n       d_year = 1999 and\r\n       s_state in ('GA','MI', 'OH', 'AL', 'FL', 'SD')\r\n group by rollup (i_item_id, s_state)\r\n order by i_item_id\r\n         ,s_state\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id,\r         s_state, grouping(s_state) g_state,\r         avg(ss_quantity) agg1,\r         avg(ss_list_price) agg2,\r         avg(ss_coupon_amt) agg3,\r         avg(ss_sales_price) agg4\r  from store_sales, customer_demographics, date_dim, store, item\r  where ss_sold_date_sk = d_date_sk and\r        ss_item_sk = i_item_sk and\r        ss_store_sk = s_store_sk and\r        ss_cdemo_sk = cd_demo_sk and\r        cd_gender = 'M' and\r        cd_marital_status = 'D' and\r        cd_education_status = 'Secondary' and\r        d_year = 1999 and\r        s_state in ('GA','MI', 'OH', 'AL', 'FL', 'SD')\r  group by rollup (i_item_id, s_state)\r  order by i_item_id\r          ,s_state\r   ) where rownum <= 100;\r \r ", 
                    "id": 569, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/569.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query27.tpl\r", 
                    "sid": 74, 
                    "endTime": 1575595907.079733
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:47", 
                    "startTimeFormat": "2019-12-06 09:31:47", 
                    "startTime": 1575595907.079845, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_570.sql", 
                    "second": 0.22513604164123535, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r\nfrom(select *\r\n     from (select item_sk,rank() over (order by rank_col asc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r\n                 from store_sales ss1\r\n                 where ss_store_sk = 197\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 197\r\n                                                    and ss_cdemo_sk is null\r\n                                                  group by ss_store_sk))V1)V11\r\n     where rnk  < 11) asceding,\r\n    (select *\r\n     from (select item_sk,rank() over (order by rank_col desc) rnk\r\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r\n                 from store_sales ss1\r\n                 where ss_store_sk = 197\r\n                 group by ss_item_sk\r\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r\n                                                  from store_sales\r\n                                                  where ss_store_sk = 197\r\n                                                    and ss_cdemo_sk is null\r\n                                                  group by ss_store_sk))V2)V21\r\n     where rnk  < 11) descending,\r\nitem i1,\r\nitem i2\r\nwhere asceding.rnk = descending.rnk \r\n  and i1.i_item_sk=asceding.item_sk\r\n  and i2.i_item_sk=descending.item_sk\r\norder by asceding.rnk\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\r from(select *\r      from (select item_sk,rank() over (order by rank_col asc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \r                  from store_sales ss1\r                  where ss_store_sk = 197\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 197\r                                                     and ss_cdemo_sk is null\r                                                   group by ss_store_sk))V1)V11\r      where rnk  < 11) asceding,\r     (select *\r      from (select item_sk,rank() over (order by rank_col desc) rnk\r            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\r                  from store_sales ss1\r                  where ss_store_sk = 197\r                  group by ss_item_sk\r                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\r                                                   from store_sales\r                                                   where ss_store_sk = 197\r                                                     and ss_cdemo_sk is null\r                                                   group by ss_store_sk))V2)V21\r      where rnk  < 11) descending,\r item i1,\r item i2\r where asceding.rnk = descending.rnk \r   and i1.i_item_sk=asceding.item_sk\r   and i2.i_item_sk=descending.item_sk\r order by asceding.rnk\r  ) where rownum <= 100;\r \r ", 
                    "id": 570, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/570.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query44.tpl\r", 
                    "sid": 75, 
                    "endTime": 1575595907.304981
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:47", 
                    "startTimeFormat": "2019-12-06 09:31:47", 
                    "startTime": 1575595907.305088, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_571.sql", 
                    "second": 0.5735230445861816, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   count(distinct cs_order_number) as \"order count\"\r\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r\n  ,sum(cs_net_profit) as \"total net profit\"\r\nfrom\r\n   catalog_sales cs1\r\n  ,date_dim\r\n  ,customer_address\r\n  ,call_center\r\nwhere\r\n    d_date between to_date('2002-4-01','yyyy-mm-dd') and \r\n           (to_date('2002-4-01' ,'yyyy-mm-dd') + 60 )\r\nand cs1.cs_ship_date_sk = d_date_sk\r\nand cs1.cs_ship_addr_sk = ca_address_sk\r\nand ca_state = 'TX'\r\nand cs1.cs_call_center_sk = cc_call_center_sk\r\nand cc_county in ('San Miguel County','Williamson County','Huron County','Kittitas County',\r\n                  'Richland County'\r\n)\r\nand exists (select *\r\n            from catalog_sales cs2\r\n            where cs1.cs_order_number = cs2.cs_order_number\r\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r\nand not exists(select *\r\n               from catalog_returns cr1\r\n               where cs1.cs_order_number = cr1.cr_order_number)\r\norder by count(distinct cs_order_number)\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    count(distinct cs_order_number) as \"order count\"\r   ,sum(cs_ext_ship_cost) as \"total shipping cost\"\r   ,sum(cs_net_profit) as \"total net profit\"\r from\r    catalog_sales cs1\r   ,date_dim\r   ,customer_address\r   ,call_center\r where\r     d_date between to_date('2002-4-01','yyyy-mm-dd') and \r            (to_date('2002-4-01' ,'yyyy-mm-dd') + 60 )\r and cs1.cs_ship_date_sk = d_date_sk\r and cs1.cs_ship_addr_sk = ca_address_sk\r and ca_state = 'TX'\r and cs1.cs_call_center_sk = cc_call_center_sk\r and cc_county in ('San Miguel County','Williamson County','Huron County','Kittitas County',\r                   'Richland County'\r )\r and exists (select *\r             from catalog_sales cs2\r             where cs1.cs_order_number = cs2.cs_order_number\r               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\r and not exists(select *\r                from catalog_returns cr1\r                where cs1.cs_order_number = cr1.cr_order_number)\r order by count(distinct cs_order_number)\r  ) where rownum <= 100;\r \r ", 
                    "id": 571, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/571.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query16.tpl\r", 
                    "sid": 76, 
                    "endTime": 1575595907.878611
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:50", 
                    "startTimeFormat": "2019-12-06 09:31:47", 
                    "startTime": 1575595907.878711, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_572.sql", 
                    "second": 2.6407370567321777, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with cs_ui as\r\n (select cs_item_sk\r\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r\n  from catalog_sales\r\n      ,catalog_returns\r\n  where cs_item_sk = cr_item_sk\r\n    and cs_order_number = cr_order_number\r\n  group by cs_item_sk\r\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r\ncross_sales as\r\n (select i_product_name product_name\r\n     ,i_item_sk item_sk\r\n     ,s_store_name store_name\r\n     ,s_zip store_zip\r\n     ,ad1.ca_street_number b_street_number\r\n     ,ad1.ca_street_name b_street_name\r\n     ,ad1.ca_city b_city\r\n     ,ad1.ca_zip b_zip\r\n     ,ad2.ca_street_number c_street_number\r\n     ,ad2.ca_street_name c_street_name\r\n     ,ad2.ca_city c_city\r\n     ,ad2.ca_zip c_zip\r\n     ,d1.d_year as syear\r\n     ,d2.d_year as fsyear\r\n     ,d3.d_year s2year\r\n     ,count(*) cnt\r\n     ,sum(ss_wholesale_cost) s1\r\n     ,sum(ss_list_price) s2\r\n     ,sum(ss_coupon_amt) s3\r\n  FROM   store_sales\r\n        ,store_returns\r\n        ,cs_ui\r\n        ,date_dim d1\r\n        ,date_dim d2\r\n        ,date_dim d3\r\n        ,store\r\n        ,customer\r\n        ,customer_demographics cd1\r\n        ,customer_demographics cd2\r\n        ,promotion\r\n        ,household_demographics hd1\r\n        ,household_demographics hd2\r\n        ,customer_address ad1\r\n        ,customer_address ad2\r\n        ,income_band ib1\r\n        ,income_band ib2\r\n        ,item\r\n  WHERE  ss_store_sk = s_store_sk AND\r\n         ss_sold_date_sk = d1.d_date_sk AND\r\n         ss_customer_sk = c_customer_sk AND\r\n         ss_cdemo_sk= cd1.cd_demo_sk AND\r\n         ss_hdemo_sk = hd1.hd_demo_sk AND\r\n         ss_addr_sk = ad1.ca_address_sk and\r\n         ss_item_sk = i_item_sk and\r\n         ss_item_sk = sr_item_sk and\r\n         ss_ticket_number = sr_ticket_number and\r\n         ss_item_sk = cs_ui.cs_item_sk and\r\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\r\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\r\n         c_current_addr_sk = ad2.ca_address_sk and\r\n         c_first_sales_date_sk = d2.d_date_sk and\r\n         c_first_shipto_date_sk = d3.d_date_sk and\r\n         ss_promo_sk = p_promo_sk and\r\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r\n         cd1.cd_marital_status <> cd2.cd_marital_status and\r\n         i_color in ('saddle','moccasin','antique','salmon','smoke','turquoise') and\r\n         i_current_price between 31 and 31 + 10 and\r\n         i_current_price between 31 + 1 and 31 + 15\r\ngroup by i_product_name\r\n       ,i_item_sk\r\n       ,s_store_name\r\n       ,s_zip\r\n       ,ad1.ca_street_number\r\n       ,ad1.ca_street_name\r\n       ,ad1.ca_city\r\n       ,ad1.ca_zip\r\n       ,ad2.ca_street_number\r\n       ,ad2.ca_street_name\r\n       ,ad2.ca_city\r\n       ,ad2.ca_zip\r\n       ,d1.d_year\r\n       ,d2.d_year\r\n       ,d3.d_year\r\n)\r\nselect cs1.product_name\r\n     ,cs1.store_name\r\n     ,cs1.store_zip\r\n     ,cs1.b_street_number\r\n     ,cs1.b_street_name\r\n     ,cs1.b_city\r\n     ,cs1.b_zip\r\n     ,cs1.c_street_number\r\n     ,cs1.c_street_name\r\n     ,cs1.c_city\r\n     ,cs1.c_zip\r\n     ,cs1.syear\r\n     ,cs1.cnt\r\n     ,cs1.s1 as s11\r\n     ,cs1.s2 as s21\r\n     ,cs1.s3 as s31\r\n     ,cs2.s1 as s12\r\n     ,cs2.s2 as s22\r\n     ,cs2.s3 as s32\r\n     ,cs2.syear\r\n     ,cs2.cnt\r\nfrom cross_sales cs1,cross_sales cs2\r\nwhere cs1.item_sk=cs2.item_sk and\r\n     cs1.syear = 2000 and\r\n     cs2.syear = 2000 + 1 and\r\n     cs2.cnt <= cs1.cnt and\r\n     cs1.store_name = cs2.store_name and\r\n     cs1.store_zip = cs2.store_zip\r\norder by cs1.product_name\r\n       ,cs1.store_name\r\n       ,cs2.cnt\r\n       ,cs1.s1\r\n       ,cs2.s1;\r\n\r\n", 
                    "oneline_sql": "with cs_ui as\r  (select cs_item_sk\r         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\r   from catalog_sales\r       ,catalog_returns\r   where cs_item_sk = cr_item_sk\r     and cs_order_number = cr_order_number\r   group by cs_item_sk\r   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\r cross_sales as\r  (select i_product_name product_name\r      ,i_item_sk item_sk\r      ,s_store_name store_name\r      ,s_zip store_zip\r      ,ad1.ca_street_number b_street_number\r      ,ad1.ca_street_name b_street_name\r      ,ad1.ca_city b_city\r      ,ad1.ca_zip b_zip\r      ,ad2.ca_street_number c_street_number\r      ,ad2.ca_street_name c_street_name\r      ,ad2.ca_city c_city\r      ,ad2.ca_zip c_zip\r      ,d1.d_year as syear\r      ,d2.d_year as fsyear\r      ,d3.d_year s2year\r      ,count(*) cnt\r      ,sum(ss_wholesale_cost) s1\r      ,sum(ss_list_price) s2\r      ,sum(ss_coupon_amt) s3\r   FROM   store_sales\r         ,store_returns\r         ,cs_ui\r         ,date_dim d1\r         ,date_dim d2\r         ,date_dim d3\r         ,store\r         ,customer\r         ,customer_demographics cd1\r         ,customer_demographics cd2\r         ,promotion\r         ,household_demographics hd1\r         ,household_demographics hd2\r         ,customer_address ad1\r         ,customer_address ad2\r         ,income_band ib1\r         ,income_band ib2\r         ,item\r   WHERE  ss_store_sk = s_store_sk AND\r          ss_sold_date_sk = d1.d_date_sk AND\r          ss_customer_sk = c_customer_sk AND\r          ss_cdemo_sk= cd1.cd_demo_sk AND\r          ss_hdemo_sk = hd1.hd_demo_sk AND\r          ss_addr_sk = ad1.ca_address_sk and\r          ss_item_sk = i_item_sk and\r          ss_item_sk = sr_item_sk and\r          ss_ticket_number = sr_ticket_number and\r          ss_item_sk = cs_ui.cs_item_sk and\r          c_current_cdemo_sk = cd2.cd_demo_sk AND\r          c_current_hdemo_sk = hd2.hd_demo_sk AND\r          c_current_addr_sk = ad2.ca_address_sk and\r          c_first_sales_date_sk = d2.d_date_sk and\r          c_first_shipto_date_sk = d3.d_date_sk and\r          ss_promo_sk = p_promo_sk and\r          hd1.hd_income_band_sk = ib1.ib_income_band_sk and\r          hd2.hd_income_band_sk = ib2.ib_income_band_sk and\r          cd1.cd_marital_status <> cd2.cd_marital_status and\r          i_color in ('saddle','moccasin','antique','salmon','smoke','turquoise') and\r          i_current_price between 31 and 31 + 10 and\r          i_current_price between 31 + 1 and 31 + 15\r group by i_product_name\r        ,i_item_sk\r        ,s_store_name\r        ,s_zip\r        ,ad1.ca_street_number\r        ,ad1.ca_street_name\r        ,ad1.ca_city\r        ,ad1.ca_zip\r        ,ad2.ca_street_number\r        ,ad2.ca_street_name\r        ,ad2.ca_city\r        ,ad2.ca_zip\r        ,d1.d_year\r        ,d2.d_year\r        ,d3.d_year\r )\r select cs1.product_name\r      ,cs1.store_name\r      ,cs1.store_zip\r      ,cs1.b_street_number\r      ,cs1.b_street_name\r      ,cs1.b_city\r      ,cs1.b_zip\r      ,cs1.c_street_number\r      ,cs1.c_street_name\r      ,cs1.c_city\r      ,cs1.c_zip\r      ,cs1.syear\r      ,cs1.cnt\r      ,cs1.s1 as s11\r      ,cs1.s2 as s21\r      ,cs1.s3 as s31\r      ,cs2.s1 as s12\r      ,cs2.s2 as s22\r      ,cs2.s3 as s32\r      ,cs2.syear\r      ,cs2.cnt\r from cross_sales cs1,cross_sales cs2\r where cs1.item_sk=cs2.item_sk and\r      cs1.syear = 2000 and\r      cs2.syear = 2000 + 1 and\r      cs2.cnt <= cs1.cnt and\r      cs1.store_name = cs2.store_name and\r      cs1.store_zip = cs2.store_zip\r order by cs1.product_name\r        ,cs1.store_name\r        ,cs2.cnt\r        ,cs1.s1\r        ,cs2.s1;\r \r ", 
                    "id": 572, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/572.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query64.tpl\r", 
                    "sid": 77, 
                    "endTime": 1575595910.519448
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:50", 
                    "startTimeFormat": "2019-12-06 09:31:50", 
                    "startTime": 1575595910.519542, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_573.sql", 
                    "second": 0.19800996780395508, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc \r\n       ,i_category \r\n       ,i_class \r\n       ,i_current_price\r\n       ,sum(cs_ext_sales_price) as itemrevenue \r\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r\n           (partition by i_class) as revenueratio\r\n from\tcatalog_sales\r\n     ,item \r\n     ,date_dim\r\n where cs_item_sk = i_item_sk \r\n   and i_category in ('Jewelry', 'Men', 'Women')\r\n   and cs_sold_date_sk = d_date_sk\r\n and d_date between to_date('1999-06-08' ,'yyyy-mm-dd') \r\n \t\t\t\tand (to_date('1999-06-08' ,'yyyy-mm-dd') + 30)\r\n group by i_item_id\r\n         ,i_item_desc \r\n         ,i_category\r\n         ,i_class\r\n         ,i_current_price\r\n order by i_category\r\n         ,i_class\r\n         ,i_item_id\r\n         ,i_item_desc\r\n         ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc \r        ,i_category \r        ,i_class \r        ,i_current_price\r        ,sum(cs_ext_sales_price) as itemrevenue \r        ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\r            (partition by i_class) as revenueratio\r  from\tcatalog_sales\r      ,item \r      ,date_dim\r  where cs_item_sk = i_item_sk \r    and i_category in ('Jewelry', 'Men', 'Women')\r    and cs_sold_date_sk = d_date_sk\r  and d_date between to_date('1999-06-08' ,'yyyy-mm-dd') \r  \t\t\t\tand (to_date('1999-06-08' ,'yyyy-mm-dd') + 30)\r  group by i_item_id\r          ,i_item_desc \r          ,i_category\r          ,i_class\r          ,i_current_price\r  order by i_category\r          ,i_class\r          ,i_item_id\r          ,i_item_desc\r          ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 573, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/573.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query20.tpl\r", 
                    "sid": 78, 
                    "endTime": 1575595910.717552
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:51", 
                    "startTimeFormat": "2019-12-06 09:31:50", 
                    "startTime": 1575595910.717651, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_574.sql", 
                    "second": 0.6022660732269287, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  s_store_name, s_store_id,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from date_dim, store_sales, store\r\n where d_date_sk = ss_sold_date_sk and\r\n       s_store_sk = ss_store_sk and\r\n       s_gmt_offset = -5 and\r\n       d_year = 1998 \r\n group by s_store_name, s_store_id\r\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  s_store_name, s_store_id,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from date_dim, store_sales, store\r  where d_date_sk = ss_sold_date_sk and\r        s_store_sk = ss_store_sk and\r        s_gmt_offset = -5 and\r        d_year = 1998 \r  group by s_store_name, s_store_id\r  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\r   ) where rownum <= 100;\r \r ", 
                    "id": 574, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/574.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query43.tpl\r", 
                    "sid": 79, 
                    "endTime": 1575595911.319917
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:52", 
                    "startTimeFormat": "2019-12-06 09:31:51", 
                    "startTime": 1575595911.320014, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_575.sql", 
                    "second": 1.3136630058288574, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with ssr as\r\n (select s_store_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ss_store_sk as store_sk,\r\n            ss_sold_date_sk  as date_sk,\r\n            ss_ext_sales_price as sales_price,\r\n            ss_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from store_sales\r\n    union all\r\n    select sr_store_sk as store_sk,\r\n           sr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           sr_return_amt as return_amt,\r\n           sr_net_loss as net_loss\r\n    from store_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     store\r\n where date_sk = d_date_sk\r\n       and d_date between  to_date('2002-08-30','yyyy-mm-dd') \r\n                  and to_date('2002-08-30','yyyy-mm-dd') + 14\r\n       and store_sk = s_store_sk\r\n group by s_store_id)\r\n ,\r\n csr as\r\n (select cp_catalog_page_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  cs_catalog_page_sk as page_sk,\r\n            cs_sold_date_sk  as date_sk,\r\n            cs_ext_sales_price as sales_price,\r\n            cs_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from catalog_sales\r\n    union all\r\n    select cr_catalog_page_sk as page_sk,\r\n           cr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           cr_return_amount as return_amt,\r\n           cr_net_loss as net_loss\r\n    from catalog_returns\r\n   ) salesreturns,\r\n     date_dim,\r\n     catalog_page\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-30','yyyy-mm-dd') \r\n                  and to_date('2002-08-30','yyyy-mm-dd') +14\r\n       and page_sk = cp_catalog_page_sk\r\n group by cp_catalog_page_id)\r\n ,\r\n wsr as\r\n (select web_site_id,\r\n        sum(sales_price) as sales,\r\n        sum(profit) as profit,\r\n        sum(return_amt) as returns,\r\n        sum(net_loss) as profit_loss\r\n from\r\n  ( select  ws_web_site_sk as wsr_web_site_sk,\r\n            ws_sold_date_sk  as date_sk,\r\n            ws_ext_sales_price as sales_price,\r\n            ws_net_profit as profit,\r\n            cast(0 as decimal(7,2)) as return_amt,\r\n            cast(0 as decimal(7,2)) as net_loss\r\n    from web_sales\r\n    union all\r\n    select ws_web_site_sk as wsr_web_site_sk,\r\n           wr_returned_date_sk as date_sk,\r\n           cast(0 as decimal(7,2)) as sales_price,\r\n           cast(0 as decimal(7,2)) as profit,\r\n           wr_return_amt as return_amt,\r\n           wr_net_loss as net_loss\r\n    from web_returns left outer join web_sales on\r\n         ( wr_item_sk = ws_item_sk\r\n           and wr_order_number = ws_order_number)\r\n   ) salesreturns,\r\n     date_dim,\r\n     web_site\r\n where date_sk = d_date_sk\r\n       and d_date between to_date('2002-08-30','yyyy-mm-dd') \r\n                  and to_date('2002-08-30','yyyy-mm-dd') + 14\r\n       and wsr_web_site_sk = web_site_sk\r\n group by web_site_id)\r\n select * from ( select  channel\r\n        , id\r\n        , sum(sales) as sales\r\n        , sum(returns) as returns\r\n        , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n        , 'store' || s_store_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   ssr\r\n union all\r\n select 'catalog channel' as channel\r\n        , 'catalog_page' || cp_catalog_page_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from  csr\r\n union all\r\n select 'web channel' as channel\r\n        , 'web_site' || web_site_id as id\r\n        , sales\r\n        , returns\r\n        , (profit - profit_loss) as profit\r\n from   wsr\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n         ,id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with ssr as\r  (select s_store_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ss_store_sk as store_sk,\r             ss_sold_date_sk  as date_sk,\r             ss_ext_sales_price as sales_price,\r             ss_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from store_sales\r     union all\r     select sr_store_sk as store_sk,\r            sr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            sr_return_amt as return_amt,\r            sr_net_loss as net_loss\r     from store_returns\r    ) salesreturns,\r      date_dim,\r      store\r  where date_sk = d_date_sk\r        and d_date between  to_date('2002-08-30','yyyy-mm-dd') \r                   and to_date('2002-08-30','yyyy-mm-dd') + 14\r        and store_sk = s_store_sk\r  group by s_store_id)\r  ,\r  csr as\r  (select cp_catalog_page_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  cs_catalog_page_sk as page_sk,\r             cs_sold_date_sk  as date_sk,\r             cs_ext_sales_price as sales_price,\r             cs_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from catalog_sales\r     union all\r     select cr_catalog_page_sk as page_sk,\r            cr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            cr_return_amount as return_amt,\r            cr_net_loss as net_loss\r     from catalog_returns\r    ) salesreturns,\r      date_dim,\r      catalog_page\r  where date_sk = d_date_sk\r        and d_date between to_date('2002-08-30','yyyy-mm-dd') \r                   and to_date('2002-08-30','yyyy-mm-dd') +14\r        and page_sk = cp_catalog_page_sk\r  group by cp_catalog_page_id)\r  ,\r  wsr as\r  (select web_site_id,\r         sum(sales_price) as sales,\r         sum(profit) as profit,\r         sum(return_amt) as returns,\r         sum(net_loss) as profit_loss\r  from\r   ( select  ws_web_site_sk as wsr_web_site_sk,\r             ws_sold_date_sk  as date_sk,\r             ws_ext_sales_price as sales_price,\r             ws_net_profit as profit,\r             cast(0 as decimal(7,2)) as return_amt,\r             cast(0 as decimal(7,2)) as net_loss\r     from web_sales\r     union all\r     select ws_web_site_sk as wsr_web_site_sk,\r            wr_returned_date_sk as date_sk,\r            cast(0 as decimal(7,2)) as sales_price,\r            cast(0 as decimal(7,2)) as profit,\r            wr_return_amt as return_amt,\r            wr_net_loss as net_loss\r     from web_returns left outer join web_sales on\r          ( wr_item_sk = ws_item_sk\r            and wr_order_number = ws_order_number)\r    ) salesreturns,\r      date_dim,\r      web_site\r  where date_sk = d_date_sk\r        and d_date between to_date('2002-08-30','yyyy-mm-dd') \r                   and to_date('2002-08-30','yyyy-mm-dd') + 14\r        and wsr_web_site_sk = web_site_sk\r  group by web_site_id)\r  select * from ( select  channel\r         , id\r         , sum(sales) as sales\r         , sum(returns) as returns\r         , sum(profit) as profit\r  from \r  (select 'store channel' as channel\r         , 'store' || s_store_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   ssr\r  union all\r  select 'catalog channel' as channel\r         , 'catalog_page' || cp_catalog_page_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from  csr\r  union all\r  select 'web channel' as channel\r         , 'web_site' || web_site_id as id\r         , sales\r         , returns\r         , (profit - profit_loss) as profit\r  from   wsr\r  ) x\r  group by rollup (channel, id)\r  order by channel\r          ,id\r   ) where rownum <= 100;\r \r ", 
                    "id": 575, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/575.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query5.tpl\r", 
                    "sid": 80, 
                    "endTime": 1575595912.633677
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:54", 
                    "startTimeFormat": "2019-12-06 09:31:52", 
                    "startTime": 1575595912.633783, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_576.sql", 
                    "second": 2.1362409591674805, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with v1 as(\r\n select i_category, i_brand,\r\n        s_store_name, s_company_name,\r\n        d_year, d_moy,\r\n        sum(ss_sales_price) sum_sales,\r\n        avg(sum(ss_sales_price)) over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name, d_year)\r\n          avg_monthly_sales,\r\n        rank() over\r\n          (partition by i_category, i_brand,\r\n                     s_store_name, s_company_name\r\n           order by d_year, d_moy) rn\r\n from item, store_sales, date_dim, store\r\n where ss_item_sk = i_item_sk and\r\n       ss_sold_date_sk = d_date_sk and\r\n       ss_store_sk = s_store_sk and\r\n       (\r\n         d_year = 1999 or\r\n         ( d_year = 1999-1 and d_moy =12) or\r\n         ( d_year = 1999+1 and d_moy =1)\r\n       )\r\n group by i_category, i_brand,\r\n          s_store_name, s_company_name,\r\n          d_year, d_moy),\r\n v2 as(\r\n select v1.s_store_name\r\n        ,v1.d_year\r\n        ,v1.avg_monthly_sales\r\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r\n from v1, v1 v1_lag, v1 v1_lead\r\n where v1.i_category = v1_lag.i_category and\r\n       v1.i_category = v1_lead.i_category and\r\n       v1.i_brand = v1_lag.i_brand and\r\n       v1.i_brand = v1_lead.i_brand and\r\n       v1.s_store_name = v1_lag.s_store_name and\r\n       v1.s_store_name = v1_lead.s_store_name and\r\n       v1.s_company_name = v1_lag.s_company_name and\r\n       v1.s_company_name = v1_lead.s_company_name and\r\n       v1.rn = v1_lag.rn + 1 and\r\n       v1.rn = v1_lead.rn - 1)\r\n select * from ( select  *\r\n from v2\r\n where  d_year = 1999 and    \r\n        avg_monthly_sales > 0 and\r\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r\n order by sum_sales - avg_monthly_sales, 3\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with v1 as(\r  select i_category, i_brand,\r         s_store_name, s_company_name,\r         d_year, d_moy,\r         sum(ss_sales_price) sum_sales,\r         avg(sum(ss_sales_price)) over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name, d_year)\r           avg_monthly_sales,\r         rank() over\r           (partition by i_category, i_brand,\r                      s_store_name, s_company_name\r            order by d_year, d_moy) rn\r  from item, store_sales, date_dim, store\r  where ss_item_sk = i_item_sk and\r        ss_sold_date_sk = d_date_sk and\r        ss_store_sk = s_store_sk and\r        (\r          d_year = 1999 or\r          ( d_year = 1999-1 and d_moy =12) or\r          ( d_year = 1999+1 and d_moy =1)\r        )\r  group by i_category, i_brand,\r           s_store_name, s_company_name,\r           d_year, d_moy),\r  v2 as(\r  select v1.s_store_name\r         ,v1.d_year\r         ,v1.avg_monthly_sales\r         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\r  from v1, v1 v1_lag, v1 v1_lead\r  where v1.i_category = v1_lag.i_category and\r        v1.i_category = v1_lead.i_category and\r        v1.i_brand = v1_lag.i_brand and\r        v1.i_brand = v1_lead.i_brand and\r        v1.s_store_name = v1_lag.s_store_name and\r        v1.s_store_name = v1_lead.s_store_name and\r        v1.s_company_name = v1_lag.s_company_name and\r        v1.s_company_name = v1_lead.s_company_name and\r        v1.rn = v1_lag.rn + 1 and\r        v1.rn = v1_lead.rn - 1)\r  select * from ( select  *\r  from v2\r  where  d_year = 1999 and    \r         avg_monthly_sales > 0 and\r         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\r  order by sum_sales - avg_monthly_sales, 3\r   ) where rownum <= 100;\r \r ", 
                    "id": 576, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/576.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query47.tpl\r", 
                    "sid": 81, 
                    "endTime": 1575595914.770024
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:55", 
                    "startTimeFormat": "2019-12-06 09:31:54", 
                    "startTime": 1575595914.770111, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_577.sql", 
                    "second": 0.44925880432128906, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n  cd_gender,\r\n  cd_marital_status,\r\n  cd_education_status,\r\n  count(*) cnt1,\r\n  cd_purchase_estimate,\r\n  count(*) cnt2,\r\n  cd_credit_rating,\r\n  count(*) cnt3,\r\n  cd_dep_count,\r\n  count(*) cnt4,\r\n  cd_dep_employed_count,\r\n  count(*) cnt5,\r\n  cd_dep_college_count,\r\n  count(*) cnt6\r\n from\r\n  customer c,customer_address ca,customer_demographics\r\n where\r\n  c.c_current_addr_sk = ca.ca_address_sk and\r\n  ca_county in ('Collin County','Geneva County','Cannon County','Orleans Parish','Pope County') and\r\n  cd_demo_sk = c.c_current_cdemo_sk and \r\n  exists (select *\r\n          from store_sales,date_dim\r\n          where c.c_customer_sk = ss_customer_sk and\r\n                ss_sold_date_sk = d_date_sk and\r\n                d_year = 2001 and\r\n                d_moy between 2 and 2+3) and\r\n   exists (select *\r\n          from (\r\n             select ws_bill_customer_sk as customer_sk, d_year,d_moy\r\n             from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r\n              and d_year = 2001 and\r\n                  d_moy between 2 and 2+3\r\n             union all\r\n             select cs_ship_customer_sk as customer_sk, d_year, d_moy\r\n             from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r\n              and d_year = 2001 and\r\n                  d_moy between 2 and 2+3\r\n\t     ) x\r\n            where c.c_customer_sk = customer_sk)\r\n group by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n order by cd_gender,\r\n          cd_marital_status,\r\n          cd_education_status,\r\n          cd_purchase_estimate,\r\n          cd_credit_rating,\r\n          cd_dep_count,\r\n          cd_dep_employed_count,\r\n          cd_dep_college_count\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r   cd_gender,\r   cd_marital_status,\r   cd_education_status,\r   count(*) cnt1,\r   cd_purchase_estimate,\r   count(*) cnt2,\r   cd_credit_rating,\r   count(*) cnt3,\r   cd_dep_count,\r   count(*) cnt4,\r   cd_dep_employed_count,\r   count(*) cnt5,\r   cd_dep_college_count,\r   count(*) cnt6\r  from\r   customer c,customer_address ca,customer_demographics\r  where\r   c.c_current_addr_sk = ca.ca_address_sk and\r   ca_county in ('Collin County','Geneva County','Cannon County','Orleans Parish','Pope County') and\r   cd_demo_sk = c.c_current_cdemo_sk and \r   exists (select *\r           from store_sales,date_dim\r           where c.c_customer_sk = ss_customer_sk and\r                 ss_sold_date_sk = d_date_sk and\r                 d_year = 2001 and\r                 d_moy between 2 and 2+3) and\r    exists (select *\r           from (\r              select ws_bill_customer_sk as customer_sk, d_year,d_moy\r              from web_sales, date_dim where ws_sold_date_sk = d_date_sk\r               and d_year = 2001 and\r                   d_moy between 2 and 2+3\r              union all\r              select cs_ship_customer_sk as customer_sk, d_year, d_moy\r              from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk\r               and d_year = 2001 and\r                   d_moy between 2 and 2+3\r \t     ) x\r             where c.c_customer_sk = customer_sk)\r  group by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  order by cd_gender,\r           cd_marital_status,\r           cd_education_status,\r           cd_purchase_estimate,\r           cd_credit_rating,\r           cd_dep_count,\r           cd_dep_employed_count,\r           cd_dep_college_count\r  ) where rownum <= 100;\r \r ", 
                    "id": 577, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/577.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query10.tpl\r", 
                    "sid": 82, 
                    "endTime": 1575595915.21937
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:56", 
                    "startTimeFormat": "2019-12-06 09:31:55", 
                    "startTime": 1575595915.219456, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_578.sql", 
                    "second": 1.187000036239624, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with results as\r\n( select\r\n    sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r\n from\r\n    store_sales\r\n  ,date_dim      d1\r\n  ,store\r\n where\r\n    d1.d_month_seq between 1195 and 1195 + 11\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and s_store_sk  = ss_store_sk\r\n and s_state in\r\n            ( select s_state\r\n              from  (select s_state as s_state,\r\n                 rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r\n                      from  store_sales, store, date_dim\r\n                      where d_month_seq between 1195 and 1195 + 11\r\n                 and d_date_sk = ss_sold_date_sk\r\n                 and s_store_sk  = ss_store_sk\r\n                      group by s_state\r\n                    ) tmp1 \r\n              where ranking <= 5)\r\n  group by s_state,s_county) ,  \r\n results_rollup as \r\n(select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r\n union\r\n select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r\n union\r\n select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r\n select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r\n  ,rank() over (\r\n     partition by lochierarchy, \r\n     case when g_county = 0 then s_state end \r\n     order by total_sum desc) as rank_within_parent\r\n from results_rollup\r\n order by\r\n  lochierarchy desc\r\n  ,case when lochierarchy = 0 then s_state end\r\n  ,rank_within_parent\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select\r     sum(ss_net_profit) as total_sum ,s_state ,s_county, 0 as gstate, 0 as g_county\r  from\r     store_sales\r   ,date_dim      d1\r   ,store\r  where\r     d1.d_month_seq between 1195 and 1195 + 11\r  and d1.d_date_sk = ss_sold_date_sk\r  and s_store_sk  = ss_store_sk\r  and s_state in\r             ( select s_state\r               from  (select s_state as s_state,\r                  rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\r                       from  store_sales, store, date_dim\r                       where d_month_seq between 1195 and 1195 + 11\r                  and d_date_sk = ss_sold_date_sk\r                  and s_store_sk  = ss_store_sk\r                       group by s_state\r                     ) tmp1 \r               where ranking <= 5)\r   group by s_state,s_county) ,  \r  results_rollup as \r (select total_sum ,s_state ,s_county, 0 as g_state, 0 as g_county, 0 as lochierarchy from results\r  union\r  select sum(total_sum) as total_sum,s_state, NULL as s_county, 0 as g_state, 1 as g_county, 1 as lochierarchy from results group by s_state\r  union\r  select sum(total_sum) as total_sum ,NULL as s_state ,NULL as s_county, 1 as g_state, 1 as g_county, 2 as lochierarchy from results)\r  select * from ( select  total_sum ,s_state ,s_county, lochierarchy \r   ,rank() over (\r      partition by lochierarchy, \r      case when g_county = 0 then s_state end \r      order by total_sum desc) as rank_within_parent\r  from results_rollup\r  order by\r   lochierarchy desc\r   ,case when lochierarchy = 0 then s_state end\r   ,rank_within_parent\r   ) where rownum <= 100;\r \r ", 
                    "id": 578, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/578.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query70.tpl\r", 
                    "sid": 83, 
                    "endTime": 1575595916.406456
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:31:57", 
                    "startTimeFormat": "2019-12-06 09:31:56", 
                    "startTime": 1575595916.406553, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_579.sql", 
                    "second": 1.3864479064941406, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2000\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=3\r\n  and inv2.d_moy=3+1\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\nwith inv as\r\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r\n      from inventory\r\n          ,item\r\n          ,warehouse\r\n          ,date_dim\r\n      where inv_item_sk = i_item_sk\r\n        and inv_warehouse_sk = w_warehouse_sk\r\n        and inv_date_sk = d_date_sk\r\n        and d_year =2000\r\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r\n where case mean when 0 then 0 else stdev/mean end > 1)\r\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r\nfrom inv inv1,inv inv2\r\nwhere inv1.i_item_sk = inv2.i_item_sk\r\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r\n  and inv1.d_moy=3\r\n  and inv2.d_moy=3+1\r\n  and inv1.cov > 1.5\r\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r\n        ,inv2.d_moy,inv2.mean, inv2.cov\r\n;\r\n\r\n", 
                    "oneline_sql": "with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2000\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=3\r   and inv2.d_moy=3+1\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r with inv as\r (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r        ,stdev,mean, case mean when 0 then null else stdev/mean end cov\r  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\r             ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\r       from inventory\r           ,item\r           ,warehouse\r           ,date_dim\r       where inv_item_sk = i_item_sk\r         and inv_warehouse_sk = w_warehouse_sk\r         and inv_date_sk = d_date_sk\r         and d_year =2000\r       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\r  where case mean when 0 then 0 else stdev/mean end > 1)\r select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\r         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\r from inv inv1,inv inv2\r where inv1.i_item_sk = inv2.i_item_sk\r   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\r   and inv1.d_moy=3\r   and inv2.d_moy=3+1\r   and inv1.cov > 1.5\r order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\r         ,inv2.d_moy,inv2.mean, inv2.cov\r ;\r \r ", 
                    "id": 579, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/579.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query39.tpl\r", 
                    "sid": 84, 
                    "endTime": 1575595917.793001
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:00", 
                    "startTimeFormat": "2019-12-06 09:31:57", 
                    "startTime": 1575595917.793094, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_580.sql", 
                    "second": 2.8162710666656494, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_desc\r\n      ,w_warehouse_name\r\n      ,d1.d_week_seq\r\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r\n      ,count(*) total_cnt\r\nfrom catalog_sales\r\njoin inventory on (cs_item_sk = inv_item_sk)\r\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\r\njoin item on (i_item_sk = cs_item_sk)\r\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\r\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\r\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r\nwhere d1.d_week_seq = d2.d_week_seq\r\n  and inv_quantity_on_hand < cs_quantity \r\n  and d3.d_date > d1.d_date + 5\r\n  and hd_buy_potential = '>10000'\r\n  and d1.d_year = 2002\r\n  and cd_marital_status = 'M'\r\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\r\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_desc\r       ,w_warehouse_name\r       ,d1.d_week_seq\r       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\r       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\r       ,count(*) total_cnt\r from catalog_sales\r join inventory on (cs_item_sk = inv_item_sk)\r join warehouse on (w_warehouse_sk=inv_warehouse_sk)\r join item on (i_item_sk = cs_item_sk)\r join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\r join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\r join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\r join date_dim d2 on (inv_date_sk = d2.d_date_sk)\r join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\r left outer join promotion on (cs_promo_sk=p_promo_sk)\r left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\r where d1.d_week_seq = d2.d_week_seq\r   and inv_quantity_on_hand < cs_quantity \r   and d3.d_date > d1.d_date + 5\r   and hd_buy_potential = '>10000'\r   and d1.d_year = 2002\r   and cd_marital_status = 'M'\r group by i_item_desc,w_warehouse_name,d1.d_week_seq\r order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\r  ) where rownum <= 100;\r \r ", 
                    "id": 580, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/580.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query72.tpl\r", 
                    "sid": 85, 
                    "endTime": 1575595920.609365
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:01", 
                    "startTimeFormat": "2019-12-06 09:32:00", 
                    "startTime": 1575595920.609467, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_581.sql", 
                    "second": 1.316075086593628, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "WITH all_sales AS (\r\n SELECT d_year\r\n       ,i_brand_id\r\n       ,i_class_id\r\n       ,i_category_id\r\n       ,i_manufact_id\r\n       ,SUM(sales_cnt) AS sales_cnt\r\n       ,SUM(sales_amt) AS sales_amt\r\n FROM (SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\r\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r\n                                                    AND cs_item_sk=cr_item_sk)\r\n       WHERE i_category='Children'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\r\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r\n                                                AND ss_item_sk=sr_item_sk)\r\n       WHERE i_category='Children'\r\n       UNION\r\n       SELECT d_year\r\n             ,i_brand_id\r\n             ,i_class_id\r\n             ,i_category_id\r\n             ,i_manufact_id\r\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\r\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r\n                                            AND ws_item_sk=wr_item_sk)\r\n       WHERE i_category='Children') sales_detail\r\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r\nselect * from ( SELECT  prev_yr.d_year AS prev_year\r\n                          ,curr_yr.d_year AS year\r\n                          ,curr_yr.i_brand_id\r\n                          ,curr_yr.i_class_id\r\n                          ,curr_yr.i_category_id\r\n                          ,curr_yr.i_manufact_id\r\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\r\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\r\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r\n FROM all_sales curr_yr, all_sales prev_yr\r\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r\n   AND curr_yr.i_class_id=prev_yr.i_class_id\r\n   AND curr_yr.i_category_id=prev_yr.i_category_id\r\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r\n   AND curr_yr.d_year=2001\r\n   AND prev_yr.d_year=2001-1\r\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r\n ORDER BY sales_cnt_diff,sales_amt_diff\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "WITH all_sales AS (\r  SELECT d_year\r        ,i_brand_id\r        ,i_class_id\r        ,i_category_id\r        ,i_manufact_id\r        ,SUM(sales_cnt) AS sales_cnt\r        ,SUM(sales_amt) AS sales_amt\r  FROM (SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\r              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\r        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\r                           JOIN date_dim ON d_date_sk=cs_sold_date_sk\r                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \r                                                     AND cs_item_sk=cr_item_sk)\r        WHERE i_category='Children'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\r              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\r        FROM store_sales JOIN item ON i_item_sk=ss_item_sk\r                         JOIN date_dim ON d_date_sk=ss_sold_date_sk\r                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \r                                                 AND ss_item_sk=sr_item_sk)\r        WHERE i_category='Children'\r        UNION\r        SELECT d_year\r              ,i_brand_id\r              ,i_class_id\r              ,i_category_id\r              ,i_manufact_id\r              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\r              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\r        FROM web_sales JOIN item ON i_item_sk=ws_item_sk\r                       JOIN date_dim ON d_date_sk=ws_sold_date_sk\r                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number \r                                             AND ws_item_sk=wr_item_sk)\r        WHERE i_category='Children') sales_detail\r  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\r select * from ( SELECT  prev_yr.d_year AS prev_year\r                           ,curr_yr.d_year AS year\r                           ,curr_yr.i_brand_id\r                           ,curr_yr.i_class_id\r                           ,curr_yr.i_category_id\r                           ,curr_yr.i_manufact_id\r                           ,prev_yr.sales_cnt AS prev_yr_cnt\r                           ,curr_yr.sales_cnt AS curr_yr_cnt\r                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\r                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\r  FROM all_sales curr_yr, all_sales prev_yr\r  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\r    AND curr_yr.i_class_id=prev_yr.i_class_id\r    AND curr_yr.i_category_id=prev_yr.i_category_id\r    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\r    AND curr_yr.d_year=2001\r    AND prev_yr.d_year=2001-1\r    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\r  ORDER BY sales_cnt_diff,sales_amt_diff\r   ) where rownum <= 100;\r \r ", 
                    "id": 581, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/581.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query75.tpl\r", 
                    "sid": 86, 
                    "endTime": 1575595921.925542
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:02", 
                    "startTimeFormat": "2019-12-06 09:32:01", 
                    "startTime": 1575595921.925652, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_582.sql", 
                    "second": 0.17882990837097168, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id\r\n      ,i_item_desc \r\n      ,i_category \r\n      ,i_class \r\n      ,i_current_price\r\n      ,sum(ws_ext_sales_price) as itemrevenue \r\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r\n          (partition by i_class) as revenueratio\r\nfrom\t\r\n\tweb_sales\r\n    \t,item \r\n    \t,date_dim\r\nwhere \r\n\tws_item_sk = i_item_sk \r\n  \tand i_category in ('Electronics', 'Women', 'Sports')\r\n  \tand ws_sold_date_sk = d_date_sk\r\n\tand d_date between  to_date('2001-05-03' ,'yyyy-mm-dd') \r\n\t\t\t\tand  to_date('2001-05-03' ,'yyyy-mm-dd') + 30\r\ngroup by \r\n\ti_item_id\r\n        ,i_item_desc \r\n        ,i_category\r\n        ,i_class\r\n        ,i_current_price\r\norder by \r\n\ti_category\r\n        ,i_class\r\n        ,i_item_id\r\n        ,i_item_desc\r\n        ,revenueratio\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r       ,i_item_desc \r       ,i_category \r       ,i_class \r       ,i_current_price\r       ,sum(ws_ext_sales_price) as itemrevenue \r       ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\r           (partition by i_class) as revenueratio\r from\t\r \tweb_sales\r     \t,item \r     \t,date_dim\r where \r \tws_item_sk = i_item_sk \r   \tand i_category in ('Electronics', 'Women', 'Sports')\r   \tand ws_sold_date_sk = d_date_sk\r \tand d_date between  to_date('2001-05-03' ,'yyyy-mm-dd') \r \t\t\t\tand  to_date('2001-05-03' ,'yyyy-mm-dd') + 30\r group by \r \ti_item_id\r         ,i_item_desc \r         ,i_category\r         ,i_class\r         ,i_current_price\r order by \r \ti_category\r         ,i_class\r         ,i_item_id\r         ,i_item_desc\r         ,revenueratio\r  ) where rownum <= 100;\r \r ", 
                    "id": 582, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/582.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query12.tpl\r", 
                    "sid": 87, 
                    "endTime": 1575595922.104482
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:02", 
                    "startTimeFormat": "2019-12-06 09:32:02", 
                    "startTime": 1575595922.104582, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_583.sql", 
                    "second": 0.0941770076751709, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, catalog_sales\r\n where i_current_price between 21 and 21 + 30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1998-04-29' ,'yyyy-mm-dd') and to_date('1998-04-29' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (726,859,954,796)\r\n and inv_quantity_on_hand between 100 and 500\r\n and cs_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, catalog_sales\r  where i_current_price between 21 and 21 + 30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1998-04-29' ,'yyyy-mm-dd') and to_date('1998-04-29' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (726,859,954,796)\r  and inv_quantity_on_hand between 100 and 500\r  and cs_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 583, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/583.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query37.tpl\r", 
                    "sid": 88, 
                    "endTime": 1575595922.198759
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:02", 
                    "startTimeFormat": "2019-12-06 09:32:02", 
                    "startTime": 1575595922.198882, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_584.sql", 
                    "second": 0.21963095664978027, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  ca_zip\r\n       ,sum(cs_sales_price)\r\n from catalog_sales\r\n     ,customer\r\n     ,customer_address\r\n     ,date_dim\r\n where cs_bill_customer_sk = c_customer_sk\r\n \tand c_current_addr_sk = ca_address_sk \r\n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r\n                                   '85392', '85460', '80348', '81792')\r\n \t      or ca_state in ('CA','WA','GA')\r\n \t      or cs_sales_price > 500)\r\n \tand cs_sold_date_sk = d_date_sk\r\n \tand d_qoy = 2 and d_year = 2002\r\n group by ca_zip\r\n order by ca_zip\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  ca_zip\r        ,sum(cs_sales_price)\r  from catalog_sales\r      ,customer\r      ,customer_address\r      ,date_dim\r  where cs_bill_customer_sk = c_customer_sk\r  \tand c_current_addr_sk = ca_address_sk \r  \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\r                                    '85392', '85460', '80348', '81792')\r  \t      or ca_state in ('CA','WA','GA')\r  \t      or cs_sales_price > 500)\r  \tand cs_sold_date_sk = d_date_sk\r  \tand d_qoy = 2 and d_year = 2002\r  group by ca_zip\r  order by ca_zip\r   ) where rownum <= 100;\r \r ", 
                    "id": 584, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/584.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query15.tpl\r", 
                    "sid": 89, 
                    "endTime": 1575595922.418513
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:04", 
                    "startTimeFormat": "2019-12-06 09:32:02", 
                    "startTime": 1575595922.418611, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_585.sql", 
                    "second": 1.8697528839111328, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with wss as \r\n (select d_week_seq,\r\n        ss_store_sk,\r\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r\n from store_sales,date_dim\r\n where d_date_sk = ss_sold_date_sk\r\n group by d_week_seq,ss_store_sk\r\n )\r\n select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r\n from\r\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r\n        ,s_store_id s_store_id1,sun_sales sun_sales1\r\n        ,mon_sales mon_sales1,tue_sales tue_sales1\r\n        ,wed_sales wed_sales1,thu_sales thu_sales1\r\n        ,fri_sales fri_sales1,sat_sales sat_sales1\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1205 and 1205 + 11) y,\r\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r\n        ,s_store_id s_store_id2,sun_sales sun_sales2\r\n        ,mon_sales mon_sales2,tue_sales tue_sales2\r\n        ,wed_sales wed_sales2,thu_sales thu_sales2\r\n        ,fri_sales fri_sales2,sat_sales sat_sales2\r\n  from wss,store,date_dim d\r\n  where d.d_week_seq = wss.d_week_seq and\r\n        ss_store_sk = s_store_sk and \r\n        d_month_seq between 1205+ 12 and 1205 + 23) x\r\n where s_store_id1=s_store_id2\r\n   and d_week_seq1=d_week_seq2-52\r\n order by s_store_name1,s_store_id1,d_week_seq1\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with wss as \r  (select d_week_seq,\r         ss_store_sk,\r         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\r         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\r         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\r         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\r         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\r         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\r         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\r  from store_sales,date_dim\r  where d_date_sk = ss_sold_date_sk\r  group by d_week_seq,ss_store_sk\r  )\r  select * from ( select  s_store_name1,s_store_id1,d_week_seq1\r        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\r        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\r        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\r  from\r  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\r         ,s_store_id s_store_id1,sun_sales sun_sales1\r         ,mon_sales mon_sales1,tue_sales tue_sales1\r         ,wed_sales wed_sales1,thu_sales thu_sales1\r         ,fri_sales fri_sales1,sat_sales sat_sales1\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1205 and 1205 + 11) y,\r  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\r         ,s_store_id s_store_id2,sun_sales sun_sales2\r         ,mon_sales mon_sales2,tue_sales tue_sales2\r         ,wed_sales wed_sales2,thu_sales thu_sales2\r         ,fri_sales fri_sales2,sat_sales sat_sales2\r   from wss,store,date_dim d\r   where d.d_week_seq = wss.d_week_seq and\r         ss_store_sk = s_store_sk and \r         d_month_seq between 1205+ 12 and 1205 + 23) x\r  where s_store_id1=s_store_id2\r    and d_week_seq1=d_week_seq2-52\r  order by s_store_name1,s_store_id1,d_week_seq1\r  ) where rownum <= 100;\r \r ", 
                    "id": 585, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/585.sql", 
                    "secondFormat": "00:00:01", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query59.tpl\r", 
                    "sid": 90, 
                    "endTime": 1575595924.288364
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:04", 
                    "startTimeFormat": "2019-12-06 09:32:04", 
                    "startTime": 1575595924.288456, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_586.sql", 
                    "second": 0.17052197456359863, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select  \r\n        cc_call_center_id Call_Center,\r\n        cc_name Call_Center_Name,\r\n        cc_manager Manager,\r\n        sum(cr_net_loss) Returns_Loss\r\nfrom\r\n        call_center,\r\n        catalog_returns,\r\n        date_dim,\r\n        customer,\r\n        customer_address,\r\n        customer_demographics,\r\n        household_demographics\r\nwhere\r\n        cr_call_center_sk       = cc_call_center_sk\r\nand     cr_returned_date_sk     = d_date_sk\r\nand     cr_returning_customer_sk= c_customer_sk\r\nand     cd_demo_sk              = c_current_cdemo_sk\r\nand     hd_demo_sk              = c_current_hdemo_sk\r\nand     ca_address_sk           = c_current_addr_sk\r\nand     d_year                  = 2002 \r\nand     d_moy                   = 12\r\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r\nand     hd_buy_potential like 'Unknown%'\r\nand     ca_gmt_offset           = -7\r\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r\norder by sum(cr_net_loss) desc;\r\n\r\n", 
                    "oneline_sql": "select  \r         cc_call_center_id Call_Center,\r         cc_name Call_Center_Name,\r         cc_manager Manager,\r         sum(cr_net_loss) Returns_Loss\r from\r         call_center,\r         catalog_returns,\r         date_dim,\r         customer,\r         customer_address,\r         customer_demographics,\r         household_demographics\r where\r         cr_call_center_sk       = cc_call_center_sk\r and     cr_returned_date_sk     = d_date_sk\r and     cr_returning_customer_sk= c_customer_sk\r and     cd_demo_sk              = c_current_cdemo_sk\r and     hd_demo_sk              = c_current_hdemo_sk\r and     ca_address_sk           = c_current_addr_sk\r and     d_year                  = 2002 \r and     d_moy                   = 12\r and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\r         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\r and     hd_buy_potential like 'Unknown%'\r and     ca_gmt_offset           = -7\r group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\r order by sum(cr_net_loss) desc;\r \r ", 
                    "id": 586, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/586.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query91.tpl\r", 
                    "sid": 91, 
                    "endTime": 1575595924.458978
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:05", 
                    "startTimeFormat": "2019-12-06 09:32:04", 
                    "startTime": 1575595924.459072, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_587.sql", 
                    "second": 0.5565898418426514, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r\nfrom\r\n   catalog_sales\r\n  ,warehouse\r\n  ,ship_mode\r\n  ,call_center\r\n  ,date_dim\r\nwhere\r\n    d_month_seq between 1199 and 1199 + 11\r\nand cs_ship_date_sk   = d_date_sk\r\nand cs_warehouse_sk   = w_warehouse_sk\r\nand cs_ship_mode_sk   = sm_ship_mode_sk\r\nand cs_call_center_sk = cc_call_center_sk\r\ngroup by\r\n   substr(w_warehouse_name,1,20)\r\n  ,sm_type\r\n  ,cc_name\r\norder by substr(w_warehouse_name,1,20)\r\n        ,sm_type\r\n        ,cc_name\r\n ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \r                  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\r                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \r   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \r from\r    catalog_sales\r   ,warehouse\r   ,ship_mode\r   ,call_center\r   ,date_dim\r where\r     d_month_seq between 1199 and 1199 + 11\r and cs_ship_date_sk   = d_date_sk\r and cs_warehouse_sk   = w_warehouse_sk\r and cs_ship_mode_sk   = sm_ship_mode_sk\r and cs_call_center_sk = cc_call_center_sk\r group by\r    substr(w_warehouse_name,1,20)\r   ,sm_type\r   ,cc_name\r order by substr(w_warehouse_name,1,20)\r         ,sm_type\r         ,cc_name\r  ) where rownum <= 100;\r \r ", 
                    "id": 587, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/587.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query99.tpl\r", 
                    "sid": 92, 
                    "endTime": 1575595925.015662
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:05", 
                    "startTimeFormat": "2019-12-06 09:32:05", 
                    "startTime": 1575595925.015754, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_588.sql", 
                    "second": 0.07017707824707031, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  distinct(i_product_name)\r\n from item i1\r\n where i_manufact_id between 888 and 888+40 \r\n   and (select count(*) as item_cnt\r\n        from item\r\n        where (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'lace' or i_color = 'steel') and \r\n        (i_units = 'Tbl' or i_units = 'Unknown') and\r\n        (i_size = 'medium' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'turquoise' or i_color = 'orange') and\r\n        (i_units = 'Gross' or i_units = 'Each') and\r\n        (i_size = 'small' or i_size = 'petite')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'cornflower' or i_color = 'powder') and\r\n        (i_units = 'Ton' or i_units = 'Cup') and\r\n        (i_size = 'extra large' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'red' or i_color = 'burlywood') and\r\n        (i_units = 'Box' or i_units = 'Ounce') and\r\n        (i_size = 'medium' or i_size = 'economy')\r\n        ))) or\r\n       (i_manufact = i1.i_manufact and\r\n        ((i_category = 'Women' and \r\n        (i_color = 'slate' or i_color = 'antique') and \r\n        (i_units = 'Bunch' or i_units = 'Case') and\r\n        (i_size = 'medium' or i_size = 'economy')\r\n        ) or\r\n        (i_category = 'Women' and\r\n        (i_color = 'light' or i_color = 'aquamarine') and\r\n        (i_units = 'N/A' or i_units = 'Pallet') and\r\n        (i_size = 'small' or i_size = 'petite')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'chiffon' or i_color = 'pale') and\r\n        (i_units = 'Pound' or i_units = 'Lb') and\r\n        (i_size = 'extra large' or i_size = 'large')\r\n        ) or\r\n        (i_category = 'Men' and\r\n        (i_color = 'seashell' or i_color = 'coral') and\r\n        (i_units = 'Tsp' or i_units = 'Oz') and\r\n        (i_size = 'medium' or i_size = 'economy')\r\n        )))) > 0\r\n order by i_product_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  distinct(i_product_name)\r  from item i1\r  where i_manufact_id between 888 and 888+40 \r    and (select count(*) as item_cnt\r         from item\r         where (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'lace' or i_color = 'steel') and \r         (i_units = 'Tbl' or i_units = 'Unknown') and\r         (i_size = 'medium' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'turquoise' or i_color = 'orange') and\r         (i_units = 'Gross' or i_units = 'Each') and\r         (i_size = 'small' or i_size = 'petite')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'cornflower' or i_color = 'powder') and\r         (i_units = 'Ton' or i_units = 'Cup') and\r         (i_size = 'extra large' or i_size = 'large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'red' or i_color = 'burlywood') and\r         (i_units = 'Box' or i_units = 'Ounce') and\r         (i_size = 'medium' or i_size = 'economy')\r         ))) or\r        (i_manufact = i1.i_manufact and\r         ((i_category = 'Women' and \r         (i_color = 'slate' or i_color = 'antique') and \r         (i_units = 'Bunch' or i_units = 'Case') and\r         (i_size = 'medium' or i_size = 'economy')\r         ) or\r         (i_category = 'Women' and\r         (i_color = 'light' or i_color = 'aquamarine') and\r         (i_units = 'N/A' or i_units = 'Pallet') and\r         (i_size = 'small' or i_size = 'petite')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'chiffon' or i_color = 'pale') and\r         (i_units = 'Pound' or i_units = 'Lb') and\r         (i_size = 'extra large' or i_size = 'large')\r         ) or\r         (i_category = 'Men' and\r         (i_color = 'seashell' or i_color = 'coral') and\r         (i_units = 'Tsp' or i_units = 'Oz') and\r         (i_size = 'medium' or i_size = 'economy')\r         )))) > 0\r  order by i_product_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 588, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/588.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query41.tpl\r", 
                    "sid": 93, 
                    "endTime": 1575595925.085931
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:05", 
                    "startTime": 1575595925.086031, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_589.sql", 
                    "second": 2.105767011642456, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select case when (select count(*) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) > 39425879\r\n            then (select avg(ss_ext_discount_amt) \r\n                  from store_sales \r\n                  where ss_quantity between 1 and 20) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 1 and 20) end bucket1 ,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) > 47965456\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) \r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 21 and 40) end bucket2,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) > 44905193\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 41 and 60) end bucket3,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) > 1367595\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 61 and 80) end bucket4,\r\n       case when (select count(*)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) > 12639514\r\n            then (select avg(ss_ext_discount_amt)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100)\r\n            else (select avg(ss_net_profit)\r\n                  from store_sales\r\n                  where ss_quantity between 81 and 100) end bucket5\r\nfrom reason\r\nwhere r_reason_sk = 1\r\n;\r\n\r\n", 
                    "oneline_sql": "select case when (select count(*) \r                   from store_sales \r                   where ss_quantity between 1 and 20) > 39425879\r             then (select avg(ss_ext_discount_amt) \r                   from store_sales \r                   where ss_quantity between 1 and 20) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 1 and 20) end bucket1 ,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 21 and 40) > 47965456\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 21 and 40) \r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 21 and 40) end bucket2,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 41 and 60) > 44905193\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 41 and 60)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 41 and 60) end bucket3,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 61 and 80) > 1367595\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 61 and 80)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 61 and 80) end bucket4,\r        case when (select count(*)\r                   from store_sales\r                   where ss_quantity between 81 and 100) > 12639514\r             then (select avg(ss_ext_discount_amt)\r                   from store_sales\r                   where ss_quantity between 81 and 100)\r             else (select avg(ss_net_profit)\r                   from store_sales\r                   where ss_quantity between 81 and 100) end bucket5\r from reason\r where r_reason_sk = 1\r ;\r \r ", 
                    "id": 589, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/589.sql", 
                    "secondFormat": "00:00:02", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query9.tpl\r", 
                    "sid": 94, 
                    "endTime": 1575595927.191798
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.191917, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_590.sql", 
                    "second": 0.2668430805206299, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "with results as\r\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r\n from\r\n    web_sales\r\n   ,date_dim       d1\r\n   ,item\r\n where\r\n    d1.d_month_seq between 1211 and 1211+11\r\n and d1.d_date_sk = ws_sold_date_sk\r\n and i_item_sk  = ws_item_sk\r\n group by i_category,i_class\r\n ) ,\r\nresults_rollup as\r\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r\n  union\r\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r\n  union\r\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r\nselect * from ( select \r\n total_sum ,i_category ,i_class, lochierarchy \r\n   ,rank() over (\r\n \tpartition by lochierarchy,\r\n \tcase when g_class = 0 then i_category end \r\n \torder by total_sum desc) as rank_within_parent\r\n from\r\n results_rollup\r\n order by\r\n   lochierarchy desc,\r\n   case when lochierarchy = 0 then i_category end,\r\n   rank_within_parent \r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "with results as\r ( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \r  from\r     web_sales\r    ,date_dim       d1\r    ,item\r  where\r     d1.d_month_seq between 1211 and 1211+11\r  and d1.d_date_sk = ws_sold_date_sk\r  and i_item_sk  = ws_item_sk\r  group by i_category,i_class\r  ) ,\r results_rollup as\r ( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\r   union\r   select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\r   union\r   select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\r select * from ( select \r  total_sum ,i_category ,i_class, lochierarchy \r    ,rank() over (\r  \tpartition by lochierarchy,\r  \tcase when g_class = 0 then i_category end \r  \torder by total_sum desc) as rank_within_parent\r  from\r  results_rollup\r  order by\r    lochierarchy desc,\r    case when lochierarchy = 0 then i_category end,\r    rank_within_parent \r   ) where rownum <= 100;\r \r ", 
                    "id": 590, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/590.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query86.tpl\r", 
                    "sid": 95, 
                    "endTime": 1575595927.45876
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.458879, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_591.sql", 
                    "second": 0.07840609550476074, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select c_last_name\r\n       ,c_first_name\r\n       ,c_salutation\r\n       ,c_preferred_cust_flag\r\n       ,ss_ticket_number\r\n       ,cnt from\r\n   (select ss_ticket_number\r\n          ,ss_customer_sk\r\n          ,count(*) cnt\r\n    from store_sales,date_dim,store,household_demographics\r\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r\n    and store_sales.ss_store_sk = store.s_store_sk  \r\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r\n    and (household_demographics.hd_buy_potential = '501-1000' or\r\n         household_demographics.hd_buy_potential = '5001-10000')\r\n    and household_demographics.hd_vehicle_count > 0\r\n    and (case when household_demographics.hd_vehicle_count > 0 \r\n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r\n\telse null \r\n\tend)  > 1.2\r\n    and date_dim.d_year in (1999,1999+1,1999+2)\r\n    and store.s_county in ('Oglethorpe County','Mobile County','Fairfield County','Luce County',\r\n                           'Jackson County','Dauphin County','Ziebach County','Richland County')\r\n    group by ss_ticket_number,ss_customer_sk) dn,customer\r\n    where ss_customer_sk = c_customer_sk\r\n      and cnt between 15 and 20\r\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r\n\r\n", 
                    "oneline_sql": "select c_last_name\r        ,c_first_name\r        ,c_salutation\r        ,c_preferred_cust_flag\r        ,ss_ticket_number\r        ,cnt from\r    (select ss_ticket_number\r           ,ss_customer_sk\r           ,count(*) cnt\r     from store_sales,date_dim,store,household_demographics\r     where store_sales.ss_sold_date_sk = date_dim.d_date_sk\r     and store_sales.ss_store_sk = store.s_store_sk  \r     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\r     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\r     and (household_demographics.hd_buy_potential = '501-1000' or\r          household_demographics.hd_buy_potential = '5001-10000')\r     and household_demographics.hd_vehicle_count > 0\r     and (case when household_demographics.hd_vehicle_count > 0 \r \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \r \telse null \r \tend)  > 1.2\r     and date_dim.d_year in (1999,1999+1,1999+2)\r     and store.s_county in ('Oglethorpe County','Mobile County','Fairfield County','Luce County',\r                            'Jackson County','Dauphin County','Ziebach County','Richland County')\r     group by ss_ticket_number,ss_customer_sk) dn,customer\r     where ss_customer_sk = c_customer_sk\r       and cnt between 15 and 20\r     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\r \r ", 
                    "id": 591, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/591.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query34.tpl\r", 
                    "sid": 96, 
                    "endTime": 1575595927.537285
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:07", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.53737, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_592.sql", 
                    "second": 0.16622209548950195, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  i_item_id\r\n       ,i_item_desc\r\n       ,i_current_price\r\n from item, inventory, date_dim, store_sales\r\n where i_current_price between 84 and 84+30\r\n and inv_item_sk = i_item_sk\r\n and d_date_sk=inv_date_sk\r\n and d_date between to_date('1998-03-08' ,'yyyy-mm-dd') and to_date('1998-03-08' ,'yyyy-mm-dd') + 60\r\n and i_manufact_id in (427,735,328,28)\r\n and inv_quantity_on_hand between 100 and 500\r\n and ss_item_sk = i_item_sk\r\n group by i_item_id,i_item_desc,i_current_price\r\n order by i_item_id\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  i_item_id\r        ,i_item_desc\r        ,i_current_price\r  from item, inventory, date_dim, store_sales\r  where i_current_price between 84 and 84+30\r  and inv_item_sk = i_item_sk\r  and d_date_sk=inv_date_sk\r  and d_date between to_date('1998-03-08' ,'yyyy-mm-dd') and to_date('1998-03-08' ,'yyyy-mm-dd') + 60\r  and i_manufact_id in (427,735,328,28)\r  and inv_quantity_on_hand between 100 and 500\r  and ss_item_sk = i_item_sk\r  group by i_item_id,i_item_desc,i_current_price\r  order by i_item_id\r   ) where rownum <= 100;\r \r ", 
                    "id": 592, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/592.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query82.tpl\r", 
                    "sid": 97, 
                    "endTime": 1575595927.703592
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:08", 
                    "startTimeFormat": "2019-12-06 09:32:07", 
                    "startTime": 1575595927.703669, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_593.sql", 
                    "second": 0.4219839572906494, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select   \r\n     i_item_id\r\n    ,i_item_desc\r\n    ,s_store_id\r\n    ,s_store_name\r\n    ,sum(ss_quantity)        as store_sales_quantity\r\n    ,sum(sr_return_quantity) as store_returns_quantity\r\n    ,sum(cs_quantity)        as catalog_sales_quantity\r\n from\r\n    store_sales\r\n   ,store_returns\r\n   ,catalog_sales\r\n   ,date_dim             d1\r\n   ,date_dim             d2\r\n   ,date_dim             d3\r\n   ,store\r\n   ,item\r\n where\r\n     d1.d_moy               = 4 \r\n and d1.d_year              = 2000\r\n and d1.d_date_sk           = ss_sold_date_sk\r\n and i_item_sk              = ss_item_sk\r\n and s_store_sk             = ss_store_sk\r\n and ss_customer_sk         = sr_customer_sk\r\n and ss_item_sk             = sr_item_sk\r\n and ss_ticket_number       = sr_ticket_number\r\n and sr_returned_date_sk    = d2.d_date_sk\r\n and d2.d_moy               between 4 and  4 + 3 \r\n and d2.d_year              = 2000\r\n and sr_customer_sk         = cs_bill_customer_sk\r\n and sr_item_sk             = cs_item_sk\r\n and cs_sold_date_sk        = d3.d_date_sk     \r\n and d3.d_year              in (2000,2000+1,2000+2)\r\n group by\r\n    i_item_id\r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n order by\r\n    i_item_id \r\n   ,i_item_desc\r\n   ,s_store_id\r\n   ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select   \r      i_item_id\r     ,i_item_desc\r     ,s_store_id\r     ,s_store_name\r     ,sum(ss_quantity)        as store_sales_quantity\r     ,sum(sr_return_quantity) as store_returns_quantity\r     ,sum(cs_quantity)        as catalog_sales_quantity\r  from\r     store_sales\r    ,store_returns\r    ,catalog_sales\r    ,date_dim             d1\r    ,date_dim             d2\r    ,date_dim             d3\r    ,store\r    ,item\r  where\r      d1.d_moy               = 4 \r  and d1.d_year              = 2000\r  and d1.d_date_sk           = ss_sold_date_sk\r  and i_item_sk              = ss_item_sk\r  and s_store_sk             = ss_store_sk\r  and ss_customer_sk         = sr_customer_sk\r  and ss_item_sk             = sr_item_sk\r  and ss_ticket_number       = sr_ticket_number\r  and sr_returned_date_sk    = d2.d_date_sk\r  and d2.d_moy               between 4 and  4 + 3 \r  and d2.d_year              = 2000\r  and sr_customer_sk         = cs_bill_customer_sk\r  and sr_item_sk             = cs_item_sk\r  and cs_sold_date_sk        = d3.d_date_sk     \r  and d3.d_year              in (2000,2000+1,2000+2)\r  group by\r     i_item_id\r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r  order by\r     i_item_id \r    ,i_item_desc\r    ,s_store_id\r    ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 593, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/593.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query29.tpl\r", 
                    "sid": 98, 
                    "endTime": 1575595928.125653
                }, 
                {
                    "endTimeFormat": "2019-12-06 09:32:08", 
                    "startTimeFormat": "2019-12-06 09:32:08", 
                    "startTime": 1575595928.125725, 
                    "oneline_sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/oneline_594.sql", 
                    "second": 0.33412790298461914, 
                    "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/query_5.sql", 
                    "sql": "select * from (select  \r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n ,max(ss_net_profit) as store_sales_profit\r\n ,max(sr_net_loss) as store_returns_loss\r\n ,max(cs_net_profit) as catalog_sales_profit\r\n from\r\n store_sales\r\n ,store_returns\r\n ,catalog_sales\r\n ,date_dim d1\r\n ,date_dim d2\r\n ,date_dim d3\r\n ,store\r\n ,item\r\n where\r\n d1.d_moy = 4\r\n and d1.d_year = 2001\r\n and d1.d_date_sk = ss_sold_date_sk\r\n and i_item_sk = ss_item_sk\r\n and s_store_sk = ss_store_sk\r\n and ss_customer_sk = sr_customer_sk\r\n and ss_item_sk = sr_item_sk\r\n and ss_ticket_number = sr_ticket_number\r\n and sr_returned_date_sk = d2.d_date_sk\r\n and d2.d_moy               between 4 and  10\r\n and d2.d_year              = 2001\r\n and sr_customer_sk = cs_bill_customer_sk\r\n and sr_item_sk = cs_item_sk\r\n and cs_sold_date_sk = d3.d_date_sk\r\n and d3.d_moy               between 4 and  10 \r\n and d3.d_year              = 2001\r\n group by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n order by\r\n i_item_id\r\n ,i_item_desc\r\n ,s_store_id\r\n ,s_store_name\r\n  ) where rownum <= 100;\r\n\r\n", 
                    "oneline_sql": "select * from (select  \r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  ,max(ss_net_profit) as store_sales_profit\r  ,max(sr_net_loss) as store_returns_loss\r  ,max(cs_net_profit) as catalog_sales_profit\r  from\r  store_sales\r  ,store_returns\r  ,catalog_sales\r  ,date_dim d1\r  ,date_dim d2\r  ,date_dim d3\r  ,store\r  ,item\r  where\r  d1.d_moy = 4\r  and d1.d_year = 2001\r  and d1.d_date_sk = ss_sold_date_sk\r  and i_item_sk = ss_item_sk\r  and s_store_sk = ss_store_sk\r  and ss_customer_sk = sr_customer_sk\r  and ss_item_sk = sr_item_sk\r  and ss_ticket_number = sr_ticket_number\r  and sr_returned_date_sk = d2.d_date_sk\r  and d2.d_moy               between 4 and  10\r  and d2.d_year              = 2001\r  and sr_customer_sk = cs_bill_customer_sk\r  and sr_item_sk = cs_item_sk\r  and cs_sold_date_sk = d3.d_date_sk\r  and d3.d_moy               between 4 and  10 \r  and d3.d_year              = 2001\r  group by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r  order by\r  i_item_id\r  ,i_item_desc\r  ,s_store_id\r  ,s_store_name\r   ) where rownum <= 100;\r \r ", 
                    "id": 594, 
                    "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/sqls/594.sql", 
                    "secondFormat": "00:00:00", 
                    "filename": "query_5.sql", 
                    "isSuccess": true, 
                    "template": "query25.tpl\r", 
                    "sid": 99, 
                    "endTime": 1575595928.459853
                }
            ], 
            "second": 144.42106890678406, 
            "startTime": 1575595784.038865, 
            "endTime": 1575595928.459934
        }
    }, 
    "DataMaintenance4": {
        "endTimeFormat": "2019-12-06 09:32:53", 
        "startTimeFormat": "2019-12-06 09:32:37", 
        "secondFormat": "00:00:16", 
        "sqls": [
            {
                "endTimeFormat": "2019-12-06 09:32:37", 
                "startTimeFormat": "2019-12-06 09:32:37", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CR.sql", 
                "oneline_sqlpath": "", 
                "second": 0.5630040168762207, 
                "key": "LF_CR", 
                "sql": "drop table crv;\r\nCREATE table crv as\r\nSELECT d_date_sk cr_return_date_sk\r\n,t_time_sk cr_return_time_sk\r\n,i_item_sk cr_item_sk\r\n,c1.c_customer_sk cr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk cr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk cr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk cr_refunded_addr_sk\r\n,c2.c_customer_sk cr_returning_customer_sk\r\n,c2.c_current_cdemo_sk cr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk cr_returning_hdemo_sk\r\n,c2.c_current_addr_sk cr_returning_addr_sk\r\n,cc_call_center_sk cr_call_center_sk\r\n,cp_catalog_page_sk CR_CATALOG_PAGE_SK\r\n,sm_ship_mode_sk CR_SHIP_MODE_SK\r\n,w_warehouse_sk CR_WAREHOUSE_SK\r\n,r_reason_sk cr_reason_sk\r\n,cret_order_id cr_order_number\r\n,cret_return_qty cr_return_quantity\r\n,cret_return_amt cr_return_amount\r\n,cret_return_tax cr_return_tax\r\n,cret_return_amt + cret_return_tax AS cr_return_amt_inc_tax\r\n,cret_return_fee cr_fee\r\n,cret_return_ship_cost cr_return_ship_cost\r\n,cret_refunded_cash cr_refunded_cash\r\n,cret_reversed_charge cr_reversed_charge\r\n,cret_merchant_credit cr_merchant_credit\r\n,cret_return_amt+cret_return_tax+cret_return_fee\r\n-cret_refunded_cash-cret_reversed_charge-cret_merchant_credit cr_net_loss\r\nFROM s_catalog_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(cret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON\r\n((CAST(substr(cret_return_time,1,2) AS integer)*3600\r\n+CAST(substr(cret_return_time,4,2) AS integer)*60\r\n+CAST(substr(cret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (cret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (cret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (cret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN call_center ON (cret_call_center_id = cc_call_center_id)\r\nLEFT OUTER JOIN catalog_page ON (cret_catalog_page_id = cp_catalog_page_id)\r\nLEFT OUTER JOIN ship_mode ON (cret_shipmode_id = sm_ship_mode_id)\r\nLEFT OUTER JOIN warehouse ON (cret_warehouse_id = w_warehouse_id)\r\nWHERE i_rec_end_date IS NULL AND cc_rec_end_date IS NULL;\r\n\r\ninsert into catalog_returns select\r\ncr_return_date_sk,cr_return_time_sk,cr_item_sk,cr_refunded_customer_sk,cr_refunded_cdemo_sk,cr_refunded_hdemo_sk,cr_refunded_addr_sk,cr_returning_customer_sk,cr_returning_cdemo_sk,cr_returning_hdemo_sk,cr_returning_addr_sk,cr_call_center_sk,cr_catalog_page_sk,cr_ship_mode_sk,cr_warehouse_sk,cr_reason_sk,cr_order_number,cr_return_quantity,cr_return_amount,cr_return_tax,cr_return_amt_inc_tax,cr_fee,cr_return_ship_cost,cr_refunded_cash,cr_reversed_charge,cr_merchant_credit,cr_net_loss\r\nfrom crv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 1, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CR.sql", 
                "startTime": 1575595957.33311, 
                "secondFormat": "00:00:00", 
                "filename": "LF_CR.sql", 
                "isSuccess": true, 
                "template": "LF_CR.sql", 
                "sid": 1, 
                "endTime": 1575595957.896114
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:40", 
                "startTimeFormat": "2019-12-06 09:32:37", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 2.61822509765625, 
                "key": "LF_CS", 
                "sql": "drop table csv;\r\nCREATE table csv as\r\nSELECT d1.d_date_sk cs_sold_date_sk\r\n,t_time_sk cs_sold_time_sk\r\n,d2.d_date_sk cs_ship_date_sk\r\n,c1.c_customer_sk cs_bill_customer_sk\r\n,c1.c_current_cdemo_sk cs_bill_cdemo_sk\r\n,c1.c_current_hdemo_sk cs_bill_hdemo_sk\r\n,c1.c_current_addr_sk cs_bill_addr_sk\r\n,c2.c_customer_sk cs_ship_customer_sk\r\n,c2.c_current_cdemo_sk cs_ship_cdemo_sk\r\n,c2.c_current_hdemo_sk cs_ship_hdemo_sk\r\n,c2.c_current_addr_sk cs_ship_addr_sk\r\n,cc_call_center_sk cs_call_center_sk\r\n,cp_catalog_page_sk cs_catalog_page_sk\r\n,sm_ship_mode_sk cs_ship_mode_sk\r\n,w_warehouse_sk cs_warehouse_sk\r\n,i_item_sk cs_item_sk\r\n,p_promo_sk cs_promo_sk\r\n,cord_order_id cs_order_number\r\n,clin_quantity cs_quantity\r\n,i_wholesale_cost cs_wholesale_cost\r\n,i_current_price cs_list_price\r\n,clin_sales_price cs_sales_price\r\n,(i_current_price-clin_sales_price)*clin_quantity cs_ext_discount_amt\r\n,clin_sales_price * clin_quantity cs_ext_sales_price\r\n,i_wholesale_cost * clin_quantity cs_ext_wholesale_cost\r\n,i_current_price * clin_quantity CS_EXT_LIST_PRICE\r\n,i_current_price * cc_tax_percentage CS_EXT_TAX\r\n,clin_coupon_amt cs_coupon_amt\r\n,clin_ship_cost * clin_quantity CS_EXT_SHIP_COST\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt cs_net_paid\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)*(1+cc_tax_percentage) cs_net_paid_inc_tax\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) CS_NET_PAID_INC_SHIP\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity)\r\n+ i_current_price * cc_tax_percentage CS_NET_PAID_INC_SHIP_TAX\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)-(clin_quantity*i_wholesale_cost) cs_net_profit\r\nFROM\r\ns_catalog_order\r\nLEFT OUTER JOIN date_dim d1 ON\r\n(cast(TO_DATE(cord_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (cord_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (cord_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cord_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN call_center ON (cord_call_center_id = cc_call_center_id AND cc_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (cord_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_catalog_order_lineitem ON (cord_order_id = clin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON\r\n(cast(TO_DATE(clin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN catalog_page ON\r\n(clin_catalog_page_number = cp_catalog_page_number and clin_catalog_number = cp_catalog_number)\r\nLEFT OUTER JOIN warehouse ON (clin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN item ON (clin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN promotion ON (clin_promotion_id = p_promo_id);\r\n\r\ninsert into catalog_sales select\r\n cs_sold_date_sk,cs_sold_time_sk,cs_ship_date_sk,cs_bill_customer_sk,cs_bill_cdemo_sk,cs_bill_hdemo_sk,cs_bill_addr_sk,cs_ship_customer_sk,cs_ship_cdemo_sk,cs_ship_hdemo_sk,cs_ship_addr_sk,cs_call_center_sk,cs_catalog_page_sk,cs_ship_mode_sk,cs_warehouse_sk,cs_item_sk,cs_promo_sk,cs_order_number,cs_quantity,cs_wholesale_cost,cs_list_price,cs_sales_price,cs_ext_discount_amt,cs_ext_sales_price,cs_ext_wholesale_cost,cs_ext_list_price,cs_ext_tax,cs_coupon_amt,cs_ext_ship_cost,cs_net_paid,cs_net_paid_inc_tax,cs_net_paid_inc_ship,cs_net_paid_inc_ship_tax,cs_net_profit\r\nfrom csv\r\n", 
                "oneline_sql": "", 
                "id": 2, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CS.sql", 
                "startTime": 1575595957.896227, 
                "secondFormat": "00:00:02", 
                "filename": "LF_CS.sql", 
                "isSuccess": true, 
                "template": "LF_CS.sql", 
                "sid": 2, 
                "endTime": 1575595960.514452
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:43", 
                "startTimeFormat": "2019-12-06 09:32:40", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 3.0357019901275635, 
                "key": "LF_I", 
                "sql": "drop table iv;\r\nCREATE table iv AS\r\nSELECT d_date_sk inv_date_sk,\r\ni_item_sk inv_item_sk,\r\nw_warehouse_sk inv_warehouse_sk,\r\ninvn_qty_on_hand inv_quantity_on_hand\r\nFROM s_inventory\r\nLEFT OUTER JOIN warehouse ON (invn_warehouse_id=w_warehouse_id)\r\nLEFT OUTER JOIN item ON (invn_item_id=i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN date_dim ON (d_date=CAST(TO_DATE(invn_date,'YYYY-MM-DD') AS DATE));\r\n\r\ninsert into inventory select\r\ninv_date_sk,inv_item_sk,inv_warehouse_sk,inv_quantity_on_hand\r\nfrom iv\r\n", 
                "oneline_sql": "", 
                "id": 3, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_I.sql", 
                "startTime": 1575595960.514556, 
                "secondFormat": "00:00:03", 
                "filename": "LF_I.sql", 
                "isSuccess": true, 
                "template": "LF_I.sql", 
                "sid": 3, 
                "endTime": 1575595963.550258
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:44", 
                "startTimeFormat": "2019-12-06 09:32:43", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SR.sql", 
                "oneline_sqlpath": "", 
                "second": 0.94582200050354, 
                "key": "LF_SR", 
                "sql": "drop table srv;\r\nCREATE table srv as\r\nSELECT d_date_sk sr_returned_date_sk\r\n,t_time_sk sr_return_time_sk\r\n,i_item_sk sr_item_sk\r\n,c_customer_sk sr_customer_sk\r\n,c_current_cdemo_sk sr_cdemo_sk\r\n,c_current_hdemo_sk sr_hdemo_sk\r\n,c_current_addr_sk sr_addr_sk\r\n,s_store_sk sr_store_sk\r\n,r_reason_sk sr_reason_sk\r\n,sret_ticket_number sr_ticket_number\r\n,sret_return_qty sr_return_quantity\r\n,sret_return_amt sr_return_amt\r\n,sret_return_tax sr_return_tax\r\n,sret_return_amt + sret_return_tax sr_return_amt_inc_tax\r\n,sret_return_fee sr_fee\r\n,sret_return_ship_cost sr_return_ship_cost\r\n,sret_refunded_cash sr_refunded_cash\r\n,sret_reversed_charge sr_reversed_charge\r\n,sret_store_credit sr_store_credit\r\n,sret_return_amt+sret_return_tax+sret_return_fee\r\n-sret_refunded_cash-sret_reversed_charge-sret_store_credit sr_net_loss\r\nFROM s_store_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(sret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim\r\nON (( cast(substr(sret_return_time,1,2) AS integer)*3600\r\n+cast(substr(sret_return_time,4,2) AS integer)*60\r\n+cast(substr(sret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (sret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer ON (sret_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (sret_store_id = s_store_id)\r\nLEFT OUTER JOIN reason ON (sret_reason_id = r_reason_id)\r\nWHERE i_rec_end_date IS NULL\r\nAND s_rec_end_date IS NULL;\r\n\r\ninsert into store_returns select\r\nsr_returned_date_sk,sr_return_time_sk,sr_item_sk,sr_customer_sk,sr_cdemo_sk,sr_hdemo_sk,sr_addr_sk,sr_store_sk,sr_reason_sk,sr_ticket_number,sr_return_quantity,sr_return_amt,sr_return_tax,sr_return_amt_inc_tax,sr_fee,sr_return_ship_cost,sr_refunded_cash,sr_reversed_charge,sr_store_credit,sr_net_loss\r\nfrom srv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 4, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SR.sql", 
                "startTime": 1575595963.550358, 
                "secondFormat": "00:00:00", 
                "filename": "LF_SR.sql", 
                "isSuccess": true, 
                "template": "LF_SR.sql", 
                "sid": 4, 
                "endTime": 1575595964.49618
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:48", 
                "startTimeFormat": "2019-12-06 09:32:44", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 4.2492921352386475, 
                "key": "LF_SS", 
                "sql": "drop table ssv;\r\nCREATE table ssv as\r\nSELECT d_date_sk ss_sold_date_sk,\r\nt_time_sk ss_sold_time_sk,\r\ni_item_sk ss_item_sk,\r\nc_customer_sk ss_customer_sk,\r\nc_current_cdemo_sk ss_cdemo_sk,\r\nc_current_hdemo_sk ss_hdemo_sk,\r\nc_current_addr_sk ss_addr_sk,\r\ns_store_sk ss_store_sk,\r\np_promo_sk ss_promo_sk,\r\npurc_purchase_id ss_ticket_number,\r\nplin_quantity ss_quantity,\r\ni_wholesale_cost ss_wholesale_cost,\r\ni_current_price ss_list_price,\r\nplin_sale_price ss_sales_price,\r\n(i_current_price-plin_sale_price)*plin_quantity ss_ext_discount_amt,\r\nplin_sale_price * plin_quantity ss_ext_sales_price,\r\ni_wholesale_cost * plin_quantity ss_ext_wholesale_cost,\r\ni_current_price * plin_quantity ss_ext_list_price,\r\ni_current_price * s_tax_precentage ss_ext_tax,\r\nplin_coupon_amt ss_coupon_amt,\r\n(plin_sale_price * plin_quantity)-plin_coupon_amt ss_net_paid,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)*(1+s_tax_precentage) ss_net_paid_inc_tax,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)-(plin_quantity*i_wholesale_cost)\r\nss_net_profit\r\nFROM\r\ns_purchase\r\nLEFT OUTER JOIN customer ON (purc_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (purc_store_id = s_store_id)\r\nLEFT OUTER JOIN date_dim ON (cast(TO_DATE(purc_purchase_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON (PURC_PURCHASE_TIME = t_time)\r\nJOIN s_purchase_lineitem ON (purc_purchase_id = plin_purchase_id)\r\nLEFT OUTER JOIN promotion ON plin_promotion_id = p_promo_id\r\nLEFT OUTER JOIN item ON plin_item_id = i_item_id\r\nWHERE\r\npurc_purchase_id = plin_purchase_id\r\nAND i_rec_end_date is NULL\r\nAND s_rec_end_date is NULL;\r\n\r\ninsert into store_sales select\r\nss_sold_date_sk,ss_sold_time_sk,  ss_item_sk,  ss_customer_sk,  ss_cdemo_sk,  ss_hdemo_sk,  ss_addr_sk,  ss_store_sk,  ss_promo_sk,  ss_ticket_number,  ss_quantity,  ss_wholesale_cost,  ss_list_price,  ss_sales_price,  ss_ext_discount_amt,  ss_ext_sales_price,  ss_ext_wholesale_cost,  ss_ext_list_price,  ss_ext_tax,  ss_coupon_amt,  ss_net_paid,  ss_net_paid_inc_tax,  ss_net_profit\r\nfrom ssv\r\n", 
                "oneline_sql": "", 
                "id": 5, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SS.sql", 
                "startTime": 1575595964.496296, 
                "secondFormat": "00:00:04", 
                "filename": "LF_SS.sql", 
                "isSuccess": true, 
                "template": "LF_SS.sql", 
                "sid": 5, 
                "endTime": 1575595968.745588
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:49", 
                "startTimeFormat": "2019-12-06 09:32:48", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WR.sql", 
                "oneline_sqlpath": "", 
                "second": 0.42304396629333496, 
                "key": "LF_WR", 
                "sql": "drop table wrv;\r\nCREATE table wrv AS\r\nSELECT d_date_sk wr_return_date_sk\r\n,t_time_sk wr_return_time_sk\r\n,i_item_sk wr_item_sk\r\n,c1.c_customer_sk wr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk wr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk wr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk wr_refunded_addr_sk\r\n,c2.c_customer_sk wr_returning_customer_sk\r\n,c2.c_current_cdemo_sk wr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk wr_returning_hdemo_sk\r\n,c2.c_current_addr_sk wr_returning_addr_sk\r\n,wp_web_page_sk wr_web_page_sk\r\n,r_reason_sk wr_reason_sk\r\n,wret_order_id wr_order_number\r\n,wret_return_qty wr_return_quantity\r\n,wret_return_amt wr_return_amt\r\n,wret_return_tax wr_return_tax\r\n,wret_return_amt + wret_return_tax AS wr_return_amt_inc_tax\r\n,wret_return_fee wr_fee\r\n,wret_return_ship_cost wr_return_ship_cost\r\n,wret_refunded_cash wr_refunded_cash\r\n,wret_reversed_charge wr_reversed_charge\r\n,wret_account_credit wr_account_credit\r\n,wret_return_amt+wret_return_tax+wret_return_fee\r\n-wret_refunded_cash-wret_reversed_charge-wret_account_credit wr_net_loss\r\nFROM s_web_returns LEFT OUTER JOIN date_dim ON (cast(TO_DATE(wret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON ((CAST(SUBSTR(wret_return_time,1,2) AS integer)*3600\r\n+CAST(SUBSTR(wret_return_time,4,2) AS integer)*60+CAST(SUBSTR(wret_return_time,7,2) AS integer))=t_time)\r\nLEFT OUTER JOIN item ON (wret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (wret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (wret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (wret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN web_page ON (wret_web_site_id = WP_WEB_PAGE_id)\r\nWHERE i_rec_end_date IS NULL AND wp_rec_end_date IS NULL;\r\n\r\ninsert into web_returns select\r\nwr_return_date_sk,wr_return_time_sk,wr_item_sk,wr_refunded_customer_sk,wr_refunded_cdemo_sk,wr_refunded_hdemo_sk,wr_refunded_addr_sk,wr_returning_customer_sk,wr_returning_cdemo_sk,wr_returning_hdemo_sk,wr_returning_addr_sk,wr_web_page_sk,wr_reason_sk,wr_order_number,wr_return_quantity,wr_return_amt,wr_return_tax,wr_return_amt_inc_tax,wr_fee,wr_return_ship_cost,wr_refunded_cash,wr_reversed_charge,wr_account_credit,wr_net_loss\r\nfrom wrv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 6, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WR.sql", 
                "startTime": 1575595968.74569, 
                "secondFormat": "00:00:00", 
                "filename": "LF_WR.sql", 
                "isSuccess": true, 
                "template": "LF_WR.sql", 
                "sid": 6, 
                "endTime": 1575595969.168734
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:49", 
                "startTimeFormat": "2019-12-06 09:32:49", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.7378749847412109, 
                "key": "LF_WS", 
                "sql": "drop table wsv;\r\nCREATE table wsv AS\r\nSELECT d1.d_date_sk ws_sold_date_sk,\r\nt_time_sk ws_sold_time_sk,\r\nd2.d_date_sk ws_ship_date_sk,\r\ni_item_sk ws_item_sk,\r\nc1.c_customer_sk ws_bill_customer_sk,\r\nc1.c_current_cdemo_sk ws_bill_cdemo_sk,\r\nc1.c_current_hdemo_sk ws_bill_hdemo_sk,\r\nc1.c_current_addr_sk ws_bill_addr_sk,\r\nc2.c_customer_sk ws_ship_customer_sk,\r\nc2.c_current_cdemo_sk ws_ship_cdemo_sk,\r\nc2.c_current_hdemo_sk ws_ship_hdemo_sk,\r\nc2.c_current_addr_sk ws_ship_addr_sk,\r\nwp_web_page_sk ws_web_page_sk,\r\nweb_site_sk ws_web_site_sk,\r\nsm_ship_mode_sk ws_ship_mode_sk,\r\nw_warehouse_sk ws_warehouse_sk,\r\np_promo_sk ws_promo_sk,\r\nword_order_id ws_order_number,\r\nwlin_quantity ws_quantity,\r\ni_wholesale_cost ws_wholesale_cost,\r\ni_current_price ws_list_price,\r\nwlin_sales_price ws_sales_price,\r\n(i_current_price-wlin_sales_price)*wlin_quantity ws_ext_discount_amt,\r\nwlin_sales_price * wlin_quantity ws_ext_sales_price,\r\ni_wholesale_cost * wlin_quantity ws_ext_wholesale_cost,\r\ni_current_price * wlin_quantity ws_ext_list_price,\r\ni_current_price * web_tax_percentage ws_ext_tax,\r\nwlin_coupon_amt ws_coupon_amt,\r\nwlin_ship_cost * wlin_quantity WS_EXT_SHIP_COST,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt ws_net_paid,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)*(1+web_tax_percentage) ws_net_paid_inc_tax,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(wlin_quantity*i_wholesale_cost)\r\nWS_NET_PAID_INC_SHIP,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt + (wlin_ship_cost * wlin_quantity)\r\n+ i_current_price * web_tax_percentage WS_NET_PAID_INC_SHIP_TAX,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(i_wholesale_cost * wlin_quantity)\r\nWS_NET_PROFIT\r\nFROM\r\ns_web_order\r\nLEFT OUTER JOIN date_dim d1 ON (cast(TO_DATE(word_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (word_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (word_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (word_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN web_site ON (word_web_site_id = web_site_id AND web_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (word_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_web_order_lineitem ON (word_order_id = wlin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON (cast(TO_DATE(wlin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN item ON (wlin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN web_page ON (wlin_web_page_id = wp_web_page_id AND wp_rec_end_date IS NULL)\r\nLEFT OUTER JOIN warehouse ON (wlin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN promotion ON (wlin_promotion_id = p_promo_id);\r\n\r\ninsert into web_sales select \r\n ws_sold_date_sk,ws_sold_time_sk, ws_ship_date_sk, ws_item_sk, ws_bill_customer_sk, ws_bill_cdemo_sk, ws_bill_hdemo_sk, ws_bill_addr_sk, ws_ship_customer_sk, ws_ship_cdemo_sk, ws_ship_hdemo_sk, ws_ship_addr_sk, ws_web_page_sk, ws_web_site_sk, ws_ship_mode_sk, ws_warehouse_sk, ws_promo_sk, ws_order_number, ws_quantity, ws_wholesale_cost, ws_list_price, ws_sales_price, ws_ext_discount_amt, ws_ext_sales_price, ws_ext_wholesale_cost, ws_ext_list_price, ws_ext_tax, ws_coupon_amt, ws_ext_ship_cost, ws_net_paid, ws_net_paid_inc_tax, ws_net_paid_inc_ship, ws_net_paid_inc_ship_tax, ws_net_profit\r\nfrom wsv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 7, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WS.sql", 
                "startTime": 1575595969.168858, 
                "secondFormat": "00:00:00", 
                "filename": "LF_WS.sql", 
                "isSuccess": true, 
                "template": "LF_WS.sql", 
                "sid": 7, 
                "endTime": 1575595969.906733
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:50", 
                "startTimeFormat": "2019-12-06 09:32:49", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.37888002395629883, 
                "key": "DF_CS", 
                "sql": "delete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >=  (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and cs_sold_date_sk <=  (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n\r\n", 
                "oneline_sql": "", 
                "id": 8, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_CS.sql", 
                "startTime": 1575595969.906892, 
                "secondFormat": "00:00:00", 
                "filename": "DF_CS.sql", 
                "isSuccess": true, 
                "template": "DF_CS.sql", 
                "sid": 8, 
                "endTime": 1575595970.285772
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:52", 
                "startTimeFormat": "2019-12-06 09:32:50", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 1.7253308296203613, 
                "key": "DF_SS", 
                "sql": "delete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk<= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 9, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_SS.sql", 
                "startTime": 1575595970.285916, 
                "secondFormat": "00:00:01", 
                "filename": "DF_SS.sql", 
                "isSuccess": true, 
                "template": "DF_SS.sql", 
                "sid": 9, 
                "endTime": 1575595972.011247
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:52", 
                "startTimeFormat": "2019-12-06 09:32:52", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.6227920055389404, 
                "key": "DF_WS", 
                "sql": "delete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\t ws_sold_date_sk <= (select max(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and \r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 10, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_WS.sql", 
                "startTime": 1575595972.011348, 
                "secondFormat": "00:00:00", 
                "filename": "DF_WS.sql", 
                "isSuccess": true, 
                "template": "DF_WS.sql", 
                "sid": 10, 
                "endTime": 1575595972.63414
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:53", 
                "startTimeFormat": "2019-12-06 09:32:52", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 0.7247500419616699, 
                "key": "DF_I", 
                "sql": "delete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd'))\r\n", 
                "oneline_sql": "", 
                "id": 11, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_I.sql", 
                "startTime": 1575595972.634248, 
                "secondFormat": "00:00:00", 
                "filename": "DF_I.sql", 
                "isSuccess": true, 
                "template": "DF_I.sql", 
                "sid": 11, 
                "endTime": 1575595973.358998
            }
        ], 
        "second": 16.026458978652954, 
        "startTime": 1575595957.332899, 
        "endTime": 1575595973.359358
    }, 
    "DataMaintenance3": {
        "endTimeFormat": "2019-12-06 09:32:37", 
        "startTimeFormat": "2019-12-06 09:32:21", 
        "secondFormat": "00:00:15", 
        "sqls": [
            {
                "endTimeFormat": "2019-12-06 09:32:22", 
                "startTimeFormat": "2019-12-06 09:32:21", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CR.sql", 
                "oneline_sqlpath": "", 
                "second": 0.8569509983062744, 
                "key": "LF_CR", 
                "sql": "drop table crv;\r\nCREATE table crv as\r\nSELECT d_date_sk cr_return_date_sk\r\n,t_time_sk cr_return_time_sk\r\n,i_item_sk cr_item_sk\r\n,c1.c_customer_sk cr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk cr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk cr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk cr_refunded_addr_sk\r\n,c2.c_customer_sk cr_returning_customer_sk\r\n,c2.c_current_cdemo_sk cr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk cr_returning_hdemo_sk\r\n,c2.c_current_addr_sk cr_returning_addr_sk\r\n,cc_call_center_sk cr_call_center_sk\r\n,cp_catalog_page_sk CR_CATALOG_PAGE_SK\r\n,sm_ship_mode_sk CR_SHIP_MODE_SK\r\n,w_warehouse_sk CR_WAREHOUSE_SK\r\n,r_reason_sk cr_reason_sk\r\n,cret_order_id cr_order_number\r\n,cret_return_qty cr_return_quantity\r\n,cret_return_amt cr_return_amount\r\n,cret_return_tax cr_return_tax\r\n,cret_return_amt + cret_return_tax AS cr_return_amt_inc_tax\r\n,cret_return_fee cr_fee\r\n,cret_return_ship_cost cr_return_ship_cost\r\n,cret_refunded_cash cr_refunded_cash\r\n,cret_reversed_charge cr_reversed_charge\r\n,cret_merchant_credit cr_merchant_credit\r\n,cret_return_amt+cret_return_tax+cret_return_fee\r\n-cret_refunded_cash-cret_reversed_charge-cret_merchant_credit cr_net_loss\r\nFROM s_catalog_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(cret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON\r\n((CAST(substr(cret_return_time,1,2) AS integer)*3600\r\n+CAST(substr(cret_return_time,4,2) AS integer)*60\r\n+CAST(substr(cret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (cret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (cret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (cret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN call_center ON (cret_call_center_id = cc_call_center_id)\r\nLEFT OUTER JOIN catalog_page ON (cret_catalog_page_id = cp_catalog_page_id)\r\nLEFT OUTER JOIN ship_mode ON (cret_shipmode_id = sm_ship_mode_id)\r\nLEFT OUTER JOIN warehouse ON (cret_warehouse_id = w_warehouse_id)\r\nWHERE i_rec_end_date IS NULL AND cc_rec_end_date IS NULL;\r\n\r\ninsert into catalog_returns select\r\ncr_return_date_sk,cr_return_time_sk,cr_item_sk,cr_refunded_customer_sk,cr_refunded_cdemo_sk,cr_refunded_hdemo_sk,cr_refunded_addr_sk,cr_returning_customer_sk,cr_returning_cdemo_sk,cr_returning_hdemo_sk,cr_returning_addr_sk,cr_call_center_sk,cr_catalog_page_sk,cr_ship_mode_sk,cr_warehouse_sk,cr_reason_sk,cr_order_number,cr_return_quantity,cr_return_amount,cr_return_tax,cr_return_amt_inc_tax,cr_fee,cr_return_ship_cost,cr_refunded_cash,cr_reversed_charge,cr_merchant_credit,cr_net_loss\r\nfrom crv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 1, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CR.sql", 
                "startTime": 1575595941.513229, 
                "secondFormat": "00:00:00", 
                "filename": "LF_CR.sql", 
                "isSuccess": true, 
                "template": "LF_CR.sql", 
                "sid": 1, 
                "endTime": 1575595942.37018
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:24", 
                "startTimeFormat": "2019-12-06 09:32:22", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 2.4804530143737793, 
                "key": "LF_CS", 
                "sql": "drop table csv;\r\nCREATE table csv as\r\nSELECT d1.d_date_sk cs_sold_date_sk\r\n,t_time_sk cs_sold_time_sk\r\n,d2.d_date_sk cs_ship_date_sk\r\n,c1.c_customer_sk cs_bill_customer_sk\r\n,c1.c_current_cdemo_sk cs_bill_cdemo_sk\r\n,c1.c_current_hdemo_sk cs_bill_hdemo_sk\r\n,c1.c_current_addr_sk cs_bill_addr_sk\r\n,c2.c_customer_sk cs_ship_customer_sk\r\n,c2.c_current_cdemo_sk cs_ship_cdemo_sk\r\n,c2.c_current_hdemo_sk cs_ship_hdemo_sk\r\n,c2.c_current_addr_sk cs_ship_addr_sk\r\n,cc_call_center_sk cs_call_center_sk\r\n,cp_catalog_page_sk cs_catalog_page_sk\r\n,sm_ship_mode_sk cs_ship_mode_sk\r\n,w_warehouse_sk cs_warehouse_sk\r\n,i_item_sk cs_item_sk\r\n,p_promo_sk cs_promo_sk\r\n,cord_order_id cs_order_number\r\n,clin_quantity cs_quantity\r\n,i_wholesale_cost cs_wholesale_cost\r\n,i_current_price cs_list_price\r\n,clin_sales_price cs_sales_price\r\n,(i_current_price-clin_sales_price)*clin_quantity cs_ext_discount_amt\r\n,clin_sales_price * clin_quantity cs_ext_sales_price\r\n,i_wholesale_cost * clin_quantity cs_ext_wholesale_cost\r\n,i_current_price * clin_quantity CS_EXT_LIST_PRICE\r\n,i_current_price * cc_tax_percentage CS_EXT_TAX\r\n,clin_coupon_amt cs_coupon_amt\r\n,clin_ship_cost * clin_quantity CS_EXT_SHIP_COST\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt cs_net_paid\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)*(1+cc_tax_percentage) cs_net_paid_inc_tax\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) CS_NET_PAID_INC_SHIP\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity)\r\n+ i_current_price * cc_tax_percentage CS_NET_PAID_INC_SHIP_TAX\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)-(clin_quantity*i_wholesale_cost) cs_net_profit\r\nFROM\r\ns_catalog_order\r\nLEFT OUTER JOIN date_dim d1 ON\r\n(cast(TO_DATE(cord_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (cord_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (cord_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cord_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN call_center ON (cord_call_center_id = cc_call_center_id AND cc_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (cord_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_catalog_order_lineitem ON (cord_order_id = clin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON\r\n(cast(TO_DATE(clin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN catalog_page ON\r\n(clin_catalog_page_number = cp_catalog_page_number and clin_catalog_number = cp_catalog_number)\r\nLEFT OUTER JOIN warehouse ON (clin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN item ON (clin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN promotion ON (clin_promotion_id = p_promo_id);\r\n\r\ninsert into catalog_sales select\r\n cs_sold_date_sk,cs_sold_time_sk,cs_ship_date_sk,cs_bill_customer_sk,cs_bill_cdemo_sk,cs_bill_hdemo_sk,cs_bill_addr_sk,cs_ship_customer_sk,cs_ship_cdemo_sk,cs_ship_hdemo_sk,cs_ship_addr_sk,cs_call_center_sk,cs_catalog_page_sk,cs_ship_mode_sk,cs_warehouse_sk,cs_item_sk,cs_promo_sk,cs_order_number,cs_quantity,cs_wholesale_cost,cs_list_price,cs_sales_price,cs_ext_discount_amt,cs_ext_sales_price,cs_ext_wholesale_cost,cs_ext_list_price,cs_ext_tax,cs_coupon_amt,cs_ext_ship_cost,cs_net_paid,cs_net_paid_inc_tax,cs_net_paid_inc_ship,cs_net_paid_inc_ship_tax,cs_net_profit\r\nfrom csv\r\n", 
                "oneline_sql": "", 
                "id": 2, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CS.sql", 
                "startTime": 1575595942.370276, 
                "secondFormat": "00:00:02", 
                "filename": "LF_CS.sql", 
                "isSuccess": true, 
                "template": "LF_CS.sql", 
                "sid": 2, 
                "endTime": 1575595944.850729
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:26", 
                "startTimeFormat": "2019-12-06 09:32:24", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 1.7533390522003174, 
                "key": "LF_I", 
                "sql": "drop table iv;\r\nCREATE table iv AS\r\nSELECT d_date_sk inv_date_sk,\r\ni_item_sk inv_item_sk,\r\nw_warehouse_sk inv_warehouse_sk,\r\ninvn_qty_on_hand inv_quantity_on_hand\r\nFROM s_inventory\r\nLEFT OUTER JOIN warehouse ON (invn_warehouse_id=w_warehouse_id)\r\nLEFT OUTER JOIN item ON (invn_item_id=i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN date_dim ON (d_date=CAST(TO_DATE(invn_date,'YYYY-MM-DD') AS DATE));\r\n\r\ninsert into inventory select\r\ninv_date_sk,inv_item_sk,inv_warehouse_sk,inv_quantity_on_hand\r\nfrom iv\r\n", 
                "oneline_sql": "", 
                "id": 3, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_I.sql", 
                "startTime": 1575595944.850856, 
                "secondFormat": "00:00:01", 
                "filename": "LF_I.sql", 
                "isSuccess": true, 
                "template": "LF_I.sql", 
                "sid": 3, 
                "endTime": 1575595946.604195
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:28", 
                "startTimeFormat": "2019-12-06 09:32:26", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SR.sql", 
                "oneline_sqlpath": "", 
                "second": 1.6428709030151367, 
                "key": "LF_SR", 
                "sql": "drop table srv;\r\nCREATE table srv as\r\nSELECT d_date_sk sr_returned_date_sk\r\n,t_time_sk sr_return_time_sk\r\n,i_item_sk sr_item_sk\r\n,c_customer_sk sr_customer_sk\r\n,c_current_cdemo_sk sr_cdemo_sk\r\n,c_current_hdemo_sk sr_hdemo_sk\r\n,c_current_addr_sk sr_addr_sk\r\n,s_store_sk sr_store_sk\r\n,r_reason_sk sr_reason_sk\r\n,sret_ticket_number sr_ticket_number\r\n,sret_return_qty sr_return_quantity\r\n,sret_return_amt sr_return_amt\r\n,sret_return_tax sr_return_tax\r\n,sret_return_amt + sret_return_tax sr_return_amt_inc_tax\r\n,sret_return_fee sr_fee\r\n,sret_return_ship_cost sr_return_ship_cost\r\n,sret_refunded_cash sr_refunded_cash\r\n,sret_reversed_charge sr_reversed_charge\r\n,sret_store_credit sr_store_credit\r\n,sret_return_amt+sret_return_tax+sret_return_fee\r\n-sret_refunded_cash-sret_reversed_charge-sret_store_credit sr_net_loss\r\nFROM s_store_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(sret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim\r\nON (( cast(substr(sret_return_time,1,2) AS integer)*3600\r\n+cast(substr(sret_return_time,4,2) AS integer)*60\r\n+cast(substr(sret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (sret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer ON (sret_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (sret_store_id = s_store_id)\r\nLEFT OUTER JOIN reason ON (sret_reason_id = r_reason_id)\r\nWHERE i_rec_end_date IS NULL\r\nAND s_rec_end_date IS NULL;\r\n\r\ninsert into store_returns select\r\nsr_returned_date_sk,sr_return_time_sk,sr_item_sk,sr_customer_sk,sr_cdemo_sk,sr_hdemo_sk,sr_addr_sk,sr_store_sk,sr_reason_sk,sr_ticket_number,sr_return_quantity,sr_return_amt,sr_return_tax,sr_return_amt_inc_tax,sr_fee,sr_return_ship_cost,sr_refunded_cash,sr_reversed_charge,sr_store_credit,sr_net_loss\r\nfrom srv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 4, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SR.sql", 
                "startTime": 1575595946.604288, 
                "secondFormat": "00:00:01", 
                "filename": "LF_SR.sql", 
                "isSuccess": true, 
                "template": "LF_SR.sql", 
                "sid": 4, 
                "endTime": 1575595948.247159
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:33", 
                "startTimeFormat": "2019-12-06 09:32:28", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 4.991272926330566, 
                "key": "LF_SS", 
                "sql": "drop table ssv;\r\nCREATE table ssv as\r\nSELECT d_date_sk ss_sold_date_sk,\r\nt_time_sk ss_sold_time_sk,\r\ni_item_sk ss_item_sk,\r\nc_customer_sk ss_customer_sk,\r\nc_current_cdemo_sk ss_cdemo_sk,\r\nc_current_hdemo_sk ss_hdemo_sk,\r\nc_current_addr_sk ss_addr_sk,\r\ns_store_sk ss_store_sk,\r\np_promo_sk ss_promo_sk,\r\npurc_purchase_id ss_ticket_number,\r\nplin_quantity ss_quantity,\r\ni_wholesale_cost ss_wholesale_cost,\r\ni_current_price ss_list_price,\r\nplin_sale_price ss_sales_price,\r\n(i_current_price-plin_sale_price)*plin_quantity ss_ext_discount_amt,\r\nplin_sale_price * plin_quantity ss_ext_sales_price,\r\ni_wholesale_cost * plin_quantity ss_ext_wholesale_cost,\r\ni_current_price * plin_quantity ss_ext_list_price,\r\ni_current_price * s_tax_precentage ss_ext_tax,\r\nplin_coupon_amt ss_coupon_amt,\r\n(plin_sale_price * plin_quantity)-plin_coupon_amt ss_net_paid,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)*(1+s_tax_precentage) ss_net_paid_inc_tax,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)-(plin_quantity*i_wholesale_cost)\r\nss_net_profit\r\nFROM\r\ns_purchase\r\nLEFT OUTER JOIN customer ON (purc_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (purc_store_id = s_store_id)\r\nLEFT OUTER JOIN date_dim ON (cast(TO_DATE(purc_purchase_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON (PURC_PURCHASE_TIME = t_time)\r\nJOIN s_purchase_lineitem ON (purc_purchase_id = plin_purchase_id)\r\nLEFT OUTER JOIN promotion ON plin_promotion_id = p_promo_id\r\nLEFT OUTER JOIN item ON plin_item_id = i_item_id\r\nWHERE\r\npurc_purchase_id = plin_purchase_id\r\nAND i_rec_end_date is NULL\r\nAND s_rec_end_date is NULL;\r\n\r\ninsert into store_sales select\r\nss_sold_date_sk,ss_sold_time_sk,  ss_item_sk,  ss_customer_sk,  ss_cdemo_sk,  ss_hdemo_sk,  ss_addr_sk,  ss_store_sk,  ss_promo_sk,  ss_ticket_number,  ss_quantity,  ss_wholesale_cost,  ss_list_price,  ss_sales_price,  ss_ext_discount_amt,  ss_ext_sales_price,  ss_ext_wholesale_cost,  ss_ext_list_price,  ss_ext_tax,  ss_coupon_amt,  ss_net_paid,  ss_net_paid_inc_tax,  ss_net_profit\r\nfrom ssv\r\n", 
                "oneline_sql": "", 
                "id": 5, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SS.sql", 
                "startTime": 1575595948.247272, 
                "secondFormat": "00:00:04", 
                "filename": "LF_SS.sql", 
                "isSuccess": true, 
                "template": "LF_SS.sql", 
                "sid": 5, 
                "endTime": 1575595953.238545
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:34", 
                "startTimeFormat": "2019-12-06 09:32:33", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WR.sql", 
                "oneline_sqlpath": "", 
                "second": 1.2817280292510986, 
                "key": "LF_WR", 
                "sql": "drop table wrv;\r\nCREATE table wrv AS\r\nSELECT d_date_sk wr_return_date_sk\r\n,t_time_sk wr_return_time_sk\r\n,i_item_sk wr_item_sk\r\n,c1.c_customer_sk wr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk wr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk wr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk wr_refunded_addr_sk\r\n,c2.c_customer_sk wr_returning_customer_sk\r\n,c2.c_current_cdemo_sk wr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk wr_returning_hdemo_sk\r\n,c2.c_current_addr_sk wr_returning_addr_sk\r\n,wp_web_page_sk wr_web_page_sk\r\n,r_reason_sk wr_reason_sk\r\n,wret_order_id wr_order_number\r\n,wret_return_qty wr_return_quantity\r\n,wret_return_amt wr_return_amt\r\n,wret_return_tax wr_return_tax\r\n,wret_return_amt + wret_return_tax AS wr_return_amt_inc_tax\r\n,wret_return_fee wr_fee\r\n,wret_return_ship_cost wr_return_ship_cost\r\n,wret_refunded_cash wr_refunded_cash\r\n,wret_reversed_charge wr_reversed_charge\r\n,wret_account_credit wr_account_credit\r\n,wret_return_amt+wret_return_tax+wret_return_fee\r\n-wret_refunded_cash-wret_reversed_charge-wret_account_credit wr_net_loss\r\nFROM s_web_returns LEFT OUTER JOIN date_dim ON (cast(TO_DATE(wret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON ((CAST(SUBSTR(wret_return_time,1,2) AS integer)*3600\r\n+CAST(SUBSTR(wret_return_time,4,2) AS integer)*60+CAST(SUBSTR(wret_return_time,7,2) AS integer))=t_time)\r\nLEFT OUTER JOIN item ON (wret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (wret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (wret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (wret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN web_page ON (wret_web_site_id = WP_WEB_PAGE_id)\r\nWHERE i_rec_end_date IS NULL AND wp_rec_end_date IS NULL;\r\n\r\ninsert into web_returns select\r\nwr_return_date_sk,wr_return_time_sk,wr_item_sk,wr_refunded_customer_sk,wr_refunded_cdemo_sk,wr_refunded_hdemo_sk,wr_refunded_addr_sk,wr_returning_customer_sk,wr_returning_cdemo_sk,wr_returning_hdemo_sk,wr_returning_addr_sk,wr_web_page_sk,wr_reason_sk,wr_order_number,wr_return_quantity,wr_return_amt,wr_return_tax,wr_return_amt_inc_tax,wr_fee,wr_return_ship_cost,wr_refunded_cash,wr_reversed_charge,wr_account_credit,wr_net_loss\r\nfrom wrv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 6, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WR.sql", 
                "startTime": 1575595953.238648, 
                "secondFormat": "00:00:01", 
                "filename": "LF_WR.sql", 
                "isSuccess": true, 
                "template": "LF_WR.sql", 
                "sid": 6, 
                "endTime": 1575595954.520376
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:35", 
                "startTimeFormat": "2019-12-06 09:32:34", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.7326619625091553, 
                "key": "LF_WS", 
                "sql": "drop table wsv;\r\nCREATE table wsv AS\r\nSELECT d1.d_date_sk ws_sold_date_sk,\r\nt_time_sk ws_sold_time_sk,\r\nd2.d_date_sk ws_ship_date_sk,\r\ni_item_sk ws_item_sk,\r\nc1.c_customer_sk ws_bill_customer_sk,\r\nc1.c_current_cdemo_sk ws_bill_cdemo_sk,\r\nc1.c_current_hdemo_sk ws_bill_hdemo_sk,\r\nc1.c_current_addr_sk ws_bill_addr_sk,\r\nc2.c_customer_sk ws_ship_customer_sk,\r\nc2.c_current_cdemo_sk ws_ship_cdemo_sk,\r\nc2.c_current_hdemo_sk ws_ship_hdemo_sk,\r\nc2.c_current_addr_sk ws_ship_addr_sk,\r\nwp_web_page_sk ws_web_page_sk,\r\nweb_site_sk ws_web_site_sk,\r\nsm_ship_mode_sk ws_ship_mode_sk,\r\nw_warehouse_sk ws_warehouse_sk,\r\np_promo_sk ws_promo_sk,\r\nword_order_id ws_order_number,\r\nwlin_quantity ws_quantity,\r\ni_wholesale_cost ws_wholesale_cost,\r\ni_current_price ws_list_price,\r\nwlin_sales_price ws_sales_price,\r\n(i_current_price-wlin_sales_price)*wlin_quantity ws_ext_discount_amt,\r\nwlin_sales_price * wlin_quantity ws_ext_sales_price,\r\ni_wholesale_cost * wlin_quantity ws_ext_wholesale_cost,\r\ni_current_price * wlin_quantity ws_ext_list_price,\r\ni_current_price * web_tax_percentage ws_ext_tax,\r\nwlin_coupon_amt ws_coupon_amt,\r\nwlin_ship_cost * wlin_quantity WS_EXT_SHIP_COST,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt ws_net_paid,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)*(1+web_tax_percentage) ws_net_paid_inc_tax,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(wlin_quantity*i_wholesale_cost)\r\nWS_NET_PAID_INC_SHIP,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt + (wlin_ship_cost * wlin_quantity)\r\n+ i_current_price * web_tax_percentage WS_NET_PAID_INC_SHIP_TAX,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(i_wholesale_cost * wlin_quantity)\r\nWS_NET_PROFIT\r\nFROM\r\ns_web_order\r\nLEFT OUTER JOIN date_dim d1 ON (cast(TO_DATE(word_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (word_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (word_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (word_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN web_site ON (word_web_site_id = web_site_id AND web_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (word_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_web_order_lineitem ON (word_order_id = wlin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON (cast(TO_DATE(wlin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN item ON (wlin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN web_page ON (wlin_web_page_id = wp_web_page_id AND wp_rec_end_date IS NULL)\r\nLEFT OUTER JOIN warehouse ON (wlin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN promotion ON (wlin_promotion_id = p_promo_id);\r\n\r\ninsert into web_sales select \r\n ws_sold_date_sk,ws_sold_time_sk, ws_ship_date_sk, ws_item_sk, ws_bill_customer_sk, ws_bill_cdemo_sk, ws_bill_hdemo_sk, ws_bill_addr_sk, ws_ship_customer_sk, ws_ship_cdemo_sk, ws_ship_hdemo_sk, ws_ship_addr_sk, ws_web_page_sk, ws_web_site_sk, ws_ship_mode_sk, ws_warehouse_sk, ws_promo_sk, ws_order_number, ws_quantity, ws_wholesale_cost, ws_list_price, ws_sales_price, ws_ext_discount_amt, ws_ext_sales_price, ws_ext_wholesale_cost, ws_ext_list_price, ws_ext_tax, ws_coupon_amt, ws_ext_ship_cost, ws_net_paid, ws_net_paid_inc_tax, ws_net_paid_inc_ship, ws_net_paid_inc_ship_tax, ws_net_profit\r\nfrom wsv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 7, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WS.sql", 
                "startTime": 1575595954.520498, 
                "secondFormat": "00:00:00", 
                "filename": "LF_WS.sql", 
                "isSuccess": true, 
                "template": "LF_WS.sql", 
                "sid": 7, 
                "endTime": 1575595955.25316
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:35", 
                "startTimeFormat": "2019-12-06 09:32:35", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.3806588649749756, 
                "key": "DF_CS", 
                "sql": "delete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >=  (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and cs_sold_date_sk <=  (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n\r\n", 
                "oneline_sql": "", 
                "id": 8, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_CS.sql", 
                "startTime": 1575595955.253271, 
                "secondFormat": "00:00:00", 
                "filename": "DF_CS.sql", 
                "isSuccess": true, 
                "template": "DF_CS.sql", 
                "sid": 8, 
                "endTime": 1575595955.63393
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:36", 
                "startTimeFormat": "2019-12-06 09:32:35", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.6567699909210205, 
                "key": "DF_SS", 
                "sql": "delete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk<= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 9, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_SS.sql", 
                "startTime": 1575595955.634046, 
                "secondFormat": "00:00:00", 
                "filename": "DF_SS.sql", 
                "isSuccess": true, 
                "template": "DF_SS.sql", 
                "sid": 9, 
                "endTime": 1575595956.290816
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:36", 
                "startTimeFormat": "2019-12-06 09:32:36", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.28369688987731934, 
                "key": "DF_WS", 
                "sql": "delete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\t ws_sold_date_sk <= (select max(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and \r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 10, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_WS.sql", 
                "startTime": 1575595956.290966, 
                "secondFormat": "00:00:00", 
                "filename": "DF_WS.sql", 
                "isSuccess": true, 
                "template": "DF_WS.sql", 
                "sid": 10, 
                "endTime": 1575595956.574663
            }, 
            {
                "endTimeFormat": "2019-12-06 09:32:37", 
                "startTimeFormat": "2019-12-06 09:32:36", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 0.7577619552612305, 
                "key": "DF_I", 
                "sql": "delete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd'))\r\n", 
                "oneline_sql": "", 
                "id": 11, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_I.sql", 
                "startTime": 1575595956.574767, 
                "secondFormat": "00:00:00", 
                "filename": "DF_I.sql", 
                "isSuccess": true, 
                "template": "DF_I.sql", 
                "sid": 11, 
                "endTime": 1575595957.332529
            }
        ], 
        "second": 15.819870948791504, 
        "startTime": 1575595941.512981, 
        "endTime": 1575595957.332852
    }, 
    "DataMaintenance2": {
        "endTimeFormat": "2019-12-06 09:29:44", 
        "startTimeFormat": "2019-12-06 09:29:23", 
        "secondFormat": "00:00:20", 
        "sqls": [
            {
                "endTimeFormat": "2019-12-06 09:29:27", 
                "startTimeFormat": "2019-12-06 09:29:23", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CR.sql", 
                "oneline_sqlpath": "", 
                "second": 4.016923904418945, 
                "key": "LF_CR", 
                "sql": "drop table crv;\r\nCREATE table crv as\r\nSELECT d_date_sk cr_return_date_sk\r\n,t_time_sk cr_return_time_sk\r\n,i_item_sk cr_item_sk\r\n,c1.c_customer_sk cr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk cr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk cr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk cr_refunded_addr_sk\r\n,c2.c_customer_sk cr_returning_customer_sk\r\n,c2.c_current_cdemo_sk cr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk cr_returning_hdemo_sk\r\n,c2.c_current_addr_sk cr_returning_addr_sk\r\n,cc_call_center_sk cr_call_center_sk\r\n,cp_catalog_page_sk CR_CATALOG_PAGE_SK\r\n,sm_ship_mode_sk CR_SHIP_MODE_SK\r\n,w_warehouse_sk CR_WAREHOUSE_SK\r\n,r_reason_sk cr_reason_sk\r\n,cret_order_id cr_order_number\r\n,cret_return_qty cr_return_quantity\r\n,cret_return_amt cr_return_amount\r\n,cret_return_tax cr_return_tax\r\n,cret_return_amt + cret_return_tax AS cr_return_amt_inc_tax\r\n,cret_return_fee cr_fee\r\n,cret_return_ship_cost cr_return_ship_cost\r\n,cret_refunded_cash cr_refunded_cash\r\n,cret_reversed_charge cr_reversed_charge\r\n,cret_merchant_credit cr_merchant_credit\r\n,cret_return_amt+cret_return_tax+cret_return_fee\r\n-cret_refunded_cash-cret_reversed_charge-cret_merchant_credit cr_net_loss\r\nFROM s_catalog_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(cret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON\r\n((CAST(substr(cret_return_time,1,2) AS integer)*3600\r\n+CAST(substr(cret_return_time,4,2) AS integer)*60\r\n+CAST(substr(cret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (cret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (cret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (cret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN call_center ON (cret_call_center_id = cc_call_center_id)\r\nLEFT OUTER JOIN catalog_page ON (cret_catalog_page_id = cp_catalog_page_id)\r\nLEFT OUTER JOIN ship_mode ON (cret_shipmode_id = sm_ship_mode_id)\r\nLEFT OUTER JOIN warehouse ON (cret_warehouse_id = w_warehouse_id)\r\nWHERE i_rec_end_date IS NULL AND cc_rec_end_date IS NULL;\r\n\r\ninsert into catalog_returns select\r\ncr_return_date_sk,cr_return_time_sk,cr_item_sk,cr_refunded_customer_sk,cr_refunded_cdemo_sk,cr_refunded_hdemo_sk,cr_refunded_addr_sk,cr_returning_customer_sk,cr_returning_cdemo_sk,cr_returning_hdemo_sk,cr_returning_addr_sk,cr_call_center_sk,cr_catalog_page_sk,cr_ship_mode_sk,cr_warehouse_sk,cr_reason_sk,cr_order_number,cr_return_quantity,cr_return_amount,cr_return_tax,cr_return_amt_inc_tax,cr_fee,cr_return_ship_cost,cr_refunded_cash,cr_reversed_charge,cr_merchant_credit,cr_net_loss\r\nfrom crv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 1, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CR.sql", 
                "startTime": 1575595763.802503, 
                "secondFormat": "00:00:04", 
                "filename": "LF_CR.sql", 
                "isSuccess": true, 
                "template": "LF_CR.sql", 
                "sid": 1, 
                "endTime": 1575595767.819427
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:32", 
                "startTimeFormat": "2019-12-06 09:29:27", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 5.077661991119385, 
                "key": "LF_CS", 
                "sql": "drop table csv;\r\nCREATE table csv as\r\nSELECT d1.d_date_sk cs_sold_date_sk\r\n,t_time_sk cs_sold_time_sk\r\n,d2.d_date_sk cs_ship_date_sk\r\n,c1.c_customer_sk cs_bill_customer_sk\r\n,c1.c_current_cdemo_sk cs_bill_cdemo_sk\r\n,c1.c_current_hdemo_sk cs_bill_hdemo_sk\r\n,c1.c_current_addr_sk cs_bill_addr_sk\r\n,c2.c_customer_sk cs_ship_customer_sk\r\n,c2.c_current_cdemo_sk cs_ship_cdemo_sk\r\n,c2.c_current_hdemo_sk cs_ship_hdemo_sk\r\n,c2.c_current_addr_sk cs_ship_addr_sk\r\n,cc_call_center_sk cs_call_center_sk\r\n,cp_catalog_page_sk cs_catalog_page_sk\r\n,sm_ship_mode_sk cs_ship_mode_sk\r\n,w_warehouse_sk cs_warehouse_sk\r\n,i_item_sk cs_item_sk\r\n,p_promo_sk cs_promo_sk\r\n,cord_order_id cs_order_number\r\n,clin_quantity cs_quantity\r\n,i_wholesale_cost cs_wholesale_cost\r\n,i_current_price cs_list_price\r\n,clin_sales_price cs_sales_price\r\n,(i_current_price-clin_sales_price)*clin_quantity cs_ext_discount_amt\r\n,clin_sales_price * clin_quantity cs_ext_sales_price\r\n,i_wholesale_cost * clin_quantity cs_ext_wholesale_cost\r\n,i_current_price * clin_quantity CS_EXT_LIST_PRICE\r\n,i_current_price * cc_tax_percentage CS_EXT_TAX\r\n,clin_coupon_amt cs_coupon_amt\r\n,clin_ship_cost * clin_quantity CS_EXT_SHIP_COST\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt cs_net_paid\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)*(1+cc_tax_percentage) cs_net_paid_inc_tax\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) CS_NET_PAID_INC_SHIP\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity)\r\n+ i_current_price * cc_tax_percentage CS_NET_PAID_INC_SHIP_TAX\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)-(clin_quantity*i_wholesale_cost) cs_net_profit\r\nFROM\r\ns_catalog_order\r\nLEFT OUTER JOIN date_dim d1 ON\r\n(cast(TO_DATE(cord_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (cord_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (cord_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cord_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN call_center ON (cord_call_center_id = cc_call_center_id AND cc_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (cord_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_catalog_order_lineitem ON (cord_order_id = clin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON\r\n(cast(TO_DATE(clin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN catalog_page ON\r\n(clin_catalog_page_number = cp_catalog_page_number and clin_catalog_number = cp_catalog_number)\r\nLEFT OUTER JOIN warehouse ON (clin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN item ON (clin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN promotion ON (clin_promotion_id = p_promo_id);\r\n\r\ninsert into catalog_sales select\r\n cs_sold_date_sk,cs_sold_time_sk,cs_ship_date_sk,cs_bill_customer_sk,cs_bill_cdemo_sk,cs_bill_hdemo_sk,cs_bill_addr_sk,cs_ship_customer_sk,cs_ship_cdemo_sk,cs_ship_hdemo_sk,cs_ship_addr_sk,cs_call_center_sk,cs_catalog_page_sk,cs_ship_mode_sk,cs_warehouse_sk,cs_item_sk,cs_promo_sk,cs_order_number,cs_quantity,cs_wholesale_cost,cs_list_price,cs_sales_price,cs_ext_discount_amt,cs_ext_sales_price,cs_ext_wholesale_cost,cs_ext_list_price,cs_ext_tax,cs_coupon_amt,cs_ext_ship_cost,cs_net_paid,cs_net_paid_inc_tax,cs_net_paid_inc_ship,cs_net_paid_inc_ship_tax,cs_net_profit\r\nfrom csv\r\n", 
                "oneline_sql": "", 
                "id": 2, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CS.sql", 
                "startTime": 1575595767.819525, 
                "secondFormat": "00:00:05", 
                "filename": "LF_CS.sql", 
                "isSuccess": true, 
                "template": "LF_CS.sql", 
                "sid": 2, 
                "endTime": 1575595772.897187
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:35", 
                "startTimeFormat": "2019-12-06 09:29:32", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 2.5330140590667725, 
                "key": "LF_I", 
                "sql": "drop table iv;\r\nCREATE table iv AS\r\nSELECT d_date_sk inv_date_sk,\r\ni_item_sk inv_item_sk,\r\nw_warehouse_sk inv_warehouse_sk,\r\ninvn_qty_on_hand inv_quantity_on_hand\r\nFROM s_inventory\r\nLEFT OUTER JOIN warehouse ON (invn_warehouse_id=w_warehouse_id)\r\nLEFT OUTER JOIN item ON (invn_item_id=i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN date_dim ON (d_date=CAST(TO_DATE(invn_date,'YYYY-MM-DD') AS DATE));\r\n\r\ninsert into inventory select\r\ninv_date_sk,inv_item_sk,inv_warehouse_sk,inv_quantity_on_hand\r\nfrom iv\r\n", 
                "oneline_sql": "", 
                "id": 3, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_I.sql", 
                "startTime": 1575595772.897291, 
                "secondFormat": "00:00:02", 
                "filename": "LF_I.sql", 
                "isSuccess": true, 
                "template": "LF_I.sql", 
                "sid": 3, 
                "endTime": 1575595775.430305
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:36", 
                "startTimeFormat": "2019-12-06 09:29:35", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SR.sql", 
                "oneline_sqlpath": "", 
                "second": 0.9220008850097656, 
                "key": "LF_SR", 
                "sql": "drop table srv;\r\nCREATE table srv as\r\nSELECT d_date_sk sr_returned_date_sk\r\n,t_time_sk sr_return_time_sk\r\n,i_item_sk sr_item_sk\r\n,c_customer_sk sr_customer_sk\r\n,c_current_cdemo_sk sr_cdemo_sk\r\n,c_current_hdemo_sk sr_hdemo_sk\r\n,c_current_addr_sk sr_addr_sk\r\n,s_store_sk sr_store_sk\r\n,r_reason_sk sr_reason_sk\r\n,sret_ticket_number sr_ticket_number\r\n,sret_return_qty sr_return_quantity\r\n,sret_return_amt sr_return_amt\r\n,sret_return_tax sr_return_tax\r\n,sret_return_amt + sret_return_tax sr_return_amt_inc_tax\r\n,sret_return_fee sr_fee\r\n,sret_return_ship_cost sr_return_ship_cost\r\n,sret_refunded_cash sr_refunded_cash\r\n,sret_reversed_charge sr_reversed_charge\r\n,sret_store_credit sr_store_credit\r\n,sret_return_amt+sret_return_tax+sret_return_fee\r\n-sret_refunded_cash-sret_reversed_charge-sret_store_credit sr_net_loss\r\nFROM s_store_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(sret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim\r\nON (( cast(substr(sret_return_time,1,2) AS integer)*3600\r\n+cast(substr(sret_return_time,4,2) AS integer)*60\r\n+cast(substr(sret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (sret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer ON (sret_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (sret_store_id = s_store_id)\r\nLEFT OUTER JOIN reason ON (sret_reason_id = r_reason_id)\r\nWHERE i_rec_end_date IS NULL\r\nAND s_rec_end_date IS NULL;\r\n\r\ninsert into store_returns select\r\nsr_returned_date_sk,sr_return_time_sk,sr_item_sk,sr_customer_sk,sr_cdemo_sk,sr_hdemo_sk,sr_addr_sk,sr_store_sk,sr_reason_sk,sr_ticket_number,sr_return_quantity,sr_return_amt,sr_return_tax,sr_return_amt_inc_tax,sr_fee,sr_return_ship_cost,sr_refunded_cash,sr_reversed_charge,sr_store_credit,sr_net_loss\r\nfrom srv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 4, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SR.sql", 
                "startTime": 1575595775.430407, 
                "secondFormat": "00:00:00", 
                "filename": "LF_SR.sql", 
                "isSuccess": true, 
                "template": "LF_SR.sql", 
                "sid": 4, 
                "endTime": 1575595776.352408
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:38", 
                "startTimeFormat": "2019-12-06 09:29:36", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 2.2043139934539795, 
                "key": "LF_SS", 
                "sql": "drop table ssv;\r\nCREATE table ssv as\r\nSELECT d_date_sk ss_sold_date_sk,\r\nt_time_sk ss_sold_time_sk,\r\ni_item_sk ss_item_sk,\r\nc_customer_sk ss_customer_sk,\r\nc_current_cdemo_sk ss_cdemo_sk,\r\nc_current_hdemo_sk ss_hdemo_sk,\r\nc_current_addr_sk ss_addr_sk,\r\ns_store_sk ss_store_sk,\r\np_promo_sk ss_promo_sk,\r\npurc_purchase_id ss_ticket_number,\r\nplin_quantity ss_quantity,\r\ni_wholesale_cost ss_wholesale_cost,\r\ni_current_price ss_list_price,\r\nplin_sale_price ss_sales_price,\r\n(i_current_price-plin_sale_price)*plin_quantity ss_ext_discount_amt,\r\nplin_sale_price * plin_quantity ss_ext_sales_price,\r\ni_wholesale_cost * plin_quantity ss_ext_wholesale_cost,\r\ni_current_price * plin_quantity ss_ext_list_price,\r\ni_current_price * s_tax_precentage ss_ext_tax,\r\nplin_coupon_amt ss_coupon_amt,\r\n(plin_sale_price * plin_quantity)-plin_coupon_amt ss_net_paid,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)*(1+s_tax_precentage) ss_net_paid_inc_tax,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)-(plin_quantity*i_wholesale_cost)\r\nss_net_profit\r\nFROM\r\ns_purchase\r\nLEFT OUTER JOIN customer ON (purc_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (purc_store_id = s_store_id)\r\nLEFT OUTER JOIN date_dim ON (cast(TO_DATE(purc_purchase_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON (PURC_PURCHASE_TIME = t_time)\r\nJOIN s_purchase_lineitem ON (purc_purchase_id = plin_purchase_id)\r\nLEFT OUTER JOIN promotion ON plin_promotion_id = p_promo_id\r\nLEFT OUTER JOIN item ON plin_item_id = i_item_id\r\nWHERE\r\npurc_purchase_id = plin_purchase_id\r\nAND i_rec_end_date is NULL\r\nAND s_rec_end_date is NULL;\r\n\r\ninsert into store_sales select\r\nss_sold_date_sk,ss_sold_time_sk,  ss_item_sk,  ss_customer_sk,  ss_cdemo_sk,  ss_hdemo_sk,  ss_addr_sk,  ss_store_sk,  ss_promo_sk,  ss_ticket_number,  ss_quantity,  ss_wholesale_cost,  ss_list_price,  ss_sales_price,  ss_ext_discount_amt,  ss_ext_sales_price,  ss_ext_wholesale_cost,  ss_ext_list_price,  ss_ext_tax,  ss_coupon_amt,  ss_net_paid,  ss_net_paid_inc_tax,  ss_net_profit\r\nfrom ssv\r\n", 
                "oneline_sql": "", 
                "id": 5, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SS.sql", 
                "startTime": 1575595776.352496, 
                "secondFormat": "00:00:02", 
                "filename": "LF_SS.sql", 
                "isSuccess": true, 
                "template": "LF_SS.sql", 
                "sid": 5, 
                "endTime": 1575595778.55681
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:40", 
                "startTimeFormat": "2019-12-06 09:29:38", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WR.sql", 
                "oneline_sqlpath": "", 
                "second": 1.7753429412841797, 
                "key": "LF_WR", 
                "sql": "drop table wrv;\r\nCREATE table wrv AS\r\nSELECT d_date_sk wr_return_date_sk\r\n,t_time_sk wr_return_time_sk\r\n,i_item_sk wr_item_sk\r\n,c1.c_customer_sk wr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk wr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk wr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk wr_refunded_addr_sk\r\n,c2.c_customer_sk wr_returning_customer_sk\r\n,c2.c_current_cdemo_sk wr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk wr_returning_hdemo_sk\r\n,c2.c_current_addr_sk wr_returning_addr_sk\r\n,wp_web_page_sk wr_web_page_sk\r\n,r_reason_sk wr_reason_sk\r\n,wret_order_id wr_order_number\r\n,wret_return_qty wr_return_quantity\r\n,wret_return_amt wr_return_amt\r\n,wret_return_tax wr_return_tax\r\n,wret_return_amt + wret_return_tax AS wr_return_amt_inc_tax\r\n,wret_return_fee wr_fee\r\n,wret_return_ship_cost wr_return_ship_cost\r\n,wret_refunded_cash wr_refunded_cash\r\n,wret_reversed_charge wr_reversed_charge\r\n,wret_account_credit wr_account_credit\r\n,wret_return_amt+wret_return_tax+wret_return_fee\r\n-wret_refunded_cash-wret_reversed_charge-wret_account_credit wr_net_loss\r\nFROM s_web_returns LEFT OUTER JOIN date_dim ON (cast(TO_DATE(wret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON ((CAST(SUBSTR(wret_return_time,1,2) AS integer)*3600\r\n+CAST(SUBSTR(wret_return_time,4,2) AS integer)*60+CAST(SUBSTR(wret_return_time,7,2) AS integer))=t_time)\r\nLEFT OUTER JOIN item ON (wret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (wret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (wret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (wret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN web_page ON (wret_web_site_id = WP_WEB_PAGE_id)\r\nWHERE i_rec_end_date IS NULL AND wp_rec_end_date IS NULL;\r\n\r\ninsert into web_returns select\r\nwr_return_date_sk,wr_return_time_sk,wr_item_sk,wr_refunded_customer_sk,wr_refunded_cdemo_sk,wr_refunded_hdemo_sk,wr_refunded_addr_sk,wr_returning_customer_sk,wr_returning_cdemo_sk,wr_returning_hdemo_sk,wr_returning_addr_sk,wr_web_page_sk,wr_reason_sk,wr_order_number,wr_return_quantity,wr_return_amt,wr_return_tax,wr_return_amt_inc_tax,wr_fee,wr_return_ship_cost,wr_refunded_cash,wr_reversed_charge,wr_account_credit,wr_net_loss\r\nfrom wrv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 6, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WR.sql", 
                "startTime": 1575595778.556929, 
                "secondFormat": "00:00:01", 
                "filename": "LF_WR.sql", 
                "isSuccess": true, 
                "template": "LF_WR.sql", 
                "sid": 6, 
                "endTime": 1575595780.332272
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:42", 
                "startTimeFormat": "2019-12-06 09:29:40", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 1.7583439350128174, 
                "key": "LF_WS", 
                "sql": "drop table wsv;\r\nCREATE table wsv AS\r\nSELECT d1.d_date_sk ws_sold_date_sk,\r\nt_time_sk ws_sold_time_sk,\r\nd2.d_date_sk ws_ship_date_sk,\r\ni_item_sk ws_item_sk,\r\nc1.c_customer_sk ws_bill_customer_sk,\r\nc1.c_current_cdemo_sk ws_bill_cdemo_sk,\r\nc1.c_current_hdemo_sk ws_bill_hdemo_sk,\r\nc1.c_current_addr_sk ws_bill_addr_sk,\r\nc2.c_customer_sk ws_ship_customer_sk,\r\nc2.c_current_cdemo_sk ws_ship_cdemo_sk,\r\nc2.c_current_hdemo_sk ws_ship_hdemo_sk,\r\nc2.c_current_addr_sk ws_ship_addr_sk,\r\nwp_web_page_sk ws_web_page_sk,\r\nweb_site_sk ws_web_site_sk,\r\nsm_ship_mode_sk ws_ship_mode_sk,\r\nw_warehouse_sk ws_warehouse_sk,\r\np_promo_sk ws_promo_sk,\r\nword_order_id ws_order_number,\r\nwlin_quantity ws_quantity,\r\ni_wholesale_cost ws_wholesale_cost,\r\ni_current_price ws_list_price,\r\nwlin_sales_price ws_sales_price,\r\n(i_current_price-wlin_sales_price)*wlin_quantity ws_ext_discount_amt,\r\nwlin_sales_price * wlin_quantity ws_ext_sales_price,\r\ni_wholesale_cost * wlin_quantity ws_ext_wholesale_cost,\r\ni_current_price * wlin_quantity ws_ext_list_price,\r\ni_current_price * web_tax_percentage ws_ext_tax,\r\nwlin_coupon_amt ws_coupon_amt,\r\nwlin_ship_cost * wlin_quantity WS_EXT_SHIP_COST,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt ws_net_paid,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)*(1+web_tax_percentage) ws_net_paid_inc_tax,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(wlin_quantity*i_wholesale_cost)\r\nWS_NET_PAID_INC_SHIP,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt + (wlin_ship_cost * wlin_quantity)\r\n+ i_current_price * web_tax_percentage WS_NET_PAID_INC_SHIP_TAX,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(i_wholesale_cost * wlin_quantity)\r\nWS_NET_PROFIT\r\nFROM\r\ns_web_order\r\nLEFT OUTER JOIN date_dim d1 ON (cast(TO_DATE(word_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (word_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (word_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (word_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN web_site ON (word_web_site_id = web_site_id AND web_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (word_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_web_order_lineitem ON (word_order_id = wlin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON (cast(TO_DATE(wlin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN item ON (wlin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN web_page ON (wlin_web_page_id = wp_web_page_id AND wp_rec_end_date IS NULL)\r\nLEFT OUTER JOIN warehouse ON (wlin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN promotion ON (wlin_promotion_id = p_promo_id);\r\n\r\ninsert into web_sales select \r\n ws_sold_date_sk,ws_sold_time_sk, ws_ship_date_sk, ws_item_sk, ws_bill_customer_sk, ws_bill_cdemo_sk, ws_bill_hdemo_sk, ws_bill_addr_sk, ws_ship_customer_sk, ws_ship_cdemo_sk, ws_ship_hdemo_sk, ws_ship_addr_sk, ws_web_page_sk, ws_web_site_sk, ws_ship_mode_sk, ws_warehouse_sk, ws_promo_sk, ws_order_number, ws_quantity, ws_wholesale_cost, ws_list_price, ws_sales_price, ws_ext_discount_amt, ws_ext_sales_price, ws_ext_wholesale_cost, ws_ext_list_price, ws_ext_tax, ws_coupon_amt, ws_ext_ship_cost, ws_net_paid, ws_net_paid_inc_tax, ws_net_paid_inc_ship, ws_net_paid_inc_ship_tax, ws_net_profit\r\nfrom wsv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 7, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WS.sql", 
                "startTime": 1575595780.332376, 
                "secondFormat": "00:00:01", 
                "filename": "LF_WS.sql", 
                "isSuccess": true, 
                "template": "LF_WS.sql", 
                "sid": 7, 
                "endTime": 1575595782.09072
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:42", 
                "startTimeFormat": "2019-12-06 09:29:42", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.3607170581817627, 
                "key": "DF_CS", 
                "sql": "delete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >=  (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and cs_sold_date_sk <=  (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n\r\n", 
                "oneline_sql": "", 
                "id": 8, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_CS.sql", 
                "startTime": 1575595782.090818, 
                "secondFormat": "00:00:00", 
                "filename": "DF_CS.sql", 
                "isSuccess": true, 
                "template": "DF_CS.sql", 
                "sid": 8, 
                "endTime": 1575595782.451535
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:43", 
                "startTimeFormat": "2019-12-06 09:29:42", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.5942599773406982, 
                "key": "DF_SS", 
                "sql": "delete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk<= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 9, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_SS.sql", 
                "startTime": 1575595782.451642, 
                "secondFormat": "00:00:00", 
                "filename": "DF_SS.sql", 
                "isSuccess": true, 
                "template": "DF_SS.sql", 
                "sid": 9, 
                "endTime": 1575595783.045902
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:43", 
                "startTimeFormat": "2019-12-06 09:29:43", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.2770349979400635, 
                "key": "DF_WS", 
                "sql": "delete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\t ws_sold_date_sk <= (select max(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and \r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 10, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_WS.sql", 
                "startTime": 1575595783.046017, 
                "secondFormat": "00:00:00", 
                "filename": "DF_WS.sql", 
                "isSuccess": true, 
                "template": "DF_WS.sql", 
                "sid": 10, 
                "endTime": 1575595783.323052
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:44", 
                "startTimeFormat": "2019-12-06 09:29:43", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 0.7129940986633301, 
                "key": "DF_I", 
                "sql": "delete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd'))\r\n", 
                "oneline_sql": "", 
                "id": 11, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_I.sql", 
                "startTime": 1575595783.323171, 
                "secondFormat": "00:00:00", 
                "filename": "DF_I.sql", 
                "isSuccess": true, 
                "template": "DF_I.sql", 
                "sid": 11, 
                "endTime": 1575595784.036165
            }
        ], 
        "second": 20.234195947647095, 
        "startTime": 1575595763.802298, 
        "endTime": 1575595784.036494
    }, 
    "DataMaintenance1": {
        "endTimeFormat": "2019-12-06 09:29:23", 
        "startTimeFormat": "2019-12-06 09:27:42", 
        "secondFormat": "00:01:41", 
        "sqls": [
            {
                "endTimeFormat": "2019-12-06 09:27:59", 
                "startTimeFormat": "2019-12-06 09:27:42", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CR.sql", 
                "oneline_sqlpath": "", 
                "second": 17.039595127105713, 
                "key": "LF_CR", 
                "sql": "drop table crv;\r\nCREATE table crv as\r\nSELECT d_date_sk cr_return_date_sk\r\n,t_time_sk cr_return_time_sk\r\n,i_item_sk cr_item_sk\r\n,c1.c_customer_sk cr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk cr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk cr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk cr_refunded_addr_sk\r\n,c2.c_customer_sk cr_returning_customer_sk\r\n,c2.c_current_cdemo_sk cr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk cr_returning_hdemo_sk\r\n,c2.c_current_addr_sk cr_returning_addr_sk\r\n,cc_call_center_sk cr_call_center_sk\r\n,cp_catalog_page_sk CR_CATALOG_PAGE_SK\r\n,sm_ship_mode_sk CR_SHIP_MODE_SK\r\n,w_warehouse_sk CR_WAREHOUSE_SK\r\n,r_reason_sk cr_reason_sk\r\n,cret_order_id cr_order_number\r\n,cret_return_qty cr_return_quantity\r\n,cret_return_amt cr_return_amount\r\n,cret_return_tax cr_return_tax\r\n,cret_return_amt + cret_return_tax AS cr_return_amt_inc_tax\r\n,cret_return_fee cr_fee\r\n,cret_return_ship_cost cr_return_ship_cost\r\n,cret_refunded_cash cr_refunded_cash\r\n,cret_reversed_charge cr_reversed_charge\r\n,cret_merchant_credit cr_merchant_credit\r\n,cret_return_amt+cret_return_tax+cret_return_fee\r\n-cret_refunded_cash-cret_reversed_charge-cret_merchant_credit cr_net_loss\r\nFROM s_catalog_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(cret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON\r\n((CAST(substr(cret_return_time,1,2) AS integer)*3600\r\n+CAST(substr(cret_return_time,4,2) AS integer)*60\r\n+CAST(substr(cret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (cret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (cret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (cret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN call_center ON (cret_call_center_id = cc_call_center_id)\r\nLEFT OUTER JOIN catalog_page ON (cret_catalog_page_id = cp_catalog_page_id)\r\nLEFT OUTER JOIN ship_mode ON (cret_shipmode_id = sm_ship_mode_id)\r\nLEFT OUTER JOIN warehouse ON (cret_warehouse_id = w_warehouse_id)\r\nWHERE i_rec_end_date IS NULL AND cc_rec_end_date IS NULL;\r\n\r\ninsert into catalog_returns select\r\ncr_return_date_sk,cr_return_time_sk,cr_item_sk,cr_refunded_customer_sk,cr_refunded_cdemo_sk,cr_refunded_hdemo_sk,cr_refunded_addr_sk,cr_returning_customer_sk,cr_returning_cdemo_sk,cr_returning_hdemo_sk,cr_returning_addr_sk,cr_call_center_sk,cr_catalog_page_sk,cr_ship_mode_sk,cr_warehouse_sk,cr_reason_sk,cr_order_number,cr_return_quantity,cr_return_amount,cr_return_tax,cr_return_amt_inc_tax,cr_fee,cr_return_ship_cost,cr_refunded_cash,cr_reversed_charge,cr_merchant_credit,cr_net_loss\r\nfrom crv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 1, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CR.sql", 
                "startTime": 1575595662.371419, 
                "secondFormat": "00:00:17", 
                "filename": "LF_CR.sql", 
                "isSuccess": true, 
                "template": "LF_CR.sql", 
                "sid": 1, 
                "endTime": 1575595679.411014
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:12", 
                "startTimeFormat": "2019-12-06 09:27:59", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 12.65525197982788, 
                "key": "LF_CS", 
                "sql": "drop table csv;\r\nCREATE table csv as\r\nSELECT d1.d_date_sk cs_sold_date_sk\r\n,t_time_sk cs_sold_time_sk\r\n,d2.d_date_sk cs_ship_date_sk\r\n,c1.c_customer_sk cs_bill_customer_sk\r\n,c1.c_current_cdemo_sk cs_bill_cdemo_sk\r\n,c1.c_current_hdemo_sk cs_bill_hdemo_sk\r\n,c1.c_current_addr_sk cs_bill_addr_sk\r\n,c2.c_customer_sk cs_ship_customer_sk\r\n,c2.c_current_cdemo_sk cs_ship_cdemo_sk\r\n,c2.c_current_hdemo_sk cs_ship_hdemo_sk\r\n,c2.c_current_addr_sk cs_ship_addr_sk\r\n,cc_call_center_sk cs_call_center_sk\r\n,cp_catalog_page_sk cs_catalog_page_sk\r\n,sm_ship_mode_sk cs_ship_mode_sk\r\n,w_warehouse_sk cs_warehouse_sk\r\n,i_item_sk cs_item_sk\r\n,p_promo_sk cs_promo_sk\r\n,cord_order_id cs_order_number\r\n,clin_quantity cs_quantity\r\n,i_wholesale_cost cs_wholesale_cost\r\n,i_current_price cs_list_price\r\n,clin_sales_price cs_sales_price\r\n,(i_current_price-clin_sales_price)*clin_quantity cs_ext_discount_amt\r\n,clin_sales_price * clin_quantity cs_ext_sales_price\r\n,i_wholesale_cost * clin_quantity cs_ext_wholesale_cost\r\n,i_current_price * clin_quantity CS_EXT_LIST_PRICE\r\n,i_current_price * cc_tax_percentage CS_EXT_TAX\r\n,clin_coupon_amt cs_coupon_amt\r\n,clin_ship_cost * clin_quantity CS_EXT_SHIP_COST\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt cs_net_paid\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)*(1+cc_tax_percentage) cs_net_paid_inc_tax\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) CS_NET_PAID_INC_SHIP\r\n,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity)\r\n+ i_current_price * cc_tax_percentage CS_NET_PAID_INC_SHIP_TAX\r\n,((clin_sales_price * clin_quantity)-clin_coupon_amt)-(clin_quantity*i_wholesale_cost) cs_net_profit\r\nFROM\r\ns_catalog_order\r\nLEFT OUTER JOIN date_dim d1 ON\r\n(cast(TO_DATE(cord_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (cord_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (cord_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (cord_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN call_center ON (cord_call_center_id = cc_call_center_id AND cc_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (cord_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_catalog_order_lineitem ON (cord_order_id = clin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON\r\n(cast(TO_DATE(clin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN catalog_page ON\r\n(clin_catalog_page_number = cp_catalog_page_number and clin_catalog_number = cp_catalog_number)\r\nLEFT OUTER JOIN warehouse ON (clin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN item ON (clin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN promotion ON (clin_promotion_id = p_promo_id);\r\n\r\ninsert into catalog_sales select\r\n cs_sold_date_sk,cs_sold_time_sk,cs_ship_date_sk,cs_bill_customer_sk,cs_bill_cdemo_sk,cs_bill_hdemo_sk,cs_bill_addr_sk,cs_ship_customer_sk,cs_ship_cdemo_sk,cs_ship_hdemo_sk,cs_ship_addr_sk,cs_call_center_sk,cs_catalog_page_sk,cs_ship_mode_sk,cs_warehouse_sk,cs_item_sk,cs_promo_sk,cs_order_number,cs_quantity,cs_wholesale_cost,cs_list_price,cs_sales_price,cs_ext_discount_amt,cs_ext_sales_price,cs_ext_wholesale_cost,cs_ext_list_price,cs_ext_tax,cs_coupon_amt,cs_ext_ship_cost,cs_net_paid,cs_net_paid_inc_tax,cs_net_paid_inc_ship,cs_net_paid_inc_ship_tax,cs_net_profit\r\nfrom csv\r\n", 
                "oneline_sql": "", 
                "id": 2, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_CS.sql", 
                "startTime": 1575595679.411112, 
                "secondFormat": "00:00:12", 
                "filename": "LF_CS.sql", 
                "isSuccess": true, 
                "template": "LF_CS.sql", 
                "sid": 2, 
                "endTime": 1575595692.066364
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:25", 
                "startTimeFormat": "2019-12-06 09:28:12", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 13.648940086364746, 
                "key": "LF_I", 
                "sql": "drop table iv;\r\nCREATE table iv AS\r\nSELECT d_date_sk inv_date_sk,\r\ni_item_sk inv_item_sk,\r\nw_warehouse_sk inv_warehouse_sk,\r\ninvn_qty_on_hand inv_quantity_on_hand\r\nFROM s_inventory\r\nLEFT OUTER JOIN warehouse ON (invn_warehouse_id=w_warehouse_id)\r\nLEFT OUTER JOIN item ON (invn_item_id=i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN date_dim ON (d_date=CAST(TO_DATE(invn_date,'YYYY-MM-DD') AS DATE));\r\n\r\ninsert into inventory select\r\ninv_date_sk,inv_item_sk,inv_warehouse_sk,inv_quantity_on_hand\r\nfrom iv\r\n", 
                "oneline_sql": "", 
                "id": 3, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_I.sql", 
                "startTime": 1575595692.066464, 
                "secondFormat": "00:00:13", 
                "filename": "LF_I.sql", 
                "isSuccess": true, 
                "template": "LF_I.sql", 
                "sid": 3, 
                "endTime": 1575595705.715404
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:32", 
                "startTimeFormat": "2019-12-06 09:28:25", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SR.sql", 
                "oneline_sqlpath": "", 
                "second": 6.511499881744385, 
                "key": "LF_SR", 
                "sql": "drop table srv;\r\nCREATE table srv as\r\nSELECT d_date_sk sr_returned_date_sk\r\n,t_time_sk sr_return_time_sk\r\n,i_item_sk sr_item_sk\r\n,c_customer_sk sr_customer_sk\r\n,c_current_cdemo_sk sr_cdemo_sk\r\n,c_current_hdemo_sk sr_hdemo_sk\r\n,c_current_addr_sk sr_addr_sk\r\n,s_store_sk sr_store_sk\r\n,r_reason_sk sr_reason_sk\r\n,sret_ticket_number sr_ticket_number\r\n,sret_return_qty sr_return_quantity\r\n,sret_return_amt sr_return_amt\r\n,sret_return_tax sr_return_tax\r\n,sret_return_amt + sret_return_tax sr_return_amt_inc_tax\r\n,sret_return_fee sr_fee\r\n,sret_return_ship_cost sr_return_ship_cost\r\n,sret_refunded_cash sr_refunded_cash\r\n,sret_reversed_charge sr_reversed_charge\r\n,sret_store_credit sr_store_credit\r\n,sret_return_amt+sret_return_tax+sret_return_fee\r\n-sret_refunded_cash-sret_reversed_charge-sret_store_credit sr_net_loss\r\nFROM s_store_returns\r\nLEFT OUTER JOIN date_dim\r\nON (cast(TO_DATE(sret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim\r\nON (( cast(substr(sret_return_time,1,2) AS integer)*3600\r\n+cast(substr(sret_return_time,4,2) AS integer)*60\r\n+cast(substr(sret_return_time,7,2) AS integer)) = t_time)\r\nLEFT OUTER JOIN item ON (sret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer ON (sret_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (sret_store_id = s_store_id)\r\nLEFT OUTER JOIN reason ON (sret_reason_id = r_reason_id)\r\nWHERE i_rec_end_date IS NULL\r\nAND s_rec_end_date IS NULL;\r\n\r\ninsert into store_returns select\r\nsr_returned_date_sk,sr_return_time_sk,sr_item_sk,sr_customer_sk,sr_cdemo_sk,sr_hdemo_sk,sr_addr_sk,sr_store_sk,sr_reason_sk,sr_ticket_number,sr_return_quantity,sr_return_amt,sr_return_tax,sr_return_amt_inc_tax,sr_fee,sr_return_ship_cost,sr_refunded_cash,sr_reversed_charge,sr_store_credit,sr_net_loss\r\nfrom srv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 4, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SR.sql", 
                "startTime": 1575595705.715502, 
                "secondFormat": "00:00:06", 
                "filename": "LF_SR.sql", 
                "isSuccess": true, 
                "template": "LF_SR.sql", 
                "sid": 4, 
                "endTime": 1575595712.227002
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:41", 
                "startTimeFormat": "2019-12-06 09:28:32", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 9.073148965835571, 
                "key": "LF_SS", 
                "sql": "drop table ssv;\r\nCREATE table ssv as\r\nSELECT d_date_sk ss_sold_date_sk,\r\nt_time_sk ss_sold_time_sk,\r\ni_item_sk ss_item_sk,\r\nc_customer_sk ss_customer_sk,\r\nc_current_cdemo_sk ss_cdemo_sk,\r\nc_current_hdemo_sk ss_hdemo_sk,\r\nc_current_addr_sk ss_addr_sk,\r\ns_store_sk ss_store_sk,\r\np_promo_sk ss_promo_sk,\r\npurc_purchase_id ss_ticket_number,\r\nplin_quantity ss_quantity,\r\ni_wholesale_cost ss_wholesale_cost,\r\ni_current_price ss_list_price,\r\nplin_sale_price ss_sales_price,\r\n(i_current_price-plin_sale_price)*plin_quantity ss_ext_discount_amt,\r\nplin_sale_price * plin_quantity ss_ext_sales_price,\r\ni_wholesale_cost * plin_quantity ss_ext_wholesale_cost,\r\ni_current_price * plin_quantity ss_ext_list_price,\r\ni_current_price * s_tax_precentage ss_ext_tax,\r\nplin_coupon_amt ss_coupon_amt,\r\n(plin_sale_price * plin_quantity)-plin_coupon_amt ss_net_paid,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)*(1+s_tax_precentage) ss_net_paid_inc_tax,\r\n((plin_sale_price * plin_quantity)-plin_coupon_amt)-(plin_quantity*i_wholesale_cost)\r\nss_net_profit\r\nFROM\r\ns_purchase\r\nLEFT OUTER JOIN customer ON (purc_customer_id = c_customer_id)\r\nLEFT OUTER JOIN store ON (purc_store_id = s_store_id)\r\nLEFT OUTER JOIN date_dim ON (cast(TO_DATE(purc_purchase_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON (PURC_PURCHASE_TIME = t_time)\r\nJOIN s_purchase_lineitem ON (purc_purchase_id = plin_purchase_id)\r\nLEFT OUTER JOIN promotion ON plin_promotion_id = p_promo_id\r\nLEFT OUTER JOIN item ON plin_item_id = i_item_id\r\nWHERE\r\npurc_purchase_id = plin_purchase_id\r\nAND i_rec_end_date is NULL\r\nAND s_rec_end_date is NULL;\r\n\r\ninsert into store_sales select\r\nss_sold_date_sk,ss_sold_time_sk,  ss_item_sk,  ss_customer_sk,  ss_cdemo_sk,  ss_hdemo_sk,  ss_addr_sk,  ss_store_sk,  ss_promo_sk,  ss_ticket_number,  ss_quantity,  ss_wholesale_cost,  ss_list_price,  ss_sales_price,  ss_ext_discount_amt,  ss_ext_sales_price,  ss_ext_wholesale_cost,  ss_ext_list_price,  ss_ext_tax,  ss_coupon_amt,  ss_net_paid,  ss_net_paid_inc_tax,  ss_net_profit\r\nfrom ssv\r\n", 
                "oneline_sql": "", 
                "id": 5, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_SS.sql", 
                "startTime": 1575595712.227107, 
                "secondFormat": "00:00:09", 
                "filename": "LF_SS.sql", 
                "isSuccess": true, 
                "template": "LF_SS.sql", 
                "sid": 5, 
                "endTime": 1575595721.300256
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:50", 
                "startTimeFormat": "2019-12-06 09:28:41", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WR.sql", 
                "oneline_sqlpath": "", 
                "second": 8.898741960525513, 
                "key": "LF_WR", 
                "sql": "drop table wrv;\r\nCREATE table wrv AS\r\nSELECT d_date_sk wr_return_date_sk\r\n,t_time_sk wr_return_time_sk\r\n,i_item_sk wr_item_sk\r\n,c1.c_customer_sk wr_refunded_customer_sk\r\n,c1.c_current_cdemo_sk wr_refunded_cdemo_sk\r\n,c1.c_current_hdemo_sk wr_refunded_hdemo_sk\r\n,c1.c_current_addr_sk wr_refunded_addr_sk\r\n,c2.c_customer_sk wr_returning_customer_sk\r\n,c2.c_current_cdemo_sk wr_returning_cdemo_sk\r\n,c2.c_current_hdemo_sk wr_returning_hdemo_sk\r\n,c2.c_current_addr_sk wr_returning_addr_sk\r\n,wp_web_page_sk wr_web_page_sk\r\n,r_reason_sk wr_reason_sk\r\n,wret_order_id wr_order_number\r\n,wret_return_qty wr_return_quantity\r\n,wret_return_amt wr_return_amt\r\n,wret_return_tax wr_return_tax\r\n,wret_return_amt + wret_return_tax AS wr_return_amt_inc_tax\r\n,wret_return_fee wr_fee\r\n,wret_return_ship_cost wr_return_ship_cost\r\n,wret_refunded_cash wr_refunded_cash\r\n,wret_reversed_charge wr_reversed_charge\r\n,wret_account_credit wr_account_credit\r\n,wret_return_amt+wret_return_tax+wret_return_fee\r\n-wret_refunded_cash-wret_reversed_charge-wret_account_credit wr_net_loss\r\nFROM s_web_returns LEFT OUTER JOIN date_dim ON (cast(TO_DATE(wret_return_date, 'YYYY-MM-DD') as date) = d_date)\r\nLEFT OUTER JOIN time_dim ON ((CAST(SUBSTR(wret_return_time,1,2) AS integer)*3600\r\n+CAST(SUBSTR(wret_return_time,4,2) AS integer)*60+CAST(SUBSTR(wret_return_time,7,2) AS integer))=t_time)\r\nLEFT OUTER JOIN item ON (wret_item_id = i_item_id)\r\nLEFT OUTER JOIN customer c1 ON (wret_return_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (wret_refund_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN reason ON (wret_reason_id = r_reason_id)\r\nLEFT OUTER JOIN web_page ON (wret_web_site_id = WP_WEB_PAGE_id)\r\nWHERE i_rec_end_date IS NULL AND wp_rec_end_date IS NULL;\r\n\r\ninsert into web_returns select\r\nwr_return_date_sk,wr_return_time_sk,wr_item_sk,wr_refunded_customer_sk,wr_refunded_cdemo_sk,wr_refunded_hdemo_sk,wr_refunded_addr_sk,wr_returning_customer_sk,wr_returning_cdemo_sk,wr_returning_hdemo_sk,wr_returning_addr_sk,wr_web_page_sk,wr_reason_sk,wr_order_number,wr_return_quantity,wr_return_amt,wr_return_tax,wr_return_amt_inc_tax,wr_fee,wr_return_ship_cost,wr_refunded_cash,wr_reversed_charge,wr_account_credit,wr_net_loss\r\nfrom wrv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 6, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WR.sql", 
                "startTime": 1575595721.300358, 
                "secondFormat": "00:00:08", 
                "filename": "LF_WR.sql", 
                "isSuccess": true, 
                "template": "LF_WR.sql", 
                "sid": 6, 
                "endTime": 1575595730.1991
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:57", 
                "startTimeFormat": "2019-12-06 09:28:50", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/LF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 7.677484035491943, 
                "key": "LF_WS", 
                "sql": "drop table wsv;\r\nCREATE table wsv AS\r\nSELECT d1.d_date_sk ws_sold_date_sk,\r\nt_time_sk ws_sold_time_sk,\r\nd2.d_date_sk ws_ship_date_sk,\r\ni_item_sk ws_item_sk,\r\nc1.c_customer_sk ws_bill_customer_sk,\r\nc1.c_current_cdemo_sk ws_bill_cdemo_sk,\r\nc1.c_current_hdemo_sk ws_bill_hdemo_sk,\r\nc1.c_current_addr_sk ws_bill_addr_sk,\r\nc2.c_customer_sk ws_ship_customer_sk,\r\nc2.c_current_cdemo_sk ws_ship_cdemo_sk,\r\nc2.c_current_hdemo_sk ws_ship_hdemo_sk,\r\nc2.c_current_addr_sk ws_ship_addr_sk,\r\nwp_web_page_sk ws_web_page_sk,\r\nweb_site_sk ws_web_site_sk,\r\nsm_ship_mode_sk ws_ship_mode_sk,\r\nw_warehouse_sk ws_warehouse_sk,\r\np_promo_sk ws_promo_sk,\r\nword_order_id ws_order_number,\r\nwlin_quantity ws_quantity,\r\ni_wholesale_cost ws_wholesale_cost,\r\ni_current_price ws_list_price,\r\nwlin_sales_price ws_sales_price,\r\n(i_current_price-wlin_sales_price)*wlin_quantity ws_ext_discount_amt,\r\nwlin_sales_price * wlin_quantity ws_ext_sales_price,\r\ni_wholesale_cost * wlin_quantity ws_ext_wholesale_cost,\r\ni_current_price * wlin_quantity ws_ext_list_price,\r\ni_current_price * web_tax_percentage ws_ext_tax,\r\nwlin_coupon_amt ws_coupon_amt,\r\nwlin_ship_cost * wlin_quantity WS_EXT_SHIP_COST,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt ws_net_paid,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)*(1+web_tax_percentage) ws_net_paid_inc_tax,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(wlin_quantity*i_wholesale_cost)\r\nWS_NET_PAID_INC_SHIP,\r\n(wlin_sales_price * wlin_quantity)-wlin_coupon_amt + (wlin_ship_cost * wlin_quantity)\r\n+ i_current_price * web_tax_percentage WS_NET_PAID_INC_SHIP_TAX,\r\n((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(i_wholesale_cost * wlin_quantity)\r\nWS_NET_PROFIT\r\nFROM\r\ns_web_order\r\nLEFT OUTER JOIN date_dim d1 ON (cast(TO_DATE(word_order_date, 'YYYY-MM-DD') as date) = d1.d_date)\r\nLEFT OUTER JOIN time_dim ON (word_order_time = t_time)\r\nLEFT OUTER JOIN customer c1 ON (word_bill_customer_id = c1.c_customer_id)\r\nLEFT OUTER JOIN customer c2 ON (word_ship_customer_id = c2.c_customer_id)\r\nLEFT OUTER JOIN web_site ON (word_web_site_id = web_site_id AND web_rec_end_date IS NULL)\r\nLEFT OUTER JOIN ship_mode ON (word_ship_mode_id = sm_ship_mode_id)\r\nJOIN s_web_order_lineitem ON (word_order_id = wlin_order_id)\r\nLEFT OUTER JOIN date_dim d2 ON (cast(TO_DATE(wlin_ship_date, 'YYYY-MM-DD') as date) = d2.d_date)\r\nLEFT OUTER JOIN item ON (wlin_item_id = i_item_id AND i_rec_end_date IS NULL)\r\nLEFT OUTER JOIN web_page ON (wlin_web_page_id = wp_web_page_id AND wp_rec_end_date IS NULL)\r\nLEFT OUTER JOIN warehouse ON (wlin_warehouse_id = w_warehouse_id)\r\nLEFT OUTER JOIN promotion ON (wlin_promotion_id = p_promo_id);\r\n\r\ninsert into web_sales select \r\n ws_sold_date_sk,ws_sold_time_sk, ws_ship_date_sk, ws_item_sk, ws_bill_customer_sk, ws_bill_cdemo_sk, ws_bill_hdemo_sk, ws_bill_addr_sk, ws_ship_customer_sk, ws_ship_cdemo_sk, ws_ship_hdemo_sk, ws_ship_addr_sk, ws_web_page_sk, ws_web_site_sk, ws_ship_mode_sk, ws_warehouse_sk, ws_promo_sk, ws_order_number, ws_quantity, ws_wholesale_cost, ws_list_price, ws_sales_price, ws_ext_discount_amt, ws_ext_sales_price, ws_ext_wholesale_cost, ws_ext_list_price, ws_ext_tax, ws_coupon_amt, ws_ext_ship_cost, ws_net_paid, ws_net_paid_inc_tax, ws_net_paid_inc_ship, ws_net_paid_inc_ship_tax, ws_net_profit\r\nfrom wsv\r\n\r\n", 
                "oneline_sql": "", 
                "id": 7, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/LF_WS.sql", 
                "startTime": 1575595730.199215, 
                "secondFormat": "00:00:07", 
                "filename": "LF_WS.sql", 
                "isSuccess": true, 
                "template": "LF_WS.sql", 
                "sid": 7, 
                "endTime": 1575595737.876699
            }, 
            {
                "endTimeFormat": "2019-12-06 09:28:58", 
                "startTimeFormat": "2019-12-06 09:28:57", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_CS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.9231371879577637, 
                "key": "DF_CS", 
                "sql": "delete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and cs_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from catalog_returns where cr_order_number in  (select cs_order_number from catalog_sales, date_dim  where cs_sold_date_sk=d_date_sk and\td_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from catalog_sales where cs_sold_date_sk >=  (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and cs_sold_date_sk <=  (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n\r\n", 
                "oneline_sql": "", 
                "id": 8, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_CS.sql", 
                "startTime": 1575595737.876803, 
                "secondFormat": "00:00:00", 
                "filename": "DF_CS.sql", 
                "isSuccess": true, 
                "template": "DF_CS.sql", 
                "sid": 8, 
                "endTime": 1575595738.79994
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:20", 
                "startTimeFormat": "2019-12-06 09:28:58", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_SS.sql", 
                "oneline_sqlpath": "", 
                "second": 21.649942874908447, 
                "key": "DF_SS", 
                "sql": "delete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk<= (select max(d_date_sk) from date_dim  where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from store_returns where sr_ticket_number in (select ss_ticket_number from store_sales, date_dim   where ss_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from store_sales where ss_sold_date_sk >= (select min(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tss_sold_date_sk <= (select max(d_date_sk) from date_dim  where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 9, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_SS.sql", 
                "startTime": 1575595738.800055, 
                "secondFormat": "00:00:21", 
                "filename": "DF_SS.sql", 
                "isSuccess": true, 
                "template": "DF_SS.sql", 
                "sid": 9, 
                "endTime": 1575595760.449998
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:20", 
                "startTimeFormat": "2019-12-06 09:29:20", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_WS.sql", 
                "oneline_sqlpath": "", 
                "second": 0.2865328788757324, 
                "key": "DF_WS", 
                "sql": "delete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd')) and\r\n\t\t\t\t ws_sold_date_sk <= (select max(d_date_sk) from date_dim where d_date between to_date('2000-05-20','yyyy-mm-dd') and to_date('2000-05-21','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd')) and \r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r1999-09-18','yyyy-mm-dd') and to_date('1999-09-19','yyyy-mm-dd'));\r\n\r\ndelete from web_returns where wr_order_number in (select ws_order_number from web_sales, date_dim where ws_sold_date_sk=d_date_sk and d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'));\r\ndelete from web_sales where ws_sold_date_sk >= (select min(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd')) and\r\n\t\t\t\tws_sold_date_sk<= (select max(d_date_sk) from date_dim where d_date between to_date('\r2002-11-12','yyyy-mm-dd') and to_date('2002-11-13','yyyy-mm-dd'))\r\n\r\n", 
                "oneline_sql": "", 
                "id": 10, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_WS.sql", 
                "startTime": 1575595760.450108, 
                "secondFormat": "00:00:00", 
                "filename": "DF_WS.sql", 
                "isSuccess": true, 
                "template": "DF_WS.sql", 
                "sid": 10, 
                "endTime": 1575595760.736641
            }, 
            {
                "endTimeFormat": "2019-12-06 09:29:23", 
                "startTimeFormat": "2019-12-06 09:29:20", 
                "file": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/dm/DF_I.sql", 
                "oneline_sqlpath": "", 
                "second": 3.0651791095733643, 
                "key": "DF_I", 
                "sql": "delete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('2000-05-18','yyyy-mm-dd') and to_date('2000-05-25','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r1999-09-16','yyyy-mm-dd') and to_date('1999-09-23','yyyy-mm-dd'));\r\n\r\ndelete from inventory where inv_date_sk >= ( select min(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd')) and \r\n\t\t\t\tinv_date_sk <= ( select max(d_date_sk) from date_dim  where  d_date between to_date('\r2002-11-14','yyyy-mm-dd') and to_date('2002-11-21','yyyy-mm-dd'))\r\n", 
                "oneline_sql": "", 
                "id": 11, 
                "sqlpath": "/home/yfjz/tpcds/dtrunner/tools/tpcds/tpcdsConf/stream/shentong/dm/DF_I.sql", 
                "startTime": 1575595760.736763, 
                "secondFormat": "00:00:03", 
                "filename": "DF_I.sql", 
                "isSuccess": true, 
                "template": "DF_I.sql", 
                "sid": 11, 
                "endTime": 1575595763.801942
            }
        ], 
        "second": 101.43125987052917, 
        "startTime": 1575595662.370989, 
        "endTime": 1575595763.802249
    }
}