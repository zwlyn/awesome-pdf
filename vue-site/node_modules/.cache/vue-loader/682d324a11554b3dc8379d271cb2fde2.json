{"remainingRequest":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\src\\views\\reportmanage\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\src\\views\\reportmanage\\index.vue","mtime":1579245002362},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1577960050320},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\babel-loader\\lib\\index.js","mtime":1577960100595},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1577960050320},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\vue-loader\\lib\\index.js","mtime":1577960037517}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc2VsZWN0VmFsdWU6ICIiLAogICAgICAgICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHVzZVRlbXBsYXRlOiB0cnVlLAogICAgICAgICAgICB0YWJsZURhdGE6IFtdLAogICAgICAgICAgICB0ZW1wbGF0ZU5hbWU6ICIiLAogICAgICAgICAgICBhY3Rpb246IHRoaXMuJGNsaWVudC5hcGlVcmxwcmVmaXgoKSArICIvcmVwb3J0bWFuYWdlL3VwbG9hZC90ZW1wbGF0ZSIsCiAgICAgICAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgICAgICAgaXNQYWdpbmF0aW9uOiBmYWxzZSwKICAgICAgICAgICAgLy8g5b2T5YmN6aG1CiAgICAgICAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICAgICAgICAvLyDmr4/pobXlpJrlsJHmnaEKICAgICAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgbmV3VGVtcGxhdGUoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJuZXdUZW1wbGF0ZSIpCiAgICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QodGhpcy4kY2xpZW50LmFwaVVybHByZWZpeCgpICsgIi9yZXBvcnRtYW5hZ2UvbmV3VGVtcGxhdGUiLCB7CiAgICAgICAgICAgICAgICAidGVtcGxhdGVOYW1lIjogdGhpcy50ZW1wbGF0ZU5hbWUsCiAgICAgICAgICAgICAgICAic2FtcGxlIjogdGhpcy5zZWxlY3RWYWx1ZQogICAgICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLm1lc3NhZ2UpCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgIH0sCiAgICAgICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpIHsKICAgICAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHZhbDsKICAgICAgICB9LAogICAgICAgIC8vIOW9k+WJjemhtQogICAgICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB2YWw7CiAgICAgICAgfSwKICAgICAgICBoYW5kbGVFZGl0KGluZGV4LCByb3cpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coaW5kZXgsIHJvdyk7CiAgICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QodGhpcy4kY2xpZW50LmFwaVVybHByZWZpeCgpICsgIi9yZXBvcnRtYW5hZ2Uvc2V0VGVtcGxhdGUiLCB7CiAgICAgICAgICAgICAgICAibmFtZSI6IHJvdwogICAgICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHsKICAgICAgICAgICAgICAgIC8vIGxldCB0ZW1wbGF0ZSA9IHJlcy5kYXRhLm1lc3NhZ2UudGVtcGxhdGUKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRlbXBsYXRlKQogICAgICAgICAgICAgICAgLy8gbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRlbXBsYXRlIiwgSlNPTi5zdHJpbmdpZnkodGVtcGxhdGUpKTsKCiAgICAgICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnJldGNvZGUgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICBuYW1lOiAncmVwb3J0ZWRpdCcKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGRhdGFNYW5hZ2UoaW5kZXgsIHJvdykgewogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2N1cnJlbnRUZW1wbGF0ZScsIHJvdykKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgbmFtZTogJ2RhdGFtYW5hZ2UnCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBoYW5kbGVEZWxldGUoaW5kZXgsIHJvdykgewogICAgICAgICAgICBjb25zb2xlLmxvZyhpbmRleCwgcm93KTsKICAgICAgICAgICAgdGhpcy4kYXhpb3MucG9zdCh0aGlzLiRjbGllbnQuYXBpVXJscHJlZml4KCkgKyAiL3JlcG9ydG1hbmFnZS9kZWxUZW1wbGF0ZSIsIHsKICAgICAgICAgICAgICAgICJ0ZW1wbGF0ZU5hbWUiOiByb3cKICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpCiAgICAgICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnJldGNvZGUgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgaGFuZGxlUmVuZGVyKGluZGV4LCByb3cpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coaW5kZXgsIHJvdyk7CiAgICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QodGhpcy4kY2xpZW50LmFwaVVybHByZWZpeCgpICsgIi9yZXBvcnRtYW5hZ2Uvc2V0VGVtcGxhdGUiLCB7CiAgICAgICAgICAgICAgICAidGVtcGxhdGVOYW1lIjogcm93CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgICAgICAgLy8gbGV0IHRlbXBsYXRlID0gcmVzLmRhdGEubWVzc2FnZS50ZW1wbGF0ZQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGVtcGxhdGUpCiAgICAgICAgICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidGVtcGxhdGUiLCBKU09OLnN0cmluZ2lmeSh0ZW1wbGF0ZSkpOwogICAgICAgICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5yZXRjb2RlID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgbmFtZTogJ3BkZnJlbmRlcicKICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICB2YXIgX3RoYXQgPSB0aGlzOwogICAgICAgIHRoaXMuJGNsaWVudC5ub3RpZnl3cy5ub3RpZnlCdXMuJG9uKCJ0ZW1wbGF0ZXNMaXN0IiwgZnVuY3Rpb24ocmVzKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YS50ZW1wbGF0ZXNMaXN0KQogICAgICAgICAgICAgICAgX3RoYXQudGFibGVEYXRhID0gcmVzLmRhdGEudGVtcGxhdGVzTGlzdAogICAgICAgICAgICB9KSwKCiAgICAgICAgICAgIHRoaXMuJGF4aW9zLmdldCh0aGlzLiRjbGllbnQuYXBpVXJscHJlZml4KCkgKyAiL3JlcG9ydG1hbmFnZS90ZW1wbGF0ZXNMaXN0Iiwge30sIGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKQogICAgICAgICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5yZXRjb2RlID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEubWVzc2FnZS50ZW1wbGF0ZXNMaXN0KQogICAgICAgICAgICAgICAgICAgICAgICBfdGhhdC50YWJsZURhdGEgPSByZXMuZGF0YS5tZXNzYWdlLnRlbXBsYXRlc0xpc3QKCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/reportmanage","sourcesContent":["<template>\r\n    <div>\r\n        <div>\r\n            <el-form :inline=\"true\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\" style=\"padding: 10px; padding-bottom: 0px;\">\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" @click=\"dialogFormVisible = true\">新建模板</el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n            <el-dialog title=\"新建模板\" :visible.sync=\"dialogFormVisible\" style=\"height: auto;\">\r\n                <el-form>\r\n                    <el-form-item label=\"模板名称\">\r\n                        <el-input v-model=\"templateName\" auto-complete=\"off\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"继承已有模板\">\r\n                        <el-switch v-model=\"useTemplate\" active-color=\"#13ce66\" inactive-color=\"#ff4949\">\r\n                        </el-switch>\r\n                    </el-form-item>\r\n                </el-form>\r\n                <div slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n                    <el-button type=\"primary\" @click=\"newTemplate()\">确 定</el-button>\r\n                </div>\r\n                <div v-if=\"useTemplate\">\r\n                    <el-select v-model=\"selectValue\" filterable placeholder=\"请选择\">\r\n                        <el-option v-for=\"item in tableData\" :key=\"item\" :label=\"item\" :value=\"item\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </div>\r\n            </el-dialog>\r\n\r\n            <el-table :data=tableData.slice((currentPage-1)*pageSize,currentPage*pageSize) style=\"width: 100%\">\r\n                <el-divider></el-divider>\r\n                <el-table-column label=\"报告名称\" width=\"400\">\r\n                    <template slot-scope=\"props\">\r\n                        <span style=\"margin-left: 10px\">{{ props.row }}</span>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\r\n                        <el-button size=\"mini\" @click=\"handleRender(scope.$index, scope.row)\">报告生成</el-button>\r\n                        <el-button size=\"mini\" @click=\"dataManage(scope.$index, scope.row)\">数据管理</el-button>\r\n                        <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n        </div>\r\n        <div>\r\n            <el-pagination @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\" :current-page=\"currentPage\"\r\n                :page-sizes=\"[10, 20, 30, 50, 100]\" :page-size=\"pageSize\" layout=\"total, sizes, prev, pager, next, jumper\"\r\n                :total=\"tableData.length\" width=\"300\">\r\n            </el-pagination>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                selectValue: \"\",\r\n                dialogFormVisible: false,\r\n                useTemplate: true,\r\n                tableData: [],\r\n                templateName: \"\",\r\n                action: this.$client.apiUrlprefix() + \"/reportmanage/upload/template\",\r\n                fileList: [],\r\n                isPagination: false,\r\n                // 当前页\r\n                currentPage: 1,\r\n                // 每页多少条\r\n                pageSize: 10,\r\n            }\r\n        },\r\n        methods: {\r\n            newTemplate() {\r\n                console.log(\"newTemplate\")\r\n                this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/newTemplate\", {\r\n                    \"templateName\": this.templateName,\r\n                    \"sample\": this.selectValue\r\n                }, function(res) {\r\n                    console.log(res.data.message)\r\n                })\r\n                this.dialogFormVisible = false\r\n            },\r\n            handleSizeChange(val) {\r\n                this.pageSize = val;\r\n            },\r\n            // 当前页\r\n            handleCurrentChange(val) {\r\n                this.currentPage = val;\r\n            },\r\n            handleEdit(index, row) {\r\n                console.log(index, row);\r\n                this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/setTemplate\", {\r\n                    \"name\": row\r\n                }, function(res) {\r\n                    // let template = res.data.message.template\r\n                    // console.log(template)\r\n                    // localStorage.setItem(\"template\", JSON.stringify(template));\r\n\r\n                    if (res) {\r\n                        if (res.data.retcode == 0) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    }\r\n                })\r\n                this.$router.push({\r\n                    name: 'reportedit'\r\n                })\r\n            },\r\n            dataManage(index, row) {\r\n                window.localStorage.setItem('currentTemplate', row)\r\n                this.$router.push({\r\n                    name: 'datamanage'\r\n                })\r\n            },\r\n            handleDelete(index, row) {\r\n                console.log(index, row);\r\n                this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/delTemplate\", {\r\n                    \"templateName\": row\r\n                }, function(res) {\r\n                    console.log(res)\r\n                    if (res) {\r\n                        if (res.data.retcode == 0) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            handleRender(index, row) {\r\n                console.log(index, row);\r\n                this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/setTemplate\", {\r\n                    \"templateName\": row\r\n                }, function(res) {\r\n                    // let template = res.data.message.template\r\n                    // console.log(template)\r\n                    // localStorage.setItem(\"template\", JSON.stringify(template));\r\n                    if (res) {\r\n                        if (res.data.retcode == 0) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    }\r\n                })\r\n                this.$router.push({\r\n                    name: 'pdfrender'\r\n                })\r\n            }\r\n        },\r\n        mounted() {\r\n            var _that = this;\r\n            this.$client.notifyws.notifyBus.$on(\"templatesList\", function(res) {\r\n                    console.log(res.data.templatesList)\r\n                    _that.tableData = res.data.templatesList\r\n                }),\r\n\r\n                this.$axios.get(this.$client.apiUrlprefix() + \"/reportmanage/templatesList\", {}, function(res) {\r\n                    console.log(res)\r\n                    if (res) {\r\n                        if (res.data.retcode == 0) {\r\n                            console.log(res.data.message.templatesList)\r\n                            _that.tableData = res.data.message.templatesList\r\n\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    }\r\n                })\r\n        }\r\n    }\r\n</script>\n"]}]}