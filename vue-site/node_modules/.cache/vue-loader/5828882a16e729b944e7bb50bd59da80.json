{"remainingRequest":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\src\\views\\caserecord\\index.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\src\\views\\caserecord\\index.vue","mtime":1577668509438},{"path":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace\\yfjz\\leming-webapiscraper\\vue-sites\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lbC1oZWFkZXIsCi5lbC1mb290ZXIgewoJYmFja2dyb3VuZC1jb2xvcjogI2IzYzBkMTsKCWNvbG9yOiAjMzMzOwoJdGV4dC1hbGlnbjogY2VudGVyOwoJbGluZS1oZWlnaHQ6IDIwMHB4Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsQA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/caserecord","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-form label-width=\"100px\" class=\"demo-ruleForm\" ref=\"ruleForm\">\r\n\t\t\t<el-form-item label=\"项目名称\" prop=\"projectname\">\r\n\t\t\t\t<!-- <el-input v-model=\"projectname\"\r\n                  autocomplete=\"off\"></el-input> -->\r\n\t\t\t\t<el-row class=\"demo-autocomplete\">\r\n\t\t\t\t\t<el-col style=\"width: 100%\">\r\n\t\t\t\t\t\t<div class=\"sub-title\"></div>\r\n\t\t\t\t\t\t<el-autocomplete class=\"inline-input\" :fetch-suggestions=\"querySearch\" placeholder=\"请选择项目名称或输入新项目名称\" @select=\"handleSelect\"\r\n\t\t\t\t\t\tstyle=\"width: 100%\" v-model=projectname>\r\n\t\t\t\t\t\t</el-autocomplete>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-row>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"用例名称\" prop=\"name\">\r\n\t\t\t\t<el-input v-model=\"name\" autocomplete=\"off\" oninput=\"value=value.replace(/\\W/g,'')\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"描述信息\" prop=description>\r\n\t\t\t\t<el-input v-model=\"description\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"混合比\">\r\n\t\t\t\t<el-input v-model.number=\"mix\" autocomplete=\"off\" oninput=\"value=value.replace(/\\D/g,'')\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"startRecord()\">启动录制</el-button>\r\n\t\t\t\t<el-button @click=\"stopRecord()\">停止录制</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"testAll()\">测试用例</el-button>\r\n\t\t\t\t<!-- <p>状态: {{ status }}</p> -->\r\n\t\t\t\t<!-- \t\t\t\t<el-option label=\"状态\" :value=\"status\"></el-option> -->\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\r\n\t\t<el-table :data=\"tableData\" style=\"width: 100%\">\r\n\t\t\t<el-table-column type=\"expand\">\r\n\t\t\t\t<template slot-scope=\"props\">\r\n\t\t\t\t\t<http-card :api=\"props.row\"></http-card>\r\n\t\t\t\t</template>\r\n\t\t\t</el-table-column>\r\n\t\t\t<el-table-column label=\"Method\" prop=\"method\">\r\n\t\t\t</el-table-column>\r\n\t\t\t<el-table-column label=\"Url\" prop=\"simpleUrl\">\r\n\t\t\t</el-table-column>\r\n\t\t\t<el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n\t\t\t\t<!-- <el-tag type=\"danger\" prop=\"status\"></el-tag> -->\r\n\t\t\t</el-table-column>\r\n\t\t</el-table>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport HttpCard from \"@/views/caserecord/httpcard.vue\"\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttableData: [],\r\n\t\t\t\tstatus: \"\",\r\n\t\t\t\tcouldTest: false,\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tprojectname: \"\",\r\n\t\t\t\tdescription: \"\",\r\n\t\t\t\trestaurants: [],\r\n\t\t\t\tmix: \"1\",\r\n\t\t\t\tprojectList: []\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcomponents: {\r\n\t\t\tHttpCard\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tloadAll() {\r\n\t\t\t\tvar _that = this;\r\n\t\t\t\tthis.$axios.get(this.$client.apiUrlprefix() + \"/webapiscraper/project/list\", {},\r\n\t\t\t\t\tfunction(res) {\r\n\t\t\t\t\t\tconsole.log(res.data.projectList)\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < res.data.projectList.length; i++) {\r\n\t\t\t\t\t\t\tvar tmp = {}\r\n\t\t\t\t\t\t\ttmp.value = res.data.projectList[i]\r\n\t\t\t\t\t\t\t_that.projectList.push(tmp)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\treturn this.projectList\r\n\t\t\t},\r\n\t\t\thandleSelect(item) {\r\n\t\t\t\tconsole.log(item);\r\n\t\t\t\tthis.projectname = item.value\r\n\t\t\t\tthis.$axios.post(this.$client.apiUrlprefix() + \"/webapiscraper/project/set\", {\r\n\t\t\t\t\t\"name\": this.projectname\r\n\t\t\t\t}, function(res) {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\tif (res.data.retcode == 0) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t},\r\n\t\t\tquerySearch(queryString, cb) {\r\n\t\t\t\tvar restaurants = this.restaurants;\r\n\t\t\t\tvar results = queryString ? restaurants.filter(this.createFilter(queryString)) : restaurants;\r\n\t\t\t\t// 调用 callback 返回建议列表的数据\r\n\t\t\t\tcb(results);\r\n\t\t\t},\r\n\t\t\tcreateFilter(queryString) {\r\n\t\t\t\treturn (restaurant) => {\r\n\t\t\t\t\treturn (restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tOnResponse(cases) {\r\n\t\t\t\tvar tableData = []\r\n\t\t\t\t//this.couldTest = true\r\n\t\t\t\tfor (var i = 0; i < cases.length; i++) {\r\n\t\t\t\t\tif (this.name === cases[i].name) {\r\n\t\t\t\t\t\tvar apis = cases[i].apis;\r\n\t\t\t\t\t\tfor (var j = 0; j < apis.length; j++) {\r\n\t\t\t\t\t\t\tvar item = apis[j]\r\n\t\t\t\t\t\t\ttableData.push(item)\r\n\t\t\t\t\t\t\t// if (apis[j].rawResponse) {\r\n\t\t\t\t\t\t\t// \ttableData.push(item)\r\n\t\t\t\t\t\t\t// } else {\r\n\t\t\t\t\t\t\t// \tthis.couldTest = false\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\t// if (this.couldTest) {\r\n\t\t\t\t\t\t\t// \tthis.status = \"请求返回完毕，可以停止录制\"\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.tableData = tableData\r\n\t\t\t},\r\n\t\t\tstartRecord() {\r\n\t\t\t\tthis.setStorage();\r\n\t\t\t\tvar data = {\r\n\t\t\t\t\t\"caseID\": this.name,\r\n\t\t\t\t\t\"description\": this.description,\r\n\t\t\t\t\t\"mix\": this.mix,\r\n\t\t\t\t\t\"projectName\": this.projectname\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"启动录制\")\r\n\t\t\t\tconsole.log(this.name)\r\n\t\t\t\tif (this.name == \"\" || this.name === undefined) {\r\n\t\t\t\t\tconsole.log(\"输入有误\")\r\n\t\t\t\t\tthis.$client.notifyError(this, \"启动录制失败\", \"用例名称不能为空！\", 4000);\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (this.projectname ==\"\" || this.projectname ==undefined) {\r\n\t\t\t\t\tconsole.log(\"输入有误\")\r\n\t\t\t\t\tthis.$client.notifyError(this, \"启动录制失败\", \"项目名称不能为空！\", 4000);\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar _that = this;\r\n\t\t\t\tthis.$axios.post(this.$client.apiUrlprefix() + \"/webapiscraper/monitor/start\", data, function(res) {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res.data.retcode == 0) {\r\n\t\t\t\t\t\t//_that.$client.notifySuccess(_that, \"启动录制成功\", \"\", 3000);\r\n\t\t\t\t\t\t//_that.status = \"正在进行录制,请不要停止录制\"\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//_that.status = \"请在调试模式下运行Chrome浏览器\"\r\n\t\t\t\t\t\t_that.$client.notifyError(_that, \"启动录制失败\", \"输入参数有误！\", 4000);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tstopRecord() {\r\n\r\n\t\t\t\tvar _that = this;\r\n\t\t\t\tconsole.log(this.name, this.description)\r\n\t\t\t\tvar data = {\r\n\t\t\t\t\t\"caseID\": this.name,\r\n\t\t\t\t\t\"description\": this.description\r\n\t\t\t\t}\r\n\t\t\t\tthis.$axios.post(this.$client.apiUrlprefix() + \"/webapiscraper/monitor/end\", data, function(res) {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res.data.retcode === 0) {\r\n\t\t\t\t\t\t_that.$client.notifySuccess(_that, \"已经停止录制\");\r\n\t\t\t\t\t\t_that.status = \"已停止录制\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_that.$client.notifyError(_that, \"停止录制失败\");\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\ttestAll() {\r\n\t\t\t\tvar _that = this\r\n\t\t\t\tif (_that.tableData == []) {\r\n\t\t\t\t\t_that.$client.notifyError(_that, \"数据为空不能进行测试！\");\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t_that.$client.notifySuccess(_that, \"正在测试中...\");\r\n\t\t\t\tthis.$axios.post(this.$client.apiUrlprefix() + \"/webapiscraper/testAll\", this.tableData, function(res) {\r\n\t\t\t\t\tconsole.log(res.data.message)\r\n\t\t\t\t\t//alert(res.data.message)\r\n\t\t\t\t\tlet testApis = res.data.message\r\n\t\t\t\t\tfor (var i = 0; i < testApis.length; i++) {\r\n\t\t\t\t\t\tif (testApis[i].status === \"Failed\") _that.status = _that.name + ' 测试不通过!'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (i >= testApis.length) _that.status = _that.name + ' 测试通过!'\r\n\t\t\t\t\t_that.tableData = testApis\r\n\t\t\t\t\t_that.$client.notifySuccess(_that, \"测试结束请看网址的状态\");\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tsetStorage(){\r\n\t\t\t\tlocalStorage.setItem(\"caseID\", this.name);\r\n\t\t\t\tlocalStorage.setItem(\"description\", this.description);\r\n\t\t\t\tlocalStorage.setItem(\"mix\", this.mix);\r\n\t\t\t\tlocalStorage.setItem(\"projectName\", this.projectname);\r\n\t\t\t\tconsole.log(\"已经成功暂存\");\r\n\t\t\t},\r\n\t\t\tgetStorage(){\r\n\t\t\t\tthis.name = localStorage.getItem('caseID');\r\n\t\t\t\tthis.description = localStorage.getItem('description');\r\n\t\t\t\tthis.mix = localStorage.getItem('mix');\r\n\t\t\t\tthis.projectname = localStorage.getItem('projectName');\r\n\t\t\t\tconsole.log(\"已经获得暂存\");\t\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tif(localStorage.getItem('caseID') != undefined || localStorage.getItem('description') != undefined || localStorage.getItem('mix') != undefined || localStorage.getItem('projectName') != undefined){\r\n\t\t\t\tthis.getStorage()\r\n\t\t\t}\r\n\t\t\tthis.restaurants = this.loadAll()\r\n\t\t\t// this.mix = 1\r\n\t\t\t// this.name = this.$route.params.name\r\n\t\t\t// this.projectname = this.$route.params.projectname\r\n\t\t\t// this.description = this.$route.params.description\r\n\t\t\tvar _that = this;\r\n\t\t\tthis.$client.notifyws.notifyBus.$on(\"WebApiScaperNotifyStatus\", function(res) {\r\n\t\t\t\tif (res.code == -1) {\r\n\t\t\t\t\t_that.$client.notifyError(_that, \"录制启动失败\", \"请先打开chrome浏览器！\", 4000);\r\n\t\t\t\t\tconsole.log(\"录制启动失败\", \"请先打开chrome浏览器！\")\r\n\t\t\t\t} else if (res.code == 0) {\r\n\t\t\t\t\t_that.$client.notifySuccess(_that, \"录制启动成功\", \"请打开弹出的页面进行录制操作！\", 4000);\r\n\t\t\t\t\tconsole.log(\"录制启动成功\", \"请打开弹出的页面进行录制操作！\")\r\n\t\t\t\t} else if (res.code == 1) {\r\n\t\t\t\t\t_that.$client.notifySuccess(_that, \"录制启动成功\", \"请在已经打开的页面接着录制操作！\", 4000);\r\n\t\t\t\t\tconsole.log(\"录制启动成功\", \"请在已经打开的页面接着录制操作！\")\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.$client.notifyws.notifyBus.$on(\"WebApiScaperData\", function(res) {\r\n\t\t\t\t_that.OnResponse(res.data.cases)\r\n\t\t\t});\r\n\t\t\tthis.$axios.get(this.$client.apiUrlprefix() + \"/webapiscraper/result\", {}, function(res) {\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\tif (res.data.retcode == 0) {\r\n\t\t\t\t\t\tconsole.log(res.data.result.cases)\r\n\t\t\t\t\t\t_that.OnResponse(res.data.result.cases)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.el-header,\r\n\t.el-footer {\r\n\t\tbackground-color: #b3c0d1;\r\n\t\tcolor: #333;\r\n\t\ttext-align: center;\r\n\t\tline-height: 200px;\r\n\t}\r\n</style>\r\n"]}]}