{"remainingRequest":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\src\\views\\pdfrender\\index.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\src\\views\\pdfrender\\index.vue","mtime":1579172789016},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\css-loader\\dist\\cjs.js","mtime":1577960050887},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1577960037541},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\postcss-loader\\src\\index.js","mtime":1577960051578},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1577960050320},{"path":"D:\\workspace\\yfjz\\leming-reportdesigner\\vue-sites\\node_modules\\vue-loader\\lib\\index.js","mtime":1577960037517}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouQ29kZU1pcnJvciB7CiAgICBvdmVyZmxvdy15OiBzY3JvbGw7CiAgICBoZWlnaHQ6IDkwMHB4Owp9CgouQ29kZU1pcnJvci1mb2N1c2VkIC5jbS1tYXRjaGhpZ2hsaWdodCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFBSUFBQUFDQ0FZQUFBQnl0ZzBrQUFBQUZrbEVRVlFJMTJOZ1lHQmdrS3pjOHg5Q01EQXdBQUFtaHdTYmlkRW9TUUFBQUFCSlJVNUVya0pnZ2c9PSk7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBib3R0b207CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7Cn0KCi5jbS1tYXRjaGhpZ2hsaWdodCB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyZWVuCn0KCi5Db2RlTWlycm9yLXNlbGVjdGlvbi1oaWdobGlnaHQtc2Nyb2xsYmFyIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGdyZWVuCn0KCi5wZGZwcmV2aWV3IHsKICAgIGhlaWdodDogY2FsYygxMDAlIC0gNTBweCk7CiAgICB3aWR0aDogMTAwJTsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogNDVweDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiQA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/pdfrender","sourcesContent":["<template>\r\n\r\n    <el-row>\r\n        <el-col :span=\"12\">\r\n            <el-button @click=\"pdfrender()\" type=\"success\" style=\"margin: 10px;\">生成报告</el-button>\r\n            <el-button @click=\"formatData()\" type=\"primary\" style=\"margin: 10px;\">{{formatButtonValue}}</el-button>\r\n            <el-button @click=\"dialogFormVisible = true\" type=\"primary\" style=\"margin: 10px;\">保存</el-button>\r\n            <el-dialog title=\"保存数据\" :visible.sync=\"dialogFormVisible\">\r\n              <el-form>\r\n                <el-form-item label=\"数据名称\">\r\n                  <el-input v-model=\"dataName\" auto-complete=\"off\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"同时保存pdf\">\r\n                    <el-switch\r\n                      v-model=\"createPdf\"\r\n                      active-color=\"#13ce66\"\r\n                      inactive-color=\"#ff4949\">\r\n                    </el-switch>\r\n                </el-form-item>\r\n              </el-form>\r\n              <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"save()\">确 定</el-button>\r\n              </div>\r\n            </el-dialog>\r\n           <el-dialog title=\"请输入以下参数\" :visible.sync=\"formatArgsVisible\">\r\n              <el-form>\r\n                <el-form-item label=\"数据库类型\" v-if=\"formatArgs.needDbtype\">\r\n                      <el-select placeholder=\"请选择\" v-model=\"formatArgs.dbtype\">\r\n                        <el-option\r\n                          v-for=\"item in formatArgs.dbtypeList\"\r\n                          :key=\"item\"\r\n                          :label=\"item\"\r\n                          :value=\"item\">\r\n                        </el-option>\r\n                      </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"用户数量\" v-if=\"formatArgs.needCustomer\">\r\n                  <el-input v-model=\"formatArgs.customer\" auto-complete=\"off\" ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"导入数据时间\" v-if=\"formatArgs.needDataLoad\">\r\n                  <el-input v-model=\"formatArgs.dataLoad\" auto-complete=\"off\" ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"同时保存pdf\">\r\n                    <el-switch\r\n                      v-model=\"createPdf\"\r\n                      active-color=\"#13ce66\"\r\n                      inactive-color=\"#ff4949\">\r\n                    </el-switch>\r\n                </el-form-item>\r\n              </el-form>\r\n              <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"formatArgsVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"formatWithArgs()\">确 定</el-button>\r\n              </div>\r\n            </el-dialog>\r\n            <div class=\"codemirror\">\r\n                <codemirror v-model=\"data\" :options=\"cmOptions\"></codemirror>\r\n            </div>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n            <div class=\"pdfpreview\">\r\n                <object :data=url type=\"application/pdf\" width=\"50%\" height=\"100%\" internalinstanceid=\"41\"></object>\r\n            </div>\r\n            \r\n        </el-col>\r\n    </el-row>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\n    // require component\r\n    import {\r\n        codemirror\r\n    } from 'vue-codemirror'\r\n\r\n    // require styles//\r\n    import 'codemirror/lib/codemirror.css'\r\n    import 'codemirror/mode/python/python.js'\r\n    import 'codemirror/theme/mbo.css'\r\n    import 'codemirror/theme/monokai.css'\r\n    import 'codemirror/addon/selection/active-line.js'\r\n    import 'codemirror/addon/edit/closebrackets.js'\r\n\r\n    // component\r\n    export default {\r\n        components: {\r\n            codemirror\r\n        },\r\n        data() {\r\n            return {\r\n                formatArgs:{\r\n                    dbtype:\"oracle\",\r\n                    customer:\"5000\",\r\n                    dataLoad:\"1800\",\r\n                    needDbtype:false,\r\n                    needCustomer:false,\r\n                    needDataLoad:false,\r\n                    dbtypeList:['oracle', 'dm', 'mysql', 'kingbase', 'sqlserver']\r\n                },\r\n                formatArgsVisible:false,\r\n                formatButtonValue:\"格式化数据\",\r\n                isFormate:false,\r\n                model: {},\r\n                dataName: \"\",\r\n                data: \"\",\r\n                url: \"\",\r\n                form:[],\r\n                createPdf: true,\r\n                dialogFormVisible: false,\r\n                cmOptions: {\r\n                    // codemirror options\r\n                    styleActiveLine: true,\r\n                    tabSize: 4,\r\n                    indentUnit: 4, // 智能缩进单位为4个空格长度\r\n                    indentWithTabs: true, // 使用制表符进行智能缩进\r\n                    mode: 'text/x-python',\r\n                    //keyMap: \"sublime\", // 快键键风格  会导致next错误\r\n                    smartIndent: true, //智能缩进\r\n                    lineWrapping: true, //\r\n                    theme: 'monokai',\r\n                    lineNumbers: true,\r\n                    line: true,\r\n                    gutters: [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"],\r\n                    highlightSelectionMatches: {\r\n                        showToken: /\\w/,\r\n                        annotateScrollbar: true\r\n                    },\r\n                    foldGutter: true,\r\n                    closebrackets: true\r\n                    // more codemirror options, 更多 codemirror 的高级配置...\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            formatWithArgs(){\r\n                var _that = this\r\n                if(this.isFormate === false){\r\n                    console.log(this.model)\r\n                    this.model.dataJson = JSON.parse(this.data)\r\n                    this.model.dataJson.dbtype = this.formatArgs.dbtype\r\n                    this.model.dataJson.customer = this.formatArgs.customer\r\n                    this.model.dataJson.dataLoad = this.formatArgs.dataLoad\r\n                    this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/formatData\", this.model, function(\r\n                        res) {\r\n                        console.log(res.data)\r\n                        _that.data = JSON.stringify(res.data.message, null, 4)\r\n                    })\r\n                    this.formatArgsVisible = false\r\n                    this.isFormate = true\r\n                    this.formatButtonValue = \"取消格式化\"\r\n                }\r\n            },\r\n            formatData(){\r\n                if(this.isFormate === false){\r\n                    if (this.model.templateName.search('tpce') === 0){\r\n                        this.formatArgsVisible = true\r\n                        this.formatArgs.needCustomer = true\r\n                        this.formatArgs.needDbtype = true\r\n                    }\r\n                    else if(this.model.templateName.search('tpcds') === 0){\r\n                        this.formatArgsVisible = true\r\n                        this.formatArgs.needCustomer = true\r\n                        this.formatArgs.needDbtype = true\r\n                        this.formatArgs.needDataLoad = true\r\n                    }\r\n                    else{\r\n                        var _that = this\r\n\r\n                            console.log(this.model)\r\n                            this.model.dataJson = JSON.parse(this.data)\r\n                            this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/formatData\", this.model, function(\r\n                                res) {\r\n                                console.log(res.data)\r\n                                _that.data = JSON.stringify(res.data.message, null, 4)\r\n                            })\r\n                            this.formatButtonValue = \"取消格式化\"\r\n                            this.isFormate = true\r\n                        }\r\n                }\r\n                else{\r\n                    this.isFormate = false\r\n                    this.formatButtonValue = \"格式化数据\"\r\n                    this.data = JSON.stringify(this.model.dataJson, null, 4)\r\n                }\r\n\r\n            },\r\n            onCmReady(cm) {\r\n                console.log('the editor is readied!', cm)\r\n            },\r\n            onCmFocus(cm) {\r\n                console.log('the editor is focus!', cm)\r\n            },\r\n            onCmCodeChange(newCode) {\r\n                console.log('this is new code', newCode)\r\n                this.data = newCode\r\n            },\r\n            pdfrender() {\r\n                console.log('渲染脚本');\r\n                var _that = this;\r\n                this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/setData\", JSON.parse(this.data), function(\r\n                    res) {\r\n                    console.log(res.data)\r\n                })\r\n                this.$axios.get(this.$client.apiUrlprefix() + \"/reportmanage/pdfGenerate\", {}, function(res) {\r\n                    console.log(res.data.message)\r\n                    _that.url = _that.$client.apiUrlprefix() + \"/report/run?key=\" + res.data.message;\r\n\r\n                })\r\n            },\r\n            save() {\r\n                if (this.model.dataModel.dataPath == undefined){\r\n                    // 创建新的data的 json文件\r\n                    this.model.dataModel.dataPath = this.model.dataModel.dirPath + this.dataName + '.json'\r\n                    this.model.createPdf = this.createPdf \r\n\r\n                    this.model.dataModel.dataName = this.dataName\r\n                    this.model.dataJson = JSON.parse(this.data)\r\n                }\r\n                else{\r\n                    // 保存覆盖已有的data json文件\r\n                    this.model.createPdf = this.createPdf\r\n                    this.model.dataModel.dataPath = this.model.dataModel.dataPath.replace(this.model.dataModel.dataName, this.dataName)\r\n                    this.model.dataModel.dataName = this.dataName\r\n                    this.model.dataJson = JSON.parse(this.data)\r\n                }\r\n                this.$axios.post(this.$client.apiUrlprefix() + \"/reportmanage/saveData\", this.model, function(\r\n                    res) {\r\n                    console.log(res.data)\r\n                })\r\n                this.dialogFormVisible = false\r\n            }\r\n        },\r\n        mounted() {\r\n            var _that = this\r\n            this.$axios.get(this.$client.apiUrlprefix() + \"/reportmanage/getData\", {}, function(res) {\r\n                console.log(res.data.message)\r\n                if (res) {\r\n                    if (res.data.retcode == 0) {\r\n                        // 将json 转换为 string 并且 优美展示\r\n                        console.log(res.data.message)\r\n                        _that.model = res.data.message\r\n                        _that.data = JSON.stringify(res.data.message.dataJson, null, 4);\r\n                        _that.dataName = res.data.message.dataModel.dataName\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                }\r\n            })\r\n\r\n        }\r\n\r\n    }\r\n</script>\r\n<style>\r\n    .CodeMirror {\r\n        overflow-y: scroll;\r\n        height: 900px;\r\n    }\r\n\r\n    .CodeMirror-focused .cm-matchhighlight {\r\n        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAFklEQVQI12NgYGBgkKzc8x9CMDAwAAAmhwSbidEoSQAAAABJRU5ErkJggg==);\r\n        background-position: bottom;\r\n        background-repeat: repeat-x;\r\n    }\r\n\r\n    .cm-matchhighlight {\r\n        background-color: lightgreen\r\n    }\r\n\r\n    .CodeMirror-selection-highlight-scrollbar {\r\n        background-color: green\r\n    }\r\n\r\n    .pdfpreview {\r\n        height: calc(100% - 50px);\r\n        width: 100%;\r\n        position: absolute;\r\n        top: 45px;\r\n    }\r\n</style>\n"]}]}